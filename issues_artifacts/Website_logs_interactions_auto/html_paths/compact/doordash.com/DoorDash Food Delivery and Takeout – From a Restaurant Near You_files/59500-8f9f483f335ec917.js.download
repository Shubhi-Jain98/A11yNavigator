!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="39008230-6354-4753-b0ba-751a8b8a65f4",e._sentryDebugIdIdentifier="sentry-dbid-39008230-6354-4753-b0ba-751a8b8a65f4")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59500],{941528:function(e,t,d){d.d(t,{A:function(){return o}});var n=d(385796),r=d(729724),s=d(823302);let i=[r.G.ConvenienceMerchantFirstProduct,r.G.ConvenienceItemFirstProduct,r.G.BrowseListLink,r.G.SeoItemFirstProduct],l=e=>{let{crawlerInfo:t}=(0,s.qr)(e=>({crawlerInfo:e.crawlerInfo})),d=(0,s.qr)(e=>e.pageType);return t.isCrawler?"no_prompt":!e&&d&&i.includes(d)?"geolocation_prompt_multi_confirm":"default"},a={showGetLocationButton:!1,onClickGetLocation:()=>{},autocompleteInitialValue:"",autocompleteFetchOnFocus:!1,isGetLocationButtonDisabled:!1,isLoading:!1,firstAddressAutocompleteLocation:null,showAddressBarSubmitButton:!1,shouldFetchGeoLocationOnLoad:!1,shouldAddAddressAfterPermissionsGrant:!1,fetchGeoLocationAddresses:()=>{},showAddressInputModalOnLoad:!0,isAddressBarGeoSuggestionDropdownEnabled:!1,isAddressBarAutofocusEnabled:!1,showAddressTopPromptBanner:!0,addressCollectionVariant:"default"},o=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{fetchGeoLocationAddresses:d,addressSuggestions:r,isLoading:s}=(0,n.f)(),i=l(t),o=null==r?void 0:null===(e=r[0])||void 0===e?void 0:e.street,u={...a,onClickGetLocation:()=>{r.length||d()},autocompleteInitialValue:t?"":o,autocompleteFetchOnFocus:!t,isLoading:s,firstAddressAutocompleteLocation:(null==r?void 0:r[0])||null,showAddressBarSubmitButton:!0,shouldFetchGeoLocationOnLoad:!0,fetchGeoLocationAddresses:d,addressCollectionVariant:i};if("default"===i);else if("no_prompt"===i)return{...a,showAddressInputModalOnLoad:!1,isGetLocationButtonDisabled:!0,showAddressTopPromptBanner:!1};else if("geolocation_prompt_confirm"===i)return u;else if("geolocation_prompt_deferred"===i)return{...u,showAddressInputModalOnLoad:!1,shouldFetchGeoLocationOnLoad:!1,showAddressTopPromptBanner:!1};else if("geolocation_prompt_no_confirm"===i)return{...u,showAddressInputModalOnLoad:!1,shouldAddAddressAfterPermissionsGrant:!0,showAddressTopPromptBanner:!1};else if("geolocation_prompt_multi_confirm"===i)return{...u,autocompleteInitialValue:"",isAddressBarGeoSuggestionDropdownEnabled:!0};return a}},555912:function(e,t,d){var n=d(361967),r=d(196421),s=d(576263),i=d(951939),l=d(454709),a=d(723280),o=d(976067),u=d(465830),c=d(313773),f=d(222679),p=d(152724),g=d(516202),m=d(116692),v=d(278884),h=d(970501),b=d(818617),A=d(455639),_=d(360968),y=d(480704),S=d(99060),x=d(195650),C=d(283416),P=d(895973),I=d(148632),j=d(871387),E=d(717182),k=d(861264),Z=d(731690),L=d(994084),w=d(712504);t.Z=e=>{var t;let{dropoffOptions:d=[],dropoffPreferences:T=[],onCancel:D,driverInstructions:O,address:N,handleSubmitNewAddress:F,handleSubmitEditAddress:$,customizations:B,onShowPinCodeEducationModal:M,doNotShowPinCodeWarningBanner:z}=e,{consumer:R}=(0,v.R)(),U=(0,f.jb)(e=>e.state),q=(0,p.p)(),G=(0,y._h)(),V=(0,m.Z)(N.countryCode),{localEditForm:W,updateLocalEditForm:Q}=(0,E.R)({selectedAdddressData:N,isBuzzerInputEncouraged:V,consumerLastName:R.lastName,dropoffOptions:d,dropoffPreferences:T,driverInstructions:O}),{subpremise:H,entryCode:K,selectedDropoffOptionId:Y,dropoffOptionWithInstructions:J,draftCoordinates:X,formError:ee}=W,et=(0,k.V0)(ee),[ed,en]=c.useState(k.Gt.Edit),er=()=>Q("draftCoordinates",null),[es,ei]=c.useState(null),el=()=>ei(null),{isAdjustPinReadjustmentEnabled:ea}=(0,w.Z)(),{hideAdjustPin:eo=!1,hideDropOffOptions:eu=!1}=B||{};return(c.useEffect(()=>{(0,A.j)(_.wd.EditAddressPageView)},[]),ed===k.Gt.ChangePin)?(0,n.jsx)(S.Z,{address:N,onSubmit:e=>{if(Q("formError",""),el(),ea){Q("draftCoordinates",e),en(k.Gt.Edit);return}(0,y.ng)(e,N)?(Q("draftCoordinates",e),en(k.Gt.Edit)):(er(),ei(Z.ZP.t("addressPickerStrings_addressEditPinLocationError")))},onCancel:e=>{e.nativeEvent.stopImmediatePropagation(),er(),el(),en(k.Gt.Edit)},draftCoordinates:X||(0,y.ey)(N),handleChangePinLocation:e=>{Q("draftCoordinates",e)},errorMessage:es,hideTitle:!1,shouldStackActionButtons:!1,hideActionButtons:!1}):(0,n.jsxs)(i.Z,{"data-anchor-id":b.ep.AddressEditForm,"data-testid":b.ep.AddressEditForm,children:[(0,n.jsx)(P.Z,{separatorType:l.C.separator,children:(0,n.jsx)(C.Z,{hideAdjustPin:eo,isAddressLabelEnabled:!1,shortname:null!==(t=N.shortname)&&void 0!==t?t:"",printableAddress:N.printableAddress,address:N,locationOverride:X||(0,y.ey)(N),onClickAdjustPin:e=>{e.nativeEvent.stopImmediatePropagation(),en(k.Gt.ChangePin),(0,I.mo)()},subpremise:H})}),(0,n.jsx)(g.Z,{onClick:()=>{},orderCartId:null==q?void 0:q.id}),(0,n.jsx)(a.Z,{value:H,size:o.J9.small,onChange:e=>Q("subpremise",e),placeholder:V?Z.ZP.t("addressPickerStrings_apartmentInputWithBuzzer_placeholder"):Z.ZP.t("addressPickerStrings_apartmentInput_placeholder"),label:V?Z.ZP.t("addressPickerStrings_apartmentInputWithBuzzer_label"):Z.ZP.t("addressPickerStrings_apartmentInput_label")}),G&&"ready"===U&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.Z,{value:K,size:o.J9.small,onChange:e=>{Q("entryCode",e)},placeholder:Z.ZP.t("addressPickerStrings_entryCode_placeholder"),label:Z.ZP.t("addressPickerStrings_entryCode_label"),description:Z.ZP.t("addressPickerStrings_OptionalLabel")})}),!eu&&(0,n.jsx)(j.Z,{dropoffOptions:d,selectedDropoffOptionId:Y,onDropoffOptionChange:e=>Q("selectedDropoffOptionId",e),instructions:(0,y.I0)(J,Y),onInstructionsChange:e=>{Y&&Q("dropoffOptionWithInstructions",J.slice().map(t=>t.optionId===Y?{optionId:Y,instructions:e}:t))},useNewDesign:!1,onCloseOfAddressEdit:D,onShowPinCodeEducationModal:M,doNotShowPinCodeWarningBanner:z}),!!et&&(0,n.jsx)(x.Z,{children:null!=et?et:""}),(0,n.jsxs)(u.Z,{children:[(0,n.jsx)(r.Z,{onClick:D,type:s.L$.tertiary,children:Z.ZP.t("addressPickerStrings_addressEditCancel")}),(0,n.jsx)(r.Z,{"data-anchor-id":b.ep.AddressEditSave,onClick:function(e){e.nativeEvent.stopImmediatePropagation();let t=Y||void 0,d=H||"",n=K||"",r=(0,y.I0)(J,Y),{manualLat:s,manualLng:i}=(0,y.Yt)(X),l={subpremise:d,driverInstructions:r,dropoffOptionId:t,manualLat:s,manualLng:i,addressLinkType:h.z5q.ADDRESS_LINK_TYPE_UNSPECIFIED,entryCode:n,buildingName:void 0,personalAddressLabel:void 0,addressId:N.addressId},{lat:a,lng:o}=N;Q("formError",null);let u=(0,y.Uq)(N)?N.id:"";if(K&&(0,I.eK)(u,K.length),(0,y.Uq)(N)){var c;null===(c=$({...l,addressId:N.id}))||void 0===c||c.then(()=>{s&&i&&(0,L.$g)({original_lat:a,original_lng:o,pin_lat:s,pin_lng:i})}).catch(e=>{Q("formError",(0,k.Au)(e)),s&&i&&(0,k.NC)(e)&&(0,L.ij)({original_lat:a,original_lng:o,pin_lat:s,pin_lng:i})})}else{let e=F(l);void 0!==e&&e.then(()=>{(0,I.KS)({manualLat:s,manualLng:i,lat:a,lng:o,dropoffOptionId:t}),s&&i&&(0,L.$g)({original_lat:a,original_lng:o,pin_lat:s,pin_lng:i})}).catch(e=>{Q("formError",(0,k.Au)(e)),(0,I.hJ)({manualLat:s,manualLng:i,lat:a,lng:o,dropoffOptionId:t}),s&&i&&(0,k.NC)(e)&&(0,L.ij)({original_lat:a,original_lng:o,pin_lat:s,pin_lng:i})})}},children:Z.ZP.t("addressPickerStrings_addressEditSave")})]})]})}},283416:function(e,t,d){var n=d(361967),r=d(951939),s=d(655692),i=d(161206),l=d(901270),a=d(465830),o=d(54881),u=d(196421),c=d(576263),f=d(686143);d(313773);var p=d(469894),g=d(805990),m=d(731690),v=d(374856),h=d(650646),b=d(861264),A=d(653394);let _=(0,p.default)(()=>Promise.all([d.e(1042),d.e(8334),d.e(60638)]).then(d.bind(d,332350)),{loadableGenerated:{webpack:()=>[332350]},ssr:!1}),y={styles:b.r};t.Z=e=>{let{hideAdjustPin:t,isAddressLabelEnabled:d,shortname:p,subpremise:b,printableAddress:S,address:x,locationOverride:C,onClickAdjustPin:P}=e,I=(0,A.cv)(),j=I&&void 0!==x.formattedAddressSegmentedList&&x.formattedAddressSegmentedNonUserEditableFieldsList[0]?x.formattedAddressSegmentedNonUserEditableFieldsList[0]:b?"".concat(p," ").concat((0,g.Ay)(b)).trim():p,E=I&&void 0!==x.formattedAddressSegmentedList&&x.formattedAddressSegmentedNonUserEditableFieldsList[0]?x.formattedAddressSegmentedNonUserEditableFieldsList[0]:p,k=I&&void 0!==x.formattedAddressSegmentedList&&x.formattedAddressSegmentedNonUserEditableFieldsList[1]?x.formattedAddressSegmentedNonUserEditableFieldsList[1]:(0,g.gj)(p||"",S||"");return(0,n.jsxs)(r.Z,{size:d?s.Uo.small:s.Uo.none,children:[!d&&(0,n.jsx)(i.x,{textStyle:l.TextStyle.display.medium,"data-testid":"AddressEditHeaderTitle",children:E}),(0,n.jsx)(_,{defaultAddress:x,locationOverride:C,mapOptions:d?y:void 0,allowDifferentMapProvider:!0}),(0,n.jsxs)(a.Z,{alignItems:o.v2.center,justifyContent:o.dy.spaceBetween,children:[(0,n.jsxs)(r.Z,{size:d?s.Uo.none:s.Uo.xxSmall,children:[(0,n.jsx)(i.x,{textStyle:d?l.TextStyle.label.medium.default:l.TextStyle.label.large.strong,color:l.d9.text.default,children:I?E:d?j:p}),(0,n.jsx)(i.x,{textStyle:l.TextStyle.label.small.default,color:l.d9.text.subdued.default,children:k})]}),!t&&(0,n.jsx)(h.iP,{children:(0,n.jsx)(u.Z,{onClick:P,type:c.L$.tertiary,size:d?f.qE.small:void 0,"data-testid":v.D.AddressEditAdjustPinButton,children:m.ZP.t("addressPickerStrings_addressEditAdjustPin")})})]})]})}},895973:function(e,t,d){var n=d(361967),r=d(454709),s=d(366503);d(313773);var i=d(374856);t.Z=e=>{let{separatorType:t=r.C.fullBorder,hideSeparator:d=!1,children:l}=e;return(0,n.jsxs)(n.Fragment,{children:[l,!d&&(0,n.jsx)(s.Z,{"data-testid":i.D.AddressEditSectionSeparator,type:t})]})}},650646:function(e,t,d){d.d(t,{Bv:function(){return u},Ko:function(){return o},RY:function(){return f},Si:function(){return c},iP:function(){return a},pW:function(){return p}});var n=d(992899),r=d(685393),s=d(806286),i=d(455277),l=d(918564);let a=l.default.div.withConfig({componentId:"sc-48f6a83f-0"})(["flex:0;"]),o=l.default.div.withConfig({componentId:"sc-48f6a83f-1"})(["width:calc("," * 2);top:80%;left:50%;transform:translate(-50%,-50%);position:absolute;"],n.Q2.usage.space.legacyXxxLarge),u=l.default.div.withConfig({componentId:"sc-48f6a83f-2"})(["width:auto;button{div{padding:",";}}"],n.Q2.usage.space.none);l.default.div.withConfig({componentId:"sc-48f6a83f-3"})(["padding-top:",";margin-left:calc(-1 * ",");margin-right:calc(-1 * ",");"],n.Q2.usage.space.xxxLarge,n.Q2.usage.space.medium,n.Q2.usage.space.medium);let c=l.default.button.withConfig({componentId:"sc-48f6a83f-4"})(["display:flex;justify-content:center;align-items:center;cursor:pointer;border:none;background-color:inherit;padding:0;"]),f=(0,l.default)(r.Z).attrs(()=>({type:s.IconType.CloseCircleFill,size:i.J.medium})).withConfig({componentId:"sc-48f6a83f-5"})([""]),p=l.default.div.withConfig({componentId:"sc-48f6a83f-6"})(["padding-top:",";"],n.Q2.usage.space.xSmall)},148632:function(e,t,d){d.d(t,{KS:function(){return l},UR:function(){return c},ZU:function(){return u},eK:function(){return p},hJ:function(){return a},mo:function(){return f}});var n=d(650118),r=d(455639),s=d(360968);let i=e=>t=>{let d,{manualLat:s,manualLng:i,lat:l,lng:a,dropoffOptionId:o}=t,u=!!(s&&i);d=s&&i?(0,n.Z)({latitude:s,longitude:i},{latitude:l,longitude:a}):0,(0,r.j)(e,{withCustomCoordinates:u,dropoff_option_id:o,pin_lat:s,pin_lng:i,original_addr_lat:l,original_addr_lng:a,distance:d})},l=i(s.wd.SubmittedNewAddress),a=i(s.wd.SubmittedNewAddressError),o=e=>t=>{let{addressId:d,manualLat:n,manualLng:s}=t;(0,r.j)(e,{address_id:d,pin_lat:n,pin_lng:s})},u=o(s.wd.SubmittedPinAdjustment),c=o(s.wd.SubmittedPinAdjustmentError),f=()=>{(0,r.j)(s.wd.ClickedAdjustPin)},p=(e,t)=>{(0,r.j)(s.wd.ChangedEntryCode,{address_id:e,entryCodeLength:t})}},504253:function(e,t,d){d.d(t,{Z:function(){return H}});var n=d(361967),r=d(951939),s=d(655692),i=d(465830),l=d(723280),a=d(976067),o=d(196421),u=d(576263),c=d(686143),f=d(806286),p=d(827515),g=d(313773),m=d(152724),v=d(516202),h=d(116692),b=d(278884),A=d(249478),_=d(818617),y=d(731690),S=d(455639),x=d(360968),C=d(480704),P=d(99060),I=d(498777),j=d(374856),E=d(85890),k=d(283416),Z=d(895973),L=d(650646),w=d(148632),T=d(725075),D=d(538204),O=d(161206),N=d(901270),F=d(928823),$=d(350497),B=d.n($),M=d(885174),z=d(6383),R=d(861264);let U=B()(e=>e(),200);var q=e=>{let{labelName:t,onChange:d,error:i}=e,[o,u]=g.useState(),[c,f]=g.useState(t),p=g.useRef(null),m=(0,R.Rc)(i);return g.useEffect(()=>{(0,R.Yg)(i)&&p.current&&(0,M.Wk)(p.current,80)},[i]),(0,n.jsxs)(r.Z,{size:s.Uo.small,children:[(0,n.jsx)("div",{ref:p,children:(0,n.jsx)(l.Z,{value:c,size:a.J9.large,label:y.ZP.t("addressPickerStrings_addressLabel_label"),onChange:e=>{f(e),U(()=>{let t=e.trim();d(t),u((0,R.Kf)(t))})},onClick:()=>(0,z.Jn)(c),placeholder:y.ZP.t("addressPickerStrings_addressLabel_placeholder"),renderAfterContent:c?()=>(0,n.jsx)(L.Si,{type:"button","aria-label":y.ZP.t("addressPickerStrings_addressLabel_clearButtonText"),onClick:()=>{d(""),f(""),u(void 0)},children:(0,n.jsx)(L.RY,{})}):void 0,error:m&&i?i:o})}),(0,n.jsx)(T.Z,{"data-testid":j.D.AddressLabelBanner,bannerType:D.$.highlight,body:(0,n.jsx)(O.x,{textStyle:N.TextStyle.body.small.default,children:y.ZP.t("addressPickerStrings_addressLabel_bannerText")}),iconType:F.W.None})]})},G=d(871387),V=d(717182),W=d(166120),Q=d(970501),H=e=>{var t,d;let{dropoffOptions:T=[],dropoffPreferences:D=[],driverInstructions:O,address:N,preSelectedAddressLabelName:F,handleRemoveAddress:$,defaultAddressId:B,hideAdjustPin:M=!1,hideDropOffOptions:z=!1,onShowPinCodeEducationModal:R,onCloseOfAddressEdit:U,doNotShowPinCodeWarningBanner:H}=e,{consumer:K}=(0,b.R)(),Y=(0,m.p)(),{isMobile:J}=(0,A.ac)(),X=(0,h.Z)(N.countryCode),{mode:ee,setMode:et,useDraftAddressFromModal:ed,draftAddress:en,setDraftAddress:er,editFormError:es,setEditFormError:ei}=null!==(t=(0,I.R)())&&void 0!==t?t:{},{localEditForm:el,updateLocalEditForm:ea}=(0,V.R)({selectedAdddressData:N,isBuzzerInputEncouraged:X,consumerLastName:K.lastName,dropoffOptions:T,dropoffPreferences:D,driverInstructions:O,preSelectedAddressLabelName:F}),{subpremise:eo,buildingName:eu,entryCode:ec,personalAddressLabelName:ef,selectedDropoffOptionId:ep,dropoffOptionWithInstructions:eg,draftCoordinates:em}=el,ev=!!(0,C.Uq)(N)&&B===N.id;!function(e){let{skip:t,localEditForm:d,setDraftAddress:n,address:r,isGiftingAddressToggled:s}=e,{isAddressLabelEnabled:i}=(0,W.Z)();(0,g.useEffect)(()=>{t||null==n||n(e=>{let t=i?{labelName:d.personalAddressLabelName,labelIcon:null}:null,n={subpremise:d.subpremise,buildingName:d.buildingName,entryCode:d.entryCode,dropoffOptionId:d.selectedDropoffOptionId||void 0,driverInstructions:(0,C.I0)(d.dropoffOptionWithInstructions,d.selectedDropoffOptionId),addressLinkType:s?Q.z5q.ADDRESS_LINK_TYPE_GIFT:Q.z5q.ADDRESS_LINK_TYPE_UNSPECIFIED,personalAddressLabel:t,isGiftingAddressToggled:s,draftCoordinates:d.draftCoordinates,googlePlaceId:(0,C.aN)(r)?r.googlePlaceId:"",id:(0,C.aN)(r)?"":r.id,addressId:""};if(!e){var l,a,o,u,c,f;return{...r,...n,city:null!==(l=r.city)&&void 0!==l?l:"",state:null!==(a=r.state)&&void 0!==a?a:"",lat:r.lat,lng:r.lng,street:null!==(o=r.street)&&void 0!==o?o:"",shortname:null!==(u=r.shortname)&&void 0!==u?u:"",printableAddress:null!==(c=r.printableAddress)&&void 0!==c?c:"",zipCode:null!==(f=r.zipCode)&&void 0!==f?f:""}}return{...r,...e,...n}})},[d,t,s,n,i,r])}({skip:!ed,localEditForm:el,setDraftAddress:er,address:N,isGiftingAddressToggled:!1});let eh=g.useCallback(e=>ea("personalAddressLabelName",e),[ea]);return(g.useEffect(()=>{(0,S.j)(x.wd.EditAddressPageView)},[]),ee===E.A.Default)?null:ee===E.A.ChangePin?(0,n.jsx)(P.Z,{address:N,draftCoordinates:em||(0,C.ey)(N),handleChangePinLocation:e=>ea("draftCoordinates",e),errorMessage:null,hideTitle:!0,shouldStackActionButtons:J,hideActionButtons:!0}):(0,n.jsxs)(r.Z,{"data-anchor-id":_.ep.AddressEditForm,"data-testid":j.D.AddressEditForm,children:[(0,n.jsx)(r.Z,{size:s.Uo.small,children:(0,n.jsx)(Z.Z,{children:(0,n.jsx)(k.Z,{hideAdjustPin:M,isAddressLabelEnabled:!0,shortname:null!==(d=N.shortname)&&void 0!==d?d:"",printableAddress:N.printableAddress,address:N,locationOverride:(null==en?void 0:en.draftCoordinates)||(0,C.ey)(N),onClickAdjustPin:e=>{e.nativeEvent.stopImmediatePropagation(),null==ei||ei(null),null==et||et(E.A.ChangePin),(0,w.mo)()},subpremise:eo})})}),(0,n.jsxs)(Z.Z,{children:[(0,n.jsx)(v.Z,{onClick:()=>{},orderCartId:null==Y?void 0:Y.id}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(l.Z,{value:eo,size:a.J9.small,onChange:e=>ea("subpremise",e),label:X?y.ZP.t("addressPickerStrings_apartmentInputWithBuzzer_label"):y.ZP.t("addressPickerStrings_apartmentInput_labelV2")}),(0,n.jsx)(l.Z,{value:ec,size:a.J9.small,onChange:e=>{ea("entryCode",e)},label:y.ZP.t("addressPickerStrings_entryCode_label")})]}),(0,n.jsx)(l.Z,{value:eu,size:a.J9.small,onChange:e=>{ea("buildingName",e)},label:y.ZP.t("addressPickerStrings_buildingName_label")}),!z&&(0,n.jsx)(G.Z,{dropoffOptions:T,selectedDropoffOptionId:ep,onDropoffOptionChange:e=>ea("selectedDropoffOptionId",e),instructions:(0,C.I0)(eg,ep),onInstructionsChange:e=>{ep&&ea("dropoffOptionWithInstructions",eg.slice().map(t=>t.optionId===ep?{optionId:ep,instructions:e}:t))},useNewDesign:!0,onCloseOfAddressEdit:U,onShowPinCodeEducationModal:R,doNotShowPinCodeWarningBanner:H})]}),!K.isGuest&&(0,n.jsx)(Z.Z,{hideSeparator:ev,children:(0,n.jsx)(q,{labelName:ef,onChange:eh,error:null!=es?es:null})}),!ev&&(0,C.Uq)(N)&&(0,n.jsx)(Z.Z,{hideSeparator:!0,children:(0,n.jsx)(L.pW,{"data-testid":j.D.AddressEditRemoveButton,children:(0,n.jsx)(o.Z,{type:u.L$.destructive,size:c.qE.small,isInline:!0,leadingIcon:f.IconType.TrashLine,onClick:()=>$((0,C.Uq)(N)?N.id:""),children:y.ZP.t("address_remove_address")})})}),(0,n.jsx)(p.Z,{size:J?s.$f.legacyXxxLarge:s.$f.xxxLarge})]})}},994084:function(e,t,d){d.d(t,{$g:function(){return i},ij:function(){return l},oT:function(){return s}});var n=d(360968),r=d(455639);let s=()=>{(0,r.j)(n.wd.AdjustPinPageView)},i=e=>{(0,r.j)(n.wd.AdjustPinSaveSuccess,e)},l=e=>{(0,r.j)(n.wd.AdjustPinSaveDistanceTooFarError,e)}},871387:function(e,t,d){d.d(t,{Z:function(){return C}});var n=d(361967),r=d(723280),s=d(976067),i=d(951939),l=d(655692),a=d(161206),o=d(901270),u=d(465830),c=d(196421),f=d(576263),p=d(686143),g=d(1702),m=d(444080),v=d(313773),h=d(818617),b=d(544904),A=d(731690),_=d(970501),y=d(725075),S=d(538204),x=e=>{let{bannerLabel:t="",bannerBody:d,onCloseOfAddressEdit:r,onShowPinCodeEducationModal:s}=e;return(0,n.jsx)(y.Z,{label:t,body:d,bannerStyle:S.v4.default,bannerType:S.$.warning,actionPosition:S.b2.bottom,primaryAction:{onClick:()=>{null==r||r(),null==s||s()},content:A.ZP.t("manageSubscription_learnMore")}})},C=e=>{let{dropoffOptions:t,selectedDropoffOptionId:d,onDropoffOptionChange:y,instructions:S,onInstructionsChange:C,useNewDesign:P,onCloseOfAddressEdit:I,onShowPinCodeEducationModal:j,doNotShowPinCodeWarningBanner:E}=e,k=t.find(e=>(null==e?void 0:e.id)==="2"),Z=t.find(e=>(null==e?void 0:e.id)==="1"),L=(null==Z?void 0:Z.proofOfDeliveryType)===_.VCv.PIN_CODE,[w,T]=v.useState(""),D=A.ZP.t("addressPickerStrings_dropOffOptions_pinCode_disabled_message");v.useEffect(()=>{(null==k?void 0:k.disabledMessage)&&T(null==k?void 0:k.disabledMessage)},[t,null==k?void 0:k.disabledMessage]);let O=e=>null!==d?(0,n.jsx)(r.Z,{value:S,size:s.J9.medium,onChange:C,isMultiline:e,isResizeable:!0,placeholder:(0,b.sQ)(t,d||""),label:(0,b.sQ)(t,d||""),isLabelHidden:!0,"data-testid":h.ep.AddressEditDropoffInstructions}):null;return P?(0,n.jsxs)(i.Z,{size:l.Uo.small,children:[(0,n.jsx)(a.x,{textStyle:o.TextStyle.label.small.strong,children:A.ZP.t("addressPickerStrings_dropOffOptionsSentenceCase")}),(0,n.jsx)(u.Z,{size:l.O8.xSmall,children:t.map(e=>(0,n.jsx)(c.Z,{type:f.L$.tertiary,size:p.qE.small,isDisabled:!e.isEnabled,isToggled:e.id===d,isToggleable:!0,isInline:!0,onClick:()=>y(e.id),"data-testid":h.ep.AddressEditDropoffOption,children:e.displayString},e.id))}),O(3),L&&!E&&(0,n.jsx)(x,{bannerBody:w||D,onCloseOfAddressEdit:I,onShowPinCodeEducationModal:j})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.Z,{"data-testid":h.ep.AddressEditDropoffSelection,children:[(0,n.jsx)(a.x,{textStyle:o.TextStyle.label.small.strong,children:A.ZP.t("addressPickerStrings_dropOffOptions")}),t.map(e=>(0,n.jsxs)(i.Z,{size:l.$f.small,children:[(0,n.jsx)(g.Z,{label:e.displayString,name:"dropoff-type",isDisabled:!e.isEnabled,isSelected:e.id===d,type:m._S.radio,onChange:()=>{y(e.id)},"data-testid":h.ep.AddressEditDropoffOption}),!e.isEnabled&&!L&&e.disabledMessage&&(0,n.jsx)(a.x,{textStyle:o.TextStyle.label.small.default,color:o.d9.text.default,children:e.disabledMessage})]},e.id))]}),O(2),L&&!E&&(0,n.jsx)(x,{bannerBody:w||D,onCloseOfAddressEdit:I,onShowPinCodeEducationModal:j})]})}},717182:function(e,t,d){d.d(t,{R:function(){return s}});var n=d(313773),r=d(544904);function s(e){let{selectedAdddressData:t,isBuzzerInputEncouraged:d,consumerLastName:s,dropoffOptions:i,dropoffPreferences:l,driverInstructions:a,preSelectedAddressLabelName:o}=e,[u,c]=(0,n.useState)(function(e){var t,d;let{selectedAdddressData:n,isBuzzerInputEncouraged:s,consumerLastName:i,dropoffOptions:l,dropoffPreferences:a,driverInstructions:o,preSelectedAddressLabelName:u}=e;return{subpremise:(s?i:null==n?void 0:n.subpremise)||"",buildingName:(null==n?void 0:n.buildingName)||"",entryCode:(null==n?void 0:n.entryCode)||"",personalAddressLabelName:null!==(d=null!=u?u:null==n?void 0:null===(t=n.personalAddressLabel)||void 0===t?void 0:t.labelName)&&void 0!==d?d:"",selectedDropoffOptionId:(0,r.xy)(a,l),dropoffOptionWithInstructions:(0,r.MG)(a,l,o),draftCoordinates:(null==n?void 0:n.manualLat)&&(null==n?void 0:n.manualLng)?{lat:null==n?void 0:n.manualLat,lng:null==n?void 0:n.manualLng}:null,formError:null}}({selectedAdddressData:t,isBuzzerInputEncouraged:d,consumerLastName:s,dropoffOptions:i,dropoffPreferences:l,driverInstructions:a,preSelectedAddressLabelName:o})),f=(0,n.useCallback)((e,t)=>{c(d=>({...d,[e]:t}))},[]);return(0,n.useMemo)(()=>({localEditForm:u,updateLocalEditForm:f}),[u,f])}},861264:function(e,t,d){d.d(t,{Au:function(){return f},Gt:function(){return r},Kf:function(){return g},NC:function(){return p},Rc:function(){return o},V0:function(){return c},Yg:function(){return u},r:function(){return l}});var n,r,s=d(55648),i=d(731690);(n=r||(r={})).ChangePin="ChangePin",n.Edit="Edit";let l=[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]}],a=["This label is already in use"],o=e=>!!(e&&a.includes(e)),u=e=>null==e?void 0:e.includes("value too long for type character varying(28)"),c=e=>o(e)?null:e,f=e=>{let t=(0,s.ie)(e);return(null==t?void 0:t.message)||i.ZP.t("addressPickerStrings_addressEditSaveNewError")},p=e=>{let t=(0,s.ie)(e);return((null==t?void 0:t.message)||"").includes("Pin location is too far from the address")},g=e=>0===e.length?i.ZP.t("addressPickerStrings_addressLabel_minCharacterError"):e.length>28?i.ZP.t("addressPickerStrings_addressLabel_maxCharacterError"):void 0},659500:function(e,t,d){d.d(t,{Z:function(){return di}});var n,r,s,i,l=d(361967),a=d(299891),o=d(313773),u=d(244118),c=d(299116),f=d(371801),p=d(964697),g=d(976067),m=d(196421),v=d(576263),h=d(686143),b=d(827515),A=d(655692),_=d(951939),y=d(366503),S=d(992899),x=d(262679),C=d(446169),P=d.n(C),I=d(918564),j=d(972173),E=d(554859),k=d(811094),Z=d(166120),L=d(649454),w=d(702210),T=d(731690),D=d(455639),O=d(544694),N=d(555912),F=d(504253),$=d(806286),B=d(161206),M=d(901270),z=d(818617),R=d(805990),U=d(360968),q=d(480704),G=d(374856),V=d(23644),W=d(424),Q=d(498367);let H=I.default.div.withConfig({componentId:"sc-d61ef26b-0"})(["> div{background-color:transparent;:hover{background-color:",";}}"],e=>{let{isSelected:t}=e;return t?W.i2.SystemRed20:S.Q2.usage.color.background.strong.default});var K=e=>{let{addressId:t,addressShortName:d,centered:n,size:r,useCustomTheme:s,isSelected:i,handleClick:a}=e,o=()=>(0,l.jsx)(V.Z,{type:v.L$.plain,"data-anchor-id":z.ep.AddressEditIcon,"data-testid":z.ep.AddressEditIcon,accessibilityLabel:T.ZP.t("addressPickerStrings_editAddressAriaLabel",{streetAddress:d}),onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a(t)},iconType:h.L.EditLine,tag:"div",size:null!=r?r:void 0}),u=()=>s?(0,l.jsx)(H,{isSelected:i,children:o()}):o();return n?(0,l.jsx)(Q.A7,{children:u()}):u()},Y=e=>{let{addressId:t,addressShortName:d,handleClick:n}=e;return(0,l.jsx)(V.Z,{type:v.L$.plain,"data-anchor-id":z.ep.AddressDeleteIcon,"data-testid":z.ep.AddressDeleteIcon,accessibilityLabel:T.ZP.t("addressPickerStrings_removeAddressAriaLabel",{streetAddress:d}),onClick:e=>{e.stopPropagation(),n(t)},iconType:h.L.Close,tag:"div"})},J=d(515916),X=d(871825),ee=d(356972),et=d(3746),ed=e=>{let{isSelected:t,title:d,subtext:n,iconStart:r,isSeparatorVisible:s=!0,renderAfterContent:i,onClick:a,dataAttributes:o}=e,{isAddressLabelEnabled:u}=(0,Z.Z)(),c=o?{"data-anchor-id":o.dataAnchorId,"data-testid":o.dataTestId}:{},f=()=>(0,l.jsx)(J.Z,{...c,size:X.LK.small,insetVerticalSize:u?A.wM.small:A.wM.medium,accessibilityRole:"radio",leadingIcon:r,isToggleable:!0,isToggled:t,onClick:a,label:d,description:n,renderAfterContent:i,isSeparatorVisible:s,iconVerticalAlignment:u?ee.Ao.center:void 0});return t&&u?(0,l.jsx)(et.iS,{overrides:{usage:{color:{transparent:{default:W.i2.SystemRed0,hovered:W.i2.SystemRed5,pressed:W.i2.SystemRed20}}}},children:f()}):(0,l.jsx)(l.Fragment,{children:f()})},en=d(653394),er=d(445116);let es=e=>{let{isSelected:t,isAddressLabelEnabled:d,personalAddressLabel:n}=e;return d?(0,q.at)(null==n?void 0:n.labelIcon,t):t?$.IconType.RadioOnCircleFill:$.IconType.RadioOffCircleLine};var ei=e=>{var t;let{availableAddresses:d,defaultAddressId:n,onEdit:r,onSelect:s,onRemove:i,source:a,isLiteGuest:u,isAddressLabelEnabled:c,getIsRecentAddressSelected:f}=e,p=null!==(t=null==d?void 0:d.filter(j.K))&&void 0!==t?t:[],g=p.length;o.useEffect(()=>{(0,D.j)(U.wd.EnterAddressPageView,{num_saved_addresses:g,source:a})},[g,a]);let m=(0,en.cv)(),v=(0,er.M)();return(0,l.jsx)("div",{role:"radiogroup","data-anchor-id":z.ep.AddressList,children:p.map((e,t)=>{var d;let a=e.shortname||"",o=m&&e.formattedAddressSegmentedList[0]?e.formattedAddressSegmentedList[0]:"".concat(e.shortname," ").concat((0,R.Ay)(e.subpremise)).trim(),g=(null==f?void 0:f(e.id))||!1,b=null!==(d=e.personalAddressLabel)&&void 0!==d?d:null,A=c&&(null==b?void 0:b.labelName);return(0,l.jsx)(ed,{isSelected:g,title:A?b.labelName:o,subtext:(()=>{let t=m&&e.formattedAddressSegmentedList[1]?e.formattedAddressSegmentedList[1]:A?e.printableAddress:(0,R.gj)(a,e.printableAddress||"");return c?(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.strong,color:g?M.d9.currentColor:M.d9.text.subdued.default,children:t}):t})(),iconStart:{isInteractive:!1,type:es({isSelected:g,isAddressLabelEnabled:c,personalAddressLabel:b})},isSeparatorVisible:!c||t!==p.length-1,renderAfterContent:()=>{if(u||v)return null;let t=c?h.rm.small:null;return(0,l.jsxs)(l.Fragment,{children:[r&&(0,l.jsx)(K,{addressId:e.id,addressShortName:a,handleClick:r,centered:c,size:t,useCustomTheme:c,isSelected:g}),!c&&!g&&i&&(0,l.jsx)(Y,{addressId:e.id,addressShortName:a,handleClick:i})]})},onClick:()=>{s(e.id),w.AR(n),(0,D.j)("m_update_user_default_address_job_success",{address_id:e.id})},dataAttributes:{dataAnchorId:z.ep.AddressListItem,dataTestId:G.D.AddressListItem}},e.id)})})},el=d(249478),ea=e=>{let{availableAddressesWithoutLabel:t,onClick:d}=e,[n,r]=o.useState(-1),{isMobile:s}=(0,el.ac)();return(0,l.jsx)(l.Fragment,{children:t.map((e,i)=>{var a;let o="".concat(e.shortname," ").concat((0,R.Ay)(e.subpremise)).trim(),u=n===i||s;return(0,l.jsx)("div",{onMouseEnter:()=>r(i),onMouseLeave:()=>r(-1),children:(0,l.jsx)(J.Z,{"data-anchor-id":z.ep.AddressListSetLabelItem,"data-testid":z.ep.AddressListSetLabelItem,size:X.LK.small,insetVerticalSize:A.wM.small,accessibilityRole:"radio",leadingIcon:{isInteractive:!1,type:$.IconType.LocationPinEnabledLine},isToggleable:!0,onClick:()=>{null==d||d(e.id)},label:o,description:(0,R.gj)(e.shortname||"",e.printableAddress||""),trailingIcon:u?{isInteractive:!1,type:$.IconType.ChevronRight,size:18}:void 0,isSeparatorVisible:i!==t.length-1})},null!==(a=e.id)&&void 0!==a?a:e.shortname)})})},eo=e=>{let{isSelected:t,onClick:d,isAddressLabelEnabled:n}=e,r=(0,l.jsx)(J.Z,{size:X.LK.small,accessibilityRole:"radio",leadingIcon:{isInteractive:!1,type:n?t?$.IconType.LocationPointerFill:$.IconType.LocationPointerLine:t?$.IconType.RadioOnCircleFill:$.IconType.RadioOffCircleLine},isToggleable:!0,isToggled:t,onClick:d,label:T.ZP.t("layoutStrings_header_currentLocation"),"data-testid":"CurrentLocationListCell"});return n&&t?(0,l.jsx)(et.iS,{overrides:{usage:{color:{transparent:{default:W.i2.SystemBlue5,hovered:W.i2.SystemBlue10,pressed:W.i2.SystemBlue30},brand:{primary:W.i2.SystemBlue70},text:{selected:S.Q2.usage.color.text.default}}}},children:r}):r},eu=d(222679),ec=d(305017),ef=d(970501),ep=d(6383);let eg=(0,I.default)(B.x).attrs(()=>({textStyle:M.TextStyle.title.medium})).withConfig({componentId:"sc-2bdec999-0"})(["padding-left:",";margin-bottom:",";margin-top:",";"],S.Q2.usage.space.medium,S.Q2.usage.space.xxSmall,S.Q2.usage.space.small);var em=e=>{let{trackingContext:t,labeledAddresses:d,getIsLabeledAddressSelected:n,onClickUnsetAddress:r,onSelectLabelWithAddress:s,onEditLabelWithAddress:i}=e,a=(0,eu.y)(ec.pc.addressLabelsWebFollowUp,!1),o=d.filter(e=>e.type!==ef.jEO.PLUS&&null==e.address),u=d.filter(e=>e.type!==ef.jEO.PLUS),c=a?u:o,f=e=>{var d,n,i,l;let{addressEntryPoint:o,defaultAddressId:u}=t;(0,ep.Ur)({addressEntryPoint:o.toLowerCase().includes("checkout")?U.kS.Checkout:U.kS.AddressPicker,labelName:e.labelName,labelIcon:e.labelIcon,settingNew:!a||!e.address,addressId:a?null===(d=e.address)||void 0===d?void 0:d.id:null,previousAddressId:a?u:null}),a&&e.address?s(e.address.id):r({addressId:"",shortname:null!==(i=null===(n=e.address)||void 0===n?void 0:n.shortname)&&void 0!==i?i:void 0,labelName:null!==(l=e.labelName)&&void 0!==l?l:void 0})};return 0===c.length?null:(0,l.jsxs)(l.Fragment,{children:[a&&(0,l.jsx)(eg,{children:T.ZP.t("addressPickerString_labeled")}),(0,l.jsx)(Q.Kk,{children:c.map((e,t)=>{var d;let r=null!=e.address,s=n(e);return(0,l.jsx)(ed,{isSelected:s,title:e.labelName,subtext:(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.strong,color:s?M.d9.currentColor:M.d9.text.subdued.default,children:a&&r?null===(d=e.address)||void 0===d?void 0:d.printableAddress:T.ZP.t("addressPickerStrings_setAddress")}),iconStart:{isInteractive:!1,type:(0,q.at)(e.labelIcon,s)},renderAfterContent:()=>a&&r&&e.address?(0,l.jsx)(K,{addressId:e.address.id,addressShortName:e.address.shortname||"",handleClick:()=>{var t;return(null===(t=e.address)||void 0===t?void 0:t.id)&&i(e)},centered:!0,size:h.rm.small,useCustomTheme:!0,isSelected:s}):(0,l.jsx)(Q.Wk,{children:(0,l.jsx)(V.Z,{iconType:h.L.Add,type:v.xZ.tertiary,accessibilityLabel:T.ZP.t("addressPickerStrings_addresses"),size:h.rm.small})}),onClick:()=>f(e)},"".concat(e.labelName,"-").concat(t))})})]})},ev=(e,t,d)=>{let{isAddressLabelEnabled:n}=(0,Z.Z)(),r=(0,eu.y)(ec.pc.addressLabelsWebFollowUp,!1)&&n,s=(0,o.useCallback)(n=>{let s=n===d,i=r&&!!e.find(e=>{var t;return(null===(t=e.address)||void 0===t?void 0:t.id)===n});return!t&&s&&!i},[r,t,d,e]),i=(0,o.useCallback)(e=>{var n;return r&&null!=e.address&&!t&&d===(null===(n=e.address)||void 0===n?void 0:n.id)},[r,t,d]);return(0,o.useMemo)(()=>({getIsRecentAddressSelected:s,getIsLabeledAddressSelected:i}),[s,i])},eh=d(997341),eb=d(498777),eA=d(488954),e_=d(85890);let ey=e=>{let{onClick:t,isDarkBackground:d,isDisabled:n=!1}=e;return(0,l.jsx)(m.Z,{isInline:!0,size:h.qE.small,leadingIcon:$.IconType.LocationPointerLine,type:d?v.L$.plain:v.L$.tertiary,onClick:t,accessibilityLabel:T.ZP.t("address_suggestion_get_location"),isDisabled:n,children:T.ZP.t("address_suggestion_get_location")})};var eS=d(941528),ex=d(837475),eC=d(514739),eP=d(298590),eI=d(730342),ej=d(584148);let eE=["Catex/AddressInput/PromptBanner/AddressPickerConnected","Common/Layout/LayoutAddressPicker/AddressPickerConnected"],ek=[eC.O6.none,eC.O6.xxxSmall],eZ=e=>{let{initialInputValue:t="",addressEntryPoint:d="",hideGetLocationButton:n=!0,enableGeoLocationRedesign:r=!1,onGeoSuggestionDropdownSelect:s,isOpen:i,...a}=e,[u,c]=(0,o.useState)(t),[f,p]=(0,o.useState)(!u),g=(0,o.useCallback)(()=>{p(!1)},[]);(0,ej.O)("scroll",g),(0,ej.O)("keypress",g);let m=(0,o.useCallback)(e=>{c(e.street),s(e),(0,eh.Bi)(d||"")},[d,s]);return(0,l.jsx)(eP.E,{anchorContainerDisplayMode:"block",isOpen:i,position:eC.eW.bottomCenter,shouldAutomaticallyFlip:!1,setContentWidthAsAnchorWidth:!0,offset:ek,content:f&&(0,l.jsx)(eL,{children:(0,l.jsx)(eI.Z.List,{onAddressSelect:m,isStaticPosition:!0,isAddressPickerInputEmpty:!u,enableHoverOnItemAfterContent:!1,hideGetLocationButton:n,enableLoggedOutHomePageStyle:r})}),children:(0,l.jsx)(O.Z,{...a,initialInputValue:u})})},eL=I.default.div.withConfig({componentId:"sc-aec236dd-0"})(["max-height:20vh;overflow-y:scroll;scroll-behavior:smooth;overscroll-behavior:auto;"]);var ew=d(994084),eT=d(861264),eD=d(483377),eO=d(948807),eN=d(885200),eF=d(789147),e$=d(242630),eB=d(975484),eM=d(278728),ez=d(807515);let eR=I.default.div.withConfig({componentId:"sc-ee921dd3-0"})(["display:",";flex-wrap:wrap;gap:",";"],e=>e.isVisible?"flex":"none",S.Q2.usage.space.medium);var eU=(0,ez.zH)(e=>{var t,d;let{addressEntryPoint:n,onAddAddress:r,availableAddresses:s,labeledAddresses:i,onUpdateAddress:a,onSelectAddress:S,dropoffOptions:C,loading:I,addressAutocompleteLabel:$,isStaticPositionSuggestions:B,hideAddressList:M,defaultAddressId:z,onRemoveAddress:R,isLiteGuest:G,isGuest:V,renderBeforeAddressList:W,customizations:H,renderFooterActions:K=()=>null,defaultAddress:Y,handleIdentityLinkClick:J,placeholder:X,showIdentityLink:ee=!0,setIsEditTitle:et,setSelectedAddress:ed,selectedAddressLabelName:er,isCurrentLocationEnabled:es,isCurrentLocationSelected:el,onClickCurrentLocation:eu,refetchQueries:ec,onSetLabelForAddressComplete:ef,onCloseAddressEdit:ep,onShowPinCodeEducationModal:eg,doNotShowPinCodeWarningBanner:eC}=e,{isAddressLabelEnabled:eP}=(0,Z.Z)(),eI=(0,en.Wk)(),{getAddressDetails:ej}=(0,eD.l)(),{getAddressCandidate:ek,saveAddressCandidate:eL}=(0,e$.y)(),ez="".concat(n,"/AddressPicker"),[eU,eq]=o.useState(),[eG,eV]=o.useState(e_.A.Default),[eW,eQ]=o.useState(!1),eH=(0,eF.t)(),{mode:eK,setMode:eY}=null!==(t=(0,eb.R)())&&void 0!==t?t:{},{getIsRecentAddressSelected:eJ,getIsLabeledAddressSelected:eX}=ev(i,el,z),e0=eK||eG,e1=eY||eV,{renderAddressEditFormInModal:e6=!1,editFormModalTitle:e9=T.ZP.t("addressPickerStrings_changeAddress"),renderAutocompleteSuggestionsInAnchoredLayer:e3=!1,hideAutoCompleteLabel:e2,renderOnDarkBackground:e8=!1,disableAddressValidation:e7=!1,isSearchField:e4=!1,disableBlur:e5=!1,hideGetLocationButton:te=!0,enableGeoLocationRedesign:tt=!1}=H||{},td=((null==s?void 0:s.length)||0)>0,tn=(null!=s?s:[]).filter(j.K).filter(e=>{var t;return!(null===(t=e.personalAddressLabel)||void 0===t?void 0:t.labelName)}),tr=(e,t)=>{eq(e),e1(t),null==et||et(t===e_.A.Edit),(0,eh.zj)(),w.Qh(ez)},ts=e=>(tr(e,e_.A.Default),r({...e}).then(()=>{(0,D.j)(U.wd.AddressSelectionWithoutValidation,{...e})}).catch(()=>{(0,D.j)(U.wd.SubmittedNewAddressError,{...e})})),ti=e=>{null==e||e.nativeEvent.stopImmediatePropagation(),eq(void 0),e1(e_.A.Default),null==et||et(!1),eQ(!1)},{showGetLocationButton:tl,onClickGetLocation:ta,autocompleteInitialValue:to,autocompleteFetchOnFocus:tu,isLoading:tc,firstAddressAutocompleteLocation:tf,showAddressBarSubmitButton:tp,isAddressBarGeoSuggestionDropdownEnabled:tg,isAddressBarAutofocusEnabled:tm}=(0,eS.A)(null!==Y),tv=(0,en.M5)(V,td),th=(0,en.cv)(),[tb,tA]=o.useState(tf);o.useEffect(()=>{tA(tf)},[tf]);let t_=(e,t)=>{var d,n,r;let s=null==e?void 0:e.id;s&&(eq(e),e1(e_.A.Edit),(0,eh.gC)(),null==et||et(!0),null==ed||ed({addressId:s,shortname:null!==(n=null==e?void 0:e.shortname)&&void 0!==n?n:void 0,labelName:null!==(r=null!=t?t:null==e?void 0:null===(d=e.personalAddressLabel)||void 0===d?void 0:d.labelName)&&void 0!==r?r:void 0}))},ty=e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i,addressLinkType:l,buildingName:o,entryCode:u,personalAddressLabel:c}=e;return a({subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i,addressLinkType:l,buildingName:o,entryCode:u,personalAddressLabel:c}).then(e=>{var t;e1(e_.A.Default),null==et||et(!1),(0,eh.Hz)({addressId:r,dropoffOptionId:n,manualLat:s,manualLng:i,addressEntryPoint:ez,addressToUpdate:Y,editResponse:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.editConsumerAddressV2}),s&&i&&(0,ew.$g)({original_lat:null==Y?void 0:Y.lat,original_lng:null==Y?void 0:Y.lng,pin_lat:s,pin_lng:i})}).catch(e=>{throw(0,eh.a5)({addressId:r,dropoffOptionId:n,manualLat:s,manualLng:i,addressEntryPoint:ez,addressToUpdate:Y,editResponse:null}),s&&i&&(0,eT.NC)(e)&&(0,ew.ij)({original_lat:null==Y?void 0:Y.lat,original_lng:null==Y?void 0:Y.lng,pin_lat:s,pin_lng:i}),e})},tS=e=>e7?ts(e):tr(e,e_.A.Edit),tx=e=>{e7?ts(e):(eq(e),e1(e_.A.Edit),null==et||et(e0===e_.A.Edit))},tC=e=>{tx((0,eB.r)(e)),eQ(!0)},tP=()=>{e1(e_.A.ManualAddress)},tI=new eO.l$(ek,eL),tj=(0,q.KE)();if(e0===e_.A.ManualAddress)return e6?(0,l.jsx)(eO.ZP,{addressEntryPoint:n,initialCountryCode:eH,loading:!1,addressExperienceServiceProvider:tI,labelConfigs:tj,trackingEvents:eN.EK,onConfirmDropoffLocation:tC,onBack:ti,renderedInModal:!0}):(0,l.jsx)(eO.ZP,{addressEntryPoint:n,initialCountryCode:eH,loading:!1,addressExperienceServiceProvider:tI,labelConfigs:tj,trackingEvents:eN.EK,onConfirmDropoffLocation:tC,onBack:ti});if((e0===e_.A.Edit||e0===e_.A.ChangePin)&&eU){if(eP&&eU){let e=(0,q.Uq)(eU)?eU.dropoffPreferences.allPreferences:[];return e6?(0,l.jsx)(eA.Z,{addressEntryPoint:ez,title:e9,address:eU,defaultAddressId:(0,q.aN)(eU)?"":eU.id,dropoffOptions:C,driverInstructions:null!==(d=eU.driverInstructions)&&void 0!==d?d:void 0,dropoffPreferences:e,onClose:ti,customizations:H,refetchQueries:ec,onCloseAddressEdit:ep,onShowPinCodeEducationModal:eg,doNotShowPinCodeWarningBanner:eC,shouldSkipValidateAddress:eW}):(0,l.jsx)(u.Z,{isVisible:I,type:c.j.loading,children:(0,l.jsx)(f.Z,{children:(0,l.jsx)(L.n,{skip:eW,address:(0,q.Uq)(eU)?eU:void 0,googlePlaceId:(0,q.Uq)(eU)?void 0:eU.googlePlaceId,addressId:(0,q.Uq)(eU)?void 0:eU.addressId,children:(0,l.jsx)(F.Z,{dropoffOptions:C,handleRemoveAddress:e=>{e?R(e):(0,x.eN)({level:"warning",message:"Trying to remove an address without id"})},preSelectedAddressLabelName:null!=er?er:void 0,dropoffPreferences:e,address:eU,defaultAddressId:z,hideAdjustPin:null==H?void 0:H.hideAdjustPin,hideDropOffOptions:null==H?void 0:H.hideDropOffOptions,onCloseOfAddressEdit:ep,onShowPinCodeEducationModal:eg,doNotShowPinCodeWarningBanner:eC})})})})}let e=(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(u.Z,{isVisible:I,type:c.j.loading,children:(0,l.jsx)(f.Z,{children:(0,l.jsx)(L.n,{skip:eW,address:(0,q.Uq)(eU)?eU:void 0,googlePlaceId:(0,q.Uq)(eU)?void 0:eU.googlePlaceId,addressId:(0,q.Uq)(eU)?void 0:eU.addressId,children:(0,l.jsx)(N.Z,{onCancel:ti,dropoffOptions:C,handleSubmitNewAddress:e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:s,manualLng:i,addressLinkType:l,buildingName:a,entryCode:o,personalAddressLabel:u,addressId:c}=e;if(eU&&!(0,q.Uq)(eU))return r({...eU,subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:s,manualLng:i,addressLinkType:l,buildingName:a,entryCode:o,personalAddressLabel:u,addressId:c})},handleSubmitEditAddress:ty,dropoffPreferences:(0,q.Uq)(eU)?eU.dropoffPreferences.allPreferences:[],address:eU,customizations:H,doNotShowPinCodeWarningBanner:eC})})})})});return e6?(0,l.jsx)(p.Z,{isOpen:!0,onClose:ti,title:e9,children:(0,l.jsx)(Q.oh,{children:e})}):e}let tE={label:null!=$?$:eP?"":T.ZP.t("addressPickerStrings_defaultAutocompleteLabel"),isLabelHidden:e2,initialInputValue:to||"",isStaticPositionSuggestions:B,onSelect:tS,renderSuggestionsInAnchoredLayer:e3,placeholder:X,isRounded:eP,addressEntryPoint:ez,shouldFetchSuggestionsOnFocus:tu,isLoading:tc,textFieldSize:tp?g.J9.large:void 0,updateSavedSuggestion:e=>{if(e){if(tk&&(null==e?void 0:e.placeId)&&(null==e?void 0:e.description)){if(e.placeId===(null==tb?void 0:tb.googlePlaceId))return;eI?(0,ex.PK)(e.placeId,ej).then(e=>{e.googlePlaceId!=(null==tb?void 0:tb.googlePlaceId)&&tA(e)}).catch(()=>{(0,x.eN)({level:"error",message:"Error on getAddressDetails"})}):(0,ex.N2)(e.placeId,e.description).then(e=>{e.googlePlaceId!=(null==tb?void 0:tb.googlePlaceId)&&tA(e)})}}else tA(null)},isAddressInputAutoFocused:tm||tv,isSearchField:e4,disableBlur:e5,renderConnectedAfter:tp&&null==Y?()=>(0,l.jsx)(m.Z,{onClick:()=>{tb&&((0,eh.pW)(n),tS(tb))},type:v.L$.full,size:h.qE.large,children:T.ZP.t("address_suggestion_submit_location")}):void 0,onEditAddress:e=>{t_(P()(s).find(t=>e===t.addressId))},onSelectAddress:e=>{let t=P()(s).find(t=>e===t.addressId);t&&t.id&&S(t.id)},isManualAddressEntryEnabled:th,onManualAddressEntry:tP,manualEntryCTAComp:e=>(0,l.jsx)(eM.Z,{active:e}),manualEntryCTAOnClick:tP},tk=tg&&!eE.includes(n);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(u.Z,{isVisible:I,type:c.j.loading,children:[eP&&(0,l.jsx)(b.Z,{size:A.$f.xSmall}),(0,l.jsx)(f.Z,{isSquished:eP,children:(0,l.jsxs)(_.Z,{children:[tk?(0,l.jsx)(eZ,{...tE,isOpen:!!tk,onGeoSuggestionDropdownSelect:e=>{tA(e)},hideGetLocationButton:te,enableGeoLocationRedesign:tt}):(0,l.jsx)(O.Z,{...tE}),(0,l.jsxs)(eR,{isVisible:tl||ee,"data-testid":"ButtonContainer",children:[tl&&(0,l.jsx)(ey,{onClick:()=>{(0,eh.iZ)(n),ta()},isDarkBackground:e8}),ee&&(0,l.jsx)(k.Jk,{isGuest:V,handleIdentityLinkClick:J,entry:E.KP.APP,isDarkBackground:e8,isAddressLabelEnabled:eP})]})]})}),eP&&!V&&e0===e_.A.Default&&(0,l.jsx)(em,{labeledAddresses:i,getIsLabeledAddressSelected:eX,onSelectLabelWithAddress:S,onEditLabelWithAddress:e=>{if(!e.address)return;let{address:t,labelName:d}=e;t_(t,null!=d?d:void 0)},trackingContext:{addressEntryPoint:n,defaultAddressId:z},onClickUnsetAddress:e=>{let{addressId:t,labelName:d,shortname:n}=e;e1(e_.A.SetLabel),null==ed||ed({addressId:t,labelName:d,shortname:n,isFromLabeledAddress:!0})}}),!M&&(0,l.jsxs)(l.Fragment,{children:[td&&!eP&&(0,l.jsx)(y.Z,{}),null==W?void 0:W(),(0,q.T8)({mode:e0,availableAddresses:s,isAddressLabelEnabled:eP})&&(0,l.jsx)(Q.UI,{hasMarginTop:ee,children:T.ZP.t("addressPickerStrings_recent")}),es&&e0===e_.A.Default&&(0,l.jsx)(eo,{isAddressLabelEnabled:eP,isSelected:el,onClick:eu}),e0===e_.A.SetLabel&&eP?(0,l.jsx)(ea,{availableAddressesWithoutLabel:tn,onClick:e=>{var t,d;let n=null==s?void 0:s.find(t=>(null==t?void 0:t.id)===e);if(!n)return;let{subpremise:r,dropoffPreferences:i,id:l,manualLat:a,manualLng:o,addressLinkType:u,buildingName:c,entryCode:f}=n,p=i.allPreferences.find(e=>e.isDefault);null===(t=ty({addressId:l,subpremise:r,driverInstructions:null!==(d=null==p?void 0:p.instructions)&&void 0!==d?d:null,dropoffOptionId:null==p?void 0:p.optionId,manualLat:null!=a?a:void 0,manualLng:null!=o?o:void 0,addressLinkType:u,entryCode:null!=f?f:void 0,buildingName:null!=c?c:void 0,personalAddressLabel:{labelName:er}}))||void 0===t||t.then(()=>{null==ef||ef()})}}):(0,l.jsx)(ei,{availableAddresses:s,defaultAddressId:z,onEdit:(e,t)=>{t_(P()(s).find(t=>e===t.id),t)},onSelect:S,onRemove:R,isLiteGuest:G,isAddressLabelEnabled:eP,getIsRecentAddressSelected:eJ})]}),!K()&&(0,l.jsx)(b.Z,{size:eP?A.$f.medium:A.$f.none}),K()]})})},{name:"AddressPicker"}),eq=d(723280),eG=d(454709);let eV=()=>{let{isStorefront:e}=(0,a.Z)(),t=(0,eu.AY)(ec.pc.sfHoneybeeAutocompleteMigrationxx,"fallback");if(!e)return!1;let d=t.includes("HB");return(0,D.j)("sf_cx_hb_migration_autocomplete_dv",{value:t,hbEnabled:d}),d},eW=()=>"HB-MAE"===(0,eu.AY)(ec.pc.sfHoneybeeAutocompleteMigrationxx,"fallback");var eQ=d(822489),eH=d(37223),eK=e=>{let t={hideModal:!0,delivery:!0,tm:eH.dF.AddressChanged},d=eQ.stringify(t),n=e.includes("?")?"&":"?";return e+n+d},eY=d(714313),eJ=d(852670),eX=d(979994),e0=d(860413);function e1(){let e=(0,eX._)(["\n  query storefrontBestStoreForDeliveryAddress($businessId: ID!, $lat: Float!, $lng: Float!) {\n    deliverability: storefrontBestStoreForDeliveryAddress(businessId: $businessId, lat: $lat, lng: $lng) {\n      bestStoreId\n      deliverToAddress\n      redirectUrl\n    }\n  }\n"]);return e1=function(){return e},e}function e6(){let e=(0,eX._)(["\n  query storefrontBestStoreForDeliveryAddressByBusinessGroup(\n    $businessGroupId: ID!\n    $lat: Float!\n    $lng: Float!\n  ) {\n    deliverability: storefrontBestStoreForDeliveryAddressByBusinessGroup(\n      businessGroupId: $businessGroupId\n      lat: $lat\n      lng: $lng\n    ) {\n      bestStoreId\n      deliverToAddress\n      redirectUrl\n    }\n  }\n"]);return e6=function(){return e},e}let e9=(0,e0.gql)(e1()),e3=(0,e0.gql)(e6()),e2=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>null;return(0,eJ.t)(e9,{onCompleted:e})};var e8=d(496922),e7=d(260014),e4=d(665666);let e5=e=>{let{landOnPickup:t}=e,{storeInformation:d}=o.useContext(e7.ZP),n=(0,eY.tv)(),{businessId:r,storeId:s,businessGroupId:i}=d,l={};t&&(l.pickup=!0,l.delivery=!1);let a=(0,e4.mA)(l,r,i);return o.useEffect(()=>{(0,D.j)("storefront_redirect_to_landing_page",{storeId:s,businessId:r}),n.replace(a)},[a,n,r,s]),null},te=(0,I.default)(f.Z).attrs(()=>({size:A.wM.medium})).withConfig({componentId:"sc-875f5f61-0"})(["background-color:",";"],S.Q2.usage.color.negative.subdued.default),tt=(0,I.default)(f.Z).attrs(()=>({size:A.wM.medium})).withConfig({componentId:"sc-875f5f61-1"})(["background-color:",";"],S.Q2.usage.color.negative.subdued.default),td=e=>{let t={usage:{color:{background:{subdued:{default:S.Q2.usage.color.background.subdued.default}},button:{primary:{background:{default:W.i2.SystemWhite,hovered:S.Q2.usage.color.background.subdued.default,pressed:W.i2.SystemWhite},foreground:{default:W.i2.SystemBlack}}}}}};return(0,l.jsx)(et.iS,{overrides:t,children:(0,l.jsx)(m.Z,{...e,children:e.children})})};var tn=d(465830),tr=d(54881),ts=d(685393);let ti=()=>(0,D.j)("new_fulfillment_flow_existing_address_select"),tl=()=>(0,D.j)("new_fulfillment_flow_out_of_range"),ta=()=>(0,D.j)("new_fulfillment_flow_redirect_to_pickup_from_out_of_range"),to=()=>(0,D.j)("new_fulfillment_flow_switch_and_save_banner_load"),tu=e=>{let{isExistingAddress:t,isSubpremisePresent:d}=e;return(0,D.j)("new_fulfillment_flow_next_click",{is_existing_address:t,is_subpremise_present:d})},tc=()=>(0,D.j)("new_fulfillment_flow_redirecting_to_closer_store"),tf=e=>{(0,D.j)("new_fulfillment_flow_add_new_address",{is_redirecting_to_closer_store:e})},tp=()=>(0,D.j)("new_fulfillment_flow_add_address_edit_click");var tg=d(285310),tm=e=>{let{addressEntryPoint:t}=e,[,d]=(0,tg.o)();o.useEffect(()=>{tl()},[]);let[n,r]=o.useState(!1);if(n){if(ta(),!t.includes("Storefront/Home"))return(0,l.jsx)(e5,{landOnPickup:n});d(ef.LK5.Pickup)}return(0,l.jsx)(te,{children:(0,l.jsxs)(tn.Z,{size:A.O8.medium,justifyContent:tr.dy.spaceBetween,children:[(0,l.jsx)(ts.Z,{type:$.IconType.ErrorFill,color:$.EY.negative.strong.default,accessibilityLabel:T.ZP.t("addressPickerStrings_accessibilityErrorIconLabel")}),(0,l.jsxs)(_.Z,{size:A.Uo.xSmall,children:[(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.large.default,weight:M.fs.bold,children:T.ZP.t("addressPickerStrings_addressOutOfRangeHeading")}),(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.default,children:T.ZP.t("addressPickerStrings_addressOutOfRangeBannerText")}),(0,l.jsx)(td,{isInline:!0,isRaised:!0,onClick:()=>r(!0),children:(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.strong,color:S.Q2.usage.color.text.default,children:T.ZP.t("addressPickerStrings_addressOutOfRangeButton")})})]})]})})},tv=d(330920),th=()=>{let e=(0,eH.H3)(),{isMxWebsite:t}=(0,tv.E)(),[d,n]=o.useMemo(()=>e||t?[T.ZP.t("storefront_menu_fastStorePicker_enterDeliveryAddressModal_newAddressNewOrderTitle"),T.ZP.t("storefront_menu_fastStorePicker_enterDeliveryAddressModal_newAddressNewOrderSubTitle")]:[T.ZP.t("addressPickerStrings_addressSwitchAndSaveBannerTitle"),T.ZP.t("addressPickerStrings_addressSwitchAndSaveBannerText")],[e,t]);return o.useEffect(()=>{to()},[]),(0,l.jsx)(tt,{children:(0,l.jsxs)(tn.Z,{size:A.O8.medium,justifyContent:tr.dy.spaceBetween,children:[(0,l.jsx)(ts.Z,{type:e?$.IconType.ErrorFill:$.IconType.WarningFill,color:e?$.EY.negative.default:$.EY.warning.default,accessibilityLabel:T.ZP.t("addressPickerStrings_accessibilitywarningIconLabel")}),(0,l.jsxs)(_.Z,{size:A.Uo.xSmall,children:[(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.large.default,children:d}),(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.default,children:n})]})]})})},tb=d(469894),tA=d(516202),t_=d(99060),ty=d(195650),tS=d(116692),tx=d(118697),tC=d(1702),tP=d(444080),tI=d(518766),tj=d(278884),tE=d(544904),tk=d(650646),tZ=d(148632),tL=d(902297);let tw=(0,tb.default)(()=>Promise.all([d.e(1042),d.e(8334),d.e(60638)]).then(d.bind(d,332350)),{loadableGenerated:{webpack:()=>[332350]},ssr:!1});(n=s||(s={})).ChangePin="ChangePin",n.Edit="Edit";var tT=e=>{let{saveButtonText:t,dropoffOptions:d,dropoffPreferences:n,onCancel:r,onAddressEdit:s,printableAddress:i,driverInstructions:a,subpremise:u,address:c,shortname:f,handleSubmitNewAddress:p,handleSubmitEditAddress:b,handleSubmitPinUpdate:S,showControlsOnlyForEditAddress:x,showEditAddressButton:C,customizations:P}=e,I=(0,tx.Z)(),{consumer:j}=(0,tj.R)(),{orderCart:E}=(0,tL.re)(),k=(0,eu.jb)(e=>e.state),Z=(0,q._h)(),L=(0,tS.Z)(c.countryCode),[w,D]=o.useState((L?j.lastName:u)||""),[O,N]=o.useState((null==c?void 0:c.entryCode)||""),[F,$]=o.useState((0,tE.xy)(n,d)),[U,G]=o.useState((0,tE.MG)(n,d,a)),[V,W]=o.useState("Edit"),[Q,H]=o.useState(null),K=()=>H(null),[Y,J]=o.useState(null),X=()=>J(null),[ee,et]=o.useState(null),{hideAdjustPin:ed=!1,hideDropOffOptions:en=!1}=P||{};async function er(e){e.nativeEvent.stopImmediatePropagation();let t=F||void 0,d=w||"",n=O||"",r=(0,q.I0)(U,F),{manualLat:s,manualLng:i}=(0,q.Yt)(Q),l={subpremise:d,driverInstructions:r,dropoffOptionId:t,manualLat:s,manualLng:i,entryCode:n};et(null);let a=(0,q.Uq)(c)?c.id:"";if(O&&(0,tZ.eK)(a,O.length),(0,q.Uq)(c)&&(null==j?void 0:j.id))b({...l,addressId:c.id});else{let e=p(l);if(void 0!==e){let{lat:d,lng:n}=c;e.then(()=>(0,tZ.KS)({manualLat:s,manualLng:i,lat:d,lng:n,dropoffOptionId:t})).catch(e=>{var r;et((null==e?void 0:null===(r=e.graphQLErrors[0])||void 0===r?void 0:r.message)||T.ZP.t("addressPickerStrings_addressEditSaveNewError")),(0,tZ.hJ)({manualLat:s,manualLng:i,lat:d,lng:n,dropoffOptionId:t})})}}}let es=(0,l.jsx)(tk.iP,{children:(0,l.jsx)(m.Z,{onClick:e=>{e.nativeEvent.stopImmediatePropagation(),W("ChangePin"),(0,tZ.mo)()},type:v.L$.primary,children:T.ZP.t("addressPickerStrings_addressEditAdjustPin")})});return"Edit"===V?(0,l.jsxs)(_.Z,{"data-anchor-id":z.ep.AddressEditForm,"data-testid":z.ep.AddressEditForm,children:[(0,l.jsx)(tw,{defaultAddress:c,locationOverride:Q||(0,q.ey)(c),allowDifferentMapProvider:I,overlayComponent:ed?null:(0,l.jsx)(tk.Ko,{children:es})}),(0,l.jsxs)(tn.Z,{alignItems:tr.v2.center,justifyContent:tr.dy.spaceBetween,children:[(0,l.jsx)(_.Z,{size:A.Uo.xxSmall,children:(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(tA.Z,{onClick:()=>{},orderCartId:null==E?void 0:E.id}),(0,l.jsx)(B.x,{as:tI.$h.H3,textStyle:M.TextStyle.body.medium.default,children:"".concat(f).concat(u?" ".concat((0,R.Ay)(u)):"",", ").concat((0,R.gj)(f||"",i||""))})]})}),(x||(0,q.Uq)(c))&&!C?null:(0,l.jsx)(tk.Bv,{children:(0,l.jsx)(m.Z,{size:h.qE.small,type:v.L$.flatPrimary,onClick:s,children:T.ZP.t("addressPickerStrings_addressEdit")})})]}),(0,q.Uq)(c)&&(0,l.jsx)(o.Fragment,{children:(0,l.jsx)(eq.Z,{value:w,size:g.J9.small,onChange:e=>D(e),placeholder:L?T.ZP.t("addressPickerStrings_apartmentInputWithBuzzer_placeholder"):T.ZP.t("addressPickerStrings_apartmentInput_placeholder"),label:L?T.ZP.t("addressPickerStrings_apartmentInputWithBuzzer_label"):T.ZP.t("addressPickerStrings_apartmentInput_label"),isLabelHidden:!1})}),Z&&"ready"===k&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(eq.Z,{value:O,size:g.J9.small,onChange:e=>{N(e)},placeholder:T.ZP.t("addressPickerStrings_entryCode_placeholder"),label:T.ZP.t("addressPickerStrings_entryCode_label"),description:T.ZP.t("addressPickerStrings_OptionalLabel")})}),!en&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(_.Z,{"data-testid":z.ep.AddressEditDropoffSelection,children:[(0,l.jsx)(y.Z,{type:eG.C.fullBorder}),d.map(e=>(0,l.jsxs)(_.Z,{size:A.$f.small,children:[(0,l.jsx)(tC.Z,{label:e.displayString,name:"dropoff-type",isDisabled:!e.isEnabled,isSelected:e.id===F,type:tP._S.radio,onChange:()=>{$(e.id)}}),!e.isEnabled&&e.disabledMessage&&(0,l.jsx)(B.x,{textStyle:M.TextStyle.label.small.default,color:M.d9.text.default,children:e.disabledMessage}),(0,l.jsx)(y.Z,{type:eG.C.fullBorder})]},e.id))]}),null!==F?(0,l.jsx)(eq.Z,{value:(0,q.I0)(U,F),size:g.J9.small,onChange:e=>{G(U.slice().map(t=>t.optionId===F?{optionId:F,instructions:e}:t))},isMultiline:2,isResizeable:!0,placeholder:(0,tE.sQ)(d,F||""),label:T.ZP.t("addressPickerStrings_addressDeliveryInstructions"),description:T.ZP.t("addressPickerStrings_OptionalLabel"),isLabelHidden:!1,"data-testid":z.ep.AddressEditDropoffInstructions}):null]}),ee&&(0,l.jsx)(ty.Z,{children:ee}),(0,l.jsxs)(tn.Z,{children:[(0,l.jsx)(m.Z,{onClick:x||(0,q.Uq)(c)?r:s,type:v.L$.tertiary,children:x?T.ZP.t("addressPickerStrings_addressEditCancel"):T.ZP.t("addressPickerStrings_addressEditBackButtonText")}),(0,l.jsx)(m.Z,{"data-anchor-id":z.ep.AddressEditSave,onClick:er,children:t||T.ZP.t("addressPickerStrings_addressEditSave")})]})]}):(0,l.jsx)(t_.Z,{address:c,onSubmit:(0,q.Uq)(c)?e=>{X();let{manualLat:t,manualLng:d}=(0,q.Yt)(e);(0,q.Uq)(c)&&S(c.id,t,d).then(()=>{W("Edit"),(0,tZ.ZU)({addressId:c.id,manualLat:t,manualLng:d})}).catch(()=>{J(T.ZP.t("addressPickerStrings_addressEditPinSaveError")),K(),(0,tZ.UR)({addressId:c.id,manualLat:t,manualLng:d})})}:e=>{X(),(0,q.ng)(e,c)?(H(e),W("Edit")):(K(),J(T.ZP.t("addressPickerStrings_addressEditPinLocationError")))},onCancel:e=>{e.nativeEvent.stopImmediatePropagation(),K(),X(),W("Edit")},draftCoordinates:Q||(0,q.ey)(c),handleChangePinLocation:H,errorMessage:Y,shouldStackActionButtons:!1})},tD=d(453508),tO=d(820339);let tN=I.default.div.withConfig({componentId:"sc-20307b4-0"})(["display:flex;align-items:center;justify-content:space-between;color:",";background:",";padding:"," ",";border-top:1px solid ",";&:hover{cursor:pointer;background-color:",";}"],S.Q2.usage.color.text.default,e=>e.active?S.Q2.usage.color.background.subdued.default:S.Q2.usage.color.background.default,S.Q2.usage.space.small,S.Q2.usage.space.medium,S.Q2.usage.color.border.strong.hovered,S.Q2.usage.color.background.subdued.default),tF=I.default.div.withConfig({componentId:"sc-20307b4-1"})(["flex-grow:1;padding:0 ",";"],S.Q2.usage.space.medium);var t$=d(455277);let tB=e=>{let{onClick:t,active:d}=e;return eW()?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(tN,{role:"option","aria-selected":"false","data-testid":"manual-address-entry",onClick:t,active:d,children:[(0,l.jsx)(ts.Z,{"data-testid":"after-suggestion-add-icon",size:t$.J.medium,type:$.IconType.AddCircleFill,accessibilityLabel:T.ZP.t("manualAddressEntry_cta")}),(0,l.jsxs)(tF,{children:[(0,l.jsx)(B.x,{textStyle:M.TextStyle.body.medium.default,children:T.ZP.t("manualAddressEntry_cta")}),(0,l.jsx)(B.x,{textStyle:M.TextStyle.body.small.default,children:T.ZP.t("manualAddressEntry_description")})]}),(0,l.jsx)(ts.Z,{"data-testid":"after-suggestion-chevron-icon",size:t$.J.medium,type:$.IconType.ChevronRight,accessibilityLabel:T.ZP.t("manualAddressEntry_cta")})]})}):null};var tM=d(917041),tz=d(374897);function tR(){let e=(0,eX._)(["\n  mutation getAddressDetails($addressIdentifier: AddressIdentifier!) {\n    getAddressDetails(addressIdentifier: $addressIdentifier) {\n      address {\n        id\n        lat\n        lng\n        formattedAddress\n        streetAddress\n        locationAddress\n        subpremise\n        streetNumber\n        streetName\n        locality\n        administrativeAreaLevel1\n        administrativeAreaLevel2\n        postalCode\n        postalCodeSuffix\n        country\n        countryShortname\n        name\n        neighborhood\n        timezone\n        languageCode\n        isGeneric\n        formattedAddressShort\n        formattedAddressSegmented\n        formattedAddressSegmentedNonUserEditableFields\n        createdAt\n        sourcePlaceId\n      }\n    }\n  }\n"]);return tR=function(){return e},e}d(794304),d(498436);let tU=(0,e0.gql)(tR());function tq(){let e=(0,eX._)(["\n  query getAutocompletePredictions(\n    $inputAddress: String!\n    $lat: Float\n    $lng: Float\n    $locale: String\n    $searchRadiusMeters: Int\n    $maxResults: Int\n    $iso3166Alpha2CountryCode: String\n  ) {\n    getAutocompletePredictions(\n      inputAddress: $inputAddress\n      lat: $lat\n      lng: $lng\n      locale: $locale\n      searchRadiusMeters: $searchRadiusMeters\n      maxResults: $maxResults\n      iso3166Alpha2CountryCode: $iso3166Alpha2CountryCode\n    ) {\n      predictionsList {\n        lat\n        lng\n        formattedAddress\n        formattedAddressShort\n        formattedAddressSegmentedList\n        formattedAddressSegmentedNonUserEditableFieldsList\n        countryShortname\n        sourcePlaceId\n      }\n    }\n  }\n"]);return tq=function(){return e},e}let tG=(0,e0.gql)(tq()),tV=()=>{let e=(0,tz.x)();return{getAutocompletePredictions:t=>{let{addressInput:d}=t;return(0,D.j)("cx_storefront_hb_autocomplete_address_search",{query:d}),e.query({query:tG,variables:{inputAddress:d}}).then(e=>{var t,d;return(null==e?void 0:null===(d=e.data)||void 0===d?void 0:null===(t=d.getAutocompletePredictions)||void 0===t?void 0:t.predictionsList)||[]}).then(e=>{let t=e.map(e=>({lat:e.lat,lng:e.lng,formatted_address:e.formattedAddress,formatted_address_short:e.formattedAddressShort,formatted_address_segmented:e.formattedAddressSegmentedList||[],formatted_address_segmented_non_user_editable_fields:e.formattedAddressSegmentedNonUserEditableFieldsList||[],country_shortname:e.countryShortname,source_place_id:e.sourcePlaceId})),n=t.map(e=>e.formatted_address||"").filter(Boolean);return(0,D.j)("cx_storefront_hb_autocomplete_address_predictions",{predictions:n,count:n.length,query:d}),t}).catch(()=>((0,x.eN)({level:"error",message:"Error on Honeybee getAutocompletePredictions",request:{data:{inputAddress:d}}}),[]))},getAddressDetails:t=>e.mutate({mutation:tU,variables:{addressIdentifier:{sourcePlaceId:{source_place_id:t,_type:ef.Lfv.source_place_id_request}}}}).then(e=>{var t,d;return(null==e?void 0:null===(d=e.data)||void 0===d?void 0:null===(t=d.getAddressDetails)||void 0===t?void 0:t.address)||{}}).then(e=>({id:null==e?void 0:e.id,lat:null==e?void 0:e.lat,lng:null==e?void 0:e.lng,formatted_address:null==e?void 0:e.formattedAddress,street_address:null==e?void 0:e.streetAddress,location_address:null==e?void 0:e.locationAddress,subpremise:null==e?void 0:e.subpremise,street_number:null==e?void 0:e.streetNumber,street_name:null==e?void 0:e.streetName,locality:null==e?void 0:e.locality,administrative_area_level1:null==e?void 0:e.administrativeAreaLevel1,administrative_area_level2:null==e?void 0:e.administrativeAreaLevel2,postal_code:null==e?void 0:e.postalCode,postal_code_suffix:null==e?void 0:e.postalCodeSuffix,country:null==e?void 0:e.country,country_shortname:null==e?void 0:e.countryShortname,name:null==e?void 0:e.name,neighborhood:null==e?void 0:e.neighborhood,timezone:null==e?void 0:e.timezone,language_code:null==e?void 0:e.languageCode,is_generic:null==e?void 0:e.isGeneric,formatted_address_short:null==e?void 0:e.formattedAddressShort,formatted_address_segmented:(null==e?void 0:e.formattedAddressSegmented)||[],formatted_address_segmented_non_user_editable_fields:(null==e?void 0:e.formattedAddressSegmentedNonUserEditableFields)||[],created_at:(null==e?void 0:e.createdAt)?new Date(e.createdAt):new Date,source_place_id:null==e?void 0:e.sourcePlaceId})).catch(()=>((0,x.eN)({level:"error",message:"Error on Honeybee getAddressDetails",request:{data:{sourcePlaceId:t}}}),{}))}};var tW=d(513850);let tQ=(0,eH.$P)(),tH=e=>{let{onSelect:t,openManualAddressEntry:d,...n}=e,{getAddressDetails:r,getAutocompletePredictions:s}=tV(),i=(0,tW.w)(),a=o.useCallback(e=>{t((0,eB.l)(e))},[t]),u=i?tO.Ye:tM.Ye;return(0,l.jsx)(u,{label:T.ZP.t("addressPickerStrings_addressStreetAddress"),placeholder:T.ZP.t("addressPickerStrings_addressEnterAddressSF"),addressService:{getAddressDetails:r,getAddressAutocompletePredictions:s},onSelect:a,onChange:tQ,showStreetAddressOnly:!1,iconProps:{type:$.IconType.LocationPinEnabledFill,size:t$.J.medium},suggestionsMatchWidth:!0,manualEntryCTAComp:e=>(0,l.jsx)(tB,{onClick:d,active:e}),manualEntryCTAOnClick:d,...n})},tK=e=>{let{formatted_address_non_editable_line_one:t,formatted_address_non_editable_line_two:d,lat:n,lng:r,geo_address_id:s,subpremise:i,manualLat:l,manualLng:a}=e;return{city:"",state:"",street:"",shortname:t,printableAddress:"".concat(t,", ").concat(d),zipCode:"",googlePlaceId:"",lat:n,lng:r,addressId:s,subpremise:i,manualLat:l,manualLng:a}},tY=e=>({candidate_token:e.candidateToken,lat:e.lat,lng:e.lng,formatted_address_non_editable_line_one:e.formattedAddressNonEditableLineOne,formatted_address_non_editable_line_two:e.formattedAddressNonEditableLineTwo,formatted_address_line_one:e.formattedAddressLineOne,formatted_address_line_two:e.formattedAddressLineTwo,map_vendor_for_address_display:e.mapVendorForAddressDisplay}),tJ=e=>{var t,d,n,r,s;let i=e.dropoffPreferences.map(e=>{var t,d,n;return{instructions:null!==(t=null==e?void 0:e.instructions)&&void 0!==t?t:null,is_default:null!==(d=null==e?void 0:e.isDefault)&&void 0!==d?d:null,option_id:null!==(n=null==e?void 0:e.optionId)&&void 0!==n?n:null}}),l={name:null===(t=e.labelInfo)||void 0===t?void 0:t.name,icon:null!==(r=null===(n=e.labelInfo)||void 0===n?void 0:null===(d=n.icon)||void 0===d?void 0:d.labelIcon)&&void 0!==r?r:"LABEL_ICON_TYPE_PIN"};return{geo_address_id:e.geoAddressId,formatted_address_non_editable_line_one:e.formattedAddressNonEditableLineOne,formatted_address_non_editable_line_two:e.formattedAddressNonEditableLineTwo,country_code:e.countryCode,lat:e.lat,lng:e.lng,dropoff_preferences:i,label_info:l,is_saved:e.isSaved,overrides:null!==(s=e.overrides)&&void 0!==s?s:{}}};var tX=d(437712);let t0=I.default.div.withConfig({componentId:"sc-f67d87d-0"})(["margin:calc(-1 * ",");"],S.Q2.usage.space.medium);function t1(){let e=(0,eX._)(["\n  query findManualAddressEntryCandidate(\n    $streetAddress: String!\n    $locality: String!\n    $adminLevel1: String!\n    $postalCode: String!\n    $countryCode: String!\n    $supportedMapVendors: [SupportedMapVendors!]!\n  ) {\n    findManualAddressEntryCandidate(\n      streetAddress: $streetAddress\n      locality: $locality\n      adminLevel1: $adminLevel1\n      postalCode: $postalCode\n      countryCode: $countryCode\n      supportedMapVendors: $supportedMapVendors\n    ) {\n      candidateToken\n      formattedAddressLineOne\n      formattedAddressLineTwo\n      formattedAddressNonEditableLineOne\n      formattedAddressNonEditableLineTwo\n      lat\n      lng\n      mapVendorForAddressDisplay\n    }\n  }\n"]);return t1=function(){return e},e}let t6=(0,e0.gql)(t1());function t9(){let e=(0,eX._)(["\n  mutation saveAddressesManualEntryCandidate(\n    $candidateToken: String!\n    $manualLat: Float\n    $manualLng: Float\n    $consumerId: String\n  ) {\n    saveManualAddressEntryCandidate(\n      candidateToken: $candidateToken\n      manualLat: $manualLat\n      manualLng: $manualLng\n      consumerId: $consumerId\n    ) {\n      buildingName\n      consumerAddressLinkId\n      countryCode\n      dropoffPreferences {\n        instructions\n        isDefault\n        optionId\n      }\n      entryCode\n      formattedAddressNonEditableLineOne\n      formattedAddressNonEditableLineTwo\n      geoAddressId\n      isSaved\n      labelInfo {\n        icon {\n          labelIcon\n          labelName\n        }\n        name\n      }\n      lat\n      lng\n      overrides {\n        dataSource\n        lat\n        lng\n        subpremise\n      }\n      subpremise\n    }\n  }\n"]);return t9=function(){return e},e}let t3=(0,e0.gql)(t9()),t2=()=>{let{consumer:e}=(0,tj.R)(),t=(0,tz.x)();return{getAddressesManualEntryCandidate:async e=>t.query({query:t6,variables:{...e,supportedMapVendors:[ef.dYw.GOOGLE]}}).then(e=>{let{data:t}=e,d=null==t?void 0:t.findManualAddressEntryCandidate;if(!d)throw Error("no data for getAddressesManualEntryCandidate");return tY(d)}).catch(e=>{var t;throw(0,x.eN)({level:"error",message:null!==(t=e.message)&&void 0!==t?t:"Error on Address Experience Service getAddressesManualEntryCandidate"}),e}),saveAddressesManualEntryCandidate:async d=>{let n={candidateToken:d.candidateToken,manualLat:d.location.latitude,manualLng:d.location.longitude,consumerId:null==e?void 0:e.id};return t.mutate({mutation:t3,variables:n}).then(e=>{let{data:t}=e,d=null==t?void 0:t.saveManualAddressEntryCandidate;if(!d)throw Error("no data for saveAddressesManualEntryCandidate");return tJ(d)}).catch(e=>{var t;throw(0,x.eN)({level:"error",message:null!==(t=e.message)&&void 0!==t?t:"Error on Address Experience Service saveAddressesManualEntryCandidate"}),e})}}};var t8=d(823302);let t7=e=>{var t,d,n,r,s,i,a,u,c,f;let g,{asModal:m,entryPoint:v,onClose:h,onSelect:b}=e,A=(0,t8.qr)(e=>e.pageType),_=t2(),{businessInformation:y}=o.useContext(tX.Z),{themingOverridesParams:{customTheme:S}}=y,{storeInformation:x}=(0,e7.TX)(),C=null!==(t=null==x?void 0:x.themingOverridesV8)&&void 0!==t?t:{},P=o.useCallback(e=>{b(tK(e)),h()},[b,h]),I=(0,q.KE)(),j=(0,eF.t)();S?g={comp:{color:{button:{primary:{background:{default:null!==(u=null==S?void 0:null===(n=S.colors)||void 0===n?void 0:null===(d=n.base)||void 0===d?void 0:d.brandSecondary)&&void 0!==u?u:void 0,hovered:null!==(c=null==S?void 0:null===(s=S.colors)||void 0===s?void 0:null===(r=s.derived)||void 0===r?void 0:r.lightBrandSecondary)&&void 0!==c?c:void 0,pressed:null!==(f=null==S?void 0:null===(a=S.colors)||void 0===a?void 0:null===(i=a.derived)||void 0===i?void 0:i.lightBrandSecondary)&&void 0!==f?f:void 0}}}}}}:C&&(g=C);let E=(0,l.jsx)(et.iS,{overrides:g,children:(0,l.jsx)(eO.ZP,{addressEntryPoint:null!=v?v:A,initialCountryCode:j,loading:!1,addressExperienceServiceProvider:_,ManualAddressFormContainer:t0,ManualAddressConfirmationContainer:t0,labelConfigs:I,onConfirmDropoffLocation:P,onBack:h,trackingEvents:eN.EK})});return m?(0,l.jsx)(p.Z,{"data-testid":"autocomplete-manual-address-modal",isOpen:!0,onClose:h,title:T.ZP.t("addressPickerStrings_changeAddress"),children:E}):(0,l.jsx)(l.Fragment,{children:E})};var t4=d(752664);(r=i||(i={})).Default="Default",r.Edit="Edit";var t5=(0,ez.zH)(e=>{var t,d;let{addressEntryPoint:n,onCompleted:r,onAddAddress:s,availableAddresses:i,onUpdateAddress:p,onSelectAddress:v,dropoffOptions:h,loading:b,isStaticPositionSuggestions:A,hideAddressList:_,selectedAddressId:S,onRemoveAddress:x,isLiteGuest:C,isGuest:I,renderBeforeAddressList:j,customizations:Z,defaultAddress:D,handleIdentityLinkClick:N,showIdentityLink:F=!0,setIsEditTitle:$}=e,B=eV(),M="".concat(n,"/StorefrontAddressPicker"),{push:R}=(0,eY.tv)(),{isStorefront:U}=(0,a.Z)(),{storeInformation:G}=o.useContext(e7.ZP),V=(null==G?void 0:G.businessId)||"",[W,H]=o.useState(),[K,Y]=o.useState(S),[J,X]=o.useState((null==W?void 0:W.subpremise)||""),[ee,et]=o.useState(""),ed=(0,eu.y)(ec.pc.sfBusinessGroupStorePickerForPickup,!1),en=(0,eu.y)(ec.pc.businessGroupStorePicker,!1)||ed,er=(0,eH.H3)(),{isMxWebsite:es}=(0,tv.E)(),[ea,eo]=e2(),[ef,ep,eg]=function(e){let[t,{data:d,loading:n}]=(0,e8.t)(e3,{onCompleted:void 0});return[t,d,n]}(),em=en?null==ep?void 0:ep.deliverability:null==eo?void 0:null===(t=eo.data)||void 0===t?void 0:t.deliverability,ev=en?eg:null==eo?void 0:eo.loading,[eb,eA]=o.useState("Default"),{isMobileTablet:e_}=(0,el.ac)(),ey=o.useCallback(e=>{let t={lat:null==e?void 0:e.lat,lng:null==e?void 0:e.lng};en?ef({variables:{...t,businessGroupId:(null==G?void 0:G.businessGroupId)||""}}):ea({variables:{...t,businessId:V}})},[ea,ef,V,null==G?void 0:G.businessGroupId,en]),{renderAutocompleteSuggestionsInAnchoredLayer:eS=!1,hideAutoCompleteLabel:ex}=Z||{},eC=e=>{X(e),S&&Y(""),W&&H({...W,subpremise:e})},eP=o.useCallback(e=>P()(i).find(t=>e===t.id),[i]),{orderCart:eI}=(0,tL.re)(),ej=!eI||eI&&(0,tD.ib)(eI);o.useEffect(()=>{if(K&&U){let e=eP(K);e&&ey(e)}},[K,eP,U,null==G?void 0:G.storeId,ey]);let eE=()=>U&&!!em&&!(null==em?void 0:em.deliverToAddress),ek=o.useMemo(()=>{var e;return null!==(e=null==em?void 0:em.deliverToAddress)&&void 0!==e&&e&&(null==em?void 0:em.bestStoreId)!==(null==G?void 0:G.storeId)},[em,null==G?void 0:G.storeId]),eZ=o.useMemo(()=>er||es?ek&&!ej:ek,[ek,er,ej,es]),eL=(null==em?void 0:em.bestStoreId)||"",ew=es?(0,eH.Ub)(eL):"/store/".concat(eL,"/"),eT=e=>{et(""),H(e),(0,eh.zj)(),w.Qh(M),U&&(Y(""),ey(e))},eD=e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:r,manualLng:i}=e;if(W&&!(0,q.Uq)(W)){let e=U&&ek;return tf(e),s({...W,subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:r,manualLng:i},e).then(()=>{if(e){tc();let e=eK(ew);eA("Default"),null==$||$(!1),R(e)}})}},eO=e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i,buildingName:l,entryCode:a}=e;return p({subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i,buildingName:l,entryCode:a}).then(e=>{var t;H(void 0),eA("Default"),null==$||$(!1),(0,eh.Hz)({addressId:r,dropoffOptionId:n,manualLat:s,manualLng:i,addressEntryPoint:M,addressToUpdate:D,editResponse:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.editConsumerAddressV2})}).catch(()=>{(0,eh.a5)({addressId:r,dropoffOptionId:n,manualLat:s,manualLng:i,addressEntryPoint:M,addressToUpdate:D,editResponse:null})})},eN=o.useCallback(e=>e===K,[K]),eF=e=>{let t=eP(e);(()=>{let d=U&&t&&ek;v(e,d).then(()=>{d&&R(eK(ew))}),K===S&&!d&&r&&r({...t,submarket:null})})()},[e$,eB]=o.useState(!1),eM=o.useCallback(()=>{eB(!1)},[]),ez=o.useCallback(()=>{eB(!0)},[]);if("Edit"===eb&&W){let e;return e=(0,q.Uq)(W)?{dropoffPreferences:W.dropoffPreferences.allPreferences,address:eP(null==W?void 0:W.id)||W}:{dropoffPreferences:[],address:W},(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(u.Z,{isVisible:b,type:c.j.loading,children:(0,l.jsx)(f.Z,{children:(0,l.jsx)(L.n,{address:(0,q.Uq)(W)?W:void 0,children:(0,l.jsx)(tT,{saveButtonText:K&&ek?T.ZP.t("addressPickerStrings_saveAndSwitchButton"):"",subpremise:(null==W?void 0:W.subpremise)||J,printableAddress:null==W?void 0:W.printableAddress,onCancel:e=>{e.nativeEvent.stopImmediatePropagation(),H(void 0),eA("Default"),null==$||$(!1)},onAddressEdit:()=>{tp(),eA("Default"),null==$||$(!1)},dropoffOptions:h,handleSubmitNewAddress:e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:r,manualLng:s}=e;if(W&&!(0,q.Uq)(W))return eD({subpremise:t,driverInstructions:d,dropoffOptionId:n,manualLat:r,manualLng:s})},handleSubmitEditAddress:e=>{let{subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i}=e;return eO({subpremise:t,driverInstructions:d,dropoffOptionId:n,addressId:r,manualLat:s,manualLng:i})},handleSubmitPinUpdate:(e,t,d)=>p({subpremise:null,driverInstructions:null,dropoffOptionId:void 0,addressId:e,manualLat:t,manualLng:d}),shortname:(null==W?void 0:W.shortname)||"",...e,customizations:Z})})})})})}let eR=U?T.ZP.t("addressPickerStrings_apartmentInput_label"):T.ZP.t("addressPickerStrings_apartmentInputTextPlaceholder");return e$?(0,l.jsx)(t7,{asModal:!0,onClose:eM,onSelect:eT}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(u.Z,{"data-anchor-id":z.ep.AddressContainer,isVisible:ev||b,type:c.j.loading,children:[eE()&&(0,l.jsx)(tm,{addressEntryPoint:n}),eZ&&(0,l.jsx)(th,{}),(0,l.jsxs)(Q.Zd,{children:[(0,l.jsx)(f.Z,{children:B?(0,l.jsx)(tH,{initialInputValue:(null==W?void 0:W.printableAddress)||"",onSelect:eT,openManualAddressEntry:ez,entityId:t4.Z.storefrontEntityId}):(0,l.jsx)(O.Z,{label:T.ZP.t("addressPickerStrings_addressStreetAddress"),isLabelHidden:ex,placeholder:T.ZP.t("addressPickerStrings_addressEnterAddress"),initialInputValue:(null==W?void 0:W.printableAddress)||"",isStaticPositionSuggestions:A,onSelect:eT,error:ee,renderSuggestionsInAnchoredLayer:eS})}),F&&(0,l.jsx)(k.bb,{handleIdentityLinkClick:N,isGuest:I,entry:E.KP.APP}),(0,l.jsx)(f.Z,{children:(0,l.jsx)(eq.Z,{value:null!==(d=null==W?void 0:W.subpremise)&&void 0!==d?d:J,size:g.J9.medium,onChange:e=>eC(e),placeholder:T.ZP.t("addressPickerStrings_apartmentInput_placeholder"),label:eR,description:T.ZP.t("addressPickerStrings_OptionalLabel"),isLabelHidden:!1})})]}),_?null:(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(y.Z,{type:eG.C.fullBorder}),!!(null==i?void 0:i.length)&&(null==j?void 0:j()),(0,l.jsx)(ei,{availableAddresses:i,defaultAddressId:K,onEdit:e=>{H(eP(e)),eA("Edit"),(0,eh.gC)(),null==$||$(!0)},onSelect:e=>{ti(),H(void 0),et(""),Y(e)},onRemove:x,isLiteGuest:C,isAddressLabelEnabled:!1,getIsRecentAddressSelected:eN})]}),(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(y.Z,{type:eG.C.fullBorder}),(0,l.jsx)(Q.qO,{children:(0,l.jsx)(m.Z,{"data-anchor-id":z.ep.AddressNextButton,isInline:!e_,onClick:K?()=>eF(K):()=>{if(!K&&!W){et(T.ZP.t("addressPickerStrings_addressRequiredLabel"));return}if(W&&eE()&&et(T.ZP.t("addressPickerStrings_addressOutsideDeliveryZoneLabel")),!eE()){tu({isExistingAddress:!!K,isSubpremisePresent:!!(null==W?void 0:W.subpremise)||!!J}),eA("Edit"),null==$||$(!0),et("");return}},children:K?ek?T.ZP.t("addressPickerStrings_saveAndSwitchButton"):T.ZP.t("addressPickerStrings_addressAddSaveButtonText"):T.ZP.t("addressPickerStrings_addressAddNextButtonText")})})]})]})})},{name:"StorefrontAddressPicker "}),de=d(336279),dt=d(277616),dd=d(119245),dn=d(718394),dr=d(910049),ds=d(861332),di=e=>{var t;let{addressEntryPoint:d,consumer:n,addressAutocompleteLabel:r,hideAddressList:s,isStaticPositionSuggestions:i,refetchQueries:u,awaitRefetchQueries:c,awaitDefaultAddressRefetchQueries:f,onChange:p,renderBeforeAddressList:g,customizations:m,renderFooterActions:v,handleIdentityLinkClick:h,placeholder:b,showIdentityLink:A=!0,setIsEditTitle:_,setSelectedAddress:y,loading:S,selectedAddressLabelName:x,isCurrentLocationEnabled:C=!1,isCurrentLocationSelected:P=!1,onClickCurrentLocation:I,onCompleteRemoveAddress:j,onSetLabelForAddressComplete:E,onCloseAddressEdit:k,onShowPinCodeEducationModal:Z,doNotShowPinCodeWarningBanner:L}=e,w="".concat(d,"/AddressPickerConnected"),{isStorefront:T}=(0,a.Z)(),{orderCart:D}=o.useContext(dd.i),{updateConsumerDefaultAddress:O,res:N}=(0,ds.Z)({refetchQueries:u,awaitRefetchQueries:f,addressEntryPoint:w,onCompleted:p}),{addConsumerAddress:F,res:$}=(0,dr.U)({addressEntryPoint:w,refetchQueries:u,awaitRefetchQueries:c,onCompleted:p}),{editAddress:B,res:{loading:M}}=(0,dn.c)(),{removeAddress:z,res:R}=(0,de.m)(j),U=n.defaultAddress||{},q=(0,dt.l)(D.id,U),G=q.loading||q.error?[]:q.dropoffOptions,V=(null==n?void 0:n.availableAddresses)||[],W=(null==n?void 0:null===(t=n.defaultAddress)||void 0===t?void 0:t.id)||"",{isGuest:Q,isLiteGuest:H}=function(e){let t=!!e&&null===e.email;return{isGuest:!!e&&!!e.isGuest,isLiteGuest:!!e&&!!e.isGuest&&!!t}}(n),K=S||N.loading||R.loading||$.loading||M;return T?(0,l.jsx)(t5,{handleIdentityLinkClick:h,addressEntryPoint:w,onCompleted:p,availableAddresses:V,selectedAddressId:W,dropoffOptions:G,loading:K,onSelectAddress:O,onRemoveAddress:z,onAddAddress:F,onUpdateAddress:B,addressAutocompleteLabel:r,hideAddressList:s,isStaticPositionSuggestions:i,isLiteGuest:H,isGuest:Q,renderBeforeAddressList:g,customizations:m,defaultAddress:n.defaultAddress,showIdentityLink:A,setIsEditTitle:_}):(0,l.jsx)(eU,{addressEntryPoint:w,renderFooterActions:v,availableAddresses:V,labeledAddresses:[],defaultAddressId:W,dropoffOptions:G,loading:K,onSelectAddress:O,onRemoveAddress:z,onAddAddress:F,onUpdateAddress:B,addressAutocompleteLabel:r,hideAddressList:s,isStaticPositionSuggestions:i,isLiteGuest:H,isGuest:Q,renderBeforeAddressList:g,customizations:m,handleIdentityLinkClick:h,defaultAddress:n.defaultAddress,placeholder:b,showIdentityLink:A,setIsEditTitle:_,setSelectedAddress:y,selectedAddressLabelName:x,isCurrentLocationEnabled:C,isCurrentLocationSelected:P,onClickCurrentLocation:I,refetchQueries:u,onSetLabelForAddressComplete:E,onCloseAddressEdit:k,onShowPinCodeEducationModal:Z,doNotShowPinCodeWarningBanner:L})}},997341:function(e,t,d){d.d(t,{Bi:function(){return o},Hz:function(){return c},a5:function(){return f},gC:function(){return i},iZ:function(){return l},pW:function(){return a},zj:function(){return s.zj}});var n=d(455639),r=d(360968),s=d(6383);let i=()=>{(0,n.j)(r.wd.ClickedEditAddress,{entry:r.kS.AddressPicker})},l=e=>(0,n.j)(r.wd.GetLocationButtonClick,{use_case:null!=e?e:""}),a=e=>(0,n.j)(r.wd.AddressBarSubmitButtonClick,{use_case:null!=e?e:""}),o=e=>(0,n.j)(r.wd.AddressBarGeoSuggestionDropdownSelect,{use_case:null!=e?e:""}),u=e=>t=>{let{addressId:d,addressEntryPoint:s,addressToUpdate:i,editResponse:l,dropoffOptionId:a,manualLat:o,manualLng:u}=t;(0,n.j)(e,{entry:r.kS.AddressPicker,dropoff_option_id:a,address_id:d,pin_lat:o,pin_lng:u}),(0,n.j)("debug_address_modify",{address_entry_point:s,...g(i),...p(l)})},c=u(r.wd.SubmittedAddressEdits),f=u(r.wd.AddressEditSubmitError),p=e=>{var t;if(!e)return{};let{defaultAddress:d,availableAddresses:n}=e,r=null==d?void 0:d.dropoffPreferences.allPreferences.find(e=>e.isDefault);return{edited_address_id:null==d?void 0:d.id,edited_address_dropoffPreference:null==r?void 0:r.optionId,edited_address_instructions:null==d?void 0:d.driverInstructions,edited_address_latitude:null==d?void 0:d.lat,edited_address_longitude:null==d?void 0:d.lng,edited_address_manual_latitude:null==d?void 0:d.manualLat,edited_address_manual_longitude:null==d?void 0:d.manualLng,edited_address_subpremise:null==d?void 0:d.subpremise,edited_available_addresses:JSON.stringify(null==n?void 0:n.map(e=>null==e?void 0:e.id)),edited_address_label_name:null==d?void 0:null===(t=d.personalAddressLabel)||void 0===t?void 0:t.labelName}},g=e=>{if(!e)return{};let t=null==e?void 0:e.dropoffPreferences.allPreferences.find(e=>e.isDefault),{id:d,driverInstructions:n,lat:r,lng:s,manualLat:i,manualLng:l,street:a,subpremise:o,city:u,state:c,zipCode:f,country:p,personalAddressLabel:g}=e;return{previous_address_id:d,previous_address_dropoffPreference:null==t?void 0:t.optionId,previous_address_instructions:n,previous_address_latitude:r,previous_address_locality_line:"".concat(u,", ").concat(c," ").concat(f,", ").concat(p),previous_address_longitude:s,previous_address_manual_latitude:i,previous_address_manual_longitude:l,previous_address_street_line:"".concat(a,", ").concat(o),previous_address_subpremise:o,previous_address_label_name:null==g?void 0:g.labelName,previous_address_label_icon:null==g?void 0:g.labelIcon}}},99060:function(e,t,d){var n=d(361967),r=d(951939),s=d(655692),i=d(196421),l=d(576263),a=d(465830),o=d(161206),u=d(901270),c=d(163465),f=d(313773),p=d(469894),g=d(703376),m=d(195650),v=d(731690),h=d(518766),b=d(994084),A=d(712504);let _=(0,p.default)(()=>Promise.all([d.e(1042),d.e(8334),d.e(60638)]).then(d.bind(d,332350)),{loadableGenerated:{webpack:()=>[332350]},ssr:!1}),y=(e,t)=>t.lat!==e.lat||t.lng!==e.lng;t.Z=e=>{let{address:t,handleChangePinLocation:d,draftCoordinates:p,errorMessage:S,onCancel:x,onSubmit:C,hideTitle:P=!1,shouldStackActionButtons:I,hideActionButtons:j=!1}=e,{isAdjustPinReadjustmentEnabled:E}=(0,A.Z)(),[k]=f.useState({lat:p.lat,lng:p.lng}),{grantedGeolocationPermission:Z,updateCurrentPosition:L}=(0,g.Z)();f.useEffect(()=>{(0,b.oT)()},[]),f.useEffect(()=>{Z&&L()},[Z,L]);let w=e=>{e.nativeEvent.stopImmediatePropagation(),y(k,p)?null==C||C(p):null==x||x(e)};return(0,n.jsxs)(r.Z,{children:[!P&&(0,n.jsx)(o.x,{as:h.$h.H2,textStyle:u.TextStyle.display.medium,children:v.ZP.t("addressPickerStrings_addressEditAdjustPin")}),(0,n.jsx)(c.Z,{setContainerAsAnchor:!0,children:(0,n.jsx)(_,{defaultAddress:t,isEditing:!0,isCompact:!1,onChange:d,locationOverride:p,allowDifferentMapProvider:!0,isTooltipVisible:E,isMapCircleVisible:E})}),S&&(0,n.jsx)(m.Z,{children:S}),!j&&(I?(0,n.jsxs)(r.Z,{size:s.Uo.xSmall,children:[(0,n.jsx)(i.Z,{onClick:w,children:v.ZP.t("addressPickerStrings_addressEditSave")}),(0,n.jsx)(i.Z,{onClick:x,type:l.L$.tertiary,children:v.ZP.t("addressPickerStrings_addressEditCancel")})]}):(0,n.jsxs)(a.Z,{children:[(0,n.jsx)(i.Z,{onClick:x,type:l.L$.tertiary,children:v.ZP.t("addressPickerStrings_addressEditCancel")}),(0,n.jsx)(i.Z,{onClick:w,children:v.ZP.t("addressPickerStrings_addressEditSave")})]}))]})}},195650:function(e,t,d){d.d(t,{Z:function(){return v}});var n=d(361967);d(313773);var r=d(918564),s=d(992899);let i=r.default.div.withConfig({componentId:"sc-51a246f5-0"})(["background-color:",";"],s.Q2.usage.color.negative.subdued.default);var l=d(371801),a=d(465830),o=d(54881),u=d(655692),c=d(685393),f=d(806286),p=d(161206),g=d(901270),m=d(284308),v=e=>(0,n.jsx)(i,{"data-testid":"AddressPickerErrorBanner",children:(0,n.jsx)(l.Z,{children:(0,n.jsxs)(a.Z,{alignItems:o.v2.center,size:u.O8.small,children:[(0,n.jsx)(c.Z,{type:f.IconType.ErrorFill,color:f.EY.negative.strong.default,accessibilityLabel:"Error Icon"}),(0,n.jsx)(m.I,{error:e.children,children:(0,n.jsx)(p.x,{textStyle:g.TextStyle.label.small.default,children:e.children})})]})})})},278728:function(e,t,d){var n=d(361967),r=d(403721),s=d(465830),i=d(54881),l=d(655692),a=d(685393),o=d(806286),u=d(951939),c=d(161206),f=d(901270),p=d(374856),g=d(731690);d(313773),t.Z=e=>{let{active:t}=e;return(0,n.jsxs)(r.FR,{"data-testid":p.D.ManualAddressEntryButton,active:t,children:[(0,n.jsxs)(s.Z,{alignItems:i.v2.center,size:l.O8.small,children:[(0,n.jsx)(a.Z,{type:o.IconType.AddCircleFill}),(0,n.jsxs)(u.Z,{size:l.Uo.xxxSmall,children:[(0,n.jsx)(c.x,{textStyle:f.TextStyle.body.medium.default,children:g.ZP.t("manualAddressEntry_cta")}),(0,n.jsx)(c.x,{textStyle:f.TextStyle.body.small.default,weight:f.fs.light,children:g.ZP.t("manualAddressEntry_description")})]})]}),(0,n.jsx)(a.Z,{type:o.IconType.ChevronRight})]})}},498777:function(e,t,d){d.d(t,{R:function(){return l},m:function(){return i}});var n=d(361967),r=d(313773);let s=r.createContext(void 0),i=e=>{let{mode:t,setMode:d,useDraftAddressFromModal:r,draftAddress:i,editFormError:l,setDraftAddress:a,setEditFormError:o,children:u}=e;return(0,n.jsx)(s.Provider,{value:{mode:t,setMode:d,useDraftAddressFromModal:r,draftAddress:i,setDraftAddress:a,editFormError:l,setEditFormError:o},children:u})},l=()=>r.useContext(s)},488954:function(e,t,d){var n=d(361967),r=d(299891),s=d(964697),i=d(228172),l=d(262679);d(313773);var a=d(649454),o=d(504253),u=d(861264),c=d(480704),f=d(336279),p=d(85890),g=d(498777),m=d(521384),v=d(607738);let h=[p.A.Edit,p.A.ChangePin];t.Z=e=>{let{addressEntryPoint:t,title:d,address:b,dropoffOptions:A,onClose:_,dropoffPreferences:y,defaultAddressId:S,driverInstructions:x,customizations:C,refetchQueries:P,testId:I,onCloseAddressEdit:j,onShowPinCodeEducationModal:E,doNotShowPinCodeWarningBanner:k,shouldSkipValidateAddress:Z=!1}=e,L="".concat(t,"/EditAddressModal"),{isStorefront:w}=(0,r.Z)(),{mode:T,setMode:D,draftAddress:O,setDraftAddress:N,editFormError:F,setEditFormError:$,saveAddress:B,saveChangePin:M,loading:z}=(0,m.p)({defaultMode:p.A.Edit,addressEntryPoint:L,addAddressMutationProps:{addressEntryPoint:L,refetchQueries:P},onEditAddressCompleted:()=>{N(void 0),null==_||_()}}),{removeAddress:R}=(0,f.m)(),U=()=>{T===p.A.ChangePin&&O&&N({...O,draftCoordinates:null}),D(p.A.Edit),$(null)},q=()=>T===p.A.ChangePin?U():null==_?void 0:_(),G=!(w||!h.includes(T)||!b);return(0,n.jsx)(s.Z,{isOpen:G,"data-testid":I,title:d,hasCloseButton:!0,onClose:q,size:i.C.small,renderFooterContent:(0,v.uW)({isAddressLabelEnabled:!0,loading:z,mode:T,error:(0,u.Yg)(F)?null:F,onCancel:q,onSave:()=>{T===p.A.ChangePin?M():T===p.A.Edit&&B()}}),children:(0,n.jsx)(g.m,{mode:T,setMode:D,useDraftAddressFromModal:!0,draftAddress:O,setDraftAddress:N,editFormError:F,setEditFormError:$,children:(0,n.jsx)(a.n,{skip:Z,address:(0,c.aN)(b)?void 0:b,googlePlaceId:(0,c.aN)(b)?b.googlePlaceId:void 0,addressId:(0,c.aN)(b)?b.addressId:void 0,children:(0,n.jsx)(o.Z,{dropoffPreferences:y,dropoffOptions:A,driverInstructions:x,address:b,hideAdjustPin:null==C?void 0:C.hideAdjustPin,hideDropOffOptions:null==C?void 0:C.hideDropOffOptions,handleRemoveAddress:e=>{e?R(e):(0,l.eN)({level:"warning",message:"Trying to remove an address without id"})},defaultAddressId:S,onCloseOfAddressEdit:j,onShowPinCodeEducationModal:E,doNotShowPinCodeWarningBanner:k})})})})}},521384:function(e,t,d){d.d(t,{p:function(){return g}});var n=d(313773),r=d(278884),s=d(731690),i=d(148632),l=d(861264),a=d(997341),o=d(480704),u=d(718394),c=d(85890),f=d(994084),p=d(910049);function g(e){let{defaultMode:t,addressEntryPoint:d,addAddressMutationProps:g,onEditAddressCompleted:m}=e,v=null!=t?t:c.A.Default,[h,b]=(0,n.useState)(v),[A,_]=(0,n.useState)(),[y,S]=(0,n.useState)(null),x=(0,n.useCallback)(()=>{_(void 0),S(null),b(v)},[v]),{saveAddress:C,loading:P}=function(e){let{addressEntryPoint:t,addAddressMutationProps:d,draftAddress:n,clearStates:s,setEditFormError:c,onEditAddressCompleted:g}=e,{addConsumerAddress:m,res:{loading:v}}=(0,p.U)(d),{editAddress:h,res:{loading:b}}=(0,u.c)(),{consumer:A}=(0,r.R)(),_=e=>{var t;let{manualLat:d,manualLng:n}=(0,o.Yt)(e.draftCoordinates),r={manualLat:d,manualLng:n,lat:e.lat,lng:e.lng,dropoffOptionId:e.dropoffOptionId};return m({lat:e.lat,lng:e.lng,city:e.city,state:e.state,zipCode:e.zipCode,printableAddress:e.printableAddress,shortname:e.shortname,googlePlaceId:e.googlePlaceId,subpremise:e.subpremise,driverInstructions:e.driverInstructions,dropoffOptionId:e.dropoffOptionId,addressLinkType:e.addressLinkType,buildingName:e.buildingName,entryCode:e.entryCode,manualLat:d,manualLng:n,personalAddressLabel:{labelName:null===(t=e.personalAddressLabel)||void 0===t?void 0:t.labelName}}).then(()=>{(0,i.KS)(r),d&&n&&(0,f.$g)({original_lat:r.lat,original_lng:r.lng,pin_lat:d,pin_lng:n}),c(null),s()}).catch(e=>{c((0,l.Au)(e)),(0,i.hJ)(r),d&&n&&(0,l.NC)(e)&&(0,f.ij)({original_lat:r.lat,original_lng:r.lng,pin_lat:d,pin_lng:n})})},y=e=>{var d;let{manualLat:n,manualLng:r}=(0,o.Yt)(e.draftCoordinates),i={addressId:e.id,dropoffOptionId:e.dropoffOptionId,manualLat:n,manualLng:r,addressEntryPoint:t,addressToUpdate:A.defaultAddress};return c(null),h({subpremise:e.subpremise,driverInstructions:e.driverInstructions,dropoffOptionId:e.dropoffOptionId,addressLinkType:e.addressLinkType,entryCode:e.entryCode,buildingName:e.buildingName,manualLat:n,manualLng:r,personalAddressLabel:{labelName:null===(d=e.personalAddressLabel)||void 0===d?void 0:d.labelName},addressId:e.id}).then(e=>{var t;g(),(0,a.Hz)({...i,editResponse:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.editConsumerAddressV2}),s()}).catch(t=>{(0,a.a5)({...i,editResponse:null});let d=(0,l.Au)(t);n&&r&&(0,l.NC)(t)&&(0,f.ij)({original_lat:null==e?void 0:e.lat,original_lng:null==e?void 0:e.lng,pin_lat:n,pin_lng:r}),c(d)})};return{loading:v||b,saveAddress:()=>{n&&((0,o.aN)(n)?_(n):y(n))}}}({addressEntryPoint:d,addAddressMutationProps:g,setEditFormError:S,onEditAddressCompleted:m,draftAddress:A,clearStates:x});return{mode:h,setMode:b,draftAddress:A,setDraftAddress:_,editFormError:y,setEditFormError:S,saveAddress:C,saveChangePin:()=>{let{draftCoordinates:e}=null!=A?A:{};A&&(e?(0,o.ng)(e,A)?(_(t=>t?{...t,manualLat:e.lat,manualLng:e.lng}:void 0),b(c.A.Edit),S(null)):(_(e=>e?{...e,manualLat:null,manualLng:null}:void 0),S(s.ZP.t("addressPickerStrings_addressEditPinLocationError"))):S(s.ZP.t("addressPickerStrings_addressEditPinLocationNoChange")))},loading:P}}},607738:function(e,t,d){d.d(t,{g7:function(){return O},OH:function(){return w},HA:function(){return N},uW:function(){return D}});var n=d(361967);d(313773);var r=d(731690),s=d(85890),i=d(951939),l=d(655692),a=d(196421),o=d(576263),u=d(686143),c=d(465830),f=d(54881),p=d(918564),g=d(249478),m=d(195650),v=d(374856);let h=(0,p.default)(i.Z).attrs(()=>({size:l.Uo.xSmall})).withConfig({componentId:"sc-64c1bd5-0"})(["flex:1;"]);var b=e=>{let{formError:t,loading:d,mode:p,onCancel:b,onSave:A}=e,{isMobile:_}=(0,g.ac)(),y=p===s.A.ChangePin,S=(0,n.jsx)(a.Z,{isInline:!y&&!_,type:y?o.L$.tertiary:o.L$.plain,onClick:b,isDisabled:d,"data-testid":v.D.AddressModalFooterCancelButton,size:_?u.qE.large:u.qE.medium,children:r.ZP.t("addressPickerStrings_addressEditCancel")}),x=(0,n.jsx)(a.Z,{isInline:!y&&!_,onClick:A,state:d?o.BN.loading:o.BN.default,"data-testid":v.D.AddressModalFooterSubmitButton,size:_?u.qE.large:u.qE.medium,children:y?r.ZP.t("addressPickerStrings_addressEditSave"):r.ZP.t("address_save_address")});return(0,n.jsxs)(h,{children:[t&&(0,n.jsx)(m.Z,{children:t}),_?(0,n.jsxs)(i.Z,{size:l.Uo.xSmall,children:[x,S]}):(0,n.jsxs)(c.Z,{justifyContent:f.dy.flexEnd,size:l.O8.xSmall,children:[S,x]})]})},A=d(389016),_=d(992899),y=d(161206),S=d(901270),x=d(150946);let C=(0,p.default)(i.Z).attrs(()=>({size:l.Uo.xSmall})).withConfig({componentId:"sc-85f16b5d-0"})(["margin-left:",";"],_.Q2.usage.space.small),P=(0,p.default)(y.x).attrs(()=>({as:"h1",textStyle:S.TextStyle.display.large,color:S.d9.text.default,fontWeight:S.fs.bold})).withConfig({componentId:"sc-85f16b5d-1"})(["display:inline;"]),I=(0,p.default)(y.x).attrs(()=>({textStyle:S.TextStyle.label.medium.default,color:S.d9.text.subdued.default})).withConfig({componentId:"sc-85f16b5d-2"})(["display:inline;"]),j=p.default.div.withConfig({componentId:"sc-85f16b5d-3"})(["display:flex;align-items:center;height:100%;"]),E=(0,p.default)(y.x).attrs(()=>({textStyle:S.TextStyle.label.medium.default,color:S.d9.text.subdued.default,maxLines:1,overflow:x.lG.truncate})).withConfig({componentId:"sc-85f16b5d-4"})(["flex-shrink:0;"]),k=(0,p.default)(y.x).attrs(()=>({textStyle:S.TextStyle.label.medium.default,color:S.d9.text.default,maxLines:1,overflow:x.lG.truncate,fontWeight:S.fs.bold})).withConfig({componentId:"sc-85f16b5d-5"})(["flex-shrink:0;"]),Z=p.default.div.withConfig({componentId:"sc-85f16b5d-6"})(["display:flex;flex-direction:column;> *{margin-left:",";}"],_.Q2.usage.space.xxSmall);var L=e=>{let{menuItemName:t,menuItemImageUrl:d,title:s,subtitle:i}=e;return(0,n.jsxs)(C,{children:[(0,n.jsxs)(j,{"data-testid":v.D.AddressModalMenuItem,children:[(0,n.jsx)(A.Z,{disableMarginLeft:!0,itemNameAlt:t,imageUrl:d},v.D.AddressBarCartItemImage),(0,n.jsxs)(Z,{children:[(0,n.jsx)(E,{children:r.ZP.t("addressModalStrings_menuItemHeader")}),(0,n.jsx)(k,{children:t})]})]}),(0,n.jsxs)(Z,{children:[(0,n.jsx)(P,{children:s}),(0,n.jsx)(I,{children:i})]})]})};let w=e=>{let{titleProp:t,isEditTitle:d,isAddressLabelEnabled:n,mode:i,isGuest:l,selectedAddressLabelName:a}=e;if(n&&i===s.A.SetLabel&&a)return r.ZP.t("addressPickerStrings_setLabelAddress",{label:null!=a?a:""});if(n&&i===s.A.ChangePin)return r.ZP.t("addressPickerStrings_addressEditAdjustPin");if(d||i===s.A.Edit)return n?r.ZP.t("address_save_address"):r.ZP.t("address_edit_title");let o=l?r.ZP.t("layoutStrings_header_addAddress"):r.ZP.t("addressPickerStrings_addresses"),u=n?o:r.ZP.t("menu_addressDetails_enterYourDeliveryAddressText_sentenceCase");return t||u},T=[s.A.Edit,s.A.ChangePin],D=e=>{let{renderFooterContentProp:t,isAddressLabelEnabled:d,loading:r,mode:s,error:i,onCancel:l,onSave:a}=e;return t||(d&&T.includes(s)?()=>(0,n.jsx)(b,{mode:s,formError:i,loading:r,onCancel:l,onSave:a}):void 0)},O=(e,t)=>(null==t?void 0:t.isFromLabeledAddress)&&e!==s.A.SetLabel?s.A.SetLabel:e===s.A.ChangePin?s.A.Edit:s.A.Default,N=e=>{let{renderContentHeaderProp:t,menuItemName:d,menuItemImageUrl:r,title:s,subtitle:i}=e;return t||((null==d?void 0:d.length)&&(null==r?void 0:r.length)&&(null==s?void 0:s.length)&&(null==i?void 0:i.length)?()=>(0,n.jsx)(L,{menuItemName:d,menuItemImageUrl:r,title:s,subtitle:i}):void 0)}},861332:function(e,t,d){d.d(t,{Z:function(){return m}});var n=d(979994),r=d(860413),s=d(797476),i=d(782723),l=d(702210),a=d(628763),o=d(213463),u=d(575551),c=d(822250);function f(){let e=(0,n._)(["\n  mutation updateConsumerDefaultAddressV2($defaultAddressId: ID!) {\n    updateConsumerDefaultAddressV2(defaultAddressId: $defaultAddressId) {\n      defaultAddress {\n        ...DefaultAddressFragment\n        # adding submarket fields here instead of in the above fragment for now to avoid propagating this field in more places than needed\n        submarket\n        submarketId\n      }\n      availableAddresses {\n        ...DefaultAddressFragment\n      }\n      orderCart {\n        ...ConsumerOrderCartFragment\n      }\n      ...CoreConsumerFragment\n    }\n  }\n  ","\n  ","\n  ","\n"]);return f=function(){return e},e}let p=(0,r.gql)(f(),s.q,u.h6,i.X),g=e=>"".concat(e,"/DefaultAddressMutation"),m=e=>{let{refetchQueries:t,awaitRefetchQueries:d=!1,addressEntryPoint:n,onCompleted:r}=e,s=(0,c.Y)(),[i,u]=(0,a.Z)({ethosAction:{name:o.r.UpdateConsumerAddress,type:o.Yh.TypedInput},unifiedTelemetryAction:s},p,{onCompleted:e=>{var t,d,n,s,i;null==r||r(null!==(s=null===(t=e.updateConsumerDefaultAddressV2)||void 0===t?void 0:t.defaultAddress)&&void 0!==s?s:void 0,null!==(i=null===(n=e.updateConsumerDefaultAddressV2)||void 0===n?void 0:null===(d=n.orderCart)||void 0===d?void 0:d.id)&&void 0!==i?i:"")}});return{updateConsumerDefaultAddress:function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i({awaitRefetchQueries:d,refetchQueries:r?[]:t,variables:{defaultAddressId:e}}).then(t=>{var d;l.hy(g(n),e,null===(d=t.data)||void 0===d?void 0:d.updateConsumerDefaultAddressV2)})},res:u}}},718394:function(e,t,d){d.d(t,{c:function(){return m}});var n=d(979994),r=d(313773),s=d(860413),i=d(628763),l=d(822250),a=d(166120),o=d(797476),u=d(782723),c=d(186927),f=d(934015);function p(){let e=(0,n._)(["\n  mutation editConsumerAddressV2(\n    $subpremise: String\n    $driverInstructions: String\n    $dropoffOptionId: String\n    $addressId: String\n    $manualLat: Float\n    $manualLng: Float\n    $addressLinkType: AddressLinkType\n    $buildingName: String\n    $entryCode: String\n    $personalAddressLabel: PersonalAddressLabelInput\n    $returnConsumerFragment: Boolean!\n  ) {\n    editConsumerAddressV2(\n      subpremise: $subpremise\n      driverInstructions: $driverInstructions\n      dropoffOptionId: $dropoffOptionId\n      addressId: $addressId\n      manualLat: $manualLat\n      manualLng: $manualLng\n      addressLinkType: $addressLinkType\n      buildingName: $buildingName\n      entryCode: $entryCode\n      personalAddressLabel: $personalAddressLabel\n    ) {\n      defaultAddress {\n        ...DefaultAddressFragment\n      }\n      availableAddresses {\n        ...DefaultAddressFragment\n      }\n      ... @include(if: $returnConsumerFragment) {\n        ...CoreConsumerFragment\n      }\n    }\n  }\n  ","\n  ","\n"]);return p=function(){return e},e}let g=(0,s.gql)(p(),o.q,u.X),m=()=>{let{getCurrentContexts:e}=r.useContext(c.V),{address:t}=e().globalContext,d=(0,l.Y)(),[n,s]=(0,i.Z)({unifiedTelemetryAction:d},g),[o,u]=(0,f.Db)(g),{isAddressLabelEnabled:p}=(0,a.Z)();return{editAddress:e=>(null==t?void 0:t.address_id)!==void 0&&(null==t?void 0:t.address_id)===e.addressId?n({variables:{...e,returnConsumerFragment:p}}):o({variables:{...e,returnConsumerFragment:p}}),res:u||s}}},336279:function(e,t,d){d.d(t,{m:function(){return f}});var n=d(979994),r=d(860413),s=d(934015),i=d(797476),l=d(782723),a=d(455639),o=d(360968);function u(){let e=(0,n._)(["\n  mutation removeConsumerAddressV2($defaultAddressId: ID!) {\n    removeConsumerAddressV2(defaultAddressId: $defaultAddressId) {\n      defaultAddress {\n        ...DefaultAddressFragment\n      }\n      availableAddresses {\n        ...DefaultAddressFragment\n      }\n      ...CoreConsumerFragment\n    }\n  }\n  ","\n  ","\n"]);return u=function(){return e},e}let c=(0,r.gql)(u(),i.q,l.X),f=e=>{let[t,d]=(0,s.Db)(c,{onCompleted:t=>{(0,a.j)(o.wd.AddressDeleteSubmit,t),null==e||e(t)}});return{removeAddress:e=>t({variables:{defaultAddressId:e}}),res:d}}},516202:function(e,t,d){var n=d(361967),r=d(538204),s=d(827515),i=d(725075),l=d(313773),a=d(315073),o=d(278884),u=d(877e3),c=d(970501),f=d(455639),p=d(731690),g=d(357166);let m=e=>{switch(e){case c.wy1.WARNING:return{bannerType:r.$.warning};case c.wy1.ERROR:return{bannerType:r.$.negative};case c.wy1.INFO:case c.wy1.UNSPECIFIED:return{bannerType:r.$.informational}}};t.Z=e=>{let{onClick:t,showPrimaryActionButton:d=!1,orderCartId:c}=e,{consumer:v}=(0,o.R)(),{result:h,recommendedActions:b}=l.useContext(u.Z),{enableCheckoutBannerAndAdressPickerTreatment:A}=(0,g.jX)(b);return((0,a.F_)(()=>{h&&(0,f.j)("checkout_address_validation_banner_shown",{validation_result_code:h.code,cart_id:c,consumer_id:v.id,banner_type:h.type})},[h,c,v.id]),h)?(0,n.jsx)(s.Z,{children:(0,n.jsx)(i.Z,{...A?{bannerType:r.$.warning,body:p.ZP.t("seo_address_validation_banner_body")}:{...m(h.type),body:h.message},primaryAction:d?{content:p.ZP.t("addressPickerStrings_validationAddressEdit"),onClick:t}:void 0})}):null}},811094:function(e,t,d){d.d(t,{Jk:function(){return x},bb:function(){return S}});var n=d(361967),r=d(313773),s=d(455639),i=d(812993),l=d(196421),a=d(686143),o=d(806286),u=d(576263),c=d(992899),f=d(918564),p=d(539599),g=d(724590),m=d(299891),v=d(166120),h=d(493260),b=d(731690),A=d(424),_=d(818617);d(554859);let y=e=>(0,s.j)("action_address_signin_signup_".concat(e)),S=e=>{let{isGuest:t,entry:d,handleIdentityLinkClick:c,isDarkBackground:f,linkText:A}=e,[S,x]=(0,r.useState)(""),{isDoorDash:C,isCaviar:P}=(0,m.Z)(),{isAddressLabelEnabled:I}=(0,v.Z)(),{showLoginInModalExpEnabled:j,showSignInSignUpModal:E,setShowSignInSignUpModal:k,onIdentityLinkClick:Z}=(0,p.Z)(),{getLoginUrl:L}=(0,h.Yq)();(0,i.L)(()=>x(L({nextPath:window.location.pathname+window.location.search})));let w=I?b.ZP.t("addressPickerStrings_signinForSavedAddressV2"):b.ZP.t("addressPickerStrings_signinForSavedAddress");return t&&(C||P)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.L,{isOpen:E,setShowSignInSignUpModal:k,onClose:()=>k(!1)}),(0,n.jsx)(l.Z,{isInline:!0,size:a.qE.small,leadingIcon:o.IconType.PersonUserLine,"data-testid":_.Am.identityButton,type:f?u.L$.plain:u.L$.tertiary,href:S,onClick:e=>{j&&((0,s.j)("signin_for_saved_address_login_modal_click"),null==c||c(),Z(),e.preventDefault()),y(d)},children:null!=A?A:w})]}):null},x=(0,f.default)(S).withConfig({componentId:"sc-962bba8e-0"})(["span{margin-top:",";color:",";}"],e=>{let{isAddressLabelEnabled:t}=e;return t?c.Q2.usage.space.xSmall:c.Q2.usage.space.none},e=>e.isDarkBackground?A.i2.SystemWhite:A.i2.SystemGrey100);(0,f.default)(S).withConfig({componentId:"sc-962bba8e-1"})(["span{text-align:center;color:",";",";}"],e=>e.isDoorDash?A.i2.SystemWhite:A.i2.SystemGrey100,e=>e.textStyles&&e.textStyles)},116692:function(e,t,d){var n=d(313773);let r=["DE"];t.Z=e=>(0,n.useMemo)(()=>"string"==typeof e&&r.map(e=>"string"==typeof e?e.toLowerCase():"").includes(e.toLowerCase()),[e])},277616:function(e,t,d){d.d(t,{l:function(){return u}});var n=d(979994),r=d(313773),s=d(860413),i=d(877182),l=d(731690);function a(){let e=(0,n._)(["\n  query dropoffOptions($cartId: ID, $addressId: ID) {\n    dropoffOptions(cartId: $cartId, addressId: $addressId) {\n      id\n      displayString\n      isDefault\n      isEnabled\n      placeholderText\n      disabledMessage\n      proofOfDeliveryType\n    }\n  }\n"]);return a=function(){return e},e}let o=(0,s.gql)(a()),u=function(e,t,d,n){var s,a,u,c,f,p,g;let m=arguments.length>4&&void 0!==arguments[4]&&arguments[4],v=(0,i.a)(o,{variables:{cartId:e,addressId:t.addressId||""}}),h=null!==(p=null===(s=v.data)||void 0===s?void 0:s.dropoffOptions)&&void 0!==p?p:[],b=null===(a=h.find(e=>(null==e?void 0:e.id)==="2"))||void 0===a?void 0:a.isEnabled,A=null===(u=h.find(e=>(null==e?void 0:e.id)==="2"))||void 0===u?void 0:u.isDefault;(0,r.useEffect)(()=>{v.refetch()},[t.id,t.addressId,d,n,b,A]);let _=null!==(g=null===(f=v.data)||void 0===f?void 0:null===(c=f.dropoffOptions)||void 0===c?void 0:c.filter(e=>null!=e))&&void 0!==g?g:[];return m&&(_[0]={...null==_?void 0:_[0],displayString:l.ZP.t("packageReturnsDropOffOptionsHandItToTheDasherTitle"),isDefault:!0,isEnabled:!0,placeholderText:l.ZP.t("packageReturnsDropOffOptionsHandItToTheDasherPlaceholder"),disabledMessage:null},_[1]={...null==_?void 0:_[1],displayString:l.ZP.t("packageReturnsDropOffOptionsPickupOutsideMyDoorTitle"),isDefault:!1,isEnabled:!0,placeholderText:l.ZP.t("packageReturnsDropOffOptionsPickupOutsideMyDoorPlaceholder"),disabledMessage:null}),{...v,dropoffOptions:_}}},942979:function(e,t,d){d.d(t,{e:function(){return o}});var n=d(979994),r=d(366033),s=d(860413),i=d(575551);function l(){let e=(0,n._)(["\n  mutation setCartFulfillmentType(\n    $cartId: ID!\n    $fulfillmentType: FulfillmentType\n    $cartContext: CartContextInput\n    $returnCartFromOrderService: Boolean\n  ) {\n    setCartFulfillmentTypeV2(\n      cartId: $cartId\n      fulfillmentType: $fulfillmentType\n      cartContext: $cartContext\n      returnCartFromOrderService: $returnCartFromOrderService\n    ) {\n      ...ConsumerOrderCartFragment\n    }\n  }\n  ","\n"]);return l=function(){return e},e}let a=(0,s.gql)(l(),i.h6);function o(e){return t=>e?{__typename:"Mutation",setCartFulfillmentTypeV2:{...e,isConsumerPickup:t}}:void 0}t.Z=function(){return(0,r.D)(a)}},649454:function(e,t,d){d.d(t,{n:function(){return S}});var n,r,s=d(979994),i=d(361967),l=d(852670),a=d(860413),o=d(313773),u=d(970501),c=d(278884),f=d(877e3);function p(){let e=(0,s._)(["\n  query validateConsumerAddressWithAddressLinkId($addressLinkId: ID!) {\n    validateConsumerAddress(addressLinkId: $addressLinkId) {\n      cartMessage {\n        code\n        type\n        message\n      }\n      validationResults {\n        code\n        type\n      }\n      userActions {\n        userActionType\n        isCheckoutBlocked\n      }\n    }\n  }\n"]);return p=function(){return e},e}function g(){let e=(0,s._)(["\n  query validateConsumerAddressWithGooglePlaceId($googlePlaceId: ID!) {\n    validateConsumerAddress(googlePlaceId: $googlePlaceId) {\n      cartMessage {\n        code\n        type\n        message\n      }\n      validationResults {\n        code\n        type\n      }\n      userActions {\n        userActionType\n        isCheckoutBlocked\n      }\n    }\n  }\n"]);return g=function(){return e},e}function m(){let e=(0,s._)(["\n  query validateConsumerAddressWithAddressId($addressId: ID!) {\n    validateConsumerAddress(addressId: $addressId) {\n      cartMessage {\n        code\n        type\n        message\n      }\n      validationResults {\n        code\n        type\n      }\n      userActions {\n        userActionType\n        isCheckoutBlocked\n      }\n    }\n  }\n"]);return m=function(){return e},e}(n=r||(r={})).ADDRESS="ADDRESS",n.SUBPREMISE="SUBPREMISE";let v=(0,a.gql)(p()),h=(0,a.gql)(g()),b=(0,a.gql)(m()),A=e=>{if(!e)return null;switch(e){case u.R4b.MESSAGE_ADDRESS_NOT_DELIVERABLE:case u.R4b.MESSAGE_ADDRESS_NOT_DELIVERABLE_ALL_DELIVERIES_BLOCKED:case u.R4b.MESSAGE_UNSPECIFIED:return r.ADDRESS;default:return r.SUBPREMISE}},_=e=>!!(null==e?void 0:e.some(e=>e.isCheckoutBlocked)),y=(e,t,d,n)=>{var r,s,i;let[a,{data:u,error:c}]=(0,l.t)(v,{fetchPolicy:"cache-and-network"}),[f,{data:p,error:g}]=(0,l.t)(h,{fetchPolicy:"cache-and-network"}),[m,{data:y,error:S}]=(0,l.t)(b,{fetchPolicy:"cache-and-network"});if((0,o.useEffect)(()=>{(e||d||n)&&!t&&(n?m({variables:{addressId:n}}):d?f({variables:{googlePlaceId:d}}):e&&a({variables:{addressLinkId:e.id}}))},[e,d,n,t,a,f,m]),t||c||g||S)return{messageLocation:null,result:null,recommendedActions:null,isCheckoutBlocked:!1};let x=y?y.validateConsumerAddress:u?u.validateConsumerAddress:null==p?void 0:p.validateConsumerAddress,C=null!==(i=null==x?void 0:x.cartMessage)&&void 0!==i?i:null;return{result:C,messageLocation:A(null==C?void 0:C.code),recommendedActions:(null==x?void 0:null===(s=x.userActions)||void 0===s?void 0:null===(r=s[0])||void 0===r?void 0:r.userActionType)||null,isCheckoutBlocked:_((null==x?void 0:x.userActions)||null)}},S=e=>{let{children:t,skip:d,address:n,googlePlaceId:r,addressId:s}=e,{consumer:l}=(0,c.R)(),a=y(n||l.defaultAddress,d,r,s);return(0,i.jsx)(f.Z.Provider,{value:a,children:t})}},885174:function(e,t,d){d.d(t,{Om:function(){return s},Wk:function(){return i}});var n=d(444679),r=d.n(n);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2?arguments[2]:void 0;r()(e,{time:500,validTarget:(e,t)=>t<2,align:{left:0,leftOffset:t},isScrollable:()=>!0},d)},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,{isScrollable:i}=n;r()(e,{time:s,align:{top:0,topOffset:t},...i&&{isScrollable:i}},d)};t.ZP=s},650118:function(e,t,d){var n=d(621363),r=d.n(n);t.Z=(e,t)=>r()(e,t,{unit:"meter"})},453508:function(e,t,d){d.d(t,{ib:function(){return o},g2:function(){return c}});var n=d(942979),r=d(455639);let s=e=>{let{storeId:t,menuId:d,isLoggedOutStorePage:n}=e;return(0,r.j)("store_page_action_delivery_pickup_toggle",{store_id:t,menu_id:d,use_case:n?"store_page_logged_out":null})};var i=d(61039),l=(e,t,d)=>{let n=i.t0.getIsDeliveryAvailable(e),r=!!(t.defaultAddress&&n);return!d&&r?{delivery:i.t0.getDeliveryFulfillmentLayoutSubtitle(e),pickup:i.t0.getPickupFulfillmentLayoutSubtitle(e)}:{delivery:"",pickup:""}};let a=(e,t)=>!!e&&(!o(e)&&!u(e,t)||!!e.groupCart),o=e=>0===(e.orders||[]).filter(e=>!!(e&&e.orderItems&&e.orderItems.length)).length,u=(e,t)=>{var d;return(null===(d=e.menu)||void 0===d?void 0:d.id)!==i._d.getCurrentMenuId(t)},c=(e,t,d,r,o,u,c,f,p)=>{var g,m;let v=i.t0.getStoreId(u),h=i._d.getCurrentMenuId(o),b=i.t0.getOffersDelivery(u),A=a(t,o),_=c&&(null==d?void 0:null===(g=d.defaultAddress)||void 0===g?void 0:g.printableAddress)===u.address.displayAddress,y=l(u,d,p);return{shouldRedirectOnToggleToDelivery:_,offersDelivery:b,shouldSetCartFulfillmentOnToggle:A,setIsToggledToPickup:r,isViewingPickup:e,trackFulfillmentToggle:()=>s({storeId:v,menuId:h,isLoggedOutStorePage:!!f}),getCartFulfillmentOpp:(0,n.e)(t),setFulfillmentVariables:{cartId:t?t.id:"",returnCartFromOrderService:!!(null==t?void 0:t.groupCart),cartContext:{isBundle:null!==(m=null==t?void 0:t.isBundle)&&void 0!==m&&m}},fulfillmentToggleEtaSubtext:y}}},934015:function(e,t,d){d.d(t,{Db:function(){return a},aM:function(){return l}});var n=d(366033),r=d(877182),s=d(262679);let i=e=>{try{if(!e)return;return{...e,meta:function(e){var t,d,n,r;let s=null==e?void 0:null===(r=e.graphQLErrors)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:null===(d=n.extensions)||void 0===d?void 0:null===(t=d.exception)||void 0===t?void 0:t.error;if(s)return{getApi:()=>s.api,getMessage:()=>s.message,getName:()=>s.name,getPath:()=>s.path,getStatusCode:()=>s.statusCode,getType:()=>s.type}}(e)}}catch(e){throw(0,s.Tb)("cx-apollo-client: Error parsing new error payload"),e}};function l(e,t){let d=(0,r.a)(e,t);return{...d,error:i(d.error)}}function a(e,t){let d=(0,n.D)(e,t),r=d[0],s=d[1];return[r,{...s,error:i(s.error)}]}}}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="831e9955-266d-5b89-abb9-ae53fffdf143")}catch(e){}}()
//# debugId=831e9955-266d-5b89-abb9-ae53fffdf143
//# sourceMappingURL=59500-8f9f483f335ec917.js.map
