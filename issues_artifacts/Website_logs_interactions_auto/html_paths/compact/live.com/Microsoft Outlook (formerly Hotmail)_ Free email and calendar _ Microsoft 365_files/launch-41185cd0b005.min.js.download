// For license information, see `https://assets.adobedtm.com/5ef092d1efb5/d6d76b37b476/launch-41185cd0b005.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2025-05-12T03:49:17Z",turbineBuildDate:"2024-08-22T17:32:44Z",turbineVersion:"28.0.0"},environment:{id:"ENe5ac16c0abde4e0db8a4cd055e2bbf71",stage:"production"},dataElements:{"Meta - Modified Date":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="article:modified_time"]')&&null!=document.querySelector('meta[name="article:modified_time"]').getAttribute("content")&&(e=document.querySelector('meta[name="article:modified_time"]').getAttribute("content")),e}}},"ACDL - Environment Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":"browser"}}},"Meta - Site Section":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return null!==document.querySelector('meta[name="awa-sitesection"]')?document.querySelector('meta[name="awa-sitesection"]').getAttribute("content"):void 0}}},"Meta - Page Group":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!==document.querySelector('meta[name="awa-pageuri"]')&&(e=document.querySelector('meta[name="awa-pageuri"]').getAttribute("content")),e}}},"ACDL - Event Name":{forceLowerCase:!0,cleanText:!0,modulePath:"gcoe-adobe-client-data-layer/src/lib/dataElements/datalayerComputedState.js",settings:{path:"eventInfo._mscom.eventData.eventName"}},"ACDL - Page Title":{modulePath:"core/src/lib/dataElements/pageInfo.js",settings:{attribute:"title"}},cachebuster:{defaultValue:"",cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/randomNumber.js",settings:{max:1e6,min:1}},"ACDL - Page Name":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e;return null!=document.querySelector("div.oneds-config[data-pagename]")&&null!=document.querySelector("div.oneds-config[data-pagename]").getAttribute("data-pagename")&&(e=document.querySelector("div.oneds-config[data-pagename]").getAttribute("data-pagename")),e}}},"Meta - AWA Canvas Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-canvasType"]')&&null!=document.querySelector('meta[name="awa-canvasType"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-canvasType"]').getAttribute("content")),e}}},"Meta - AWA Page Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-pageType"]')&&null!=document.querySelector('meta[name="awa-pageType"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-pageType"]').getAttribute("content")),e}}},"ACDL - Consents and Preferences Snapshot - JSON":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=_satellite.getVar("ACDL - Consents and Preferences Snapshot");return JSON.stringify(e)}}},"ACDL - Consent API Object Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1;return void 0!==window.siteConsent&&(e=!0),e}}},"ACDL - Device Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return(navigator.userAgentData.platform||navigator.platform)&&(e=navigator.userAgentData.platform),navigator.platform&&(e=navigator.platform),e}}},"ACDL - Entry Custom Referrer Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryReferrerTypeDetails&&(e=n.entryReferrerTypeDetails.entryCustomReferrerType),e}}},"QSP - sc_id":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("sc_id");null!=n&&(e=n)}return null!=getQueryParam("sc_id")&&null!=getQueryParam("sc_id")&&(e=getQueryParam("sc_id").toString(),localStorage.setItem("sc_id",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"XDM - All Pages":{modulePath:"adobe-alloy/dist/lib/dataElements/xdmObject/index.js",settings:{data:{web:{_mscom:{webSession:{entryUrl:"%dl_entryUrl%",sessionID:"%dl_sessionID%",entryReferrer:"%dl_entryReferrer%"}},webReferrer:{URL:"%ACDL - Referrer%",type:"%ACDL - Referrer Type%"},webInteraction:{_mscom:{hitNumber:"%dl_hitNumber%"}},webPageDetails:{URL:"%ACDL - URL%",name:"%ACDL - Page Name%",_mscom:{pageInfo:{URLQS:"%ACDL - URLQS%",pageCMS:"%Meta - AWA CMS%",pageType:"%Meta - AWA Page Type%",pageTitle:"%Meta - OG Title%",modifyDate:"%ACDL - Modified Date%",prevPageURL:"%dl_prevPageUrl%",publishDate:"%ACDL - Modified Date%",URLWithoutQS:"%ACDL - URL Without QS%",pageLoadTime:"%dl_pageLoadTime%",pageTemplate:"%Meta - Page Template%",pageLoadTimeRange:"%dl_pageLoadTimeRange%",msftConsentBannerVisibilityFlag:"%ACDL - Consent Banner Visibility Flag%"},siteInfo:{siteID:"%ACDL - Site ID%",siteName:"%ACDL - Site Name%",siteBrand:"%ACDL - Site Brand%",siteDomain:"%ACDL - Site Domain%",siteLocale:"%ACDL - Site Locale%",siteMarket:"%ACDL - Site Market%",siteLanguage:"%ACDL - Site Language%"}},server:"%ACDL - Server%",pageViews:{value:1},isHomePage:"%ACDL - Home Page Flag%",isErrorPage:"%dl_isErrorPageFlag%",siteSection:"%Meta - Site Section%"}},_mscom:{eventData:{eventName:"%dl_eventDataName%",actionType:"%dl_eventActionType%",behaviorID:"%dl_eventBehaviorID%",eventCategory:"%dl_eventBehaviorCategory%"},consentsSnapshot:"%ACDL - Consents and Preferences Snapshot%",currentIdentities:{ANON:"%ACDL - ANON Cookie%",ECID:"%ACDL - ECID%",MC1GUID:"%ACDL - MC1 GUID%",marketoMunchkinCookie:"%ACDL - Munchkin Cookie%"}},marketing:{_mscom:{ICID:"%ACDL - ICID (Internal Campaign ID)%"},trackingCode:"%dl_ocidTrackingCode%"},environment:{_dc:{language:"%dl_environmentLanguage%"},browserDetails:{name:"%ACDL - Browser Name%",userAgent:"%dl_userAgent%"}},identityMap:"%ACDL - Identity Map%",placeContext:{geo:{countryCode:"%dl_countryCode%"}}},sandbox:{name:"websdk-prod"}}},"Meta - Page Template":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="template"]')&&null!=document.querySelector('meta[name="template"]').getAttribute("content")&&(e=document.querySelector('meta[name="template"]').getAttribute("content")),e}}},"ACDL - Site Name":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return-1!=document.URL.indexOf("/microsoft-365")?"m365":"null"}}},"ACDL - Consent Banner Visibility Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1;return"undefined"!=typeof siteConsent&&siteConsent.consentControl&&siteConsent.consentControl.containerElement&&siteConsent.consentControl.containerElement.id&&null!=document.querySelector("#"+siteConsent.consentControl.containerElement.id)&&null!=document.querySelector("#"+siteConsent.consentControl.containerElement.id)&&null!=document.querySelector("#"+siteConsent.consentControl.containerElement.id+" > #wcpConsentBannerCtrl")&&null!=document.querySelector("#"+siteConsent.consentControl.containerElement.id+" > #wcpConsentBannerCtrl")&&(e=!0),e}}},"Meta - Published Date":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="article:published_time"]')&&null!=document.querySelector('meta[name="article:published_time"]').getAttribute("content")&&(e=document.querySelector('meta[name="article:published_time"]').getAttribute("content")),e}}},"ACDL - Published Date":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[property="article:published_time"]')&&null!=document.querySelector('meta[property="article:published_time"]').getAttribute("content")&&(e=document.querySelector('meta[property="article:published_time"]').getAttribute("content")),e}}},"ACDL - Entry URLQS":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryUrlQS&&(e=n.entryUrlQS),e}}},"QSP - cm_mmc":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("cm_mmc");null!=n&&(e=n)}return null!=getQueryParam("cm_mmc")&&null!=getQueryParam("cm_mmc")&&(e=getQueryParam("cm_mmc").toString(),localStorage.setItem("cm_mmc",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"ACDL - Web Session Details":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e,n,t=getCookie("webSessionDetails"),o=localStorage.getItem("webSessionDetails"),a=void 0,r=void 0,i=void 0,s=void 0,l=void 0,c=void 0,m=void 0;return t&&(null!=(e=JSON.parse(t))&&null!=e&&(a=e.sessionID,r=e.hitNumber),null!=(n=JSON.parse(o))&&null!=n&&(i=n.entryReferrer,s=n.entryReferrerTypeDetails,l=n.entryUrl,c=n.entryUrlQS,m=n.entryTrafficDetails)),{sessionID:a,hitNumber:r,entryReferrer:i,entryReferrerTypeDetails:s,entryUrl:l,entryUrlQS:c,entryTrafficDetails:m}}}},"ACDL - ICID (Internal Campaign ID)":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("ICID");null!=n&&(e=n)}return null!=getQueryParam("ICID")&&null!=getQueryParam("ICID")&&(e=getQueryParam("ICID").toString(),localStorage.setItem("ICID",e.toString())),null!=getQueryParam("icid")&&null!=getQueryParam("icid")&&(e=getQueryParam("icid").toString(),localStorage.setItem("ICID",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"ACDL - Site Market":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return document.querySelector("html").lang.split("-")[1]}}},"Meta - OG URL":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[property="og:url"]')&&null!=document.querySelector('meta[property="og:url"]').getAttribute("content")&&(e=document.querySelector('meta[property="og:url"]').getAttribute("content")),-1!==e.indexOf("https://")?e=e.split("https://")[1]:-1!==e.indexOf("http://")&&(e=e.split("http://")[1]),e}}},"QSP - wt.mc_id":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("wt_mc_id");null!=n&&(e=n)}return null!=getQueryParam("wt.mc_id")&&null!=getQueryParam("wt.mc_id")&&(e=getQueryParam("wt.mc_id").toString(),localStorage.setItem("wt_mc_id",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"QSP - cr_cc":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("cr_cc");null!=n&&(e=n)}return null!=getQueryParam("cr_cc")&&null!=getQueryParam("cr_cc")&&(e=getQueryParam("cr_cc").toString(),localStorage.setItem("cr_cc",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"ACDL - Entry URL":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryUrl&&(e=n.entryUrl),e}}},"ACDL - Page View Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=adobeSatelliteName.getVar("ACDL - Page ID"),n=0;return void 0!==window.adobeDataLayer&&void 0!==window.adobeDataLayer.getState("page."+e)&&void 0!==window.adobeDataLayer.getState("page."+e+".msftPageViewFlag")&&(n=window.adobeDataLayer.getState("page."+e+".msftPageViewFlag")),n}}},"ACDL - Munchkin Cookie":{modulePath:"core/src/lib/dataElements/cookie.js",settings:{name:"_mkto_trk"}},"ACDL - Entry Referrer Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryReferrerTypeDetails&&(e=n.entryReferrerTypeDetails.entryReferrerType),e}}},"ACDL - Entry Referrer Type Details":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryReferrerTypeDetails&&(e=n.entryReferrerTypeDetails),e}}},"ACDL - Country Code":{cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return document.querySelector("html")&&document.querySelector("html").lang&&(e=document.querySelector("html").lang.split("-")[1].toUpperCase()),"HANS"==e&&(e="CN"),2!=e.length&&(e="XX"),e}}},"ACDL - URL":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return-1!==document.location.href.indexOf("https://")?document.location.href.split("https://")[1]:-1!==document.location.href.indexOf("http://")?document.location.href.split("http://")[1]:document.location.href}}},"Meta - AWA CMS":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-cms"]')&&null!=document.querySelector('meta[name="awa-cms"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-cms"]').getAttribute("content")),e}}},"ACDL - Site Language":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return document.querySelector("html").lang.split("-")[0]}}},"ACDL - Server":{modulePath:"core/src/lib/dataElements/pageInfo.js",settings:{attribute:"hostname"}},"ACDL - Site Locale":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return document.querySelector("html").lang}}},"ACDL - Home Page Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=window.location.href.split("/")[4],n=window.location.href.split("/")[5];return"microsoft-365"===e&&void 0===n||"microsoft-365"===e&&""===n}}},"ACDL - Hit Number":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=1,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&(isNaN(n.hitNumber)||(e=parseInt(n.hitNumber))),e}}},"ACDL - Consents and Preferences Snapshot":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e,n,t,o,a,r,i,s,l,c,m,d,u,f=adobeSatelliteName.getVar("ACDL - Consent API Object Flag"),p="n";window.siteConsent,"undefined"!=typeof siteConsent&&void 0!==siteConsent.getConsent&&(e=siteConsent.getConsent(),"undefined"!==siteConsent.isConsentRequired&&(i=siteConsent.isConsentRequired),"undefined"!==e.Advertising&&(n=e.Advertising),"undefined"!==e.Analytics&&(t=e.Analytics),"undefined"!==e.SocialMedia&&(o=e.SocialMedia),"undefined"!==e.Personalization&&(a=e.personalization),"undefined"!==e.Required&&(r=e.Required));var g={sc_advertising:n,sc_analytics:t,sc_socialMedia:o,sc_personalization:a,sc_required:r,sc_consentApiObjectFlag:f,sc_isRequiredFlag:i};if(""!==(s=getCookie("MSCC"))&&null!=s&&null!=s){if(-1!==s.indexOf("c")){var w=s.split("-"),h={};w.forEach((e=>{let[n,t]=e.split("=");h[n]=t})),"undefined"!==h.cid&&(l=h.cid),"undefined"!==h.c1&&(c=h.c1),"undefined"!==h.c2&&(m=h.c2),"undefined"!==h.c3&&(d=h.c3)}-1!==s.indexOf("NR")&&(p="y")}var y,v,b,I,S,_,C,T,D,k,x,P,A={CID:l,C1:c,C2:m,C3:d,C4:u,NR:p},O=(new Date).toISOString(),E="dn",N="dy",L="defaulted_no_GPC_DataSharingOptIn",R="dn",U=adobeSatelliteName.getVar("ACDL - Consent Banner Visibility Flag"),V="dn",j=O,q="defaulted_no_consent_banner_available",M="dn",F=O,B="defaulted_no_consent_banner_available",z="dn",H=O,$="defaulted_no_consent_banner_available",W="dn",G=O,Q="defaulted_no_GPC_DataSharingOptIn";return 0==g.sc_consentApiObjectFlag&&(q="defaulted_missing_siteConsent",B="defaulted_missing_siteConsent",$="defaulted_missing_siteConsent"),"undefined"!=g&&null!=g&&(C=g.sc_analytics,D=g.sc_socialMedia,S=g.sc_advertising,x=g.sc_personalization,I=g.sc_isRequiredFlag),A&&(A.C1&&(T=A.C1),A.C2&&(k=A.C2),A.C3&&(_=A.C3),A.C4&&(P=A.C4)),void 0!==GPC_DataSharingOptIn&&(1==GPC_DataSharingOptIn&&(E="y"),0==GPC_DataSharingOptIn&&(E="n")),void 0!==getCookie("3PAdsOptOut")&&(""!==(v=getCookie("3PAdsOptOut"))?0==v||"0"==v?N="y":1!=v&&"1"!=v||(N="n"):""==v&&(v=void 0)),void 0!==GPC_DataSharingOptIn&&(L="GPC_DataSharingOptIn",R=E),null==GPC_DataSharingOptIn&&null!==v&&""!==v&&(L="3PAdsOptOut",R=N),_&&("1"==_?(V="n",q="consent_banner_mscc"):"2"==_&&(V="y",q="consent_banner_mscc")),void 0!==S&&(0==S?(V="n",q="consent_banner_wcp"):1==S&&(V="y",q="consent_banner_wcp")),T&&("1"==T?(M="n",B="consent_banner_mscc"):"2"==T&&(M="y",B="consent_banner_mscc")),void 0!==C&&(0==C?(M="n",B="consent_banner_wcp"):1==C&&(M="y",B="consent_banner_wcp")),k&&("1"==k?(z="n",$="consent_banner_mscc"):"2"==k&&(z="y",$="consent_banner_mscc")),void 0!==D&&(0==D?(z="n",$="consent_banner_wcp"):1==D&&(z="y",$="consent_banner_wcp")),"y"==E&&(W="y",Q="GPC_DataSharingOptIn"),"n"==E&&(W="n",Q="GPC_DataSharingOptIn"),P&&("1"==P?(W="n",Q="consent_banner_mscc"):"2"==P&&(W="y",Q="consent_banner_mscc")),void 0!==x&&(0==x?(W="n",Q="consent_banner_wcp"):1==x&&(W="y",Q="consent_banner_wcp")),b&&"NR"==b&&(M="y",B="consent_banner_mscc",z="y",$="consent_banner_mscc",V="y",q="consent_banner_mscc"),g.sc_isRequiredFlag&&0==I&&(M="y",B="consent_banner_wcp",z="y",$="consent_banner_wcp",V="y",q="consent_banner_wcp"),g&&g.sc_isRequiredFlag&&1==g.sc_isRequiredFlag&&("n"!=E&&"dn"!=E||"y"!=N&&"dy"!=N||(R="dn",L="GPC_DataSharingOptIn"),1==U&&("dn"!=M&&"dn"!=z&&"dn"!=V||("n"!=E&&"dn"!=E||"n"!=N&&"dy"!=N)&&("n"!=E||"y"!=N&&"dy"!=N)&&("y"!=E||"n"!=N)?(q="defaulted_consent_banner_incomplete",B="defaulted_consent_banner_incomplete",$="defaulted_consent_banner_incomplete",Q="defaulted_consent_banner_incomplete",L="defaulted_consent_banner_incomplete"):(q="defaulted_consent_banner_incomplete_and_"+L,B="defaulted_consent_banner_incomplete_and_"+L,$="defaulted_consent_banner_incomplete_and_"+L,Q="defaulted_consent_banner_incomplete_and_"+L,L="defaulted_consent_banner_incomplete_and_"+L)),"n"!=M&&"dn"!=M&&"n"!=z&&"dn"!=z&&"n"!=V&&"dn"!=V&&"n"!=E&&"dn"!=E&&"n"!=N||("n"!=M&&"n"!=z&&"n"!=V&&"dn"!=M&&"dn"!=z&&"dn"!=V||"y"!=E||"y"!=N||0!=U||("y"==M&&(B="defaulted_mixed_banner_wcp"),"y"==z&&($="defaulted_mixed_banner_wcp"),"y"==V&&(q="defaulted_mixed_banner_wcp"),"y"==W&&(Q="defaulted_mixed_banner_wcp"),"y"==R&&(L="defaulted_mixed_banner_wcp")),"n"!=M&&"n"!=z&&"n"!=V&&"dn"!=M&&"dn"!=z&&"dn"!=V||("n"!=E&&"dn"!=E||"n"!=N&&"dy"!=N)&&("n"!=E||"y"!=N&&"dy"!=N)&&("y"!=E||"n"!=N)||0!=U||("y"==M&&(B="defaulted_mixed_banner_wcp_and_"+L),"y"==z&&($="defaulted_mixed_banner_wcp_and_"+L),"y"==V&&(q="defaulted_mixed_banner_wcp_and_"+L),"y"==W&&(Q="defaulted_mixed_banner_wcp_and_"+L),"y"==R&&(L="defaulted_mixed_banner_wcp_and_"+L)),"y"!=M||"y"!=z||"y"!=V||("n"!=E&&"dn"!=E||"n"!=N&&"dy"!=N)&&("n"!=E&&"dn"!=E||"y"!=N)||(B="defaulted_"+L,$="defaulted_"+L,q="defaulted_"+L,Q="defaulted_"+L),"y"==M&&(M="dn"),"y"==z&&(z="dn"),"y"==V&&(V="dn"),"y"==W&&(W="dn"),"y"==R&&(R="dn"))),{consents:{bannerConsents:{mscc_cid:A.CID,mscc_nr:A.NR,sc_consentApiObjectFlag:g.sc_consentApiObjectFlag,sc_isRequiredFlag:g.sc_isRequiredFlag,advertising:{mscc_c3:_,sc_advertising:g.sc_advertising,val:V,time:j,source:q},analytics:{mscc_c1:T,sc_analytics:g.sc_analytics,val:M,time:F,source:B},socialMedia:{mscc_c2:k,sc_socialMedia:g.sc_socialMedia,val:z,time:H,source:$}},regulatoryComplianceType:y,collect:{val:"y"},share:{GPC_DataSharingOptIn:String(GPC_DataSharingOptIn),"3pAdsOptOut":v,val:R,time:O,source:L},personalize:{content:{mscc_c4:P,sc_personalization:g.sc_personalization,val:W,time:G,source:Q}},marketing:{},metadata:{time:O}}}}}},"ACDL - Identity Map":{modulePath:"adobe-alloy/dist/lib/dataElements/identityMap/index.js",settings:{ANON:[{id:"%ACDL - ANON Cookie%",primary:!1,authenticatedState:"ambiguous"}],FPID:[{id:"%ACDL - MC1 GUID%",primary:!0,authenticatedState:"ambiguous"}],munchkinId:[{id:"%ACDL - Munchkin Cookie%",primary:!1,authenticatedState:"ambiguous"}]}},"ACDL - URL Without QS":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=-1!==document.location.href.indexOf("https://")?document.location.href.split("https://")[1]:-1!==document.location.href.indexOf("http://")?document.location.href.split("http://")[1]:document.location.href;return-1!==e.indexOf("?")?e.split("?")[0]:e}}},"ACDL - User Agent":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return navigator.userAgent}}},"ACDL - OCID":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;if(localStorage){var n=localStorage.getItem("OCID");null!=n&&(e=n)}return null!=getQueryParam("OCID")&&null!=getQueryParam("OCID")&&(e=getQueryParam("OCID").toString(),localStorage.setItem("OCID",e.toString())),null!=getQueryParam("ocid")&&null!=getQueryParam("ocid")&&(e=getQueryParam("ocid").toString(),localStorage.setItem("OCID",e.toString())),null!=e&&""!=e||(e=void 0),e}}},"ACDL - Page Group":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){function e(e){let n="Unknown pageGroup"
;return/^windows\.microsoft\.com/.test(e)?n="windows online":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)windows($|\/)/.test(e)?n="/windows":/^support(|2)\.microsoft\.com/.test(e)?n="smc":/^account\.live\.com/.test(e)||/^account\.microsoft\.com/.test(e)?n="mee portal":/^signup\.live\.com/.test(e)?n="microsoft account signup":/buyoffice\.microsoft\.com/.test(e)?n="buy office":/office\.microsoft\.com/.test(e)?n="office.com":/^support\.office\.com\/client/.test(e)?n="office support":/^portal\.partner\.microsoftonline\.cn/.test(e)?n="office.com":/^blogs\.office\.com/.test(e)?n="office blog":/^products\.office\.com\//.test(e)?n="products office":/\.office(|ppe)\.com/.test(e)||/^apps\.skypeforbusiness\.com/.test(e)?n="office.com":/^windowsphone\.com\/s/.test(e)?n="windows phone app download":/\.windowsphone\.com/.test(e)?n="windows phone":/\.xbox\.com/.test(e)?n="xbox":/^app\.skype\.com/.test(e)?n="skype":/^(login\.skype\.com|secure\.skype\.com\/account\/personal\/change-password)/.test(e)?n="skype authentication":/^secure\.skype\.com\/wallet\/checkout/.test(e)?n="skype checkout":/^secure\.skype\.com\/wallet\/account/.test(e)?n="skype billing payment":/www\.skype\.com/.test(e)?n="skype www":/^(campaigns|thortdw|xbox)\.skype\.com/.test(e)?n="skype campaigns":/^blogs\.skype\.com/.test(e)?n="skype blogs":/^community\.skype\.com/.test(e)?n="skype community":/^developer\.skype\.com/.test(e)?n="skype developer":/(recovery|support)\.skype\.com/.test(e)?n="skype support":/web\.skype\.com/.test(e)?n="skype web client":/\.skype\.com/.test(e)?n="skype other":/\.skypeforbusiness\.com/.test(e)?n="skype for business other":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)skype/.test(e)||/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)skype/.test(e)?n="skype":/^minecraft\.net/.test(e)||/minecraft\.net/.test(e)?n="minecraft":/^www\.microsoft\.com\/download(s|)/.test(e)||/^www\.microsoft\.com\/(..-..|..-....-..|...-..|..-..-........|...-....-..)\/download/.test(e)?n="download center":/^www\.microsoft\.com\/(..-..|..|..-....|..-....-..)\/(mobile|celulares|di-dong|laitteet|mobiel|mobil|mobily|moveis|movil|moviles|telefoni)/.test(e)||/^(|www\.)trylumiaphone\.com/.test(e)||/^lumiaconversations\.microsoft\.com/.test(e)||/^expertcentre\.nokia\.com/.test(e)||/^businessmobilitycenter\.microsoft\.com/.test(e)||/^www\.microsoftdatagathering\.net/.test(e)||/r\.webapps\.microsoft\.com/.test(e)||/lumiaconversationsuk\.microsoft\.com/.test(e)||/photobeamer\.com/.test(e)?n="mobile":/^blogs\.msdn\.(|microsoft\.)com/.test(e)?n="msdn blogs":/msdn\.microsoft\.com/.test(e)?n="msdn":/^channel9\.msdn\.com/.test(e)?n="channel9":/^blogs\.technet\.(|microsoft\.)com/.test(e)?n="technet blogs":/^social\.technet\.microsoft\.com/.test(e)?n="technet social":/technet\.microsoft\.com/.test(e)?n="technet":/^answers\.microsoft\.com/.test(e)?n="support answers":/onedrive\.live\.com/.test(e)?n="onedrive FRE":/^www\.microsoft\.com\/([a-z][a-z]-[a-z][a-z]|[a-z][a-za-z][a-z][a-z][a-z]|[a-z]a-z[a-z][a-z][a-z]a-z[a-z][a-z])\/$/.test(e)||/^www\.microsoft\.com\/(..(-|\/)..|..(-|\/)....|..(-|\/)....(-|\/)..)\/default\.aspx$/.test(e)||/^www\.microsoft\.com\/[a-z]a-z[a-z][a-z][a-z][a-z]\/default\.aspx$/.test(e)||/^www\.microsoft\.com\/[a-z][a-z]-[a-z][a-z]\/(home|homepage|preview)\/(default\.aspx|)$/.test(e)||/^www\.microsoft\.com\/$/.test(e)||/^www\.microsoft\.com\/en-us\/discover\/home\//.test(e)?n="mscom home page":/\.yammer\.com/.test(e)?n="yammer":/^www\.microsoft\.com\/(|[a-z][a-z]-[a-z][a-z]|[a-z]a-z[a-z][a-z][a-z]a-z)\/software-download/.test(e)?n="software download":/^search\.microsoft\.com/.test(e)||/^www\.microsoft\.com\/(|..-..|..-....|..-....-..)\/(|new)search/.test(e)?n="microsoft.com search":/^hs\.windows\.microsoft\.com\//.test(e)?n="windows help hub":/\.windowsazure\.com/.test(e)||/azure(|info)\.microsoft\.com/.test(e)||/^(account|support|www)\.windowsazure\.cn/.test(e)||/^(tryappservice|azureinfo|azuregov|easycreate)\.azure\.com/.test(e)?n="azure":/^blog\.surface\.com/.test(e)?n="surface blog":/^www\.microsoft\.com\/surface\/..-..\/support/.test(e)?n="surface support":/^www\.microsoft\.com\/(|(..-..|..-....|..-....-..)\/)surface\//.test(e)||/^www\.microsoft\.com\/(|(..-..|..-....|..-....-..)\/)microsoft-surface-hub($|\/)/.test(e)||/^www\.surfacestudent\.com/.test(e)?n="surface":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)visual(-|)studio\//.test(e)?n="visual studio":/^www\.visualstudio\.com\/.*\/get-started/.test(e)?n="visual studio get started":/\.visualstudio\.com/.test(e)?n="visual studio":/^(www\.|)microsoft\.com\/..-..\/microsoftedgewelcome/.test(e)||/^microsoftedgewelcome\.microsoft\.com\//.test(e)?n="edge welcome experience":/^(www\.|)microsoft\.com\/..-..\/(welcomeie11|ie-firstrun\/[a-z0-9-]\/ie-11)/.test(e)?n="ie11 welcome experience":/^blogs\.onedrive\.com/.test(e)?n="one drive blog":/\.msdn\.com/.test(e)?n="msdn":/\.technet\.com/.test(e)?n="technet":/msdnevents\.com/.test(e)?n="msdn events":/\.technetevents\.com/.test(e)?n="technet events":/services\.premier\.microsoft\.com/.test(e)?n="premier proactive services":/^smallbusiness\.support\.microsoft\.com/.test(e)?n="support small business":/^partnersupport\.microsoft\.com/.test(e)?n="support partner":/^www\.answerdesk\.com/.test(e)||/^www\.awasa\.microsoft\.com/.test(e)||/^answerdesk\.microsoft\.com/.test(e)||/^answerdesk\.support\.microsoft\.com/.test(e)?n="support answerdesk and awasa":/^store\.microsoft\.com/.test(e)||/microsoftstore\./.test(e)?n="microsoft store":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)(ms|)account\//.test(e)||/^www\.microsoft\.com\/(..-..|..-....|..-....-..)\/(account\/|account$)/.test(e)?n="microsoft account":/^msevents\.microsoft\.com/.test(e)?n="worldwide events cui":/^careers\.microsoft\.com/.test(e)?n="careers":/^onlinehelp\.microsoft\.com/.test(e)?n="onlinehelp":/^(ms|)partner\.microsoft\.com/.test(e)?n="partner mpn":/^brandtools\.(partners\.extranet\.|)microsoft\.com/.test(e)?n="brand":/digitalwpc\.com/.test(e)?n="partner digital wpc":/^www\.partnermarketingcenter\.com/.test(e)?n="partner":/^(www|hosters)\.microsoftplatformready\.com/.test(e)?n="partner platform ready":/^mspartnerlp\.mspartner\.microsoft\.com/.test(e)?n="partner learning path":/^www\.microsoftcloudpartner\.com/.test(e)?n="partner":/^readytogo\.microsoft\.com/.test(e)?n="partner ready to go":/^www\.partnerlogobuilder\.com/.test(e)||/^logobuilder\.mspartner\.microsoft\.com/.test(e)?n="partner logo builder":/^www\.demoshowcasesuite\.com/.test(e)?n="partner demo showcase":/^training\.partner\.microsoft\.com/.test(e)?n="partner training":/^partners\.microsoft\.com/.test(e)?n="partner membership center":/^www\.microsoft\.com\/msppdd/.test(e)?n="partner digital distribution":/^blogs\.partner\.microsoft\.com\//.test(e)?n="partner-blogs":/\.asp\.net/.test(e)?n="asp-net":/pinpoint\.microsoft\.com/.test(e)?n="pinpoint":/^profile\.microsoft\.com/.test(e)?n="regsys profile center":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)kinectforwindowsdev\//.test(e)||/^dev\.windows\.com\/([a-z-]*|en-us)\/kinect/.test(e)?n="kinect for windows dev":/^research\.microsoft\.com/.test(e)||/^www\.microsoft\.com\/..-..\/research/.test(e)?n="research":/help\.outlook\.com/.test(e)?n="outlook help":/^social\.microsoft\.com/.test(e)?n="social":/\.ageofempires\.com/.test(e)?n="age of empires":/^blogs\.windows\.com/.test(e)?n="windows team blog":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)((err|error|errorpages)\/|smarterror\.aspx)/.test(e)?n="error":/^www\.microsoft\.com\/(..-..|..-....|..-....-..|[a-z]*)\/office365\//.test(e)?n="mscom office365":/^www\.microsoft\.com\/(..-..|..-....|..-....-..|[a-z]*|germany|cze|france|visualstudio|china|korea|romania|slovakia|taiwan|brasil|sverige|italy|apanish|err|resources|spain|middleeast)\/msdn\//.test(e)?n="msdn":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)technet\//.test(e)?n="technet":/^www\.microsoft\.com\/[a-z-]*\/server-cloud/.test(e)||/mms\.microsoft\.com\/(workspace|[a-z-]*\/cloud-platform(\/.*|$))/.test(e)||/^www\.itpro(careercenter|cloudessentials)\.com/.test(e)?n="server cloud":/^www\.microsoft\.com\/(..-..|..-....|..-....-..)\/windows\/windowsintune\//.test(e)?n="windows intune":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)government\//.test(e)?n="government":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)oem\//.test(e)?n="oem":/^myoem\.microsoft\.com/.test(e)?n="myoem":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)office\//.test(e)?n="mscom office":/^www\.microsoft\.com\/about\/twc\//.test(e)?n="trustworthy computing":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)about\//.test(e)?n="about":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)athome\//.test(e)?n="at home":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)atwork\//.test(e)?n="at work":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)atlife\//.test(e)?n="at life":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)legal\//.test(e)?n="legal":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)howtotell\//.test(e)?n="how to tell":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)biztalk\//.test(e)?n="biztalk":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)pixelsense\//.test(e)?n="pixelsense":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)(business|small-business|smallbusiness|midsizebusiness|smb|mediumbusiness|smallbiz|pme|kmu)\//.test(e)||/microsoftbusinesshub/.test(e)||/^business\.microsoft\.com/.test(e)?n="small business":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)bi\//.test(e)?n="bi":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)cloud\//.test(e)?n="cloud":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)communities\//.test(e)?n="community":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)itshowcase\//.test(e)?n="mscom it showcase":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)(news|presspass)\//.test(e)||/^news\.microsoft\.com\//.test(e)?n="news center":/^(www|privacy)\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)privacystatement/.test(e)?n="privacy statement":/^www\.microsoft\.com\/(..-..|..-....|..-....-..)\/servicesagreement/.test(e)?n="consumer services agreement":/^www\.microsoft\.com\/(..-..|..-....|..-....-..)\/msedgeretail/.test(e)?n="edge retail experience":/^www\.microsoft\.com\/(investor|..-..\/investor)\//.test(e)?n="corporate":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)careers\//.test(e)?n="careers":/^crm\.dynamics\.com/.test(e)?n="dynamics-crm":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)dynamics\//.test(e)||/^www\.microsoft\.com\/..\/envision/.test(e)?n="dynamics":/^www\.microsoft\.com\/(..-..\/|)enterprise\//.test(e)||/enterprise\.microsoft\.com\//.test(e)?n="enterprise":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)exchange\//.test(e)?n="exchange":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)expression\//.test(e)?n="expression":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)hardware\//.test(e)||/^www\.microsoft\.com\/(hardware|accessories)/.test(e)?n="hardware":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)healthvault\//.test(e)?n="health vault":/^www\.microsoft\.com\/(health|..-..\/health)\//.test(e)?n="health":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)learning\//.test(e)?n="learning":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)licensing\//.test(e)||/mla\.microsoft\.com/.test(e)||/^www\.microsoft\.com\/(..-..\/|)licensing\/.*/.test(e)||/^www\.microsoftvolumelicensing\.com/.test(e)||/^www\.microsoft\.com\/(belux\/fr\/licences|belux\/nl\/licenties|da-dk\/licens|de-at\/lizenz|es-xl\/licenciamiento|finland\/lisensointi|france\/licences|it-it\/licenze|nl-nl\/licenties|pl-pl\/licencje|pt-br\/licenciamento|romania\/licentiere|slovakia\/licencie|sv-se\/licens|turkiye\/lisanslama|mexico\/licensing)\//.test(e)||/^www\.microsoft\.com\/(israel|taiwan|slovenia|global|india|thailand|vietnam|canada|ukraine|argentina|middleeast|services|australia|austria|business|china|italy|belux|cze|malaysia|japan|rus)\/licensing/.test(e)||/^www\.microsoft\.com\/service\.\.er\/licensing/.test(e)?n="licensing":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)mac(\/|$)/.test(e)?n="office mac":/^www\.microsoft\.com\/([a-z-]*\/|)bizspark/.test(e)?n="bizspark":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)microsoftservices\//.test(e)?n="microsoft services":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)net(\/|$)/.test(e)?n="net":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)security\/sir\//.test(e)?n="security-sir":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)security\/sdl\//.test(e)?n="security-sdl":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)security\/msrc\//.test(e)?n="security-msrc":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)security\//.test(e)?n="security":/^www\.microsoft\.com\/servers\//.test(e)?n="server":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)showcase\//.test(e)?n="showcase":/^www\.microsoft\.com\/([a-z-]*\/|)silverlight(\/|.*)/.test(e)||/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)silverlight\//.test(e)?n="silverlight":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)sitemap/.test(e)?n="sitemap":/^www\.microsoft\.com\/(|(..-..|..-....|..-....-..)\/|slovakia\/)sqlserver/.test(e)?n="sql server":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)(student(s|i|)|etudiants)/.test(e)?n="student":/expression\.microsoft\.com/.test(e)?n="webdev":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)web/.test(e)?n="web":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)diversity/.test(e)||/^www\.microsoft\.com\/([a-z-]*|..-..)\/(|mscorp\/)diversity/.test(e)?n="diversity":/^www\.microsoft\.com.*\/internet-explorer/.test(e)?n="ie":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)windowsembedded/.test(e)?n="windows embedded":/^www\.microsoft\.com\/publicsector/.test(e)?n="public sector":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)windows-live/.test(e)?n="/windows live":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)windowsphone/.test(e)?n="windows phone":/^m\.microsoft\.com\/office365/.test(e)?n="mobile mscom office365":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)outlook-com/.test(e)||/^www\.microsoft\.com\/((..-..)\/|)outlook-com/.test(e)?n="outlook-com":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)piracy/.test(e)?n="piracy":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|[a-z]*\/|..-..\/|)education/.test(e)||/^education\.microsoft\.com/.test(e)?n="education":/^sharepoint\.microsoft\.com/.test(e)?n="sharepoint":/^lync\.microsoft\.com/.test(e)?n="lync":/^[a-z0-9]*\/.*/.test(e)||/^microsoft\.sharepoint\.com/.test(e)?n="microsoft intranet sites":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)careers/.test(e)?n="corporate":/^www\.microsoft\.com\/playready/.test(e)?n="mscom playready":/curah\.microsoft\.com/.test(e)?n="curah":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)enable/.test(e)?n="enable":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)genuine/.test(e)?n="genuine":/^commerce\.microsoft\.com/.test(e)?n="gifting":/^portal\.microsoftonline\.com/.test(e)?n="office365 portal":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)explore/.test(e)?n="explore":/^www\.microsoft\.com\/microsoft-band/.test(e)||/^blog\.microsofthealth\.com/.test(e)?n="band":/^www\.microsoft\.com\/microsoft-hololens/.test(e)||/^(comm\.|)holotechinfo\.com/.test(e)?n="hololens":/^www\.microsoft\.com\/microsoft-health/.test(e)?n="health":/^www\.microsoft\.com\/((..-..|..-....|..-....-..)\/|)directx/.test(e)?n="direct x":/^www\.layerscape\.org/.test(e)?n="layerscape":/^www\.microsoft\.com\/typography/.test(e)?n="typography":/^www\.microsoft\.com\/systemcenter/.test(e)?n="system center":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)(ms|)techdays/.test(e)||/^(m|)techdays\.microsoft\./.test(e)?n="techdays":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)twc/.test(e)?n="trustworthy computing":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)powerbi/.test(e)||/app\.powerbi/.test(e)?n="powerbi":/^((support|www|community)\.)?powerbi\.com/.test(e)||/^powerbi\.(uservoice|microsoft)\.com/.test(e)?n="powerbi preview":/solutions\.powerbi\.com/.test(e)?n="powerbi solutions":/^businessstore\.microsoft\.com\/(..-..)\/store/.test(e)||/^www\.microsoft\.com\/(webblend|uniblends)/.test(e)||/^www\.microsoft\.com\/..-..\/store\/(?!locations.*)/.test(e)?n="universal store":/^www\.codeforhonor\.com/.test(e)?n="code for honor":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)messenger/.test(e)?n="messenger":/^www\.microsoft\.com\/china\/pinyin/.test(e)?n="pinyin":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)casestudies/.test(e)?n="case studies":/^www\.microsoft\.com\/netherlands\/msnederland\//.test(e)?n="ms nederland":/^www\.microsoft\.com\/africa\/(youth|)4afrika\//.test(e)?n="4afrika":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)imaginecup\//.test(e)||/imaginecup\.com/.test(e)?n="imagine cup":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)yammer\//.test(e)?n="mscom yammer":/^www\.dreamspark\.com\//.test(e)?n="dreamspark":/^www\.microsoft\.com\/en-us\/evalcenter\//.test(e)?n="technet evalcenter":/\.nokia\.com/.test(e)?n="nokia":/^www\.microsoft\.com\/(|..-..\/)translator\//.test(e)?n="translator":/^www\.testdrive\.visio\.com\//.test(e)?n="testdrive visio":/^www\.whymicrosoft\.com\//.test(e)?n="why microsoft":/^www\.microsoftedvantage\.com/.test(e)?n="ed-vantage":/^[a-z0-9\-\.]*wpqs\.sfone\.net/.test(e)?n="oflab":/^blogs\.bing\.com/.test(e)?n="bing blog":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)maps\//.test(e)?n="bing maps for enterprise":/^controls\.cp\.microsoft\.com/.test(e)?n="gifting":/^blogs\.microsoft\.com/.test(e)?n="microsoft blog":/^[a-z0-9\-\.]*\.smdisp\.net/.test(e)||/^[a-z0-9\-\.]*\.wmlalicensing\.com/.test(e)?n="wmla licensing":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)winhec\//.test(e)||/^www\.winhec\.net/.test(e)?n="winhec":/^ignite\.microsoft\.com/.test(e)||/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)ignite2015\//.test(e)?n="ignite":/^community\.dynamics\.com/.test(e)?n="dynamics community":/^[a-z0-9\-\.]*microsoftgotomarket\.com/.test(e)?n="go to market":/^portal\.office\.com/.test(e)?n="365 portal":/^support\.content\.office\.net/.test(e)?n="office.com ios support":/^support\.office\.live\.com/.test(e)?n="office.com support":/^store\.office\.live\.com/.test(e)?n="office.com templates":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)outlook-com\//.test(e)?n="mscom outlook-com":/^syndication\.microsoft\.com/.test(e)?n="partner syndicated content":/^3rdpartycode\.microsoft\.com/.test(e)||/^opensource\.microsoft\.com/.test(e)?n="open source microsoft":/microsoft-college\.jp/.test(e)?n="college recruiting":/^www\.digitalipercrescere\.it/.test(e)?n="digitali per crescere":/^www\.microsoft\.com\/france\/ecorner/.test(e)?n="ecorner":/^www\.lanuvolarosa\.it/.test(e)?n="la nuvola rosa":/^blogs\.microsoft\.fr/.test(e)?n="microsoft france blog":/^blogs\.microsoft\.nl/.test(e)?n="microsoft netherlands blog":/^www\.pensandogrande\.com\.br/.test(e)?n="pensando grande":/^www\.studentenleben\.de/.test(e)?n="tech students":/^social\.answers\.microsoft\.com/.test(e)?n="microsoft answers community":/^build\.windowsstore\.com/.test(e)?n="build windows store":/^www\.maac\.ms/.test(e)?n="maac":/^(dev\.windows\.com|developer\.microsoft\.com|sysdev\.microsoft\.com)/.test(e)?n="windows dev center":/microsoft\.eventcore\.com\/winhecportal/.test(e)?n="developer":/^appstudio\.windows\.com/.test(e)?n="windows app studio":/^insider\.windows\.com/.test(e)?n="windows insider":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)kinectforwindows\//.test(e)||/^www\.microsoft\.com\/global\/..-..\/kinectforwindows\//.test(e)?n="kinect for windows":/^rto\.microsoft\.com/.test(e)?n="real time optimization":/^www\.microsoftvirtualacademy\.com/.test(e)||/^mva\.microsoft\.com/.test(e)?n="microsoft virtual academy":/partner\.support\.services\.microsoft\.com\/..-..\/contact\/chat\//.test(e)?n="chat support":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)tablet\//.test(e)?n="tablet":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)software-recovery/.test(e)?n="software recovery":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)phone\//.test(e)?n="mobile":/^www\.onenote\.com/.test(e)?n="onenote":/^winpreview\.catalysis\.com/.test(e)?n="catalysis winpreview":/^home\.diagnostics\.support\.microsoft\.com\//.test(e)?n="support diagnostics":/^www\.microsoft\.com\/..-..\/windowsforbusiness/.test(e)?n="windows business":/^www\.microsoftevents\.com/.test(e)?n="microsoft events":/^crmtestdrive\.dynamics\.com/.test(e)?n="crm testdrive":/^www\.microsoftfinancing\.com/.test(e)?n="microsoft financing":/discoverhub\.com/.test(e)?n="discover hub":/aer\.microsoft\.com/.test(e)||/www\.mepn\.com/.test(e)||/^mepn\.com/.test(e)?n="authorized education reseller":/\.azureml\.net/.test(e)?n="azureml":/^futuredecoded\.microsoft\.com/.test(e)?n="future decoded":/^www\.microsoft\.com\/((..\/..|..-..)\/worldwide|worldwide)/.test(e)||/^www\.microsoft\.com\/(..-....|..-....-..|..-..)\/contact(?!us.*)/.test(e)?n="microsoft office locations":/^www\.featureddevices\.com/.test(e)?n="featured devices":/\.microsoft\.com\/devices\//.test(e)?n="devices":/^www\.microsoft\.com\/(..-..|..-....|..-....-..)\/accessibility\//.test(e)?n="accessibility":/^www\.documentdb\.com/.test(e)?n="document db":/^www\.microsoft\.com\/..-..\/cloudandhosting/.test(e)?n="cloud and hosting":/^opensourcehub\.microsoft\.com\//.test(e)?n="open source hub":/cloudapp\.net/.test(e)?n="azure cloud app":/info\.microsoft\.com\//.test(e)?n="azure info":/^www\.microsoft\.com\/(..|..-..)\/digitalliteracy/.test(e)?n="digital literacy":/^www\.cloudfortomorrow\.com/.test(e)?n="cloud for tomorrow":/azurewebsites\.net/.test(e)?n="azure-hosted-websites":/testdrive\.visio\.com/.test(e)?n="testdrive-visio":/trainingsupport\.microsoft\.com/.test(e)?n="training-support-mscom":/partnercenter\.microsoft\.com/.test(e)?n="partner-center":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)procurement/.test(e)?n="procurement":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)moderator/.test(e)?n="mscom-moderator":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)photodna/.test(e)?n="mscom-photodna":/^www\.microsoft\.com\/((..-..|..-....|..-....-..|[a-z]*)\/|)openness/.test(e)||/^openness\.microsoft\.com\/blog\//.test(e)?n="mscom-openness":/iis\.net/.test(e)?n="iis.net":/military\.microsoft\.com/.test(e)?n="military-affairs":/^ax\.help\.dynamics\.com/.test(e)?n="dynamics-axhelp":/^mvp\.microsoft\.com/.test(e)?n="mvp":/^www\.microsoft\.com\/(..-..|ja-jp\/mscorp|australia)\/legal\//.test(e)?n="legal":/^sfb\.trafficmanager\.net/.test(e)?n="sfb-quick-tips":/^www\.microsoft\.com\/..-..\/evalcenter evalcenter-nemo/.test(e)||/^www\.microsoft\.com\/..-..\/evalcenter/.test(e)?n="evalcenter-nemo":/^(www\.|)microsoftcloudroadshow\.com/.test(e)||/^www\.microsoftcloudroadshow\.com\//.test(e)?n="microsoft-cloud-roadshow":/choosetocode\.com/.test(e)?n="choose-to-code":/^(itacademy|member\.itacademy|onlinelearning|training)\.microsoft\.com/.test(e)||/imagineacademy\.microsoft\.com/.test(e)?n="lex":/^partneruniversity\.microsoft\.com/.test(e)?n="partner university":/^o365pp-mlxprod\.microsoft\.com/.test(e)?n="o365 mlx":/^www\.conoceoffice\.com/.test(e)?n="conoce office":/^fasttrack\.(office|microsoft)\.com/.test(e)||/^success\.office\.com/.test(e)?n="office success":/^learninghub\.microsoft\.com/.test(e)?n="learninghub":/^www\.microsoft\.com\/..-..\/switch\/mac-surface\//.test(e)?n="switch mac surface":/^www\.microsoft\.com\/..-..\/trustcenter/.test(e)?n="trust center":/info\.microsoft\.com/.test(e)?n="marketo":/^www\.microsoft\.com\/(..-..|..-....)\/gift-cards/.test(e)?n="gift cards":/^microsoft\.eventcore\.com/.test(e)?n="mscom eventcore":/^gallery\.cortanaanalytics\.com/.test(e)?n="gallery cortana analytics":/^www\.microsoft\.com\/..-..\/design/.test(e)?n="mscom design":/^www\.microsoft\.com\/..-..\/ard/.test(e)?n="ard":/^www\.microsoft\.com\/..-..\/garage\//.test(e)?n="garage":/microsoft\.com\/government\/..-..\/public-services\/city-next\/pages/.test(e)||/microsoft\.com\/..-..\/citynext\//.test(e)?n="city next":/^www\.microsoft\.com\/..-..\/groove/.test(e)?n="groove":/^sc\.imp\.live\.com/.test(e)?n="sc-imp-live":/(|\.|)groupme(|-b)\.com/.test(e)?n="groupme":/digitalrivercontent\.net/.test(e)?n="microsoft store":/^www\.windowsforiotdevices\.com\//.test(e)?n="windowsforiot-devices":/^taco\.visualstudio\.com\//.test(e)?n="taco visualstudio":/^www\.partnerconnectlatam\.com/.test(e)?n="partner connect latam":/researchnews\.com/.test(e)?n="research news":/^blogs\.business\.microsoft\.com/.test(e)?n="blogs business mscom":/^www\.bingiton\.com/.test(e)||/^bingiton\.cloudapp\.net/.test(e)?n="bing it on":/www\.start\.cortanaanalytics\.com/.test(e)?n="start-cortanaanalytics":/^mbs\.microsoft\.com\/partnersource\//.test(e)?n="partnersource":/listening-trial\.microsoft\.com\/trial-bridge/.test(e)?n="listening-trial":/^mbs\.microsoft\.com\/customersource\//.test(e)?n="customersource":/www\.gmx\.com/.test(e)?n="gmx":/^crmroadmap\.dynamics\.com\//.test(e)?n="crmroadmap":/gallery\.cortanaintelligence\.com/.test(e)?n="ci-gallery":/securitycenter\.windows\.com/.test(e)?n="seville-windows":/^smartpartnermarketing\.microsoft\.com/.test(e)?n="smartpartner-marketing":/^docs\.microsoft\.com\//.test(e)?n="docs-microsoft":/www\.microsoft\.com\/...?-..\/business-store/.test(e)?n="windows-business-store":/^ad\.atdmt\.com/.test(e)?n="atlas campaign":/^googlesyndication\.com/.test(e)?n="google syndication":/^sway\.com/.test(e)?n="sway":/^login\.live\.com/.test(e)?n="mee portal":/^login\.microsoftonline\.com/.test(e)?n="commercial login":/^www\.msn\.com/.test(e)?n="msn":/^zone\.msn\.com/.test(e)?n="msn games":/^corp\.sts\.microsoft\.com\/adfs/.test(e)?n="msit authentication":/^vkbexternal\.partners\.extranet\.microsoft\.com\/vkbweb\//.test(e)?n="support sisual kb":/^www\.microsoft\.com\/..-..\/iegallery/.test(e)?n="ie gallery":/^microsoftedgetips\.microsoft\.com/.test(e)?n="edge tips":/^serviceshub\.microsoft\.com/.test(e)?n="services hub":/\/microsoft-365/.test(e)&&(n="M365"),n}e(window.location.href)}}},"ACDL - Entry Referrer":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.entryReferrer&&(e=n.entryReferrer),e}}},"Meta - AWA Is Tented Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-isTented"]')&&null!=document.querySelector('meta[name="awa-isTented"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-isTented"]').getAttribute("content")),e}}},"XDM - All Clicks":{modulePath:"adobe-alloy/dist/lib/dataElements/xdmObject/index.js",settings:{data:{web:{_mscom:{webSession:{entryUrl:"%dl_entryUrl%",sessionID:"%dl_sessionID%",entryReferrer:"%dl_entryReferrer%"}},webInteraction:{URL:"%dl_destinationUrl%",name:"%dl_elementLinkName%",type:"%dl_elementLinkType%",_mscom:{hitNumber:"%dl_hitNumber%",elementInfo:{nodeType:"%dl_nodeType%",elementID:"%dl_elementID%",elementCTA:"%dl_elementCTA%",contentName:"%dl_elementContentName%",contentType:"%dl_elementContentType%",elementText:"%dl_elementText%",elementType:"%dl_elementType%",contentNameEn:"%dl_elementContentNameEn%"},sectionInfo:{pageArea:"%dl_pageArea%",headerName:"%dl_headerName%",headerNameEn:"%dl_headerNameEn%"},componentInfo:{templateName:"%dl_templateName%",componentName:"%dl_componentName%",componentType:"%dl_componentType%",componentView:"%dl_componentView%"},containerInfo:{containerID:"%dl_containerID%",containerType:"%dl_containerType%",containerTitle:"%dl_containerTitle%",containerParentId:"%dl_containerParentId%"},containerItemInfo:{slotNumber:"%dl_slotNumber%",containerItemID:"%dl_containerItemID%",containerItemType:"%dl_containerItemType%",containerItemImage:"%dl_containerItemImage%",containerItemTitle:"%dl_containerItemTitle%"}},region:"%dl_pageLocation%",linkClicks:{value:1}},webPageDetails:{URL:"%ACDL - URL%",name:"%ACDL - Page Name%",_mscom:{pageInfo:{URLQS:"%ACDL - URLQS%",pageCMS:"%Meta - AWA CMS%",pageType:"%Meta - AWA Page Type%",pageTitle:"%Meta - OG Title%",modifyDate:"%ACDL - Modified Date%",prevPageURL:"%dl_prevPageUrl%",publishDate:"%ACDL - Published Date%",URLWithoutQS:"%ACDL - URL Without QS%",pageTemplate:"%Meta - Page Template%"},siteInfo:{siteID:"%ACDL - Site ID%",siteName:"%ACDL - Site Name%",siteBrand:"%ACDL - Site Brand%",siteDomain:"%ACDL - Site Domain%",siteLocale:"%ACDL - Site Locale%",siteMarket:"%ACDL - Site Market%",siteLanguage:"%ACDL - Site Language%"}},server:"%ACDL - Server%",isHomePage:"%ACDL - Home Page Flag%",isErrorPage:"%dl_isErrorPageFlag%",siteSection:"%Meta - Site Section%"}},_mscom:{eventData:{eventName:"%dl_eventDataName%",actionType:"%dl_eventActionType%",behaviorID:"%dl_eventBehaviorID%",eventCategory:"%dl_eventBehaviorCategory%"},consentsSnapshot:"%ACDL - Consents and Preferences Snapshot%",currentIdentities:{ANON:"%ACDL - ANON Cookie%",ECID:"%ACDL - ECID%",MC1GUID:"%ACDL - MC1 GUID%",marketoMunchkinCookie:"%ACDL - Munchkin Cookie%"}},marketing:{_mscom:{ICID:"%ACDL - ICID (Internal Campaign ID)%"},trackingCode:"%dl_ocidTrackingCode%"},environment:{_dc:{language:"%dl_environmentLanguage%"},browserDetails:{name:"%ACDL - Browser Name%",userAgent:"%dl_userAgent%"}},identityMap:"%ACDL - Identity Map%",placeContext:{geo:{countryCode:"%dl_countryCode%"}}},sandbox:{name:"websdk-prod"}}},"ACDL - Session ID":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0,n=adobeSatelliteName.getVar("ACDL - Web Session Details");return null!=n&&null!=n&&n.sessionID&&(e=n.sessionID),e}}},"ACDL - Environment Language":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return document.querySelector("html")&&document.querySelector("html").lang&&(e=document.querySelector("html").lang.split("-")[0]),e}}},"ACDL - Error Page Flag":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1,n=document.getElementsByClassName("error-message"),t=document.title.toLowerCase();return(n.length>0||"we are sorry, the page you requested cannot be found"==t)&&(e=!0),e}}},"Meta - OG Title":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[property="og:title"]')&&null!=document.querySelector('meta[property="og:title"]').getAttribute("content")&&(e=document.querySelector('meta[property="og:title"]').getAttribute("content")),e}}},"ACDL - ANON Cookie":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return getCookie("ANON")?getCookie("ANON"):void 0}}},"ACDL - Site Domain":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return window.location.hostname.split("www.")[1]}}},"ACDL - Referrer Without QS":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){}}},"ACDL - Browser Name":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=navigator.userAgent;return-1!=e.indexOf("Firefox/")&&-1===e.indexOf("Seamonkey/")?"Firefox":-1!=e.indexOf("Seamonkey/")?"Seamonkey":-1!=e.indexOf("Chrome/")&&-1===e.indexOf("Chromium/")&&-1===e.indexOf("Edg/")?"Chrome":-1!=e.indexOf("Chromium/")?"Chromium":-1!=e.indexOf("Safari/")&&-1===e.indexOf("Chrome/")&&-1===e.indexOf("Chromium/")&&-1===e.indexOf("Edg/")?"Safari":-1!=e.indexOf("OPR/")||-1!=e.indexOf("Opera/")?"Opera":-1!=e.indexOf("Edg/")?"Edge":"Other"}}},"ACDL - GPC Consent":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return 1==GPC_DataSharingOptIn?"Y":"N"}}},"ACDL - Referrer Type":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){
var e=adobeSatelliteName.getVar("ACDL - Referrer"),n="unknown",t=document.URL,o=!1,a=!1,r=["tiktok","weixinbridge.com","minecraft.","microsoftonline.","onenote.com","microsoftcasualgames.","microsoftstream","xbox.","live.com","powerapps.com","powershellgallery.com","make.gov","make.power","make.preview",".powerautomate.com","Ideas.power","zune.net","riskiq.com","powerup.microsoft.com","app-Info://platform/microsoft-","badoo.","blog.","cafemom.","deviantart.","digg.","facebook.","linkedin.","livejournal.","myspace.","ning.com","orkut.","pinterest.","tagged.com","twitter.","t.co/","yelp.","youtube.com",".reddit.com",".tumblr.com",".sina.com",".taringa.net",".tuenti.com",".odnoklassniki.ru",".vk.com",".vkontakte.ru",".flickr.com",".renren.com","plus.google.com",".me2day.net","me2day.net",".kaixin001.com",".mixi.jp",".hi5.com",".vimeo.com",".delicious.com","500px.com","stackoverflow.com","instagram.com","www.whatsapp.com","airtelforum.com","androidforums.com","arstechnica.com","aspoc.net","axforum.info","bbs.winos.cn","bytes.com","clever-forum.de","community.bamboosolutions.com","community.spiceworks.com","computerhelpforums.net","connect.nintex.com","deforum.ru","dotnet-forum.de","dotnetforum.lk","eforum.idg.se","eightwone.com","en.wikipedia.org","entwickler-forum.de","exchangepedia.com","exchangeserverpro.com","forum","forum.0day.kiev.ua","forum.4programmers.net","forum.advice.inf.br","forum.ahsay.com","forum.alsacreations.com","forum.aspitalia.com","forum.aspvn.net","forum.chip.de","forum.clubedohardware.com.br","forum.codecall.net","forum.commvalut.com","forum.computerbild.de","forum.computeridee.nl","forum.corproot.net","forum.darkhardware.com","forum.de.selfhtml.org","forum.dobreprogramy.pl","forum.eclarsys.com","forum.enteo.com","forum.fok.nl","forum.foxclub.ru","forum.funkysouls.com","forum.ge","forum.generation-nt.com","forum.gigaset.com","forum.gpit.fr","forum.hardware.fr","forum.hostingcontroller.com","forum.html.it","forum.hwsw.hu","forum.imasters.com.br","forum.infostart.ru","forum.itlab.com.vn","forum.it-share.ro","forum.ixbt.com","forum.joomla.org.hu","forum.kaspersky.com","forum.katarincic.com","forum.ks-ekspert.pl","forum.lrytas.lt","forum.mailenable.com","forum.masterdrive.it","forum.mazzy.ru","forum.ms.com","forum.nic.ru","forum.notebookreview.com","forum.oszone.net","forum.parallels.com","forum.pcastuces.com","forum.persiannetworks.com","forum.root.cz","forum.ru-board.com","forum.saabsportclub.com","forum.script-coding.com","forum.sistemuzmani.com","forum.softpedia.com","forum.sources.ru","forum.spamcop.net","forum.specopssoft.com","forum.sudrf.ru","forum.swzone.it","forum.sysinternals.com","forum.sysman.ru","forum.techzine.nl","forum.telecharger.01net.com","forum.ultrabac.com","forum.vingrad.ru","forum.winadmin.ro","forum.windowsfaq.ru","forum.wordreference.com","forum.xda-developers.com","forum.zebulon.fr","forum.zive.cz","forum.zwame.pt","forums.4d.fr","forums.anandtech.com","forums.asp.net","forums.aspfree.com","forums.autodesk.com","forums.avalon.ru","forums.cnet.com","forums.cnetfrance.fr","forums.cpanel.net","forums.crackberry.com","forums.datatel.com","forums.daypilot.org","forums.devarticles.com","forums.devshed.com","forums.digitalpoint.com","forums.epmfaq.com","forums.gfi.com","forums.guru3d.com","forums.hardwarezone.com.sg","forums.iis.net","forums.isaserver.org","forums.juniper.net","forums.kemptechnologies.com","forums.kerio.com","forums.macnn.com","forums.macrumors.com","forums.madcapsoftware.com","forums.majorgeeks.com","forums.manageengine.com","forums.mozillazine.org","forums.msexchange.org","forums.mydigitallife.info","forums.ni.com","forums.ocsinventory-ng.org","forums.overclockers.co.uk","forums.overclockers.com.au","forums.overclockers.ru","forums.pentaho.com","forums.phplist.com","forums.renewedvision.com","forums.smartertools.com","forums.somethingawful.com","forums.speedguide.net","forums.techarena.in","forums.techguy.org","forums.techsoup.org","forums.toshiba.com","forums.untangle.com","forums.whirlpool.net.au","forum-tn.ovh.com","gathering.tweakers.net","geeks.ms","get-spscripts.com","hardforum.com","itknowledgeexchange.techtarget.com","johanveldhuis.nl","kin.naver.com","lnkd.in","mathforum.org","maximoaccess.maisforum.com","mobile.experts-exchange.com","msexchangeguru.com","msgroups.net","msmvps.com","ms-office-forum.de","ms-office-forum.net","mssharepointtips.com","msunified.net","myforums.oracle.com","myitforum.com","objectmix.com","officedeveloper.net","openxmldeveloper.org","pcforum.hu","programmersforum.ru","pspcommunity.org","searchexchange.techtarget.com","serverfault.com","serversupportforum.de","sharepoint.stackexchange.com","sharepointcommunity.de","sharepointforum.com","sharepointgeorge.com","sharepoint-sandbox.com","spservices.codeplex.com","stackoverflow.com","superuser.com","supportforums.blackberry.com","sympmarc.com","sysadmins.ru","theessentialexchange.com","thinkpad-forum.de","ubuntuforums.org","uforum.uz","vmware-forum.de","windowsforum.kr","windowsforums.org","windowssecrets.com","wssv4faq.mindsharp.com","www.accessforums.net","www.access-programmers.co.uk","www.accessribbon.de","www.administrator.de","www.andrewconnell.com","www.astaticstate.com","www.avforums.com","www.axforum.info","www.benjaminathawes.com","www.bhargavs.com","www.bizsupportonline.net","www.blackberryforums.com","www.blackberryforums.com.au","www.chaholl.com","www.chandima.net","www.cmswire.com","www.codeproject.com","www.cozumpark.com","www.c-sharpcorner.com","www.cyberforum.ru","www.daniweb.com","www.databaseforum.info","www.dbforums.com","www.developpez.net","www.devx.com","www.ditii.com","www.dotnetmafia.com","www.dotnetspark.com","www.dreamincode.net","www.droidforums.net","www.edugeek.net","www.ehow.com","www.endusersharepoint.com","www.enterprisenetworkingplanet.com","www.excelbanter.com","www.excelforum.com","www.excelforum.pl","www.exchangefreaks.com","www.exchange-genie.com","www.exchangeinbox.com","www.experts-exchange.com","www.forum.mista.ru","www.forum.persianadmins.ir","www.forumla.de","www.forum-microsoft.org","www.forums.gr","www.forum-sam.com","www.forum-seven.com","www.forumtopics.com","www.generation-nt.com","www.go4answers.com","www.go4sharepoint.com","www.gotdotnet.ru","www.harbar.net","www.howardforums.com","www.infopathdev.com","www.ip-phone-forum.de","www.itproffs.se","www.jeremytaylor.net","www.khamis.net","www.mapforums.com","www.mcseboard.de","www.microsoftoffice2010forums.com","www.microsoftproject.ru","www.mikepfeiffer.net","www.mrexcel.com","www.msexchange.org","www.msexchangefaq.de","www.msfn.org","www.ms-office-forum.de","www.ms-office-forum.net","www.msofficeforums.com","www.mssharepointtips.com","www.msxfaq.de","www.myitforum.com","www.networksteve.com","www.novolocus.com","www.office-forums.com","www.office-loesung.de","www.online-marketing-forum.at","www.oooforum.org","www.oszone.net","www.outlookcode.com","www.outlookforums.com","www.pchelpforum.com","www.pcreview.co.uk","www.petri.co.il","www.physicsforums.com","www.proexchange.be","www.pro-exchange.be","www.programmersforum.ru","www.rondebruin.nl","www.server-talk.eu","www.sevenforums.com","www.sharemuch.com","www.sharepoint4developers.net","www.sharepointblues.com","www.sharepointforum.com","www.sharepointforum.nl","www.sharepointforums.org","www.sharepointnutsandbolts.com","www.sharepoint-tips.com","www.shudnow.net","www.slideshare.net","www.slipstick.com","www.sqaforums.com","www.sql.ru","www.stevieg.org","www.stumbleupon.com","www.supernature-forum.de","www.supforum.net","www.tech-archive.net","www.techques.com","www.techrepublic.com","www.techsupportforum.com","www.techtalkz.com","www.tek-tips.com","www.thevista.ru","www.tm1forum.com","www.toddklindt.com","www.tonstegeman.com","www.vbdotnetforums.com","www.vbforums.com","www.wictorwilen.se","www.windows-7-forum.net","www.windows-noob.com","www.windowsservercatalog.com","www.winfuture-forum.de","www.winvistatips.com","www.wssdemo.com","www.xbaseforum.de","www.xtremevbtalk.com","www.xing.com","www.youtube.com"],i=["beguide.com","aol.com","search.com","dogpile.com","dmoz.org","biglobe.com","aol.","altavista.com","abacho.com","ecosia.org","yandex.","suche.t-online.de","coccoc.com",".google.",".finderoo.com",".qwant.com",".yahoo.com","play.google.com",".rakuten.com",".ocn.ne.jp","jcom.co.jp",".jword.jp",".fenrir-inc.com",".lunascape.com",".fmworld.net","myvaio.sony.com",".earthlink.net",".sapo.pt","duckduckgo.com","sm.cn","livedoor.com","daum.net",".virginmedia.com",".bt.com","ee.co.uk",".alot.com","search.avg.com","search-results.com","360.cn","haosou.com","so.360.cn",".blekko.com",".googleadservices.com","m.baidu","m.bing","search.comcast.net","froute.crooz","auok.auone.jp","aldn.jp","m.mixi.jp","tkmf.jp","docomo.ne.jp","mbkn.jp","Centrum.cz","Atlas.cz","Zbozi.cz","kakaku.com","baidu.",".soso.com",".sogou.com","dict.youdao.com",".yicha.com",".iyappo.com",".searchoodle.com",".roadrunner.com","startpage.com","mywebsearch.com","zhongsou.com","bing.com","froute.crooz.jp","ohnew.com","search.mobage.com","infoseek.co.jp","biglobe.com","goo.ne.jp","search.live.com","searchteria.com","cuil.com","eniro.","www.msn.com",".sina.com","m.yahoo.co",".crooz.com","google.co.","nifty.com","ezweb.ne.jp","wakwak.com","cafesta.com","webalta.ru","so-net.ne.jp","yahoo.","livedoor.com","rambler.ru","berlingske.dk","kelkoo.","sesam.","aladdin.com","startsiden.no","ofir.dk","ask.co","odn.ne.jp","yol.co.jp","dion.ne.jp","istmania.com","metaeureka.com","khoj.com","monstercrawler.com","nate.com","business.com","nifty.com","mail.ru","pricerunner.se","altavista.no","kelkoo.se","altavista.dk","37.com","rol.ro","ntsearch.com","holms.ru","abrexa.co.uk","limeysearch.com","huifa.com","icq.com","ixquick.eu","conexcol.com","jopinet.com","infopage.com","mirago.com","ixquick.eu","tapuz.co.il","1st-spot.com","dialindia.com","labrujula.com","naver.com","libero.it","buscapique.com","teoma.com","heureka.sk","galileu.com.br","kvasir.no","luxpoint.com","irl.com","iwon.com","flix.de","tjohoo.com","findwhat.com","webstudio.com","fleecethenet.com","wp.pl","feynd.com","findit-quick.com","webbel.com","walla.co.il","dir.bg","gohip.com","grippo.com","globito.com","wanadoo.com","truesearch.com","123.cl","100.nu","data.ru","sherlock.cz","rocketlinks.com","sensis.com.au","ukindex.co.uk","ukplus.co.uk","tiscali.","exploora.com","allsearchengines.com","eniro.se","gulesider.no","krak.dk","degulesider.dk","egyptsearch.com","profusion.com","7search.com","netsprint.pl","polishworld.com","myway.com","trovator.com","empas.com","usseek.com","quepasa.com","reference.com","searchnz.co.nz","surf.sk","supercrawler.com","szm.sk","search.ch","seznam.cz","find.wanadoo.nl","suche.ch","southasia.net","smartpages.com","szm.sk","toile.qc.ca","canada.com","wizzler.com","web.de","topfile.com","virgilio.it","webcrawler.com","webwombat.com","surfer.ch","soquick.com","smartbeak.com","simplypets.com","thunderstone.com","tiscali.com","theinfodepot.com","thebighub.com","search.ch","searchalot.com","snap.com","startingpoint.com","rageworld.com","orbit.net","ask.com","point2.com","scour.com","northernlight.com","dmoz.org","live.com","metacrawler.com","metadog.com","metaiq.com","nbci.com","mcfind.com","lycos.","excite.com.au","magellan.com","mamma.com","kanoodle.com","libero.it","linkcenter.com","looksmart.com","infoseek.co.","infoseek.com","blucora.com","infotiger.com","jayde.com","jubii.dk","go.com","idealist.com","hotlaunch.com","overture.com","highway61.com","hotbot.com","ilse.nl","fireball.de","goo.ne.jp","3721.com","eerstekeuze.nl","zoeken.nl","track.nl","fansites.com","zoeken.hetnet.nl","dog.com","dictionary.com","cyberbritain.com","excite.com","excite.","about.com","alltheweb.com","enhance.com","mojeek.com","searx.me","scroggle.com","searchencrypt.com","clusty.com","teoma.com","yippy.com","search.io","boardreader.com","blin.com","shodan.io","gigablast.com","carrot2.org","pinoyweb.com","maloka.com","atypon.com","qwantjunior.com","findsounds.com"];for(let n=0;n<r.length;n++)null!=e&&-1!=e.indexOf(r[n])&&-1==e.indexOf("microsoft.com")&&(o=!0);for(let n=0;n<i.length;n++)null!=e&&-1!=e.indexOf(i[n])&&(a=!0);return(null==e||-1!=e.indexOf("microsoft.com")&&-1!=e.indexOf("azure.com")&&-1!=e.indexOf("xbox.com"))&&(-1==t.indexOf("_par_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("part_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("_afc_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("tduid")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("aff_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("tduid")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("_aff_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("tduid")&&-1==t.indexOf("ocid"))&&-1==t.indexOf("tduid")&&-1==t.indexOf("aff_")||(n="external"),(null==e||-1===e.indexOf("microsoft.com")&&-1===e.indexOf("azure.com")&&-1===e.indexOf("xbox.com"))&&(-1==t.indexOf("oan_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("mscom_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("spo_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("rm_one")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("tec_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("winstore_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&(-1==t.indexOf("oo_")||-1==t.indexOf("wt.mc_id")&&-1==t.indexOf("ocid"))&&"live.com"!=e||(n="internal"),(-1!=t.indexOf("cartemail")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("recemail")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("lifecycleemail")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("eml_cxm")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("promo")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("email_mmo")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("reviewemail")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_eml_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("eml_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_ema_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("ema_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("pd_eml")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("trans")&&-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("trigger")&&-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("receipt")&&-1!=t.indexOf("wt.mc_id")||"events.microsoft.com"==document.referrer)&&(n="email"),(-1!=t.indexOf("_scl_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_soc_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("usoc_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("soc_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_sol_")&&-1!=t.indexOf("ocid")||-1!=t.indexOf("_spl")&&-1!=t.indexOf("ocid")||-1!=t.indexOf("_pd_spl")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_pd_scl")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_pd_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("pd_scl")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("_soc_pmc_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("psoc_")&&-1!=t.indexOf("ocid")||1==o)&&(n="social"),null!=e&&""!=e||(n="typed_bookmarked"),(-1!=t.indexOf("seo_omc_goo")&&-1!=t.indexOf("ocid")||-1!=t.indexOf("_sem_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("pointitsem")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("ps_")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("google")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("datafeed")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("baidu")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("bing")&&(-1!=t.indexOf("wt.mc_id")||-1!=t.indexOf("ocid"))||-1!=t.indexOf("wt.mc_id")&&1==a||-1!=t.indexOf("cn mmc")&&1==a||-1!=t.indexOf("cr cc")&&1==a||-1!=t.indexOf("ocid")&&1==a||1==a)&&(n="search_engine"),n}}},"ACDL - URLQS":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=document.location.href;return-1!==e.indexOf("?")?e.split("?")[1]:void 0}}},"ACDL - Page ID":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e,n=window.location.pathname.substring(1),t="page_"+(n=(n=n.replace(/\//g,"_")).replace(/_$/,""));return null!=document.querySelector('meta[property="content-path"]')?(t="page_",(e=document.querySelector('meta[property="content-path"]').content).length>0&&(e=e.replace(/\//g,"_").substring(1)),t+=e=e.replace(/_$/,"")):null!=document.querySelector("body")&&null!=document.querySelector("body").getAttribute("id")&&(t=document.querySelector("body").getAttribute("id")),t}}},"ACDL - MC1 GUID":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return getCookie("MC1").substring(5,37)}}},"ACDL - Previous Page URL":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return void 0!==window.adobeDataLayer&&null!=typeof window.adobeDataLayer.getState("visitorProfile")&&void 0!==window.adobeDataLayer.getState("visitorProfile").profileLastViewedUrl&&(e=window.adobeDataLayer.getState("visitorProfile").profileLastViewedUrl),-1!==e.indexOf("https://")?e=e.split("https://")[1]:-1!==document.location.href.indexOf("http://")&&(e=e.split("http://")[1]),e}}},"Meta - AWA Market":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-market"]')&&null!=document.querySelector('meta[name="awa-market"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-market"]').getAttribute("content")),e}}},"ACDL - Content Path":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e;void 0!==window._satellite&&null!==window._satellite?e=window._satellite:void 0!==window._satellite2&&null!==window._satellite2&&(e=window._satellite2);var n=e.getVar("ACDL - Page ID"),t=window.location.pathname;return void 0!==window.adobeDataLayer?void 0!==window.adobeDataLayer.getState("page."+n)&&void 0!==window.adobeDataLayer.getState("page."+n+".repo:path")&&(t=window.adobeDataLayer.getState("page."+n+".repo:path")):null!=document.querySelector('meta[property="content-path"]')&&(t=document.querySelector('meta[property="content-path"]').content).length>0&&(t=t.replace(/\//g,"_").substring(1)),t}}},"ACDL - Modified Date":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[property="article:modified_time"]')&&null!=document.querySelector('meta[property="article:modified_time"]').getAttribute("content")&&(articlePublishTime=document.querySelector('meta[property="article:modified_time"]').getAttribute("content")),e}}},"ACDL - Site Brand":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"MSFT"}}},"Meta - Description":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="description"]')&&null!=document.querySelector('meta[name="description"]').getAttribute("content")&&(e=document.querySelector('meta[name="description"]').getAttribute("content")),e}}},"ACDL - ECID":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e;return void 0!==window.adobeDataLayer&&void 0!==window.adobeDataLayer.getState("visitorProfile")&&void 0!==window.adobeDataLayer.getState("visitorProfile.visitorECID")&&(e=window.adobeDataLayer.getState("visitorProfile.visitorECID")),e}}},"ACDL - Marketing Channel":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1,n=["tiktok","weixinbridge.com","minecraft.","microsoftonline.","onenote.com","microsoftcasualgames.","microsoftstream","xbox.","live.com","microsoft.com","microsoft365.com","powerapps.com","powershellgallery.com","make.gov","make.power","make.preview",".powerautomate.com","Ideas.power","zune.net","riskiq.com","powerup.microsoft.com","app-Info://platform/microsoft-","badoo.","blog.","cafemom.","deviantart.","digg.","facebook.","linkedin.","livejournal.","myspace.","ning.com","orkut.","pinterest.","tagged.com","twitter.","t.co","yelp.","youtube.com",".reddit.com",".tumblr.com",".sina.com",".taringa.net",".tuenti.com",".odnoklassniki.ru",".vk.com",".vkontakte.ru",".flickr.com",".renren.com","plus.google.com",".me2day.net","me2day.net",".kaixin001.com",".mixi.jp",".hi5.com",".vimeo.com",".delicious.com","500px.com","stackoverflow.com","instagram.com","www.whatsapp.com","airtelforum.com","androidforums.com","arstechnica.com","aspoc.net","axforum.info","bbs.winos.cn","bytes.com","clever-forum.de","community.bamboosolutions.com","community.spiceworks.com","computerhelpforums.net","connect.nintex.com","deforum.ru","dotnet-forum.de","dotnetforum.lk","eforum.idg.se","eightwone.com","en.wikipedia.org","entwickler-forum.de","exchangepedia.com","exchangeserverpro.com","forum","forum.0day.kiev.ua","forum.4programmers.net","forum.advice.inf.br","forum.ahsay.com","forum.alsacreations.com","forum.aspitalia.com","forum.aspvn.net","forum.chip.de","forum.clubedohardware.com.br","forum.codecall.net","forum.commvalut.com","forum.computerbild.de","forum.computeridee.nl","forum.corproot.net","forum.darkhardware.com","forum.de.selfhtml.org","forum.dobreprogramy.pl","forum.eclarsys.com","forum.enteo.com","forum.fok.nl","forum.foxclub.ru","forum.funkysouls.com","forum.ge","forum.generation-nt.com","forum.gigaset.com","forum.gpit.fr","forum.hardware.fr","forum.hostingcontroller.com","forum.html.it","forum.hwsw.hu","forum.imasters.com.br","forum.infostart.ru","forum.itlab.com.vn","forum.it-share.ro","forum.ixbt.com","forum.joomla.org.hu","forum.kaspersky.com","forum.katarincic.com","forum.ks-ekspert.pl","forum.lrytas.lt","forum.mailenable.com","forum.masterdrive.it","forum.mazzy.ru","forum.ms.com","forum.nic.ru","forum.notebookreview.com","forum.oszone.net","forum.parallels.com","forum.pcastuces.com","forum.persiannetworks.com","forum.root.cz","forum.ru-board.com","forum.saabsportclub.com","forum.script-coding.com","forum.sistemuzmani.com","forum.softpedia.com","forum.sources.ru","forum.spamcop.net","forum.specopssoft.com","forum.sudrf.ru","forum.swzone.it","forum.sysinternals.com","forum.sysman.ru","forum.techzine.nl","forum.telecharger.01net.com","forum.ultrabac.com","forum.vingrad.ru","forum.winadmin.ro","forum.windowsfaq.ru","forum.wordreference.com","forum.xda-developers.com","forum.zebulon.fr","forum.zive.cz","forum.zwame.pt","forums.4d.fr","forums.anandtech.com","forums.asp.net","forums.aspfree.com","forums.autodesk.com","forums.avalon.ru","forums.cnet.com","forums.cnetfrance.fr","forums.cpanel.net","forums.crackberry.com","forums.datatel.com","forums.daypilot.org","forums.devarticles.com","forums.devshed.com","forums.digitalpoint.com","forums.epmfaq.com","forums.gfi.com","forums.guru3d.com","forums.hardwarezone.com.sg","forums.iis.net","forums.isaserver.org","forums.juniper.net","forums.kemptechnologies.com","forums.kerio.com","forums.macnn.com","forums.macrumors.com","forums.madcapsoftware.com","forums.majorgeeks.com","forums.manageengine.com","forums.mozillazine.org","forums.msexchange.org","forums.mydigitallife.info","forums.ni.com","forums.ocsinventory-ng.org","forums.overclockers.co.uk","forums.overclockers.com.au","forums.overclockers.ru","forums.pentaho.com","forums.phplist.com","forums.renewedvision.com","forums.smartertools.com","forums.somethingawful.com","forums.speedguide.net","forums.techarena.in","forums.techguy.org","forums.techsoup.org","forums.toshiba.com","forums.untangle.com","forums.whirlpool.net.au","forum-tn.ovh.com","gathering.tweakers.net","geeks.ms","get-spscripts.com","hardforum.com","itknowledgeexchange.techtarget.com","johanveldhuis.nl","kin.naver.com","lnkd.in","mathforum.org","maximoaccess.maisforum.com","mobile.experts-exchange.com","msexchangeguru.com","msgroups.net","msmvps.com","ms-office-forum.de","ms-office-forum.net","mssharepointtips.com","msunified.net","myforums.oracle.com","myitforum.com","objectmix.com","officedeveloper.net","openxmldeveloper.org","pcforum.hu","programmersforum.ru","pspcommunity.org","searchexchange.techtarget.com","serverfault.com","serversupportforum.de","sharepoint.stackexchange.com","sharepointcommunity.de","sharepointforum.com","sharepointgeorge.com","sharepoint-sandbox.com","spservices.codeplex.com","stackoverflow.com","superuser.com","supportforums.blackberry.com","sympmarc.com","sysadmins.ru","theessentialexchange.com","thinkpad-forum.de","ubuntuforums.org","uforum.uz","vmware-forum.de","windowsforum.kr","windowsforums.org","windowssecrets.com","wssv4faq.mindsharp.com","www.accessforums.net","www.access-programmers.co.uk","www.accessribbon.de","www.administrator.de","www.andrewconnell.com","www.astaticstate.com","www.avforums.com","www.axforum.info","www.benjaminathawes.com","www.bhargavs.com","www.bizsupportonline.net","www.blackberryforums.com","www.blackberryforums.com.au","www.chaholl.com","www.chandima.net","www.cmswire.com","www.codeproject.com","www.cozumpark.com","www.c-sharpcorner.com","www.cyberforum.ru","www.daniweb.com","www.databaseforum.info","www.dbforums.com","www.developpez.net","www.devx.com","www.ditii.com","www.dotnetmafia.com","www.dotnetspark.com","www.dreamincode.net","www.droidforums.net","www.edugeek.net","www.ehow.com","www.endusersharepoint.com","www.enterprisenetworkingplanet.com","www.excelbanter.com","www.excelforum.com","www.excelforum.pl","www.exchangefreaks.com","www.exchange-genie.com","www.exchangeinbox.com","www.experts-exchange.com","www.forum.mista.ru","www.forum.persianadmins.ir","www.forumla.de","www.forum-microsoft.org","www.forums.gr","www.forum-sam.com","www.forum-seven.com","www.forumtopics.com","www.generation-nt.com","www.go4answers.com","www.go4sharepoint.com","www.gotdotnet.ru","www.harbar.net","www.howardforums.com","www.infopathdev.com","www.ip-phone-forum.de","www.itproffs.se","www.jeremytaylor.net","www.khamis.net","www.mapforums.com","www.mcseboard.de","www.microsoftoffice2010forums.com","www.microsoftproject.ru","www.mikepfeiffer.net","www.mrexcel.com","www.msexchange.org","www.msexchangefaq.de","www.msfn.org","www.ms-office-forum.de","www.ms-office-forum.net","www.msofficeforums.com","www.mssharepointtips.com","www.msxfaq.de","www.myitforum.com","www.networksteve.com","www.novolocus.com","www.office-forums.com","www.office-loesung.de","www.online-marketing-forum.at","www.oooforum.org","www.oszone.net","www.outlookcode.com","www.outlookforums.com","www.pchelpforum.com","www.pcreview.co.uk","www.petri.co.il","www.physicsforums.com","www.proexchange.be","www.pro-exchange.be","www.programmersforum.ru","www.rondebruin.nl","www.server-talk.eu","www.sevenforums.com","www.sharemuch.com","www.sharepoint4developers.net","www.sharepointblues.com","www.sharepointforum.com","www.sharepointforum.nl","www.sharepointforums.org","www.sharepointnutsandbolts.com","www.sharepoint-tips.com","www.shudnow.net","www.slideshare.net","www.slipstick.com","www.sqaforums.com","www.sql.ru","www.stevieg.org","www.stumbleupon.com","www.supernature-forum.de","www.supforum.net","www.tech-archive.net","www.techques.com","www.techrepublic.com","www.techsupportforum.com","www.techtalkz.com","www.tek-tips.com","www.thevista.ru","www.tm1forum.com","www.toddklindt.com","www.tonstegeman.com","www.vbdotnetforums.com","www.vbforums.com","www.wictorwilen.se","www.windows-7-forum.net","www.windows-noob.com","www.windowsservercatalog.com","www.winfuture-forum.de","www.winvistatips.com","www.wssdemo.com","www.xbaseforum.de","www.xtremevbtalk.com","www.xing.com","www.youtube.com"];for(let t=0;t<n.length;t++)-1!=window.referrer.indexOf(n[t])&&(e=!0);switch(!0){case-1!=window.URL.indexOf("cartemail")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("recemail")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("lifecycleemail")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("eml_cxm")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("promo")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("trans")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("trigger")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("receipt")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("_eml_")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("eml_")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("_eml_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("eml_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("_ema_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("ema_")&&-1!=window.URL.indexOf("ocid"):case"events.microsoft.com"==document.referrer:return"Email";case-1!=window.URL.indexOf("_scl_")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("_sol_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("_spl")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("_scl_")&&-1!=window.URL.indexOf("ocid"):return"Social";case-1!=window.URL.indexOf("crmip_")&&-1!=window.URL.indexOf("ocid"):return"In-Product";case-1!=window.URL.indexOf("seo_omc_goo")&&-1!=window.URL.indexOf("ocid"):return"Organic Search";case-1!=window.URL.indexOf("_ qsg_")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("_ qsg_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("oo_support")&&-1!=window.URL.indexOf("ocid"):return"O&O";case-1!=window.URL.indexOf("tduid"):case-1!=window.URL.indexOf("aff_"):return"Affiliate";case-1!=window.URL.indexOf("pd_eml")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("pd_eml")&&-1!=window.URL.indexOf("wt.mc _ id"):return"Paid Email";case-1!=window.URL.indexOf("_ola_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("_ola_")&&-1!=window.URL.indexOf("wt.mc _ id"):return"Paid Display";case-1!=window.URL.indexOf("pd_scl")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("PSOC_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("pd_scl")&&-1!=window.URL.indexOf("wt.mc _ id"):return"Paid Social";case-1!=window.URL.indexOf("_sem_")&&-1!=window.URL.indexOf("ocid"):case-1!=window.URL.indexOf("_sem_")&&-1!=window.URL.indexOf("wt.mc _ id"):case-1!=window.URL.indexOf("wt.mc_id"):return"Paid Search";case e&&-1!=window.URL.indexOf("ocid"):case e&&-1==window.URL.indexOf("wt.mc _ id"):return"Paid Social";case e:return"Organic Social";case null==document.referrer:case""==document.referrer:return"Direct Traffic";default:return"O&O"}}}},"ACDL - Referrer":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=document.referrer;return-1!==e.indexOf("https://")?e=e.split("https://")[1]:-1!==e.indexOf("http://")&&(e=e.split("http://")[1]),e}}},"Meta - AWA Page Template":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=void 0;return null!=document.querySelector('meta[name="awa-pgtmp"]')&&null!=document.querySelector('meta[name="awa-pgtmp"]').getAttribute("content")&&(e=document.querySelector('meta[name="awa-pgtmp"]').getAttribute("content")),e}}},"ACDL - Site ID":{forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"M365"}}}},extensions:{"common-web-sdk-plugins":{displayName:"Common Web SDK Plugins",hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EP72fbeb9839644a1daa8eca9f84e02dcf/",modules:{}},"gcoe-adobe-client-data-layer":{displayName:"Adobe Client Data Layer",hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EP6e4c031a8b7640d7ac3fab013fa28b17/",settings:{dataLayerName:"adobeDataLayer",injectLibrary:!0},modules:{"gcoe-adobe-client-data-layer/src/lib/dataElements/datalayerComputedState.js":{name:"datalayer-computed-state",displayName:"Data Layer Computed State",script:function(e,n,t){"use strict";e.exports=function(e){if(null!=e){var n=o();if(void 0!==n)return""!==e.path?n.getState(e.path):n.getState()}};var o=t("../util/getDataLayer")}},"gcoe-adobe-client-data-layer/src/lib/events/datalayerPushListener.js":{name:"datalayer-push",displayName:"Data Pushed",script:function(e,n,t){"use strict";e.exports=function(e,n){if(null!=e){
var t=e.method,a=e.eventKey,r=e.scope,i=o(),s=function(e){var t={message:e,beforeState:{},afterState:{},fullState:i.getState()};n(t)},l={};void 0!==r&&(l.scope=r),"allData"===t?i.push((function(e){e.addEventListener("adobeDataLayer:change",s,l)})):"allEvents"===t?i.push((function(e){e.addEventListener("adobeDataLayer:event",s,l)})):"specificEvent"===t&&""!==a&&i.push((function(e){e.addEventListener(a,s,l)}))}};var o=t("../util/getDataLayer")}},"gcoe-adobe-client-data-layer/src/lib/main.js":{script:function(e,n,t,o){var a=o.getExtensionSettings(),r=a.dataLayerName,i=a.injectLibrary;if(window.adobeDataLayer=window.adobeDataLayer||[],"object"!=typeof window.adobeDataLayer&&(o.logger.log("Initializing adobeDataLayer to [] as it isn't an object yet."),window.adobeDataLayer=[]),"adobeDataLayer"!==r&&("object"==typeof window[r]?(o.logger.log('Using "'+r+'" instead of "adobeDataLayer" as data layer name.'),window.adobeDataLayer.push((function(e){for(var n=0;n<window[r].length;n++)e.push(window[r][n]);window[r]=e}))):o.logger.warn('Could not use "'+r+'" instead of "adobeDataLayer", because the object does not exist!')),i&&void 0===window.adobeDataLayer.getState){function s(e,n){return m(e)||c(e,n)||u(e,n)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],o=!0,a=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(t.push(i.value),!n||t.length!==n);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw r}}return t}}function m(e){if(Array.isArray(e))return e}function d(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=u(e))){var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,r=!0,i=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return r=e.done,e},e:function(e){i=!0,a=e},f:function(){try{r||null==o.return||o.return()}finally{if(i)throw a}}}}function u(e,n){if(e){if("string"==typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(e,n):void 0}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o.logger.log("Initializing adobeDataLayer as it wasn't found during the initialization."),function e(n,o,a){function r(s,l){if(!o[s]){if(!n[s]){var c="function"==typeof t&&t;if(!l&&c)return c(s,!0);if(i)return i(s,!0);var m=new Error("Cannot find module '"+s+"'");throw m.code="MODULE_NOT_FOUND",m}var d=o[s]={exports:{}};n[s][0].call(d.exports,(function(e){return r(n[s][1][e]||e)}),d,d.exports,e,n,o,a)}return o[s].exports}for(var i="function"==typeof t&&t,s=0;s<a.length;s++)r(a[s]);return r}({1:[function(e,n,t){(function(e){(function(){function o(e,n){for(var t=-1,o=null==e?0:e.length,a=0,r=[];++t<o;){var i=e[t];n(i,t,e)&&(r[a++]=i)}return r}function a(e,n){for(var t=-1,o=null==e?0:e.length,a=Array(o);++t<o;)a[t]=n(e[t],t,e);return a}function r(e,n){for(var t=-1,o=n.length,a=e.length;++t<o;)e[a+t]=n[t];return e}function i(e,n){for(var t=-1,o=null==e?0:e.length;++t<o;)if(n(e[t],t,e))return!0;return!1}function s(e,n,t){var o=e.length;for(t+=-1;++t<o;)if(n(e[t],t,e))return t;return-1}function l(e){return e!=e}function c(e){return function(n){return e(n)}}function m(e){var n=-1,t=Array(e.size);return e.forEach((function(e,o){t[++n]=[o,e]})),t}function d(e){var n=Object;return function(t){return e(n(t))}}function u(e){var n=-1,t=Array(e.size);return e.forEach((function(e){t[++n]=e})),t}function f(){}function g(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function w(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function h(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function y(e){var n=-1,t=null==e?0:e.length;for(this.__data__=new h;++n<t;)this.add(e[n])}function v(e){this.size=(this.__data__=new w(e)).size}function b(e,n){var t,o=vt(e),a=!o&&yt(e),r=!o&&!a&&bt(e),i=!o&&!a&&!r&&_t(e);if(o=o||a||r||i){a=e.length;for(var s=String,l=-1,c=Array(a);++l<a;)c[l]=s(l);a=c}else a=[];for(t in s=a.length,e)!n&&!bn.call(e,t)||o&&("length"==t||r&&("offset"==t||"parent"==t)||i&&("buffer"==t||"byteLength"==t||"byteOffset"==t)||ne(t,s))||a.push(t);return a}function I(e,n,t){(t===Me||fe(e[n],t))&&(t!==Me||n in e)||C(e,n,t)}function S(e,n,t){var o=e[n];bn.call(e,n)&&fe(o,t)&&(t!==Me||n in e)||C(e,n,t)}function _(e,n){for(var t=e.length;t--;)if(fe(e[t][0],n))return t;return-1}function C(e,n,t){"__proto__"==n&&Rn?Rn(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}function T(e,n,t,o,a,r){var i,s=1&n,l=2&n,c=4&n;if(t&&(i=a?t(e,o,a,r):t(e)),i!==Me)return i;if(!ye(e))return e;if(o=vt(e)){if(i=function(e){var n=e.length,t=new e.constructor(n);return n&&"string"==typeof e[0]&&bn.call(e,"index")&&(t.index=e.index,t.input=e.input),t}(e),!s)return B(e,i)}else{var m=st(e),d="[object Function]"==m||"[object GeneratorFunction]"==m;if(bt(e))return q(e,s);if("[object Object]"==m||"[object Arguments]"==m||d&&!a){if(i=l||d?{}:Z(e),!s)return l?function(e,n){return z(e,it(e),n)}(e,function(e,n){return e&&z(n,Oe(n),e)}(i,e)):function(e,n){return z(e,rt(e),n)}(e,function(e,n){return e&&z(n,Ae(n),e)}(i,e))}else{if(!nn[m])return a?e:{};i=function(e,n,t){var o=e.constructor;switch(n){case"[object ArrayBuffer]":return M(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return n=t?M(e.buffer):e.buffer,new e.constructor(n,e.byteOffset,e.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return F(e,t);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return(n=new e.constructor(e.source,Qe.exec(e))).lastIndex=e.lastIndex,n;case"[object Symbol]":return Zn?Object(Zn.call(e)):{}}}(e,m,s)}}if(a=(r=r||new v).get(e))return a;if(r.set(e,i),St(e))return e.forEach((function(o){i.add(T(o,n,t,o,e,r))})),i;if(It(e))return e.forEach((function(o,a){i.set(a,T(o,n,t,a,e,r))})),i;l=c?l?Q:G:l?Oe:Ae;var u=o?Me:l(e);return function(e,n){for(var t=-1,o=null==e?0:e.length;++t<o&&!1!==n(e[t],t,e););}(u||e,(function(o,a){u&&(o=e[a=o]),S(i,a,T(o,n,t,a,e,r))})),i}function D(e,n){for(var t=0,o=(n=j(n,e)).length;null!=e&&t<o;)e=e[ie(n[t++])];return t&&t==o?e:Me}function k(e,n,t){return n=n(e),vt(e)?n:r(n,t(e))}function x(e){if(null==e)e=e===Me?"[object Undefined]":"[object Null]";else if(Ln&&Ln in Object(e)){var n=bn.call(e,Ln),t=e[Ln];try{e[Ln]=Me;var o=!0}catch(e){}var a=Sn.call(e);o&&(n?e[Ln]=t:delete e[Ln]),e=a}else e=Sn.call(e);return e}function P(e,n){return null!=e&&bn.call(e,n)}function A(e,n){return null!=e&&n in Object(e)}function O(e){return ve(e)&&"[object Arguments]"==x(e)}function E(e,n,t,o,a){if(e===n)n=!0;else if(null==e||null==n||!ve(e)&&!ve(n))n=e!=e&&n!=n;else e:{var r,i,s=vt(e),l=vt(n),c="[object Object]"==(r="[object Arguments]"==(r=s?"[object Array]":st(e))?"[object Object]":r);if(l="[object Object]"==(i="[object Arguments]"==(i=l?"[object Array]":st(n))?"[object Object]":i),(i=r==i)&&bt(e)){if(!bt(n)){n=!1;break e}c=!(s=!0)}if(i&&!c)a=a||new v,n=s||_t(e)?W(e,n,t,o,E,a):function(e,n,t,o,a,r,i){switch(t){case"[object DataView]":if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)break;e=e.buffer,n=n.buffer;case"[object ArrayBuffer]":if(e.byteLength!=n.byteLength||!r(new kn(e),new kn(n)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return fe(+e,+n);case"[object Error]":return e.name==n.name&&e.message==n.message;case"[object RegExp]":case"[object String]":return e==n+"";case"[object Map]":var s=m;case"[object Set]":if(s=s||u,e.size!=n.size&&!(1&o))break;return(t=i.get(e))?t==n:(o|=2,i.set(e,n),n=W(s(e),s(n),o,a,r,i),i.delete(e),n);case"[object Symbol]":if(Zn)return Zn.call(e)==Zn.call(n)}return!1}(e,n,r,t,o,E,a);else{if(!(1&t)&&(s=c&&bn.call(e,"__wrapped__"),r=l&&bn.call(n,"__wrapped__"),s||r)){n=E(e=s?e.value():e,n=r?n.value():n,t,o,a=a||new v);break e}if(i)n:if(a=a||new v,s=1&t,r=G(e),l=r.length,i=G(n).length,l==i||s){for(c=l;c--;){var d=r[c];if(!(s?d in n:bn.call(n,d))){n=!1;break n}}if((i=a.get(e))&&a.get(n))n=i==n;else{i=!0,a.set(e,n),a.set(n,e);for(var f=s;++c<l;){var p=e[d=r[c]],g=n[d];if(o)var w=s?o(g,p,d,n,e,a):o(p,g,d,e,n,a);if(w===Me?p!==g&&!E(p,g,t,o,a):!w){i=!1;break}f=f||"constructor"==d}i&&!f&&(t=e.constructor)!=(o=n.constructor)&&"constructor"in e&&"constructor"in n&&!("function"==typeof t&&t instanceof t&&"function"==typeof o&&o instanceof o)&&(i=!1),a.delete(e),a.delete(n),n=i}}else n=!1;else n=!1}}return n}function N(e){return"function"==typeof e?e:null==e?Le:"object"==p(e)?vt(e)?function(e,n){return te(e)&&n==n&&!ye(n)?ae(ie(e),n):function(t){var o=xe(t,e);return o===Me&&o===n?Pe(t,e):E(n,o,3)}}(e[0],e[1]):function(e){var n=function(e){for(var n=Ae(e),t=n.length;t--;){var o=n[t],a=e[o];n[t]=[o,a,a==a&&!ye(a)]}return n}(e);return 1==n.length&&n[0][2]?ae(n[0][0],n[0][1]):function(t){return t===e||function(e,n){var t=n.length,o=t;if(null==e)return!o;for(e=Object(e);t--;)if((a=n[t])[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1;for(;++t<o;){var a,r=(a=n[t])[0],i=e[r],s=a[1];if(a[2]){if(i===Me&&!(r in e))return!1}else if(a=new v,void 0!==Me||!E(s,i,3,void 0,a))return!1}return!0}(t,n)}}(e):Ue(e)}function L(e){if(!oe(e))return jn(e);var n,t=[];for(n in Object(e))bn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function R(e,n,t,o,a){e!==n&&ot(n,(function(r,i){if(ye(r)){var s=a=a||new v,l="__proto__"==i?Me:e[i],c="__proto__"==i?Me:n[i];if(p=s.get(c))I(e,i,p);else{var m=(p=o?o(l,c,i+"",e,n,s):Me)===Me;if(m){var d=vt(c),u=!d&&bt(c),f=!d&&!u&&_t(c),p=c;d||u||f?p=vt(l)?l:ge(l)?B(l):u?q(c,!(m=!1)):f?F(c,!(m=!1)):[]:be(c)||yt(c)?yt(p=l)?p=De(l):(!ye(l)||t&&we(l))&&(p=Z(c)):m=!1}m&&(s.set(c,p),R(p,c,t,o,s),s.delete(c)),I(e,i,p)}}else(s=o?o("__proto__"==i?Me:e[i],r,i+"",e,n,a):Me)===Me&&(s=r),I(e,i,s)}),Oe)}function U(e){if("string"==typeof e)return e;if(vt(e))return a(e,U)+"";if(Se(e))return et?et.call(e):"";var n=e+"";return"0"==n&&1/e==-Fe?"-0":n}function V(e,n){var t;if((n=j(n,e)).length<2)t=e;else{var o=0,a=-1,r=-1,i=(t=n).length;for(o<0&&(o=i<-o?0:i+o),(a=i<a?i:a)<0&&(a+=i),i=a<o?0:a-o>>>0,o>>>=0,a=Array(i);++r<i;)a[r]=t[r+o];t=D(e,a)}null==(e=t)||delete e[ie(me(n))]}function j(e,n){return vt(e)?e:te(e,n)?[e]:gt(ke(e))}function q(e,n){if(n)return e.slice();var t=e.length;return t=xn?xn(t):new e.constructor(t),e.copy(t),t}function M(e){var n=new e.constructor(e.byteLength);return new kn(n).set(new kn(e)),n}function F(e,n){return new e.constructor(n?M(e.buffer):e.buffer,e.byteOffset,e.length)}function B(e,n){var t=-1,o=e.length;for(n=n||Array(o);++t<o;)n[t]=e[t];return n}function z(e,n,t){var o=!t;t=t||{};for(var a=-1,r=n.length;++a<r;){var i=n[a],s=Me;s===Me&&(s=e[i]),o?C(t,i,s):S(t,i,s)}return t}function H(e){return function(e){return pt(re(e,void 0,Le),e+"")}((function(n,t){var o,a=-1,r=t.length,i=1<r?t[r-1]:Me,s=2<r?t[2]:Me;if(i=3<e.length&&"function"==typeof i?(r--,i):Me,o=s){o=t[0];var l=t[1];if(ye(s)){var c=p(l);o=!!("number"==c?pe(s)&&ne(l,s.length):"string"==c&&l in s)&&fe(s[l],o)}else o=!1}for(o&&(i=r<3?Me:i,r=1),n=Object(n);++a<r;)(s=t[a])&&e(n,s,a,i);return n}))}function $(e){return be(e)?Me:e}function W(e,n,t,o,a,r){var s=1&t,l=e.length;if(l!=(c=n.length)&&!(s&&l<c))return!1;if((c=r.get(e))&&r.get(n))return c==n;var c=-1,m=!0,d=2&t?new y:Me;for(r.set(e,n),r.set(n,e);++c<l;){var u=e[c],f=n[c];if(o)var p=s?o(f,u,c,n,e,r):o(u,f,c,e,n,r);if(p!==Me){if(p)continue;m=!1;break}if(d){if(!i(n,(function(e,n){if(!d.has(n)&&(u===e||a(u,e,t,o,r)))return d.push(n)}))){m=!1;break}}else if(u!==f&&!a(u,f,t,o,r)){m=!1;break}}return r.delete(e),r.delete(n),m}function G(e){return k(e,Ae,rt)}function Q(e){return k(e,Oe,it)}function J(e,n){var t=(t=f.iteratee||Re)===Re?N:t;return arguments.length?t(e,n):t}function X(e,n){var t=e.__data__,o=p(n);return("string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?t["string"==typeof n?"string":"hash"]:t.map}function Y(e,n){var t=null==e?Me:e[n];return!ye(t)||In&&In in t||!(we(t)?Cn:Ye).test(se(t))?Me:t}function K(e,n,t){for(var o=-1,a=(n=j(n,e)).length,r=!1;++o<a;){var i=ie(n[o]);if(!(r=null!=e&&t(e,i)))break;e=e[i]}return r||++o!=a?r:!!(a=null==e?0:e.length)&&he(a)&&ne(i,a)&&(vt(e)||yt(e))}function Z(e){return"function"!=typeof e.constructor||oe(e)?{}:nt(Pn(e))}function ee(e){return vt(e)||yt(e)||!!(Nn&&e&&e[Nn])}function ne(e,n){var t=p(e);return!!(n=null==n?9007199254740991:n)&&("number"==t||"symbol"!=t&&Ze.test(e))&&-1<e&&0==e%1&&e<n}function te(e,n){if(vt(e))return!1;var t=p(e);return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=e&&!Se(e))||He.test(e)||!ze.test(e)||null!=n&&e in Object(n)}function oe(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||hn)}function ae(e,n){return function(t){return null!=t&&t[e]===n&&(n!==Me||e in Object(t))}}function re(e,n,t){return n=qn(n===Me?e.length-1:n,0),function(){for(var o=arguments,a=-1,r=qn(o.length-n,0),i=Array(r);++a<r;)i[a]=o[n+a];for(a=-1,r=Array(n+1);++a<n;)r[a]=o[a];return r[n]=t(i),function(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}(e,this,r)}}function ie(e){if("string"==typeof e||Se(e))return e;var n=e+"";return"0"==n&&1/e==-Fe?"-0":n}function se(e){if(null==e)return"";try{return vn.call(e)}catch(e){}return e+""}function le(e,n,t){var o=null==e?0:e.length;return o?((t=null==t?0:Ce(t))<0&&(t=qn(o+t,0)),s(e,J(n,3),t)):-1}function ce(e){return null!=e&&e.length?function e(n,t,o,a,i){var s=-1,l=n.length;for(o=o||ee,i=i||[];++s<l;){var c=n[s];0<t&&o(c)?1<t?e(c,t-1,o,a,i):r(i,c):a||(i[i.length]=c)}return i}(e,1):[]}function me(e){var n=null==e?0:e.length;return n?e[n-1]:Me}function de(e,n){function t(){var o=arguments,a=n?n.apply(this,o):o[0],r=t.cache;return r.has(a)?r.get(a):(o=e.apply(this,o),t.cache=r.set(a,o)||r,o)}if("function"!=typeof e||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");return t.cache=new(de.Cache||h),t}function ue(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}function fe(e,n){return e===n||e!=e&&n!=n}function pe(e){return null!=e&&he(e.length)&&!we(e)}function ge(e){return ve(e)&&pe(e)}function we(e){return!!ye(e)&&("[object Function]"==(e=x(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)}function he(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991}function ye(e){var n=p(e);return null!=e&&("object"==n||"function"==n)}function ve(e){return null!=e&&"object"==p(e)}function be(e){return!(!ve(e)||"[object Object]"!=x(e))&&(null===(e=Pn(e))||"function"==typeof(e=bn.call(e,"constructor")&&e.constructor)&&e instanceof e&&vn.call(e)==_n)}function Ie(e){return"string"==typeof e||!vt(e)&&ve(e)&&"[object String]"==x(e)}function Se(e){return"symbol"==p(e)||ve(e)&&"[object Symbol]"==x(e)}function _e(e){return e?(e=Te(e))===Fe||e===-Fe?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function Ce(e){var n=(e=_e(e))%1;return e==e?n?e-n:e:0}function Te(e){if("number"==typeof e)return e;if(Se(e))return Be;if(ye(e)&&(e=ye(e="function"==typeof e.valueOf?e.valueOf():e)?e+"":e),"string"!=typeof e)return 0===e?e:+e;e=e.replace(We,"");var n=Xe.test(e);return n||Ke.test(e)?on(e.slice(2),n?2:8):Je.test(e)?Be:+e}function De(e){return z(e,Oe(e))}function ke(e){return null==e?"":U(e)}function xe(e,n,t){return(e=null==e?Me:D(e,n))===Me?t:e}function Pe(e,n){return null!=e&&K(e,n,A)}function Ae(e){return pe(e)?b(e):L(e)}function Oe(e){if(pe(e))e=b(e,!0);else if(ye(e)){var n,t=oe(e),o=[];for(n in e)("constructor"!=n||!t&&bn.call(e,n))&&o.push(n);e=o}else{if(n=[],null!=e)for(t in Object(e))n.push(t);e=n}return e}function Ee(e){return null==e?[]:function(e,n){return a(n,(function(n){return e[n]}))}(e,Ae(e))}function Ne(e){return function(){return e}}function Le(e){return e}function Re(e){return N("function"==typeof e?e:T(e,1))}function Ue(e){return te(e)?function(e){return function(n){return null==n?Me:n[e]}}(ie(e)):function(e){return function(n){return D(n,e)}}(e)}function Ve(){return[]}function je(){return!1}function qe(){}var Me,Fe=1/0,Be=NaN,ze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,He=/^\w*$/,$e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,We=/^\s+|\s+$/g,Ge=/\\(\\)?/g,Qe=/\w*$/,Je=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ye=/^\[object .+?Constructor\]$/,Ke=/^0o[0-7]+$/i,Ze=/^(?:0|[1-9]\d*)$/,en={};en["[object Float32Array]"]=en["[object Float64Array]"]=en["[object Int8Array]"]=en["[object Int16Array]"]=en["[object Int32Array]"]=en["[object Uint8Array]"]=en["[object Uint8ClampedArray]"]=en["[object Uint16Array]"]=en["[object Uint32Array]"]=!0,en["[object Arguments]"]=en["[object Array]"]=en["[object ArrayBuffer]"]=en["[object Boolean]"]=en["[object DataView]"]=en["[object Date]"]=en["[object Error]"]=en["[object Function]"]=en["[object Map]"]=en["[object Number]"]=en["[object Object]"]=en["[object RegExp]"]=en["[object Set]"]=en["[object String]"]=en["[object WeakMap]"]=!1;var nn={};nn["[object Arguments]"]=nn["[object Array]"]=nn["[object ArrayBuffer]"]=nn["[object DataView]"]=nn["[object Boolean]"]=nn["[object Date]"]=nn["[object Float32Array]"]=nn["[object Float64Array]"]=nn["[object Int8Array]"]=nn["[object Int16Array]"]=nn["[object Int32Array]"]=nn["[object Map]"]=nn["[object Number]"]=nn["[object Object]"]=nn["[object RegExp]"]=nn["[object Set]"]=nn["[object String]"]=nn["[object Symbol]"]=nn["[object Uint8Array]"]=nn["[object Uint8ClampedArray]"]=nn["[object Uint16Array]"]=nn["[object Uint32Array]"]=!0,nn["[object Error]"]=nn["[object Function]"]=nn["[object WeakMap]"]=!1;var tn,on=parseInt,an="object"==p(e)&&e&&e.Object===Object&&e,rn="object"==("undefined"==typeof self?"undefined":p(self))&&self&&self.Object===Object&&self,sn=an||rn||Function("return this")(),ln="object"==p(t)&&t&&!t.nodeType&&t,cn=ln&&"object"==p(n)&&n&&!n.nodeType&&n,mn=cn&&cn.exports===ln,dn=mn&&an.process;e:{try{tn=dn&&dn.binding&&dn.binding("util");break e}catch(c){}tn=void 0}var un,fn=tn&&tn.isMap,pn=tn&&tn.isSet,gn=tn&&tn.isTypedArray,wn=Array.prototype,hn=Object.prototype,yn=sn["__core-js_shared__"],vn=Function.prototype.toString,bn=hn.hasOwnProperty,In=(un=/[^.]+$/.exec(yn&&yn.keys&&yn.keys.IE_PROTO||""))?"Symbol(src)_1."+un:"",Sn=hn.toString,_n=vn.call(Object),Cn=RegExp("^"+vn.call(bn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tn=mn?sn.Buffer:Me,Dn=sn.Symbol,kn=sn.Uint8Array,xn=Tn?Tn.a:Me,Pn=d(Object.getPrototypeOf),An=Object.create,On=hn.propertyIsEnumerable,En=wn.splice,Nn=Dn?Dn.isConcatSpreadable:Me,Ln=Dn?Dn.toStringTag:Me,Rn=function(){try{var e=Y(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Un=Object.getOwnPropertySymbols,Vn=Tn?Tn.isBuffer:Me,jn=d(Object.keys),qn=Math.max,Mn=Date.now,Fn=Y(sn,"DataView"),Bn=Y(sn,"Map"),zn=Y(sn,"Promise"),Hn=Y(sn,"Set"),$n=Y(sn,"WeakMap"),Wn=Y(Object,"create"),Gn=se(Fn),Qn=se(Bn),Jn=se(zn),Xn=se(Hn),Yn=se($n),Kn=Dn?Dn.prototype:Me,Zn=Kn?Kn.valueOf:Me,et=Kn?Kn.toString:Me,nt=function(e){return ye(e)?An?An(e):(qe.prototype=e,e=new qe,qe.prototype=Me,e):{}};g.prototype.clear=function(){this.__data__=Wn?Wn(null):{},this.size=0},g.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},g.prototype.get=function(e){var n=this.__data__;return Wn?"__lodash_hash_undefined__"===(e=n[e])?Me:e:bn.call(n,e)?n[e]:Me},g.prototype.has=function(e){var n=this.__data__;return Wn?n[e]!==Me:bn.call(n,e)},g.prototype.set=function(e,n){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Wn&&n===Me?"__lodash_hash_undefined__":n,this},w.prototype.clear=function(){this.__data__=[],this.size=0},w.prototype.delete=function(e){var n=this.__data__;return!((e=_(n,e))<0||(e==n.length-1?n.pop():En.call(n,e,1),--this.size,0))},w.prototype.get=function(e){var n=this.__data__;return(e=_(n,e))<0?Me:n[e][1]},w.prototype.has=function(e){return-1<_(this.__data__,e)},w.prototype.set=function(e,n){var t=this.__data__,o=_(t,e);return o<0?(++this.size,t.push([e,n])):t[o][1]=n,this},h.prototype.clear=function(){this.size=0,this.__data__={hash:new g,map:new(Bn||w),string:new g}},h.prototype.delete=function(e){return e=X(this,e).delete(e),this.size-=e?1:0,e},h.prototype.get=function(e){return X(this,e).get(e)},h.prototype.has=function(e){return X(this,e).has(e)},h.prototype.set=function(e,n){var t=X(this,e),o=t.size;return t.set(e,n),this.size+=t.size==o?0:1,this},y.prototype.add=y.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},y.prototype.has=function(e){return this.__data__.has(e)},v.prototype.clear=function(){this.__data__=new w,this.size=0},v.prototype.delete=function(e){var n=this.__data__;return e=n.delete(e),this.size=n.size,e},v.prototype.get=function(e){return this.__data__.get(e)},v.prototype.has=function(e){return this.__data__.has(e)},v.prototype.set=function(e,n){var t=this.__data__;if(t instanceof w){var o=t.__data__;if(!Bn||o.length<199)return o.push([e,n]),this.size=++t.size,this;t=this.__data__=new h(o)}return t.set(e,n),this.size=t.size,this};var tt=function(e,n){if(null==e)return e;if(!pe(e))return function(e,n){return e&&ot(e,n,Ae)}(e,n);for(var t=e.length,o=-1,a=Object(e);++o<t&&!1!==n(a[o],o,a););return e},ot=function(e,n,t){for(var o=-1,a=Object(e),r=(t=t(e)).length;r--;){var i=t[++o];if(!1===n(a[i],i,a))break}return e},at=Rn?function(e,n){return Rn(e,"toString",{configurable:!0,enumerable:!1,value:Ne(n),writable:!0})}:Le,rt=Un?function(e){return null==e?[]:(e=Object(e),o(Un(e),(function(n){return On.call(e,n)})))}:Ve,it=Un?function(e){for(var n=[];e;)r(n,rt(e)),e=Pn(e);return n}:Ve,st=x;(Fn&&"[object DataView]"!=st(new Fn(new ArrayBuffer(1)))||Bn&&"[object Map]"!=st(new Bn)||zn&&"[object Promise]"!=st(zn.resolve())||Hn&&"[object Set]"!=st(new Hn)||$n&&"[object WeakMap]"!=st(new $n))&&(st=function(e){var n=x(e);if(e=(e="[object Object]"==n?e.constructor:Me)?se(e):"")switch(e){case Gn:return"[object DataView]";case Qn:return"[object Map]";case Jn:return"[object Promise]";case Xn:return"[object Set]";case Yn:return"[object WeakMap]"}return n});var lt,ct,mt,dt,ut,ft,pt=(dt=at,ft=ut=0,function(){var e=Mn(),n=16-(e-ft);if(ft=e,0<n){if(800<=++ut)return arguments[0]}else ut=0;return dt.apply(Me,arguments)}),gt=(mt=(ct=de(ct=function(e){var n=[];return 46===e.charCodeAt(0)&&n.push(""),e.replace($e,(function(e,t,o,a){n.push(o?a.replace(Ge,"$1"):t||e)})),n},(function(e){return 500===mt.size&&mt.clear(),e}))).cache,ct),wt=(lt=le,function(e,n,t){var o=Object(e);if(!pe(e)){var a=J(n,3);e=Ae(e),n=function(e){return a(o[e],e,o)}}return-1<(n=lt(e,n,t))?o[a?e[n]:n]:Me});de.Cache=h;var ht,yt=O(function(){return arguments}())?O:function(e){return ve(e)&&bn.call(e,"callee")&&!On.call(e,"callee")},vt=Array.isArray,bt=Vn||je,It=fn?c(fn):function(e){return ve(e)&&"[object Map]"==st(e)},St=pn?c(pn):function(e){return ve(e)&&"[object Set]"==st(e)},_t=gn?c(gn):function(e){return ve(e)&&he(e.length)&&!!en[x(e)]},Ct=H((function(e,n,t){R(e,n,t)})),Tt=H((function(e,n,t,o){R(e,n,t,o)})),Dt=pt(re(ht=function(e,n){var t={};if(null==e)return t;var o=!1;n=a(n,(function(n){return n=j(n,e),o=o||1<n.length,n})),z(e,Q(e),t),o&&(t=T(t,7,$));for(var r=n.length;r--;)V(t,n[r]);return t},Me,ce),ht+"");f.constant=Ne,f.flatten=ce,f.iteratee=Re,f.keys=Ae,f.keysIn=Oe,f.memoize=de,f.merge=Ct,f.mergeWith=Tt,f.negate=ue,f.omit=Dt,f.property=Ue,f.reject=function(e,n){return(vt(e)?o:function(e,n){var t=[];return tt(e,(function(e,o,a){n(e,o,a)&&t.push(e)})),t})(e,ue(J(n,3)))},f.toPlainObject=De,f.values=Ee,f.cloneDeep=function(e){return T(e,5)},f.cloneDeepWith=function(e,n){return T(e,5,n="function"==typeof n?n:Me)},f.eq=fe,f.find=wt,f.findIndex=le,f.get=xe,f.has=function(e,n){return null!=e&&K(e,n,P)},f.hasIn=Pe,f.identity=Le,f.includes=function(e,n,t,o){if(e=pe(e)?e:Ee(e),t=t&&!o?Ce(t):0,o=e.length,t<0&&(t=qn(o+t,0)),Ie(e))e=t<=o&&-1<e.indexOf(n,t);else{if(o=!!o){if(n==n)e:{for(t-=1,o=e.length;++t<o;)if(e[t]===n){e=t;break e}e=-1}else e=s(e,l,t);o=-1<e}e=o}return e},f.isArguments=yt,f.isArray=vt,f.isArrayLike=pe,f.isArrayLikeObject=ge,f.isBuffer=bt,f.isEmpty=function(e){if(null==e)return!0;if(pe(e)&&(vt(e)||"string"==typeof e||"function"==typeof e.splice||bt(e)||_t(e)||yt(e)))return!e.length;var n=st(e);if("[object Map]"==n||"[object Set]"==n)return!e.size;if(oe(e))return!L(e).length;for(var t in e)if(bn.call(e,t))return!1;return!0},f.isEqual=function(e,n){return E(e,n)},f.isFunction=we,f.isLength=he,f.isMap=It,f.isNull=function(e){return null===e},f.isObject=ye,f.isObjectLike=ve,f.isPlainObject=be,f.isSet=St,f.isString=Ie,f.isSymbol=Se,f.isTypedArray=_t,f.last=me,f.stubArray=Ve,f.stubFalse=je,f.toFinite=_e,f.toInteger=Ce,f.toNumber=Te,f.toString=ke,f.VERSION="4.17.5",cn&&((cn.exports=f)._=f,ln._=f)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,n){n.exports={itemType:{DATA:"data",FCTN:"fctn",EVENT:"event",LISTENER_ON:"listenerOn",LISTENER_OFF:"listenerOff"},dataLayerEvent:{CHANGE:"adobeDataLayer:change",EVENT:"adobeDataLayer:event"},listenerScope:{PAST:"past",FUTURE:"future",ALL:"all"}}},{}],3:[function(e,n){var t=e("../custom-lodash"),o=e("../version.json").version,a=t.cloneDeep,r=t.get,i=e("./item"),s=e("./listener"),l=e("./listenerManager"),c=e("./constants"),m=e("./utils/customMerge");n.exports=function(e){function n(e){h=m(h,e.data)}function t(e){function t(e){return 0===g.length||e.index>g.length-1?[]:g.slice(0,e.index).map((function(e){return i(e)}))}e.valid?{data:function(e){n(e),f.triggerListeners(e)},fctn:function(e){e.config.call(g,g)},event:function(e){e.data&&n(e),f.triggerListeners(e)},listenerOn:function(e){var n=s(e);switch(n.scope){case c.listenerScope.PAST:var o,a=d(t(e));try{for(a.s();!(o=a.n()).done;){var r=o.value;f.triggerListener(n,r)}}catch(e){a.e(e)}finally{a.f()}break;case c.listenerScope.FUTURE:f.register(n);break;case c.listenerScope.ALL:if(f.register(n)){var i,l=d(t(e));try{for(l.s();!(i=l.n()).done;){var m=i.value;f.triggerListener(n,m)}}catch(e){l.e(e)}finally{l.f()}}}},listenerOff:function(e){f.unregister(s(e))}}[e.type](e):u(e)}function u(e){var n="The following item cannot be handled by the data layer because it does not have a valid format: "+JSON.stringify(e.config);console.error(n)}var f,p=e||{},g=[],w=[],h={},y={getState:function(){return h},getDataLayer:function(){return g}};return Array.isArray(p.dataLayer)||(p.dataLayer=[]),w=p.dataLayer.splice(0,p.dataLayer.length),(g=p.dataLayer).version=o,h={},f=l(y),g.push=function(e){var n=arguments,o=arguments;if(Object.keys(n).forEach((function(e){var a=i(n[e]);switch(a.valid||(u(a),delete o[e]),a.type){case c.itemType.DATA:case c.itemType.EVENT:t(a);break;case c.itemType.FCTN:delete o[e],t(a);break;case c.itemType.LISTENER_ON:case c.itemType.LISTENER_OFF:delete o[e]}})),o[0])return Array.prototype.push.apply(this,o)},g.getState=function(e){return e?r(a(h),e):a(h)},g.addEventListener=function(e,n,o){t(i({on:e,handler:n,scope:o&&o.scope,path:o&&o.path}))},g.removeEventListener=function(e,n){t(i({off:e,handler:n}))},function(){for(var e=0;e<w.length;e++)g.push(w[e])}(),y}},{"../custom-lodash":1,"../version.json":14,"./constants":2,"./item":5,"./listener":7,"./listenerManager":8,"./utils/customMerge":10}],4:[function(e,n){var t={Manager:e("./dataLayerManager")};window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer.version?console.warn("Adobe Client Data Layer v".concat(window.adobeDataLayer.version," has already been imported/initialized on this page. You may be erroneously loading it a second time.")):t.Manager({dataLayer:window.adobeDataLayer}),n.exports=t},{"./dataLayerManager":3}],5:[function(e,n){var t=e("../custom-lodash"),o=t.isPlainObject,a=t.isEmpty,r=t.omit,i=t.find,s=e("./utils/dataMatchesContraints"),l=e("./itemConstraints"),c=e("./constants");n.exports=function(e,n){var t=e,m=n,d=i(Object.keys(l),(function(e){return s(t,l[e])}))||"function"==typeof t&&c.itemType.FCTN||o(t)&&c.itemType.DATA,u=function(){var e=r(t,Object.keys(l.event));if(!a(e))return e}();return{config:t,type:d,data:u,valid:!!d,index:m}}},{"../custom-lodash":1,"./constants":2,"./itemConstraints":6,"./utils/dataMatchesContraints":11}],6:[function(e,n){n.exports={event:{event:{type:"string"},eventInfo:{optional:!0}},listenerOn:{on:{type:"string"},handler:{type:"function"},scope:{type:"string",values:["past","future","all"],optional:!0},path:{type:"string",optional:!0}},listenerOff:{off:{type:"string"},handler:{type:"function",optional:!0},scope:{type:"string",values:["past","future","all"],optional:!0},path:{type:"string",optional:!0}}}},{}],7:[function(e,n){var t=e("./constants");n.exports=function(e){return{event:e.config.on||e.config.off,handler:e.config.handler||null,scope:e.config.scope||e.config.on&&t.listenerScope.ALL||null,path:e.config.path||null}}},{"./constants":2}],8:[function(e,n){var t=e("../custom-lodash").cloneDeep,o=e("./constants"),a=e("./utils/listenerMatch"),r=e("./utils/indexOfListener");n.exports=function(e){function n(e,n){if(a(e,n)){var o=[t(n.config)];e.handler.apply(s.getDataLayer(),o)}}var i={},s=e,l=r.bind(null,i);return{register:function(e){var n=e.event;return Object.prototype.hasOwnProperty.call(i,n)?-1===l(e)&&(i[e.event].push(e),!0):(i[e.event]=[e],!0)},unregister:function(e){var n=e.event;if(Object.prototype.hasOwnProperty.call(i,n))if(e.handler||e.scope||e.path){var t=l(e);-1<t&&i[n].splice(t,1)}else i[n]=[]},triggerListeners:function(e){(function(e){var n=[];switch(e.type){case o.itemType.DATA:n.push(o.dataLayerEvent.CHANGE);break;case o.itemType.EVENT:n.push(o.dataLayerEvent.EVENT),e.data&&n.push(o.dataLayerEvent.CHANGE),e.config.event!==o.dataLayerEvent.CHANGE&&n.push(e.config.event)}return n})(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(i,t)){var o,a=d(i[t]);try{for(a.s();!(o=a.n()).done;)n(o.value,e)}catch(t){a.e(t)}finally{a.f()}}}))},triggerListener:function(e,t){n(e,t)}}}},{"../custom-lodash":1,"./constants":2,"./utils/indexOfListener":12,"./utils/listenerMatch":13}],9:[function(e,n){var t=e("../../custom-lodash"),o=t.has,a=t.get;n.exports=function(e,n){for(var t=n.substring(0,n.lastIndexOf("."));t;){if(o(e,t)&&null==a(e,t))return!0;t=t.substring(0,t.lastIndexOf("."))}return!1}},{"../../custom-lodash":1}],10:[function(e,n){var t=e("../../custom-lodash"),o=t.cloneDeepWith,a=t.isObject,r=t.isArray,i=t.reject,s=t.mergeWith,l=t.isNull;n.exports=function(e,n){return s(e,n,(function(e,n){if(null==n)return null})),function(e,n){return o(e,(t=1<arguments.length&&void 0!==n?n:function(e){return!e},function e(n){if(a(n)){if(r(n))return i(n,t).map((function(n){return o(n,e)}));for(var s={},l=0,c=Object.keys(n);l<c.length;l++){var m=c[l];t(n[m])||(s[m]=o(n[m],e))}return s}}));var t}(e,l)}},{"../../custom-lodash":1}],11:[function(e,n){var t=e("../../custom-lodash"),o=t.find,a=t.includes;n.exports=function(e,n){return void 0===o(Object.keys(n),(function(t){var o=n[t].type,r=t&&n[t].values,i=!n[t].optional,s=e[t],l=p(s),c=o&&l!==o,m=r&&!a(r,s);return i?!s||c||m:s&&(c||m)}))}},{"../../custom-lodash":1}],12:[function(e,n){var t=e("../../custom-lodash").isEqual;n.exports=function(e,n){var o=n.event;if(Object.prototype.hasOwnProperty.call(e,o)){var a,r=d(e[o].entries());try{for(r.s();!(a=r.n()).done;){var i=s(a.value,2),l=i[0],c=i[1];if(t(c.handler,n.handler))return l}}catch(e){r.e(e)}finally{r.f()}}return-1}},{"../../custom-lodash":1}],
13:[function(e,n){function t(e,n){return!n.data||!e.path||o(n.data,e.path)||r(n.data,e.path)}var o=e("../../custom-lodash").has,a=e("../constants"),r=e("./ancestorRemoved");n.exports=function(e,n){var o=e.event,r=n.config,i=!1;return n.type===a.itemType.DATA?o===a.dataLayerEvent.CHANGE&&(i=t(e,n)):n.type===a.itemType.EVENT&&(o!==a.dataLayerEvent.EVENT&&o!==r.event||(i=t(e,n)),n.data&&o===a.dataLayerEvent.CHANGE&&(i=t(e,n))),i}},{"../../custom-lodash":1,"../constants":2,"./ancestorRemoved":9}],14:[function(e,n){n.exports={version:"2.0.2"}},{}]},{},[4])}}},"gcoe-adobe-client-data-layer/src/lib/util/getDataLayer.js":{script:function(e,n,t,o){"use strict";e.exports=function(){var e=o.getExtensionSettings();return window[e.dataLayerName]}}}}},core:{displayName:"Core",hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EPdea2007e025e4854a6b4ed545e844745/",modules:{"core/src/lib/dataElements/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,n){return e.source(n)}}},"core/src/lib/dataElements/pageInfo.js":{name:"page-info",displayName:"Page Info",script:function(e,n,t){"use strict";var o=t("@adobe/reactor-document");e.exports=function(e){switch(e.attribute){case"url":return o.location.href;case"hostname":return o.location.hostname;case"pathname":return o.location.pathname;case"protocol":return o.location.protocol;case"referrer":return o.referrer;case"title":return o.title}}}},"core/src/lib/dataElements/randomNumber.js":{name:"random-number",displayName:"Random Number",script:function(e){"use strict";e.exports=function(e){var n=Math.ceil(e.min),t=Math.floor(e.max);return n>t?NaN:Math.floor(Math.random()*(t-n+1))+n}}},"core/src/lib/dataElements/cookie.js":{name:"cookie",displayName:"Cookie",script:function(e,n,t){"use strict";var o=t("@adobe/reactor-cookie");e.exports=function(e){return o.get(e.name)}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,n){return e.source.call(n.element,n,n.target)}}},"core/src/lib/events/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,n){e.source(n)}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e,n,t,o){"use strict";var a,r,i,s,l=t("@adobe/reactor-document"),c=t("@adobe/reactor-promise"),m=t("./helpers/decorateCode"),d=t("./helpers/loadCodeSequentially"),u=t("../../../node_modules/postscribe/dist/postscribe"),f=t("./helpers/unescapeHtmlCode"),p=t("../helpers/findPageScript").getTurbine,g=(r=function(e){u(l.body,e,{beforeWriteToken:function(e){var n=e.tagName&&e.tagName.toLowerCase();return a&&"script"===n&&(e.attrs.nonce=a),"script"!==n&&"style"!==n||(Object.keys(e.attrs||{}).forEach((function(n){e.attrs[n]=f(e.attrs[n])})),e.src&&(e.src=f(e.src))),e},error:function(e){o.logger.error(e.msg)}})},i=[],s=function(){if(l.body)for(;i.length;)r(i.shift());else setTimeout(s,20)},function(e){i.push(e),s()}),w=function(){if(l.currentScript)return l.currentScript.async;var e=p();return!e||e.async}();e.exports=function(e,n){var t;a=o.getExtensionSettings().cspNonce;var r={settings:e,event:n},i=r.settings.source;if(i)return r.settings.isExternal?d(i).then((function(e){return e?(t=m(r,e),g(t.code),t.promise):c.resolve()})):(t=m(r,i),w||"loading"!==l.readyState?g(t.code):l.write&&!1===o.propertySettings.ruleComponentSequencingEnabled?l.write(t.code):g(t.code),t.promise)}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(e,n,t){"use strict";var o=t("./helpers/pageLifecycleEvents");e.exports=function(e,n){o.registerLibraryLoadedTrigger(n)}}},"core/src/lib/events/customEvent.js":{name:"custom-event",displayName:"Custom Event",script:function(e,n,t){"use strict";var o=t("./helpers/createBubbly")(),a=[];e.exports=function(e,n){var t=e.type;-1===a.indexOf(t)&&(a.push(t),window.addEventListener(t,o.evaluateEvent,!0)),o.addListener(e,(function(e){e.nativeEvent.type===t&&(e.detail=e.nativeEvent.detail,n(e))}))}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(e,n,t){"use strict";var o=t("./decorators/decorateGlobalJavaScriptCode"),a=t("./decorators/decorateNonGlobalJavaScriptCode"),r={javascript:function(e,n){return e.settings.global?o(e,n):a(e,n)},html:t("./decorators/decorateHtmlCode")};e.exports=function(e,n){return r[e.settings.language](e,n)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-promise"),a=t("./getSourceByUrl"),r=o.resolve();e.exports=function(e){var n=new o((function(n){var t=a(e);o.all([t,r]).then((function(e){var t=e[0];n(t)}))}));return r=n,n}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(e,n){var t,o;t=this,o=function(){return function(e){function n(o){if(t[o])return t[o].exports;var a=t[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var a=o(t(1));e.exports=a.default},function(e,n,t){"use strict";function o(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function a(e){return e&&e.__esModule?e:{default:e}}function r(){}function i(){var e=p.shift();if(e){var n=d.last(e);n.afterDequeue(),e.stream=s.apply(void 0,e),n.afterStreamStart()}}function s(e,n,t){function o(e){e=t.beforeWrite(e),g.write(e),t.afterWrite(e)}(g=new m.default(e,t)).id=f++,g.name=t.name||g.id,l.streams[g.name]=g;var a=e.ownerDocument,s={close:a.close,open:a.open,write:a.write,writeln:a.writeln};c(a,{close:r,open:r,write:function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return o(n.join(""))},writeln:function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return o(n.join("")+"\n")}});var d=g.win.onerror||r;return g.win.onerror=function(e,n,o){t.error({msg:e+" - "+n+": "+o}),d.apply(g.win,[e,n,o])},g.write(n,(function(){c(a,s),g.win.onerror=d,t.done(),g=null,i()})),g}function l(e,n,t){if(d.isFunction(t))t={done:t};else if("clear"===t)return p=[],g=null,void(f=0);t=d.defaults(t,u);var o=[e=/^#/.test(e)?window.document.getElementById(e.substr(1)):e.jquery?e[0]:e,n,t];return e.postscribe={cancel:function(){o.stream?o.stream.abort():o[1]=r}},t.beforeEnqueue(o),p.push(o),g||i(),e.postscribe}n.__esModule=!0;var c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};n.default=l;var m=a(t(2)),d=o(t(4)),u={afterAsync:r,afterDequeue:r,afterStreamStart:r,afterWrite:r,autoFix:!0,beforeEnqueue:r,beforeWriteToken:function(e){return e},beforeWrite:function(e){return e},done:r,error:function(e){throw new Error(e.msg)},releaseAsync:!1},f=0,p=[],g=null;c(l,{streams:{},queue:p,WriteStream:m.default})},function(e,n,t){"use strict";function o(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function a(e){return e&&e.__esModule?e:{default:e}}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){var t=u+n,o=e.getAttribute(t);return m.existy(o)?String(o):o}function s(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=u+n;m.existy(t)&&""!==t?e.setAttribute(o,t):e.removeAttribute(o)}n.__esModule=!0;var l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},c=a(t(3)),m=o(t(4)),d=!1,u="data-ps-",f="ps-style",p="ps-script",g=function(){function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.root=n,this.options=t,this.doc=n.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new c.default("",{autoFix:t.autoFix}),this.actuals=[n],this.proxyHistory="",this.proxyRoot=this.doc.createElement(n.nodeName),this.scriptStack=[],this.writeQueue=[],s(this.proxyRoot,"proxyof",0)}return e.prototype.write=function(){var e;for((e=this.writeQueue).push.apply(e,arguments);!this.deferredRemote&&this.writeQueue.length;){var n=this.writeQueue.shift();m.isFunction(n)?this._callFunction(n):this._writeImpl(n)}},e.prototype._callFunction=function(e){var n={type:"function",value:e.name||e.toString()};this._onScriptStart(n),e.call(this.win,this.doc),this._onScriptDone(n)},e.prototype._writeImpl=function(e){this.parser.append(e);for(var n=void 0,t=void 0,o=void 0,a=[];(n=this.parser.readToken())&&!(t=m.isScript(n))&&!(o=m.isStyle(n));)(n=this.options.beforeWriteToken(n))&&a.push(n);a.length>0&&this._writeStaticTokens(a),t&&this._handleScriptToken(n),o&&this._handleStyleToken(n)},e.prototype._writeStaticTokens=function(e){var n=this._buildChunk(e);return n.actual?(n.html=this.proxyHistory+n.actual,this.proxyHistory+=n.proxy,this.proxyRoot.innerHTML=n.html,d&&(n.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),d&&(n.actualInnerHTML=this.root.innerHTML),n):null},e.prototype._buildChunk=function(e){for(var n=this.actuals.length,t=[],o=[],a=[],r=e.length,i=0;i<r;i++){var s=e[i],l=s.toString();if(t.push(l),s.attrs){if(!/^noscript$/i.test(s.tagName)){var c=n++;o.push(l.replace(/(\/?>)/," "+u+"id="+c+" $1")),s.attrs.id!==p&&s.attrs.id!==f&&a.push("atomicTag"===s.type?"":"<"+s.tagName+" "+u+"proxyof="+c+(s.unary?" />":">"))}}else o.push(l),a.push("endTag"===s.type?l:"")}return{tokens:e,raw:t.join(""),actual:o.join(""),proxy:a.join("")}},e.prototype._walkChunk=function(){for(var e=void 0,n=[this.proxyRoot];m.existy(e=n.shift());){var t=1===e.nodeType;if(!t||!i(e,"proxyof")){t&&(this.actuals[i(e,"id")]=e,s(e,"id"));var o=e.parentNode&&i(e.parentNode,"proxyof");o&&this.actuals[o].appendChild(e)}n.unshift.apply(n,m.toArray(e.childNodes))}},e.prototype._handleScriptToken=function(e){var n=this,t=this.parser.clear();t&&this.writeQueue.unshift(t),e.src=e.attrs.src||e.attrs.SRC,(e=this.options.beforeWriteToken(e))&&(e.src&&this.scriptStack.length?this.deferredRemote=e:this._onScriptStart(e),this._writeScriptToken(e,(function(){n._onScriptDone(e)})))},e.prototype._handleStyleToken=function(e){var n=this.parser.clear();n&&this.writeQueue.unshift(n),e.type=e.attrs.type||e.attrs.TYPE||"text/css",(e=this.options.beforeWriteToken(e))&&this._writeStyleToken(e),n&&this.write()},e.prototype._writeStyleToken=function(e){var n=this._buildStyle(e);this._insertCursor(n,f),e.content&&(n.styleSheet&&!n.sheet?n.styleSheet.cssText=e.content:n.appendChild(this.doc.createTextNode(e.content)))},e.prototype._buildStyle=function(e){var n=this.doc.createElement(e.tagName);return n.setAttribute("type",e.type),m.eachKey(e.attrs,(function(e,t){n.setAttribute(e,t)})),n},e.prototype._insertCursor=function(e,n){this._writeImpl('<span id="'+n+'"/>');var t=this.doc.getElementById(n);t&&t.parentNode.replaceChild(e,t)},e.prototype._onScriptStart=function(e){e.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(e)},e.prototype._onScriptDone=function(e){e===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,e.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},e.prototype._writeScriptToken=function(e,n){var t=this._buildScript(e),o=this._shouldRelease(t),a=this.options.afterAsync;e.src&&(t.src=e.src,this._scriptLoadHandler(t,o?a:function(){n(),a()}));try{this._insertCursor(t,p),t.src&&!o||n()}catch(e){this.options.error(e),n()}},e.prototype._buildScript=function(e){var n=this.doc.createElement(e.tagName);return m.eachKey(e.attrs,(function(e,t){n.setAttribute(e,t)})),e.content&&(n.text=e.content),n},e.prototype._scriptLoadHandler=function(e,n){function t(){e=e.onload=e.onreadystatechange=e.onerror=null}function o(){t(),null!=n&&n(),n=null}function a(e){t(),i(e),null!=n&&n(),n=null}function r(e,n){var t=e["on"+n];null!=t&&(e["_on"+n]=t)}var i=this.options.error;r(e,"load"),r(e,"error"),l(e,{onload:function(){if(e._onload)try{e._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(n){a({msg:"onload handler failed "+n+" @ "+e.src})}o()},onerror:function(){if(e._onerror)try{e._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(n){return void a({msg:"onerror handler failed "+n+" @ "+e.src})}a({msg:"remote script failed "+e.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(e.readyState)&&o()}})},e.prototype._shouldRelease=function(e){return!/^script$/i.test(e.nodeName)||!!(this.options.releaseAsync&&e.src&&e.hasAttribute("async"))},e}();n.default=g},function(e){var n;n=function(){return function(e){function n(o){if(t[o])return t[o].exports;var a=t[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var a=o(t(1));e.exports=a.default},function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=a(t(2)),s=a(t(3)),l=o(t(6)),c=t(5),m={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},d=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.stream=t;var a=!1,s={};for(var c in i)i.hasOwnProperty(c)&&(o.autoFix&&(s[c+"Fix"]=!0),a=a||s[c+"Fix"]);a?(this._readToken=(0,l.default)(this,s,(function(){return n._readTokenImpl()})),this._peekToken=(0,l.default)(this,s,(function(){return n._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return e.prototype.append=function(e){this.stream+=e},e.prototype.prepend=function(e){this.stream=e+this.stream},e.prototype._readTokenImpl=function(){var e=this._peekTokenImpl();if(e)return this.stream=this.stream.slice(e.length),e},e.prototype._peekTokenImpl=function(){for(var e in m)if(m.hasOwnProperty(e)&&m[e].test(this.stream)){var n=s[e](this.stream);if(n)return"startTag"===n.type&&/script|style/i.test(n.tagName)?null:(n.text=this.stream.substr(0,n.length),n)}},e.prototype.peekToken=function(){return this._peekToken()},e.prototype.readToken=function(){return this._readToken()},e.prototype.readTokens=function(e){for(var n=void 0;n=this.readToken();)if(e[n.type]&&!1===e[n.type](n))return},e.prototype.clear=function(){var e=this.stream;return this.stream="",e},e.prototype.rest=function(){return this.stream},e}();for(var u in n.default=d,d.tokenToString=function(e){return e.toString()},d.escapeAttributes=function(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=(0,c.escapeQuotes)(e[t],null));return n},d.supports=i,i)i.hasOwnProperty(u)&&(d.browserHasFlaw=d.browserHasFlaw||!i[u]&&u)},function(e,n){"use strict";n.__esModule=!0;var t=!1,o=!1,a=window.document.createElement("div");try{var r="<P><I></P></I>";a.innerHTML=r,n.tagSoup=t=a.innerHTML!==r}catch(e){n.tagSoup=t=!1}try{a.innerHTML="<P><i><P></P></i></P>",n.selfClose=o=2===a.childNodes.length}catch(e){n.selfClose=o=!1}a=null,n.tagSoup=t,n.selfClose=o},function(e,n,t){"use strict";function o(e){var n=e.indexOf("-->");if(n>=0)return new c.CommentToken(e.substr(4,n-1),n+3)}function a(e){var n=e.indexOf("<");return new c.CharsToken(n>=0?n:e.length)}function r(e){var n,t,o;if(-1!==e.indexOf(">")){var a=e.match(m.startTag);if(a){var r=(n={},t={},o=a[2],a[2].replace(m.attr,(function(e,a){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(n[arguments[5]]="",t[arguments[5]]=!0):n[a]=arguments[2]||arguments[3]||arguments[4]||m.fillAttr.test(a)&&a||"":n[a]="",o=o.replace(e,"")})),{v:new c.StartTagToken(a[1],a[0].length,n,t,!!a[3],o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===r?"undefined":l(r)))return r.v}}}function i(e){var n=r(e);if(n){var t=e.slice(n.length);if(t.match(new RegExp("</\\s*"+n.tagName+"\\s*>","i"))){var o=t.match(new RegExp("([\\s\\S]*?)</\\s*"+n.tagName+"\\s*>","i"));if(o)return new c.AtomicTagToken(n.tagName,o[0].length+n.length,n.attrs,n.booleanAttrs,o[1])}}}function s(e){var n=e.match(m.endTag);if(n)return new c.EndTagToken(n[1],n[0].length)}n.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.comment=o,n.chars=a,n.startTag=r,n.atomicTag=i,n.endTag=s;var c=t(4),m={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0,n.EndTagToken=n.AtomicTagToken=n.StartTagToken=n.TagToken=n.CharsToken=n.CommentToken=n.Token=void 0;var a=t(5),r=(n.Token=function e(n,t){o(this,e),this.type=n,this.length=t,this.text=""},n.CommentToken=function(){function e(n,t){o(this,e),this.type="comment",this.length=t||(n?n.length:0),this.text="",this.content=n}return e.prototype.toString=function(){return"<!--"+this.content},e}(),n.CharsToken=function(){function e(n){o(this,e),this.type="chars",this.length=n,this.text=""}return e.prototype.toString=function(){return this.text},e}(),n.TagToken=function(){function e(n,t,a,r,i){o(this,e),this.type=n,this.length=a,this.text="",this.tagName=t,this.attrs=r,this.booleanAttrs=i,this.unary=!1,this.html5Unary=!1}return e.formatTag=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t="<"+e.tagName;for(var o in e.attrs)if(e.attrs.hasOwnProperty(o)){t+=" "+o;var r=e.attrs[o];void 0!==e.booleanAttrs&&void 0!==e.booleanAttrs[o]||(t+='="'+(0,a.escapeQuotes)(r)+'"')}return e.rest&&(t+=" "+e.rest),e.unary&&!e.html5Unary?t+="/>":t+=">",null!=n&&(t+=n+"</"+e.tagName+">"),t},e}());n.StartTagToken=function(){function e(n,t,a,r,i,s){o(this,e),this.type="startTag",this.length=t,this.text="",this.tagName=n,this.attrs=a,this.booleanAttrs=r,this.html5Unary=!1,this.unary=i,this.rest=s}return e.prototype.toString=function(){return r.formatTag(this)},e}(),n.AtomicTagToken=function(){function e(n,t,a,r,i){o(this,e),this.type="atomicTag",this.length=t,this.text="",this.tagName=n,this.attrs=a,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1,this.content=i}return e.prototype.toString=function(){return r.formatTag(this,this.content)},e}(),n.EndTagToken=function(){function e(n,t){o(this,e),this.type="endTag",this.length=t,this.text="",this.tagName=n}return e.prototype.toString=function(){return"</"+this.tagName+">"},e}()},function(e,n){"use strict";function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?e.replace(/([^"]*)"/g,(function(e,n){return/\\/.test(n)?n+'"':n+'\\"'})):n}n.__esModule=!0,n.escapeQuotes=t},function(e,n){"use strict";function t(e){return e&&"startTag"===e.type&&(e.unary=s.test(e.tagName)||e.unary,e.html5Unary=!/\/>$/.test(e.text)),e}function o(e,n){var o=e.stream,a=t(n());return e.stream=o,a}function a(e,n){var t=n.pop();e.prepend("</"+t.tagName+">")}function r(){var e=[];return e.last=function(){return this[this.length-1]},e.lastTagNameEq=function(e){var n=this.last();return n&&n.tagName&&n.tagName.toUpperCase()===e.toUpperCase()},e.containsTagName=function(e){for(var n,t=0;n=this[t];t++)if(n.tagName===e)return!0;return!1},e}function i(e,n,i){function s(){var n=o(e,i);n&&m[n.type]&&m[n.type](n)}var c=r(),m={startTag:function(t){var o=t.tagName;"TR"===o.toUpperCase()&&c.lastTagNameEq("TABLE")?(e.prepend("<TBODY>"),s()):n.selfCloseFix&&l.test(o)&&c.containsTagName(o)?c.lastTagNameEq(o)?a(e,c):(e.prepend("</"+t.tagName+">"),s()):t.unary||c.push(t)},endTag:function(t){c.last()?n.tagSoupFix&&!c.lastTagNameEq(t.tagName)?a(e,c):c.pop():n.tagSoupFix&&(i(),s())}};return function(){return s(),t(i())}}n.__esModule=!0,n.default=i;var s=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,l=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},e.exports=n()},function(e,n){"use strict";function t(e){return null!=e}function o(e){return"function"==typeof e}function a(e,n,t){var o=void 0,a=e&&e.length||0;for(o=0;o<a;o++)n.call(t,e[o],o)}function r(e,n,t){for(var o in e)e.hasOwnProperty(o)&&n.call(t,o,e[o])}function i(e,n){return e=e||{},r(n,(function(n,o){t(e[n])||(e[n]=o)})),e}function s(e){try{return Array.prototype.slice.call(e)}catch(o){var n=(t=[],a(e,(function(e){t.push(e)})),{v:t});if("object"===(void 0===n?"undefined":u(n)))return n.v}var t}function l(e){return e[e.length-1]}function c(e,n){return!(!e||"startTag"!==e.type&&"atomicTag"!==e.type||!("tagName"in e)||!~e.tagName.toLowerCase().indexOf(n))}function m(e){return c(e,"script")}function d(e){return c(e,"style")}n.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.existy=t,n.isFunction=o,n.each=a,n.eachKey=r,n.defaults=i,n.toArray=s,n.last=l,n.isTag=c,n.isScript=m,n.isStyle=d}])},"object"==typeof n&&"object"==typeof e?e.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof n?n.postscribe=o():t.postscribe=o()}},"core/src/lib/actions/helpers/unescapeHtmlCode.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-document").createElement("div");e.exports=function(e){return o.innerHTML=e,o.textContent||o.innerText||e}}},"core/src/lib/helpers/findPageScript.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-document"),a=function(e){for(var n=o.querySelectorAll("script"),t=0;t<n.length;t++){var a=n[t];if(e.test(a.src))return a}},r=function(){return a(new RegExp(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/))};e.exports={getTurbine:r,byRegexPattern:a}}},"core/src/lib/actions/helpers/decorators/decorateGlobalJavaScriptCode.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-promise");e.exports=function(e,n){return{code:"<script>\n"+n+"\n</script>",promise:o.resolve()}}}},"core/src/lib/actions/helpers/decorators/decorateNonGlobalJavaScriptCode.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-promise"),a=0;e.exports=function(e,n){var t="_runScript"+ ++a,r=new o((function(n,a){_satellite[t]=function(r){delete _satellite[t],new o((function(n){n(r.call(e.event.element,e.event,e.event.target,o))})).then(n,a)}}));return{code:'<script>_satellite["'+t+'"](function(event, target, Promise) {\n'+n+"\n});</script>",promise:r}}}},"core/src/lib/actions/helpers/decorators/decorateHtmlCode.js":{script:function(e,n,t,o){"use strict";var a=t("@adobe/reactor-promise"),r=0,i={};window._satellite=window._satellite||{},window._satellite._onCustomCodeSuccess=function(e){var n=i[e];n&&(delete i[e],n.resolve())},window._satellite._onCustomCodeFailure=function(e){var n=i[e];n&&(delete i[e],n.reject())};var s=function(e){return-1!==e.indexOf("${reactorCallbackId}")},l=function(e,n){return e.replace(/\${reactorCallbackId}/g,n)},c=function(e){return e.settings.isExternal};e.exports=function(e,n){var t;return c(e)&&(n=o.replaceTokens(n,e.event)),s(n)?(t=new a((function(e,n){i[String(r)]={resolve:e,reject:n}})),n=l(n,r),r+=1):t=a.resolve(),{code:n,promise:t}}}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-load-script"),a=t("@adobe/reactor-promise"),r=t("../../helpers/findPageScript").byRegexPattern,i={},s={},l=function(e){return s[e]||(s[e]=o(e)),s[e]};_satellite.__registerScript=function(e,n){var t;if(document.currentScript)t=document.currentScript.getAttribute("src");else{var o=new RegExp(".*"+e+".*");t=r(o).getAttribute("src")}i[t]=n},e.exports=function(e){return i[e]?a.resolve(i[e]):new a((function(n){l(e).then((function(){n(i[e])}),(function(){n()}))}))}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-window"),a=t("@adobe/reactor-document"),r=-1!==o.navigator.appVersion.indexOf("MSIE 10"),i="WINDOW_LOADED",s="DOM_READY",l="PAGE_BOTTOM",c=[l,s,i],m=function(e,n){return{element:e,target:e,nativeEvent:n}},d={};c.forEach((function(e){d[e]=[]}));var u=function(e,n){c.slice(0,p(e)+1).forEach((function(e){g(n,e)}))},f=function(){return"complete"===a.readyState?i:"interactive"===a.readyState?r?null:s:void 0},p=function(e){return c.indexOf(e)},g=function(e,n){d[n].forEach((function(n){w(e,n)})),d[n]=[]},w=function(e,n){var t=n.trigger,o=n.syntheticEventFn;t(o?o(e):null)};o._satellite=o._satellite||{},o._satellite.pageBottom=u.bind(null,l),a.addEventListener("DOMContentLoaded",u.bind(null,s),!0),o.addEventListener("load",u.bind(null,i),!0),o.setTimeout((function(){var e=f();e&&u(e)}),0),e.exports={registerLibraryLoadedTrigger:function(e){e()},registerPageBottomTrigger:function(e){d[l].push({trigger:e})},registerDomReadyTrigger:function(e){d[s].push({trigger:e,syntheticEventFn:m.bind(null,a)})},registerWindowLoadedTrigger:function(e){d[i].push({trigger:e,syntheticEventFn:m.bind(null,o)})}}}},"core/src/lib/events/helpers/createBubbly.js":{script:function(e,n,t){"use strict";var o=t("./weakMap"),a=t("./matchesProperties"),r=t("./matchesSelector");e.exports=function(){var e=[],n=new o,t={addListener:function(n,t){e.push({settings:n,callback:t})},evaluateEvent:function(t,o){if(e.length&&!n.has(t)){for(var i=t.target,s=!1;i;){for(var l=!1,c=!1,m=0;m<e.length;m++){var d=e[m],u=d.settings.elementSelector,f=d.settings.elementProperties;if((!1!==d.settings.bubbleFireIfChildFired||!s)&&(i===t.target||!1!==d.settings.bubbleFireIfParent)&&(i===t.target||u||f&&Object.keys(f).length)&&(!u||r(i,u))&&(!f||a(i,f))){var p={};o?Object.keys(t).forEach((function(e){p[e]=t[e]})):p.nativeEvent=t,p.element=i,p.target=t.target,!1!==d.callback(p)&&(c=!0,d.settings.bubbleStop&&(l=!0))}}if(l)break;c&&(s=!0),i=i.parentNode}n.set(t,!0)}},__reset:function(){e=[]}};return t}}},"core/src/lib/events/helpers/weakMap.js":{script:function(e,n,t){"use strict";var o=t("@adobe/reactor-window").WeakMap;if(void 0===o){var a=Object.defineProperty,r=Date.now()%1e9;(o=function(){this.name="__st"+(1e9*Math.random()>>>0)+r+++"__"}).prototype={set:function(e,n){var t=e[this.name];return t&&t[0]===e?t[1]=n:a(e,this.name,{value:[e,n],writable:!0}),this},get:function(e){var n;return(n=e[this.name])&&n[0]===e?n[1]:void 0},delete:function(e){var n=e[this.name];return!(!n||n[0]!==e||(n[0]=n[1]=void 0,0))},has:function(e){var n=e[this.name];return!!n&&n[0]===e}}}e.exports=o}},"core/src/lib/events/helpers/matchesProperties.js":{script:function(e,n,t){"use strict";var o=t("./../../helpers/textMatch"),a=function(e,n){return"@text"===n||"innerText"===n?e.textContent||e.innerText:n in e?e[n]:e.getAttribute?e.getAttribute(n):void 0};e.exports=function(e,n){return!n||n.every((function(n){var t=a(e,n.name),r=n.valueIsRegex?new RegExp(n.value,"i"):n.value;return o(t,r)}))}}},"core/src/lib/events/helpers/matchesSelector.js":{script:function(e,n,t,o){"use strict";e.exports=function(e,n){var t=e.matches||e.msMatchesSelector;if(t)try{return t.call(e,n)}catch(e){return o.logger.warn("Matching element failed. "+n+" is not a valid selector."),!1}return!1}}},"core/src/lib/helpers/textMatch.js":{script:function(e){"use strict";e.exports=function(e,n){if(null==n)throw new Error("Illegal Argument: Pattern is not present");return null!=e&&("string"==typeof n?e===n:n instanceof RegExp&&n.test(e))}}}}},"adobe-alloy":{displayName:"Adobe Experience Platform Web SDK",hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EP9b2d0d56e6f54e59b8eeea740ab515a3/",settings:{instances:[{name:"alloy",edgeConfigId:"10c5bc11-fba6-47f8-a42c-87d0274eafde",stagingEdgeConfigId:"f3d776b2-14fc-4c89-9c70-2b40efca8e17",clickCollectionEnabled:!1,developmentEdgeConfigId:"f3d776b2-14fc-4c89-9c70-2b40efca8e17",thirdPartyCookiesEnabled:!1,personalizationStorageEnabled:!0,autoCollectPropositionInteractions:{TGT:"always"}}],components:{eventMerge:!1}},modules:{"adobe-alloy/dist/lib/dataElements/xdmObject/index.js":{name:"xdm-object",displayName:"XDM object",script:function(e){"use strict";e.exports=e=>e.data}},"adobe-alloy/dist/lib/dataElements/identityMap/index.js":{name:"identity-map",displayName:"Identity map",script:function(e,n,t,o){"use strict";const a=t("./createIdentityMap")({logger:o.logger});e.exports=e=>a(e)}},"adobe-alloy/dist/lib/actions/sendEvent/index.js":{name:"send-event",displayName:"Send event",script:function(e,n,t,o){"use strict";var a;const r=t("./createSendEvent"),i=t("../../instanceManager/index"),{sendEventCallbackStorage:s}=t("../../index"),l=t("../../utils/createGetConfigOverrides");e.exports=r({instanceManager:i,sendEventCallbackStorage:s,getConfigOverrides:l(null===(a=o.environment)||void 0===a?void 0:a.stage)})}},"adobe-alloy/dist/lib/instanceManager/index.js":{script:function(e,n,t,o){"use strict";var a;const{createCustomInstance:r,createEventMergeId:i,components:s}=t("../alloy"),l=t("./createInstanceManager"),c=t("./injectWrapOnBeforeEventSend"),m=t("../utils/createGetConfigOverrides"),d=c({version:"2.29.0"});e.exports=l({turbine:o,window:window,createCustomInstance:r,components:s,createEventMergeId:i,orgId:_satellite.company.orgId,wrapOnBeforeEventSend:d,getConfigOverrides:m(null===(a=o.environment)||void 0===a?void 0:a.stage)})}},"adobe-alloy/dist/lib/dataElements/identityMap/createIdentityMap.js":{script:function(e){"use strict";e.exports=({logger:e})=>n=>Object.keys(n).reduce(((t,o)=>{const a=n[o].filter((({id:n},t)=>{const a="string"==typeof n&&n.length;return a||e.log(`The identifier at ${o}[${t}] was removed from the identity map because its ID is not a populated string. Its ID value is:`,n),a}));return a.length?t[o]=a:e.log(`The ${o} namespace was removed from the identity map because it contains no identifiers.`),t}),{})}},"adobe-alloy/dist/lib/actions/sendEvent/createSendEvent.js":{script:function(e,n,t){"use strict";const o=t("../../utils/clone");e.exports=({instanceManager:e,sendEventCallbackStorage:n,getConfigOverrides:t})=>a=>{const{instanceName:r,...i}=a;i.edgeConfigOverrides=t(i);const s=e.getInstance(r);if(!s)throw new Error(`Failed to send event for instance "${r}". No matching instance was configured with this name.`);return i.xdm&&(i.xdm=o(i.xdm)),i.data&&(i.data=o(i.data)),s("sendEvent",i).then((e=>{n.triggerEvent(e)}))}}},"adobe-alloy/dist/lib/index.js":{script:function(e,n,t){"use strict";const o=t("./createEventMergeIdCache"),a=t("./createSendEventCallbackStorage"),r=t("./createMediaCollectionSessionStorage"),i=t("./createVariableStore");n.eventMergeIdCache=o(),n.sendEventCallbackStorage=a(),n.mediaCollectionSessionStorage=r(),n.variableStore=i()}},"adobe-alloy/dist/lib/utils/createGetConfigOverrides.js":{script:function(e){"use strict";const n=e=>n=>{var t,o,a,r;const{edgeConfigOverrides:i}=n;let s;if(i){if(i[e])s={...i[e]};else{if(i.development||i.staging||i.production)return;s=i}if(0!==Object.keys(s).length&&!1!==s.enabled){if(delete s.enabled,(null===(t=s.com_adobe_analytics)||void 0===t||null===(t=t.reportSuites)||void 0===t?void 0:t.length)>0&&(s.com_adobe_analytics.reportSuites=s.com_adobe_analytics.reportSuites.flatMap((e=>e.includes(",")?e.split(/,\s*/gi):e)).map((e=>e.trim())).filter(Boolean)),void 0!==(null===(o=s.com_adobe_identity)||void 0===o?void 0:o.idSyncContainerId)&&null!==(null===(a=s.com_adobe_identity)||void 0===a?void 0:a.idSyncContainerId)&&"string"==typeof(null===(r=s.com_adobe_identity)||void 0===r?void 0:r.idSyncContainerId)){const e=parseInt(s.com_adobe_identity.idSyncContainerId.trim(),10);if(Number.isNaN(e))throw new Error(`The ID sync container ID "${s.com_adobe_identity.idSyncContainerId}" is not a valid integer.`);s.com_adobe_identity.idSyncContainerId=e}return s}}};e.exports=n}},"adobe-alloy/dist/lib/utils/clone.js":{script:function(e){"use strict";e.exports=e=>JSON.parse(JSON.stringify(e))}},
"adobe-alloy/dist/lib/alloy.js":{script:function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)e[o]=t[o]}return e}function r(e,n){function t(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=a({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in r)r[s]&&(i+="; "+s,!0!==r[s]&&(i+="="+r[s].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+i}}function o(n){if("undefined"!=typeof document&&(!arguments.length||n)){for(var t=document.cookie?document.cookie.split("; "):[],o={},a=0;a<t.length;a++){var r=t[a].split("="),i=r.slice(1).join("=");try{var s=decodeURIComponent(r[0]);if(o[s]=e.read(i,s),n===s)break}catch(e){}}return n?o[n]:o}}return Object.create({set:t,get:o,remove:function(e,n){t(e,"",a({},n,{expires:-1}))},withAttributes:function(e){return r(this.converter,a({},this.attributes,e))},withConverter:function(e){return r(a({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}function i(e,n=0){return(ct[e[n+0]]+ct[e[n+1]]+ct[e[n+2]]+ct[e[n+3]]+"-"+ct[e[n+4]]+ct[e[n+5]]+"-"+ct[e[n+6]]+ct[e[n+7]]+"-"+ct[e[n+8]]+ct[e[n+9]]+"-"+ct[e[n+10]]+ct[e[n+11]]+ct[e[n+12]]+ct[e[n+13]]+ct[e[n+14]]+ct[e[n+15]]).toLowerCase()}function s(){if(!mt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");mt=crypto.getRandomValues.bind(crypto)}return mt(dt)}function l(e,n,t){if(ut.randomUUID&&!n&&!e)return ut.randomUUID();const o=(e=e||{}).random??e.rng?.()??s();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){if((t=t||0)<0||t+16>n.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)n[t+e]=o[e];return n}return i(o)}function c(e){return"object"==typeof e||void 0===e}function m(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&o===String(t[e]).toLowerCase())return!0;return!1}}}function d(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&o===String(t[e]).toLowerCase())return!1;return!0}}}function u(){return{matches:(e,n)=>void 0!==e[n]&&null!==e[n]}}function f(){return{matches:(e,n)=>void 0===e[n]||null===e[n]}}function p(e){return"number"==typeof e}function g(){return{matches:(e,n,t=[])=>{const o=e[n];if(!p(o))return!1;for(let e=0;e<t.length;e+=1)if(p(t[e])&&o>t[e])return!0;return!1}}}function w(){return{matches:(e,n,t=[])=>{const o=e[n];if(!p(o))return!1;for(let e=0;e<t.length;e+=1)if(p(t[e])&&o>=t[e])return!0;return!1}}}function h(){return{matches:(e,n,t=[])=>{const o=e[n];if(!p(o))return!1;for(let e=0;e<t.length;e+=1)if(p(t[e])&&o<t[e])return!0;return!1}}}function y(){return{matches:(e,n,t=[])=>{const o=e[n];if(!p(o))return!1;for(let e=0;e<t.length;e+=1)if(p(t[e])&&o<=t[e])return!0;return!1}}}function v(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&-1!==o.indexOf(String(t[e]).toLowerCase()))return!0;return!1}}}function b(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&-1!==o.indexOf(String(t[e]).toLowerCase()))return!1;return!0}}}function I(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&o.startsWith(String(t[e]).toLowerCase()))return!0;return!1}}}function S(){return{matches:(e,n,t=[])=>{if(c(e[n]))return!1;const o=String(e[n]).toLowerCase();for(let e=0;e<t.length;e+=1)if(!c(t[e])&&o.endsWith(t[e].toLowerCase()))return!0;return!1}}}function _(e){return Du[e]}function C(e){return void 0===e}function T(e){return Object.keys(e)}function D(e,n,t){switch(n){case _u.GREATER_THAN:return e>t;case _u.GREATER_THAN_OR_EQUAL_TO:return e>=t;case _u.LESS_THAN:return e<t;case _u.LESS_THAN_OR_EQUAL_TO:return e<=t;case _u.EQUALS:return e===t;case _u.NOT_EQUALS:return e!==t;default:return!1}}function k(e,n){for(let t=0;t<n.length;t+=1)if(!C(e[n[t]]))return e[n[t]]}function x(e,n){const t=T(e);for(let o=0;o<t.length;o+=1){const a=t[o],{event:r={}}=n;if(r[t[o]]!==e[a])return!1}return!0}function P(e,n,t,o){return e.reduce(((e,a)=>{const r=k(a,ku);if(!r)return e;const i=n.events[r];if(!i)return e;const s=k(a,xu);if(!s)return e;const l=i[s];if(!l)return e;if(!x(a,l))return e;const{count:c=1}=l;return C(t)||C(o)||l.timestamp>=t&&l.timestamp<=o?e+c:e}),0)}function A(e,n,t,o){let a=t;return e.every((e=>{const t=k(e,ku);if(!t)return!1;const r=n.events[t];if(!r)return!1;const i=k(e,xu);if(!i)return!1;const s=r[i];if(!x(e,s))return!1;if(null===s||C(s)||0===s.count)return!1;const l=(C(a)||s.timestamp>=a)&&(C(o)||s.timestamp<=o);return a=s.timestamp,l}))?1:0}function O(e,n){let t=!0;for(let o=0;o<n.length;o+=1)t=t&&n[o].evaluate(e);return t}function E(e,n){let t=!1;for(let o=0;o<n.length;o+=1)if(t=t||n[o].evaluate(e),t)return!0;return!1}function N(e,n,t){return{version:e,rules:n,metadata:t}}function L(e,n,t){return{key:t,execute:t=>e.evaluate(t)?n:[],toString:()=>`Rule{condition=${e}, consequences=${n}}`}}function R(e,n){return{evaluate:e=>n.evaluate(e),toString:()=>`Condition{type=${e}, definition=${n}}`}}function U(e,n,t){return{id:e,type:n,detail:t}}function V(e,n){return{evaluate:t=>Cu.AND===e?O(t,n):Cu.OR===e&&E(t,n)}}function j(e,n,t){return{evaluate:o=>{const a=_(n);return!!a&&a.matches(o,e,t)}}}function q(e,n,t,o,a,r){return{evaluate:i=>{let s;return s=Tu.ORDERED===r?A(e,i,o,a):P(e,i,o,a),D(s,n,t)}}}function M(e,n){return Object.assign(e,n)}function F(e){const{key:n,matcher:t,values:o}=e;return j(n,t,o)}function B(e){const{logic:n,conditions:t}=e;return V(n,t.map(H))}function z(e){const{events:n,from:t,to:o,matcher:a,value:r,searchType:i}=e;return q(n,a,r,t,o,i)}function H(e){const{type:n,definition:t}=e;if(Su.MATCHER===n)return R(n,F(t));if(Su.GROUP===n)return R(n,B(t));if(Su.HISTORICAL===n)return R(n,z(t));throw new Error("Can not parse condition")}function $(e){const{id:n,type:t,detail:o}=e;return U(n,t,o)}function W(e){const{condition:n,consequences:t,key:o}=e;return L(H(n),t.map($),o)}function G(e){if(e)return{provider:e.provider,providerData:M({},e.providerData)}}function Q(e){const{version:n,rules:t,metadata:o}=e;return N(n,t.map(W),G(o))}function J(e){return{provider:Au,execute:n=>e.map((e=>e.execute(n))).filter((e=>e.length>0))}}function X(e){const{providerData:n}=e;if(!n)throw new Error("Provider data is missing in metadata");const{identityTemplate:t,buckets:o}=n;if(!t)throw new Error("Identity template is missing in provider data");if(!o)throw new Error("Buckets is missing in provider data")}function Y(e){const{xdm:n}=e;if(!n)throw new Error("XDM object is missing in the context");const{identityMap:t}=n;if(!t)throw new Error("Identity map is missing in the XDM object");const o=t[Ou];if(!o)throw new Error("ECID identity namespace is missing in the identity map");if(!Array.isArray(o)||0===o.length)throw new Error("ECID identities array is empty or not an array");const a=o[0].id;if(!a)throw new Error("ECID identity is missing in the identities array");return a}function K(e,n,t){const{providerData:o}=t,{identityTemplate:a}=o;return a.replace(Eu,n).replace(Nu,e)}function Z(e){return!C(e)}function ee(e,n=(e=>e[0])){const t={};return function(...o){const a=n(o);return Z(t[a])||(t[a]=e(...o)),t[a]}}function ne(e,n){const t=65535&n;return((n-t)*e|0)+(t*e|0)|0}function te(e,n=0){let t;const o=e.length,a=3432918353,r=461845907;let i=n;const s=-2&o;for(let n=0;n<s;n+=2)t=e.charCodeAt(n)|e.charCodeAt(n+1)<<16,t=ne(t,a),t=(131071&t)<<15|t>>>17,t=ne(t,r),i^=t,i=(524287&i)<<13|i>>>19,i=5*i+3864292196|0;return o%2==1&&(t=e.charCodeAt(s),t=ne(t,a),t=(131071&t)<<15|t>>>17,t=ne(t,r),i^=t),i^=o<<1,i^=i>>>16,i=ne(i,2246822507),i^=i>>>13,i=ne(i,3266489909),i^=i>>>16,i}function oe(e,n){const t=Lu(e),o=Math.abs(t)%n/n*Ru;return Math.round(o*Ru)/Ru}function ae(e,n,t){return{allocation:Uu(e,n),...t}}function re(e){const n={};for(let t=0;t<e.length;t+=1){const o=e[t];o.key&&(n[o.key]||(n[o.key]=[]),n[o.key].push(o))}return n}function ie(e,n){return n.map((n=>n.execute(e))).filter((e=>e.length>0))}function se(e,n){X(n);const t=e.filter((e=>!e.key)),o=re(e),{buckets:a}=n.providerData;return{provider:Pu,execute:e=>{const r=Y(e),i=ie(e,t),s=T(o),l=[];for(let t=0;t<s.length;t+=1){const i=s[t],c=o[i],m=ie(ae(K(r,i,n),a,e),c);l.push(...m)}return[...i,...l]}}}function le(e,n){if(!n)return J(e);const{provider:t}=n;return t===Pu?se(e,n):J(e)}function ce(e){const{rules:n,metadata:t}=Q(e);return le(n,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.deepAssign=n.createEventMergeId=n.createCustomInstance=n.components=void 0;var me=o(t("@adobe/reactor-query-string")),de=e=>null==e,ue=e=>!de(e)&&!Array.isArray(e)&&"object"==typeof e,fe=(...e)=>e.length<2?Object.assign(...e):e.reduce(((e,n)=>(ue(n)&&Object.keys(n).forEach((t=>{Array.isArray(n[t])?Array.isArray(e[t])?e[t].push(...n[t]):e[t]=[...n[t]]:e[t]=n[t]})),e))),pe=r({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),ge={get:pe.get.bind(pe),set:pe.set.bind(pe),remove:pe.remove.bind(pe),withConverter:pe.withConverter.bind(pe)};const we=(e,n)=>{Object.keys(n).forEach((t=>{ue(e[t])&&ue(n[t])?we(e[t],n[t]):e[t]=n[t]}))};var he=(e,...n)=>{if(de(e))throw new TypeError('deepAssign "target" cannot be null or undefined');const t=Object(e);return n.forEach((e=>we(t,Object(e)))),t};n.deepAssign=he;var ye=(e,n)=>t=>{const o=n.split(".").reduce(((e,n)=>(e[n]=e[n]||{},e[n])),e);he(o,t)},ve=()=>{const e=[];return{add(n){e.push(n)},call:(...n)=>Promise.all(e.map((e=>e(...n))))}},be=({logger:e,cookieJar:n})=>({...n,set(t,o,a){e.info("Setting cookie",{name:t,value:o,...a}),n.set(t,o,a)}}),Ie=()=>{let e=0,n=Promise.resolve();return{addTask(t){e+=1;const o=()=>t().finally((()=>{e-=1}));return n=n.then(o,o),n},get length(){return e}}};const Se=(()=>{const e=[];for(let n=0;n<256;n++){let t=n;for(let e=0;e<8;e++)t=1&t?3988292384^t>>>1:t>>>1;e.push(t)}return function(n,t){n=unescape(encodeURIComponent(n)),t||(t=0),t=~t;for(let o=0;o<n.length;o++){const a=255&(t^n.charCodeAt(o));t=t>>>8^e[a]}return(t=~t)>>>0}})();var _e=()=>{const e={};return e.promise=new Promise(((n,t)=>{e.resolve=n,e.reject=t})),e};const Ce=(e,n)=>e===n,Te=(e,n,t)=>{for(let o=0;o<e.length;o+=1)if(t(e[o],n))return o;return-1};var De=(e,n=Ce)=>e.filter(((t,o)=>Te(e,t,n)===o)),ke=(e,n)=>e.appendChild(n);const xe=(e,n)=>{Object.keys(n).forEach((t=>{if("style"===t&&ue(n[t])){const o=n[t];Object.keys(o).forEach((n=>{e.style[n]=o[n]}))}else e[t]=n[t]}))};var Pe=(e,n={},t={},o=[],a=document)=>{const r=a.createElement(e);return Object.keys(n).forEach((e=>{r.setAttribute(e,n[e])})),xe(r,t),o.forEach((e=>ke(r,e))),r};const Ae="BODY",Oe="IFRAME",Ee="IMG",Ne="DIV",Le="STYLE",Re="SCRIPT",Ue="HEAD";var Ve=({src:e,currentDocument:n=document})=>new Promise(((t,o)=>{Pe(Ee,{src:e},{onload:t,onerror:o,onabort:o},[],n)})),je=e=>"function"==typeof e,qe=e=>Array.isArray(e)&&e.length>0,Me=e=>Array.isArray(e)?e:null==e?[]:[].slice.call(e);const Fe=/^\s*>/;var Be=(e,n)=>Fe.test(n)?Me(e.querySelectorAll(`:scope ${n}`)):Me(e.querySelectorAll(n)),ze=":shadow";const He=e=>e.split(ze),$e=(e,n)=>{const t=n;return t.startsWith(">")?`${e instanceof Element||e instanceof Document?":scope":":host"} ${t}`:t};var We=(e,n)=>{const t=He(n);if(t.length<2)return Be(e,n);let o=e;for(let e=0;e<t.length;e+=1){const n=t[e].trim();if(""===n&&o.shadowRoot){o=o.shadowRoot;continue}const a=$e(o,n),r=Be(o,a);if(0===r.length||!r[0]||!r[0].shadowRoot)return r;o=r[0].shadowRoot}},Ge=e=>-1!==e.indexOf(ze),Qe=(e,n=document)=>Ge(e)?We(n,e):Be(n,e);const Je="MutationObserver",Xe="requestAnimationFrame",Ye={childList:!0,subtree:!0},Ke="visibilityState",Ze="visible",en=100,nn=5e3,tn=e=>new Error(`Could not find: ${e}`),on=e=>new Promise(e),an=e=>je(e[Je]),rn=(e,n,t,o,a)=>on(((r,i)=>{let s;const l=new e[Je]((()=>{const e=a(t);qe(e)&&(l.disconnect(),s&&clearTimeout(s),r(e))}));s=setTimeout((()=>{l.disconnect(),i(tn(t))}),o),l.observe(n,Ye)})),sn=e=>e[Ke]===Ze,ln=(e,n,t,o)=>on(((a,r)=>{const i=()=>{const t=o(n);qe(t)?a(t):e[Xe](i)};i(),setTimeout((()=>{r(tn(n))}),t)})),cn=(e,n,t)=>on(((o,a)=>{const r=()=>{const n=t(e);qe(n)?o(n):setTimeout(r,en)};r(),setTimeout((()=>{a(tn(e))}),n)}));var mn=(e,n=Qe,t=nn,o=window,a=document)=>{const r=n(e);return qe(r)?Promise.resolve(r):an(o)?rn(o,a,e,t,n):sn(a)?ln(o,e,t,n):cn(e,t,n)},dn=(e,n)=>n.matches?n.matches(e):n.msMatchesSelector(e),un=e=>{const n=e.parentNode;return n?n.removeChild(e):null};const fn={name:"Adobe Alloy"},pn={style:{display:"none",width:0,height:0}};var gn=({appendNode:e=ke,awaitSelector:n=mn,createNode:t=Pe,fireImage:o=Ve}={})=>{const a=o;let r;const i=()=>n(Ae).then((([n])=>r||(r=t(Oe,fn,pn),e(n,r)))),s=({src:e})=>i().then((n=>{const t=n.contentWindow.document;return o({src:e,currentDocument:t})}));return e=>{const{hideReferrer:n,url:t}=e;return n?s({src:t}):a({src:t})}},wn=e=>ue(e)&&0===Object.keys(e).length;const hn=(e,n)=>de(e)||!ue(e)?e:Object.keys(e).reduce(((t,o)=>{const a=e[o];if(ue(a)){const e=hn(a,n);return wn(e)?t:{...t,[o]:e}}return n(a)?{...t,[o]:a}:t}),{});var yn="com.adobe.alloy.",vn=(e,n)=>e.slice(-n);const bn=`${yn}getTld`;var In=(e,n)=>{let t="";const o=e.location.hostname.toLowerCase().split(".");let a=1;for(;a<o.length&&!n.get(bn);)a+=1,t=vn(o,a).join("."),n.set(bn,bn,{domain:t});return n.remove(bn,{domain:t}),t},Sn="kndctr",_n=e=>e.replace("@","_"),Cn=(e,n)=>`${Sn}_${_n(e)}_${n}`,Tn=(e,n)=>{const t={};return e.forEach((e=>{const o=n(e);t[o]||(t[o]=[]),t[o].push(e)})),t};const Dn="Chrome",kn="Edge",xn="EdgeChromium",Pn="Firefox",An="IE",On="Safari",En="Unknown";var Nn=e=>{let n,t=!1;return()=>(t||(t=!0,n=e()),n)};const Ln=[Dn,kn,xn,An,En];var Rn=({getBrowser:e})=>Nn((()=>Ln.includes(e())));const Un="identity",Vn="consent",jn="cluster";var qn=({orgId:e})=>{const n=Cn(e,Un);return()=>Boolean(ge.get(n))};const Mn=(e,n)=>{const t=Object.keys(e);for(let o=0;o<t.length;o+=1){const a=t[o];if(e[a].test(n))return a}return En};var Fn=({userAgent:e})=>Nn((()=>Mn({[kn]:/Edge\/([0-9\._]+)/,[xn]:/Edg\/([0-9\.]+)/,[Dn]:/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/,[Pn]:/Firefox\/([0-9\.]+)(?:\s|$)/,[An]:/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/,[On]:/Version\/([0-9\._]+).*Safari/},e)));const Bn=(e,n,t)=>({getItem(o){try{return e[n].getItem(t+o)}catch{return null}},setItem(o,a){try{return e[n].setItem(t+o,a),!0}catch{return!1}},clear(){try{return Object.keys(e[n]).forEach((o=>{o.startsWith(t)&&e[n].removeItem(o)})),!0}catch{return!1}}});var zn=e=>n=>{const t=yn+n;return{session:Bn(e,"sessionStorage",t),persistent:Bn(e,"localStorage",t)}},Hn=(e,n)=>e.filter((e=>n.includes(e))),$n=e=>"boolean"==typeof e,Wn=e=>"number"==typeof e&&!Number.isNaN(e),Gn=e=>{const n=parseInt(e,10);return Wn(n)&&e===n},Qn=(e,n)=>0===n.indexOf(`${Sn}_${_n(e)}_`),Jn=e=>"string"==typeof e,Xn=e=>Jn(e)&&e.length>0,Yn=()=>{};const Kn=e=>{const n={},t=e.split(".");switch(t.length){case 1:n.subdomain="",n.domain=e,n.topLevelDomain="";break;case 2:n.subdomain="",n.domain=e,n.topLevelDomain=t[1];break;case 3:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=t[2];break;case 4:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=`${t[2]}.${t[3]}`}return n},Zn=e=>{try{const n=new URL(e);let t=n.pathname;return e.endsWith("/")||"/"!==t||(t=""),{host:n.hostname,path:t,query:n.search.replace(/^\?/,""),anchor:n.hash.replace(/^#/,"")}}catch{return{}}},et=(e,n=Kn)=>{Jn(e)||(e="");const t=Zn(e)||{},{host:o="",path:a="",query:r="",anchor:i=""}=t;return{path:a,query:r,fragment:i,...n(o)}};var nt=e=>{if(de(e)||"object"!=typeof e)return null;const n=hn(e,(e=>!(de(e)||!$n(e)&&!Wn(e)&&!Xn(e)&&!qe(e))));return wn(n)?null:n},tt=e=>e instanceof Error?e:new Error(e),ot=({error:e,message:n})=>{try{e.message=n}catch{}},at=({error:e,message:n})=>{const t=tt(e),o=`${n}\nCaused by: ${t.message}`;return ot({error:t,message:o}),t},rt=e=>Jn(e)&&"true"===e.toLowerCase(),it=(e,n)=>{if(Wn(e)||Jn(e)){const n=Math.round(Number(e));if(!Number.isNaN(n))return n}return n};const st=(e,n,t)=>`${e}`.padStart(n,t);var lt=e=>{const n=e.getFullYear(),t=st(e.getMonth()+1,2,"0"),o=st(e.getDate(),2,"0"),a=st(e.getHours(),2,"0"),r=st(e.getMinutes(),2,"0"),i=st(e.getSeconds(),2,"0"),s=st(e.getMilliseconds(),3,"0"),l=it(e.getTimezoneOffset(),0);return`${n}-${t}-${o}T${a}:${r}:${i}.${s}${l>0?"-":"+"}${st(Math.floor(Math.abs(l)/60),2,"0")}:${st(Math.abs(l)%60,2,"0")}`};const ct=[];for(let e=0;e<256;++e)ct.push((e+256).toString(16).slice(1));let mt;const dt=new Uint8Array(16);var ut={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};const ft=e=>function(n,t){return null==n?n:e.call(this,n,t)},pt=(e,n)=>function(t,o){return n.call(this,e.call(this,t,o),o)},gt=(e,n)=>function(t,o){const a=[],r=[e,n].reduce(((e,n)=>{try{return n.call(this,e,o)}catch(n){return a.push(n),e}}),t);if(a.length)throw new Error(a.join("\n"));return r},wt=(e,n,t)=>Object.assign(pt(e,n),e,t),ht=(e,n,t)=>Object.assign(pt(e,ft(n)),e,t),yt=(e,n,t)=>Object.assign(gt(ft(n),e),e,t),vt=(e,n,t,o)=>{if(!e)throw new Error(`'${t}': Expected ${o}, but got ${JSON.stringify(n)}.`)};var bt=(e,n)=>(vt($n(e),e,n,"true or false"),e),It=(e,n)=>(vt(je(e),e,n,"a function"),e),St=(e,n)=>function(t,o){let a;const r=e.find((e=>{try{return a=e.call(this,t,o),!0}catch{return!1}}));return vt(r,t,o,n),a},_t=e=>function(n,t){vt(Array.isArray(n),n,t,"an array");const o=[],a=n.map(((a,r)=>{try{return e.call(this,a,`${t}[${r}]`,n)}catch(e){return void o.push(e.message)}}));if(o.length)throw new Error(o.join("\n"));return a},Ct=e=>n=>null==n?e:n,Tt=(e="This field has been deprecated")=>function(n,t){let o=e;return void 0!==n&&(t&&(o=`'${t}': ${o}`),this&&this.logger&&this.logger.warn(o)),n},Dt=e=>(n,t)=>(vt(n===e,n,t,`${e}`),n),kt=e=>function(n,t){vt(ue(n),n,t,"an object");const o=[],a={};if(Object.keys(n).forEach((r=>{const i=n[r],s=t?`${t}.${r}`:r;try{const n=e.call(this,i,s);void 0!==n&&(a[r]=n)}catch(e){o.push(e.message)}})),o.length)throw new Error(o.join("\n"));return a},xt=(e,n)=>(t,o)=>(vt(t>=n,t,o,`${e} greater than or equal to ${n}`),t),Pt=(e,n)=>(t,o)=>(vt(t<=n,t,o,`${e} less than or equal to ${n}`),t),At=e=>(n,t)=>{const o=[];if(Object.keys(n).forEach((n=>{if(!e[n]){const e=t?`${t}.${n}`:n;o.push(`'${e}': Unknown field.`)}})),o.length)throw new Error(o.join("\n"));return n},Ot=e=>(n,t)=>(ue(n)?vt(!wn(n),n,t,e):vt(n.length>0,n,t,e),n),Et=e=>function(n,t){vt(ue(n),n,t,"an object");const o=[],a={};if(Object.keys(e).forEach((r=>{const i=n[r],s=e[r],l=t?`${t}.${r}`:r;try{const e=s.call(this,i,l);void 0!==e&&(a[r]=e)}catch(e){o.push(e.message)}})),Object.keys(n).forEach((e=>{Object.prototype.hasOwnProperty.call(a,e)||(a[e]=n[e])})),o.length)throw new Error(o.join("\n"));return a},Nt=(e,n,t)=>function(o,a){vt(ue(o),o,a,"an object");const{[e]:r,[t]:i,...s}=o,l=n(r,a);if(void 0!==l){let n=`The field '${e}' is deprecated. Use '${t}' instead.`;if(a&&(n=`'${a}': ${n}`),void 0!==i&&i!==l)throw new Error(n);this&&this.logger&&this.logger.warn(n)}return{[t]:i||l,...s}},Lt=()=>{const e=[];return(n,t)=>(vt(-1===e.indexOf(n),n,t,"a unique value across instances"),e.push(n),n)},Rt=e=>{const n=Object.create(null);for(let t=0;t<e.length;t+=1){const o=e[t];if(o in n)return!1;n[o]=!0}return!0},Ut=()=>(e,n)=>(vt(Rt(e),e,n,"array values to be unique"),e);const Vt=/^[a-z0-9.-]{1,}$/i;var jt=(e,n)=>(vt(Vt.test(e),e,n,"a valid domain"),e),qt=(e,n)=>(vt(Gn(e),e,n,"an integer"),e),Mt=(e,n)=>(vt(Wn(e),e,n,"a number"),e),Ft=e=>{try{return null!==RegExp(e)}catch{return!1}},Bt=(e,n)=>(vt(Ft(e),e,n,"a regular expression"),e),zt=(e,n)=>{if(null==e)throw new Error(`'${n}' is a required option`);return e},Ht=(e,n)=>(vt(Jn(e),e,n,"a string"),e),$t=e=>(n,t)=>(vt(e.test(n),n,t,`does not match the ${e.toString()}`),n);const Wt=e=>e;Wt.default=function(e){return wt(this,Ct(e))},Wt.required=function(){return wt(this,zt)},Wt.deprecated=function(e){return wt(this,Tt(e))};const Gt=function(){return ht(this,jt)},Qt=function(e){return ht(this,xt("an integer",e))},Jt=function(e){return ht(this,xt("a number",e))},Xt=function(e){return ht(this,Pt("a number",e))},Yt=function(){return ht(this,qt,{minimum:Qt})},Kt=function(){return ht(this,Ot("a non-empty string"))},Zt=function(){return ht(this,Ot("a non-empty array"))},eo=function(){return ht(this,Ot("a non-empty object"))},no=function(){return ht(this,Bt)},to=function(e){return ht(this,$t(e))},oo=function(){return ht(this,Lt())},ao=function(){return ht(this,Ut())},ro=function(e,n){return wt(this,St(e,n))},io=function(){return this},so=function(e){return ht(this,_t(e),{nonEmpty:Zt,uniqueItems:ao})},lo=function(){return ht(this,bt)},co=function(){return ht(this,It)},mo=function(e){return ht(this,Dt(e))},uo=function(){return ht(this,Mt,{minimum:Jt,maximum:Xt,integer:Yt,unique:oo})},fo=function(e){return ht(this,kt(e),{nonEmpty:eo})},po=e=>({noUnknownFields:function(){return ht(this,At(e))},nonEmpty:eo,concat:function(n){const t={...e,...n.schema};return ht(this,n,po(t))},renamed:function(e,n,t){return yt(this,Nt(e,n,t))},schema:e}),go=function(e){return ht(this,Et(e),po(e))},wo=function(){return ht(this,Ht,{regexp:no,domain:Gt,nonEmpty:Kt,unique:oo,matches:to})},ho=ro.bind(Wt),yo=io.bind(Wt),vo=so.bind(Wt),bo=lo.bind(Wt),Io=co.bind(Wt),So=mo.bind(Wt),_o=uo.bind(Wt),Co=fo.bind(Wt),To=go.bind(Wt),Do=wo.bind(Wt),ko=function(...e){return ho(e.map(So),`one of these values: ${JSON.stringify(e)}`)};var xo=Co(vo(To({authenticatedState:ko("ambiguous","authenticated","loggedOut"),id:Do(),namespace:To({code:Do()}).noUnknownFields(),primary:bo(),xid:Do()}).noUnknownFields()).required()),Po=To({}),Ao="alloy_debug",Oo=({console:e,locationSearch:n,createLogger:t,instanceName:o,createNamespacedStorage:a,getMonitors:r})=>{const i=me.default.parse(n),s=a(`instance.${o}.`),l=s.session.getItem("debug");let c="true"===l,m=null===l;const d=()=>c,u=(e,{fromConfig:n})=>{n&&!m||(c=e),n||(s.session.setItem("debug",e.toString()),m=!1)};return void 0!==i[Ao]&&u(rt(i[Ao]),{fromConfig:!1}),{setDebugEnabled:u,logger:t({getDebugEnabled:d,context:{instanceName:o},getMonitors:r,console:e}),createComponentLogger:n=>t({getDebugEnabled:d,context:{instanceName:o,componentName:n},getMonitors:r,console:e})}};const Eo=["onComponentsRegistered","onBeforeEvent","onBeforeRequest","onResponse","onRequestFailure","onClick","onDecision"],No=(e,n)=>(...t)=>Promise.all(e.getLifecycleCallbacks(n).map((e=>new Promise((n=>{n(e(...t))}))))),Lo=e=>(...n)=>Promise.resolve().then((()=>e(...n)));var Ro=e=>Eo.reduce(((n,t)=>(n[t]=Lo(No(e,t)),n)),{});const Uo=(e,n)=>(...t)=>{let o;try{o=e(...t)}catch(e){throw at({error:e,message:n})}return o instanceof Promise&&(o=o.catch((e=>{throw at({error:e,message:n})}))),o};var Vo=()=>{const e={},n={},t={},o=(e,t={})=>{const o=Hn(Object.keys(n),Object.keys(t));if(o.length)throw new Error(`[ComponentRegistry] Could not register ${e} because it has existing command(s): ${o.join(",")}`);Object.keys(t).forEach((o=>{const a=t[o];a.commandName=o,a.run=Uo(a.run,`[${e}] An error occurred while executing the ${o} command.`),n[o]=a}))},a=(e,n={})=>{Object.keys(n).forEach((o=>{t[o]=t[o]||[],t[o].push(Uo(n[o],`[${e}] An error occurred while executing the ${o} lifecycle hook.`))}))};return{register(n,t){const{commands:r,lifecycle:i}=t;o(n,r),a(n,i),e[n]=t},getCommand:e=>n[e],getCommandNames:()=>Object.keys(n),getLifecycleCallbacks:e=>t[e]||[],getComponentNames:()=>Object.keys(e)}},jo=({logger:e,sendFetchRequest:n,sendBeaconRequest:t,isRequestRetryable:o,getRequestRetryDelay:a})=>({requestId:r,url:i,payload:s,useSendBeacon:l})=>{const c=JSON.stringify(s),m=JSON.parse(c);e.logOnBeforeNetworkRequest({url:i,requestId:r,payload:m});const d=(s=0)=>(l?t:n)(i,c).then((n=>{if(o({response:n,retriesAttempted:s})){const e=a({response:n,retriesAttempted:s});return new Promise((n=>{setTimeout((()=>{n(d(s+1))}),e)}))}let t;try{t=JSON.parse(n.body)}catch{}return e.logOnNetworkResponse({requestId:r,url:i,payload:m,...n,parsedBody:t,retriesAttempted:s}),{statusCode:n.statusCode,body:n.body,parsedBody:t,getHeader:n.getHeader}}));return d().catch((n=>{throw e.logOnNetworkError({requestId:r,url:i,payload:m,error:n}),at({error:n,message:"Network request failed."})}))},qo=({logger:e})=>n=>{if(n){const t=n.split(";");if(t.length>=2&&t[1].length>0)try{const e=parseInt(t[1],10);if(!Number.isNaN(e))return{regionId:e}}catch{}e.warn(`Invalid adobe edge: "${n}"`)}return{}};const Mo="in",Fo="out",Bo="pending",zo="general",Ho="declinedConsent",$o="default",Wo="initial",Go="new",Qo=e=>{const n=new Error(e);return n.code=Ho,n.message=e,n};var Jo=({logger:e})=>{const n=[],t=()=>{for(;n.length;)n.shift().resolve()},o=()=>{for(;n.length;)n.shift().reject(Qo("The user declined consent."))},a=()=>Promise.resolve(),r=()=>Promise.resolve(),i=()=>Promise.resolve(),s=()=>Promise.reject(Qo("No consent preferences have been set.")),l=()=>Promise.reject(Qo("The user declined consent.")),c=e=>{if(e)return Promise.reject(new Error("Consent is pending."));const t=_e();return n.push(t),t.promise};return{in(n){n===$o?this.awaitConsent=r:(n===Wo?e.info("Loaded user consent preferences. The user previously consented."):n===Go&&this.awaitConsent!==i&&e.info("User consented."),t(),this.awaitConsent=i)},out(n){n===$o?(e.warn("User consent preferences not found. Default consent of out will be used."),this.awaitConsent=s):(n===Wo?e.warn("Loaded user consent preferences. The user previously declined consent."):n===Go&&this.awaitConsent!==l&&e.warn("User declined consent."),o(),this.awaitConsent=l)},pending(n){n===$o&&e.info("User consent preferences not found. Default consent of pending will be used. Some commands may be delayed."),this.awaitConsent=c},awaitConsent:a,withConsent(){return this.awaitConsent(!0)},current(){switch(this.awaitConsent){case r:return{state:"in",wasSet:!1};case i:return{state:"in",wasSet:!0};case s:return{state:"out",wasSet:!1};case l:return{state:"out",wasSet:!0};case c:return{state:"pending",wasSet:!1};default:return{state:"in",wasSet:!1}}}}},Xo=({generalConsentState:e,logger:n})=>{const t=(t,o)=>{switch(t[zo]){case Mo:e.in(o);break;case Fo:e.out(o);break;case Bo:e.pending(o);break;default:n.warn(`Unknown consent value: ${t[zo]}`)}};return{initializeConsent(e,n){n[zo]?t(n,Wo):t(e,$o)},setConsent(e){t(e,Go)},suspend(){e.pending()},awaitConsent:()=>e.awaitConsent(),withConsent:()=>e.withConsent(),current:()=>e.current()}};const Yo=e=>e&&e._experience&&e._experience.decisioning&&qe(e._experience.decisioning.propositions)?e._experience.decisioning.propositions:[];var Ko=()=>{const e={};let n,t,o=!1,a=!1,r=!0;const i=e=>{if(a)throw new Error(`${e} cannot be called after event is finalized.`)},s={hasQuery(){return Object.prototype.hasOwnProperty.call(this.getContent(),"query")},getContent(){const o=JSON.parse(JSON.stringify(e));return n&&he(o,{xdm:n}),t&&he(o,{data:t}),o},setUserXdm(e){i("setUserXdm"),n=e},setUserData(e){i("setUserData"),t=e},mergeXdm(n){i("mergeXdm"),n&&he(e,{xdm:n})},mergeData(n){i("mergeData"),n&&he(e,{data:n})},mergeMeta(n){i("mergeMeta"),n&&he(e,{meta:n})},mergeQuery(n){i("mergeQuery"),n&&he(e,{query:n})},documentMayUnload(){o=!0},finalize(o){if(a)return;const i=De([...Yo(n),...Yo(e.xdm)],((e,n)=>e===n||e.id&&n.id&&e.id===n.id&&e.scope&&n.scope&&e.scope===n.scope));if(n&&this.mergeXdm(n),i.length>0&&(e.xdm._experience.decisioning.propositions=i),t&&s.mergeData(t),a=!0,o){r=!1;const n={xdm:e.xdm||{},data:e.data||{}},t=o(n);r=!1!==t,e.xdm=n.xdm||{},e.data=n.data||{},wn(e.xdm)&&delete e.xdm,wn(e.data)&&delete e.data}},getDocumentMayUnload:()=>o,isEmpty:()=>wn(e)&&(!n||wn(n))&&(!t||wn(t)),shouldSend:()=>r,getViewName(){if(n&&n.web&&n.web.webPageDetails)return n.web.webPageDetails.viewName},toJSON(){if(!a)throw new Error("toJSON called before finalize");return e}};return s};const Zo="Retry-After",ea="x-adobe-edge";var na=({extractEdgeInfo:e})=>({content:n={},getHeader:t})=>{const{handle:o=[],errors:a=[],warnings:r=[]}=n;return{getPayloadsByType:e=>o.filter((n=>n.type===e)).flatMap((e=>e.payload)),getErrors:()=>a,getWarnings:()=>r,getEdge:()=>e(t(ea)),toJSON:()=>n}};const ta="configure",oa="setDebug";var aa=({logger:e,configureCommand:n,setDebugCommand:t,handleError:o,validateCommandOptions:a})=>{let r;const i=(o,i)=>{let s;if(o===ta){if(r)throw new Error("The library has already been configured and may only be configured once.");s=()=>(r=n(i),r.then((()=>{})))}else{if(!r)throw new Error("The library must be configured first. Please do so by executing the configure command.");s=o===oa?()=>{const e=To({enabled:bo().required()}).noUnknownFields(),n=a({command:{commandName:oa,optionsValidator:e},options:i});t(n)}:()=>r.then((e=>{const n=e.getCommand(o);if(!n||!je(n.run)){const n=[ta,oa].concat(e.getCommandNames()).join(", ");throw new Error(`The ${o} command does not exist. List of available commands: ${n}.`)}const t=a({command:n,options:i});return n.run(t)}),(()=>(e.warn(`An error during configuration is preventing the ${o} command from executing.`),new Promise((()=>{})))))}return s};return(n,t={})=>new Promise((o=>{const a=i(n,t);e.logOnBeforeCommand({commandName:n,options:t}),o(a())})).catch((e=>o(e,`${n} command`))).catch((o=>{throw e.logOnCommandRejected({commandName:n,options:t,error:o}),o})).then((o=>{const a=ue(o)?o:{};return e.logOnCommandResolved({commandName:n,options:t,result:a}),a}))};const ra="https://adobe.ly/3sHgQHb";var ia=({command:e,options:n})=>{const{commandName:t,documentationUri:o=ra,optionsValidator:a}=e;let r=n;if(a)try{r=a(n)}catch(e){throw new Error(`Invalid ${t} command options:\n\t - ${e} For command documentation see: ${o}`)}return r};const sa="https://adobe.ly/3sHh553",la=({combinedConfigValidator:e,options:n,logger:t})=>{try{return e.noUnknownFields().required().call({logger:t},n)}catch(e){throw new Error(`Resolve these configuration problems:\n\t - ${e.message.split("\n").join("\n\t - ")}\nFor configuration documentation see: ${sa}`)}},ca=(e,n,t)=>t.reduce(((t,{buildOnInstanceConfiguredExtraParams:o})=>(o&&(t={...t,...o({config:e,logger:n})}),t)),{}),ma=e=>{const n=[],t={get enabled(){return e.enabled},flush(){n.forEach((({method:n,args:t})=>e[n](...t)))}};return Object.keys(e).filter((n=>"function"==typeof e[n])).forEach((e=>{t[e]=(...t)=>{n.push({method:e,args:t})}})),t};var da=({options:e,componentCreators:n,coreConfigValidators:t,createConfig:o,logger:a,setDebugEnabled:r})=>{const i=ma(a),s=n.map((({configValidators:e})=>e)).filter((e=>e)).reduce(((e,n)=>e.concat(n)),t),l=o(la({combinedConfigValidator:s,options:e,logger:i}));r(l.debugEnabled,{fromConfig:!0}),i.flush();const c=ca(l,a,n);return a.logOnInstanceConfigured({...c,config:l}),l},ua=({componentCreators:e,lifecycle:n,componentRegistry:t,getImmediatelyAvailableTools:o})=>(e.forEach((e=>{const{namespace:n}=e,a=o(n);let r;try{r=e(a)}catch(e){throw at({error:e,message:`[${n}] An error occurred during component creation.`})}t.register(n,r)})),n.onComponentsRegistered({lifecycle:n}).then((()=>t)));const fa=e=>({...e}),pa="edge.adobedc.net",ga="adobedc.demdex.net";var wa="ee",ha=()=>To({debugEnabled:bo().default(!1),datastreamId:Do().unique().required(),edgeDomain:Do().domain().default(pa),edgeBasePath:Do().nonEmpty().default(wa),orgId:Do().unique().required(),onBeforeEventSend:Io().default(Yn),edgeConfigOverrides:Po}).renamed("edgeConfigId",Do().unique(),"datastreamId"),ya=({errorPrefix:e,logger:n})=>(t,o)=>{const a=tt(t);if(a.code===Ho)return n.warn(`The ${o} could not fully complete. ${a.message}`),{};throw ot({error:a,message:`${e} ${a.message}`}),a},va=({fetch:e})=>(n,t)=>e(n,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrerPolicy:"no-referrer-when-downgrade",body:t}).then((e=>e.text().then((n=>({statusCode:e.status,getHeader:n=>e.headers.get(n),body:n}))))),ba=({sendBeacon:e,sendFetchRequest:n,logger:t})=>(o,a)=>{const r=new Blob([a],{type:"text/plain; charset=UTF-8"});return e(o,r)?Promise.resolve({statusCode:204,getHeader:()=>null,body:""}):(t.info("Unable to use `sendBeacon`; falling back to `fetch`."),n(o,a))},Ia=({getDebugEnabled:e,console:n,getMonitors:t,context:o})=>{let a=`[${o.instanceName}]`
;o.componentName&&(a+=` [${o.componentName}]`);const r=(e,n)=>{const a=t();if(a.length>0){const t={...o,...n};a.forEach((n=>{n[e]&&n[e](t)}))}},i=(t,...o)=>{r("onBeforeLog",{level:t,arguments:o}),e()&&n[t](a,...o)};return{get enabled(){return t().length>0||e()},logOnInstanceCreated(e){r("onInstanceCreated",e),i("info","Instance initialized.")},logOnInstanceConfigured(e){r("onInstanceConfigured",e),i("info","Instance configured. Computed configuration:",e.config)},logOnBeforeCommand(e){r("onBeforeCommand",e),i("info",`Executing ${e.commandName} command. Options:`,e.options)},logOnCommandResolved(e){r("onCommandResolved",e),i("info",`${e.commandName} command resolved. Result:`,e.result)},logOnCommandRejected(e){r("onCommandRejected",e),i("error",`${e.commandName} command was rejected. Error:`,e.error)},logOnBeforeNetworkRequest(e){r("onBeforeNetworkRequest",e),i("info",`Request ${e.requestId}: Sending request.`,e.payload)},logOnNetworkResponse(e){r("onNetworkResponse",e);const n=e.parsedBody||e.body?"response body:":"no response body.";i("info",`Request ${e.requestId}: Received response with status code ${e.statusCode} and ${n}`,e.parsedBody||e.body)},logOnNetworkError(e){r("onNetworkError",e),i("error",`Request ${e.requestId}: Network request failed.`,e.error)},logOnContentHiding(e){r("onContentHiding",{status:e.status}),i(e.logLevel,e.message)},logOnContentRendering(e){r("onContentRendering",{status:e.status,payload:e.detail}),i(e.logLevel,e.message)},info:i.bind(null,"info"),warn:i.bind(null,"warn"),error:i.bind(null,"error")}},Sa="__view__",_a=e=>(n,t)=>{e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(t)},Ca=e=>{const{payload:n,getAction:t,getUseSendBeacon:o,datastreamIdOverride:a,edgeSubPath:r}=e,i=l();let s=!1,c=!1;return{getId:()=>i,getPayload:()=>n,getAction:()=>t({isIdentityEstablished:c}),getDatastreamIdOverride:()=>a,getUseSendBeacon:()=>o({isIdentityEstablished:c}),getEdgeSubPath:()=>r||"",getUseIdThirdPartyDomain:()=>s,setUseIdThirdPartyDomain(){s=!0},setIsIdentityEstablished(){c=!0}}},Ta=({payload:e,datastreamIdOverride:n})=>{const t=({isIdentityEstablished:n})=>e.getDocumentMayUnload()&&n;return Ca({payload:e,getAction:({isIdentityEstablished:e})=>t({isIdentityEstablished:e})?"collect":"interact",getUseSendBeacon:t,datastreamIdOverride:n})},Da=e=>{const{content:n,addIdentity:t,hasIdentity:o}=e,a=ye(n,"meta.configOverrides");return{mergeMeta:ye(n,"meta"),mergeState:ye(n,"meta.state"),mergeQuery:ye(n,"query"),mergeConfigOverride:e=>a(nt(e)),addIdentity:t,hasIdentity:o,toJSON:()=>n}},ka=e=>n=>void 0!==(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[n]),xa=()=>{const e={},n=Da({content:e,addIdentity:_a(e),hasIdentity:ka(e)});return n.addEvent=n=>{e.events=e.events||[],e.events.push(n)},n.getDocumentMayUnload=()=>(e.events||[]).some((e=>e.getDocumentMayUnload())),n},Pa=({localConfigOverrides:e,globalConfigOverrides:n,payload:t})=>{const o={payload:t},{datastreamId:a,...r}=e||{};return a&&(o.datastreamIdOverride=a),n&&!wn(n)&&t.mergeConfigOverride(n),r&&!wn(r)&&t.mergeConfigOverride(r),o};const Aa="adb_validation_sessionid",Oa="validation.",Ea="clientId",Na=e=>{let n=e.persistent.getItem(Ea);return n||(n=l(),e.persistent.setItem(Ea,n)),n};var La=({window:e,createNamespacedStorage:n})=>{const t=n(Oa);return()=>{const n=me.default.parse(e.location.search)[Aa];if(!n)return"";const o=`${n}|${Na(t)}`;return`&${me.default.stringify({adobeAepValidationToken:o})}`}};const Ra="Event was canceled because the onBeforeEventSend callback returned false.";var Ua=({config:e,logger:n,lifecycle:t,consent:o,createEvent:a,createDataCollectionRequestPayload:r,createDataCollectionRequest:i,sendEdgeNetworkRequest:s,applyResponse:l})=>{const{onBeforeEventSend:c,edgeConfigOverrides:m}=e;return{createEvent:a,sendEvent(e,a={}){const{edgeConfigOverrides:l,...d}=a,u=Pa({payload:r(),localConfigOverrides:l,globalConfigOverrides:m}),f=i(u),p=ve(),g=ve();return t.onBeforeEvent({...d,event:e,onResponse:p.add,onRequestFailure:g.add}).then((()=>(u.payload.addEvent(e),o.awaitConsent()))).then((()=>{try{e.finalize(c)}catch(e){const n=()=>{throw e};return g.add(t.onRequestFailure),g.call({error:e}).then(n,n)}if(!e.shouldSend()){g.add(t.onRequestFailure),n.info(Ra);const e=new Error(Ra);return g.call({error:e}).then((()=>{}))}return s({request:f,runOnResponseCallbacks:p.call,runOnRequestFailureCallbacks:g.call})}))},applyResponse(e,n={}){const{renderDecisions:o=!1,decisionContext:a={},responseHeaders:s={},responseBody:c={handle:[]},personalization:m}=n,d=r(),u=i({payload:d}),f=ve();return t.onBeforeEvent({event:e,renderDecisions:o,decisionContext:a,decisionScopes:[Sa],personalization:m,onResponse:f.add,onRequestFailure:Yn}).then((()=>(d.addEvent(e),l({request:u,responseHeaders:s,responseBody:c,runOnResponseCallbacks:f.call}))))}}};const Va="state:store";var ja=({cookieJar:e,shouldTransferCookie:n,apexDomain:t,dateProvider:o})=>({cookiesToPayload(o,a){const r=""!==t&&a.endsWith(t),i={domain:t,cookiesEnabled:!0};if(!r){const t=e.get(),o=Object.keys(t).filter(n).map((e=>({key:e,value:t[e]})));o.length&&(i.entries=o)}o.mergeState(i)},responseToCookies(n){n.getPayloadsByType(Va).forEach((n=>{const a={domain:t},r=n.attrs&&n.attrs.SameSite&&n.attrs.SameSite.toLowerCase();void 0!==n.maxAge&&(a.expires=new Date(o().getTime()+1e3*n.maxAge)),void 0!==r&&(a.sameSite=r),"none"===r&&(a.secure=!0),e.set(n.key,n.value,a)}))}});const qa="mboxEdgeCluster",Ma="at_qa_mode",Fa="mbox";var Ba=({orgId:e,targetMigrationEnabled:n})=>t=>Qn(e,t)||t===Ma||n&&t===Fa,za="v1";const Ha="TypeError",$a="NetworkError",Wa=e=>e.name===Ha||e.name===$a||0===e.status;var Ga=e=>{const n=e.shift()||[],t=e.shift()||[];return fe({},...n,...t,...e)},Qa=e=>n=>{const t=()=>{throw n};return e.call({error:n}).then(t,t)};const Ja=(e,n)=>n.getUseIdThirdPartyDomain()&&Wa(e);var Xa=({config:e,lifecycle:n,cookieTransfer:t,sendNetworkRequest:o,createResponse:a,processWarningsAndErrors:r,getLocationHint:i,getAssuranceValidationTokenParams:s})=>{const{edgeDomain:l,edgeBasePath:c,datastreamId:m}=e;let d=!1;const u=(e,n)=>{const t=i(),o=t?`${c}/${t}${n.getEdgeSubPath()}`:`${c}${n.getEdgeSubPath()}`,a=n.getDatastreamIdOverride()||m;return a!==m&&n.getPayload().mergeMeta({sdkConfig:{datastream:{original:m}}}),`https://${e}/${o}/${za}/${n.getAction()}?configId=${a}&requestId=${n.getId()}${s()}`};return({request:e,runOnResponseCallbacks:i=Yn,runOnRequestFailureCallbacks:s=Yn})=>{const c=ve();c.add(n.onResponse),c.add(i);const m=ve();return m.add(n.onRequestFailure),m.add(s),n.onBeforeRequest({request:e,onResponse:c.add,onRequestFailure:m.add}).then((()=>{const n=d||!e.getUseIdThirdPartyDomain()?l:ga,a=u(n,e),r=e.getPayload();return t.cookiesToPayload(r,n),o({requestId:e.getId(),url:a,payload:r,useSendBeacon:e.getUseSendBeacon()})})).then((e=>(r(e),e))).catch((n=>{if(Ja(n,e)){d=!0,e.setUseIdThirdPartyDomain(!1);const n=u(l,e),a=e.getPayload();return t.cookiesToPayload(a,l),o({requestId:e.getId(),url:n,payload:a,useSendBeacon:e.getUseSendBeacon()})}return Qa(m)(n)})).then((({parsedBody:e,getHeader:n})=>{const o=a({content:e,getHeader:n});return t.responseToCookies(o),c.call({response:o}).then(Ga)}))}};const Ya=204,Ka="The server responded with a";var Za=({logger:e})=>n=>{const{statusCode:t,body:o,parsedBody:a}=n;if(t<200||t>=300||!a&&t!==Ya||a&&!Array.isArray(a.handle)){const e=a?JSON.stringify(a,null,2):o;throw new Error(`${Ka} status code ${t} and ${e?`response body:\n${e}`:"no response body."}`)}if(a){const{warnings:n=[],errors:t=[]}=a;n.forEach((n=>{e.warn(`${Ka} warning:`,n)})),t.forEach((n=>{e.error(`${Ka} non-fatal error:`,n)}))}},er=({orgId:e,cookieJar:n})=>{const t=Cn(e,jn),o=()=>n.get(t),a=()=>{const e=n.get(qa);if(e)return`t${e}`};return()=>o()||a()};const nr=3,tr=[429,503,502,504];var or=({response:e,retriesAttempted:n})=>n<nr&&tr.includes(e.statusCode);const ar=1e3,rr=1e3,ir=.3,sr=e=>{const n=ar+e*rr,t=n*ir,o=n-t,a=n+t;return Math.round(o+Math.random()*(a-o))},lr=e=>{const n=e.getHeader(Zo);let t;if(n){const e=parseInt(n,10);t=Gn(e)?1e3*e:Math.max(0,new Date(n).getTime()-(new Date).getTime())}return t};var cr=({response:e,retriesAttempted:n})=>{let t=lr(e);return void 0===t&&(t=sr(n)),t};const mr=200;var dr=({cookieTransfer:e,lifecycle:n,createResponse:t,processWarningsAndErrors:o})=>({request:a,responseHeaders:r,responseBody:i,runOnResponseCallbacks:s=Yn,runOnRequestFailureCallbacks:l=Yn})=>{const c=ve();c.add(n.onResponse),c.add(s);const m=ve();m.add(n.onRequestFailure),m.add(l);const d=e=>r[e];return n.onBeforeRequest({request:a,onResponse:c.add,onRequestFailure:m.add}).then((()=>o({statusCode:mr,getHeader:d,body:JSON.stringify(i),parsedBody:i}))).catch(Qa(m)).then((()=>{const n=t({content:i,getHeader:d});return e.responseToCookies(n),c.call({response:n}).then(Ga)}))},ur=e=>n=>{const t={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};he(n,{web:t})};const fr=e=>{const{screen:{orientation:n}}=e;if(null==n||null==n.type)return null;const t=n.type.split("-");return 0===t.length||"portrait"!==t[0]&&"landscape"!==t[0]?null:t[0]},pr=e=>{if(je(e.matchMedia)){if(e.matchMedia("(orientation: portrait)").matches)return"portrait";if(e.matchMedia("(orientation: landscape)").matches)return"landscape"}return null};var gr=e=>n=>{const{screen:{width:t,height:o}}=e,a={},r=it(o);r>=0&&(a.screenHeight=r);const i=it(t);i>=0&&(a.screenWidth=i);const s=fr(e)||pr(e);s&&(a.screenOrientation=s),Object.keys(a).length>0&&he(n,{device:a})},wr=e=>n=>{const{document:{documentElement:{clientWidth:t,clientHeight:o}={}}}=e,a={type:"browser"},r=it(t);r>=0&&(a.browserDetails={viewportWidth:r});const i=it(o);i>=0&&(a.browserDetails=a.browserDetails||{},a.browserDetails.viewportHeight=i),he(n,{environment:a})},hr=e=>n=>{const t=e(),o={},a=it(t.getTimezoneOffset());void 0!==a&&(o.localTimezoneOffset=a),(void 0===a||Math.abs(a)<6e3)&&(o.localTime=lt(t)),he(n,{placeContext:o})},yr=e=>n=>{const t=e().toISOString();he(n,{timestamp:t})},vr="https://ns.adobe.com/experience/alloy",br="2.26.0",Ir=e=>{he(e,{implementationDetails:{name:vr,version:br,environment:"browser"}})},Sr=(e,n,t,o)=>{const a=e.context.flatMap(((e,o)=>t[e]?[t[e]]:(n.warn(`Invalid context[${o}]: '${e}' is not available.`),[]))).concat(o);return{namespace:"Context",lifecycle:{onBeforeEvent({event:e}){const t={};return Promise.all(a.map((e=>Promise.resolve(e(t,n))))).then((()=>e.mergeXdm(t)))}}}},_r=[["architecture","string"],["bitness","string"],["model","string"],["platformVersion","string"],["wow64","boolean"]];const Cr=e=>void 0!==e.userAgentData;var Tr=e=>Cr(e)?(n,t)=>{try{return e.userAgentData.getHighEntropyValues(_r.map((e=>e[0]))).then((e=>{const t={};_r.forEach((([n,o])=>{Object.prototype.hasOwnProperty.call(e,n)&&typeof e[n]===o&&(t[n]=e[n])})),he(n,{environment:{browserDetails:{userAgentClientHints:t}}})}))}catch(e){return t.warn(`Unable to collect user-agent client hints. ${e.message}`),Yn}}:Yn;const Dr=ur(window),kr=gr(window),xr=wr(window),Pr=hr((()=>new Date)),Ar=yr((()=>new Date)),Or={web:Dr,device:kr,environment:xr,placeContext:Pr},Er={highEntropyUserAgentHints:Tr(navigator)},Nr={...Or,...Er},Lr=[Ar,Ir],Rr=({config:e,logger:n})=>Sr(e,n,Nr,Lr);Rr.namespace="Context",Rr.configValidators=To({context:vo(Do()).default(Object.keys(Or))});var Ur=({options:e})=>To({type:Do(),xdm:To({eventType:Do(),identityMap:xo}),data:To({}),documentUnloading:bo(),renderDecisions:bo(),decisionScopes:vo(Do()).uniqueItems(),personalization:To({decisionScopes:vo(Do()).uniqueItems(),surfaces:vo(Do()).uniqueItems(),sendDisplayEvent:bo().default(!0),includeRenderedPropositions:bo().default(!1),defaultPersonalizationEnabled:bo(),decisionContext:To({})}).default({sendDisplayEvent:!0}),datasetId:Do(),mergeId:Do(),edgeConfigOverrides:Po,initializePersonalization:bo()}).required().noUnknownFields()(e),Vr=({options:e})=>To({renderDecisions:bo(),responseHeaders:Co(Do().required()),responseBody:To({handle:vo(To({type:Do().required(),payload:yo().required()})).required()}).required(),personalization:To({sendDisplayEvent:bo().default(!0),decisionContext:To({})}).default({sendDisplayEvent:!0})}).noUnknownFields()(e);const jr=({eventManager:e,logger:n})=>({commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:e=>Ur({options:e}),run:t=>{const{xdm:o,data:a,documentUnloading:r,type:i,mergeId:s,datasetId:l,edgeConfigOverrides:c,...m}=t,d=e.createEvent();return r&&d.documentMayUnload(),d.setUserXdm(o),d.setUserData(a),i&&d.mergeXdm({eventType:i}),s&&d.mergeXdm({eventMergeId:s}),c&&(m.edgeConfigOverrides=c),l&&(n.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.com_adobe_experience_platform.datasets.event.datasetId' instead."),m.edgeConfigOverrides=c||{},he(m.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:l}}}})),e.sendEvent(d,m)}},applyResponse:{documentationUri:"",optionsValidator:e=>Vr({options:e}),run:n=>{const{renderDecisions:t=!1,decisionContext:o={},responseHeaders:a={},responseBody:r={handle:[]},personalization:i}=n,s=e.createEvent();return e.applyResponse(s,{renderDecisions:t,decisionContext:o,responseHeaders:a,responseBody:r,personalization:i})}}}});jr.namespace="DataCollector";const qr=(e,n)=>`ID sync ${n?"succeeded":"failed"}: ${e.spec.url}`;var Mr=({fireReferrerHideableImage:e,logger:n})=>t=>{const o=t.filter((e=>"url"===e.type));return o.length?Promise.all(o.map((t=>e(t.spec).then((()=>{n.info(qr(t,!0))})).catch((()=>{n.error(qr(t,!1))}))))).then(Yn):Promise.resolve()};const Fr=To({thirdPartyCookiesEnabled:bo().default(!0),idMigrationEnabled:bo().default(!0)});var Br=To({url:Do().required().nonEmpty(),edgeConfigOverrides:Po}).required().noUnknownFields(),zr="ECID",Hr=({addEcidQueryToPayload:e,addQueryStringIdentityToPayload:n,ensureSingleIdentity:t,setLegacyEcid:o,handleResponseForIdSyncs:a,getNamespacesFromResponse:r,getIdentity:i,consent:s,appendIdentityToUrl:l,logger:c,getIdentityOptionsValidator:m,decodeKndctrCookie:d})=>{let u,f={};return{lifecycle:{onBeforeRequest:({request:o,onResponse:a,onRequestFailure:r})=>(e(o.getPayload()),n(o.getPayload()),t({request:o,onResponse:a,onRequestFailure:r})),onResponse({response:e}){const n=r(e);return u&&u[zr]||!n||!n[zr]||o(n[zr]),n&&Object.keys(n).length>0&&(u={...u,...n}),f={...f,...e.getEdge()},a(e)}},commands:{getIdentity:{optionsValidator:m,run:e=>{const{namespaces:n}=e;return s.awaitConsent().then((()=>{if(u)return;const t=d();return t&&n.includes(zr)&&(u||(u={}),u[zr]=t,1===n.length)?void 0:i(e)})).then((()=>({identity:n.reduce(((e,n)=>(e[n]=u[n]||null,e)),{}),edge:f})))}},appendIdentityToUrl:{optionsValidator:Br,run:e=>s.withConsent().then((()=>{if(u)return;const n=d();return n?(u||(u={}),void(u[zr]=n)):i(e)})).then((()=>({url:l(u[zr],e.url)}))).catch((n=>(c.warn(`Unable to append identity to url. ${n.message}`),e)))}}}},$r=({config:e,getEcidFromVisitor:n,apexDomain:t,isPageSsl:o,cookieJar:a})=>{const{idMigrationEnabled:r,orgId:i}=e,s=`AMCV_${i}`,l=()=>{let e=null;const n="s_ecid",t=a.get(n)||a.get(s);if(t){const n=/(^|\|)MCMID\|(\d+)($|\|)/,o=t.match(n);o&&(e=o[2])}return e};return{getEcid(){if(r){const e=l();return e?Promise.resolve(e):n()}return Promise.resolve()},setEcid(e){if(r&&l()!==e){const n=o?{sameSite:"none",secure:!0}:{};a.set(s,`MCMID|${e}`,{domain:t,expires:390,...n})}}}},Wr=({logger:e})=>new Promise(((n,t)=>{if(ue(window.adobe)&&ue(window.adobe.optIn)){const o=window.adobe.optIn;e.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),o.fetchPermissions((()=>{o.isApproved([o.Categories.ECID])?(e.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),n()):t(new Error("Legacy opt-in was declined."))}),!0)}else n()})),Gr=e=>{const n=e.Visitor;return je(n)&&je(n.getInstance)&&n},Qr=({logger:e,orgId:n,awaitVisitorOptIn:t})=>()=>{const o=Gr(window);return o?t({logger:e}).then((()=>(e.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise((t=>{o.getInstance(n,{}).getMarketingCloudVisitorID((n=>{e.info("Resuming previously delayed request that was waiting for ECID from Visitor."),t(n)}),!0)}))))).catch((n=>{n?e.info(`${n.message}, retrieving ECID from experience edge`):e.info("An error occurred while obtaining the ECID from Visitor.")})):Promise.resolve()},Jr=({processIdSyncs:e})=>n=>e(n.getPayloadsByType("identity:exchange")),Xr=({doesIdentityCookieExist:e,setDomainForInitialIdentityPayload:n,addLegacyEcidToPayload:t,awaitIdentityCookie:o,logger:a})=>{let r;const i=e=>(n(e),t(e.getPayload()));return({request:n,onResponse:t,onRequestFailure:s})=>{if(e())return n.setIsIdentityEstablished(),Promise.resolve();if(r){a.info("Delaying request while retrieving ECID from server.");const e=r;return r=e.catch((()=>o({onResponse:t,onRequestFailure:s}))),e.then((()=>{a.info("Resuming previously delayed request."),n.setIsIdentityEstablished()})).catch((()=>i(n)))}return r=o({onResponse:t,onRequestFailure:s}),r.catch((()=>{})),i(n)}},Yr="CORE",Kr=({thirdPartyCookiesEnabled:e,areThirdPartyCookiesSupportedByDefault:n})=>{const t={identity:{fetch:[zr]}};return e&&n()&&t.identity.fetch.push(Yr),e=>{e.mergeQuery(t)}},Zr=({thirdPartyCookiesEnabled:e,areThirdPartyCookiesSupportedByDefault:n})=>t=>{e&&n()&&t.setUseIdThirdPartyDomain()},ei=({getLegacyEcid:e,addEcidToPayload:n})=>t=>t.hasIdentity(zr)?Promise.resolve():e().then((e=>{e&&n(t,e)})),ni="adobe_mc",ti=e=>{try{return decodeURIComponent(e)}catch{return""}};const oi=300;var ai=({locationSearch:e,dateProvider:n,orgId:t,logger:o})=>a=>{if(a.hasIdentity(zr))return;let r=me.default.parse(e)[ni];if(void 0===r)return;Array.isArray(r)&&(o.warn("Found multiple adobe_mc query string paramters, only using the last one."),r=r[r.length-1]);const i=r.split("|").reduce(((e,n)=>{const[t,o]=n.split("=");return e[t]=ti(o),e[t]=e[t].replace(/[^a-zA-Z0-9@.]/g,""),e}),{}),s=parseInt(i.TS,10),l=i.MCMID,c=ti(i.MCORGID);n().getTime()/1e3<=s+oi&&c===t&&l?(o.info(`Found valid ECID identity ${l} from the adobe_mc query string parameter.`),a.addIdentity(zr,{id:l})):o.info("Detected invalid or expired adobe_mc query string parameter.")},ri=(e,n)=>{e.addIdentity(zr,{id:n})},ii=({doesIdentityCookieExist:e,orgId:n,logger:t})=>({onResponse:o,onRequestFailure:a})=>new Promise(((r,i)=>{o((()=>{e()?r():(t.warn(`Identity cookie not found. This could be caused by any of the following issues:\n\t* The org ID ${n} configured in Alloy doesn't match the org ID specified in the edge configuration.\n\t* Experience edge was not able to set the identity cookie due to domain or cookie restrictions.\n\t* The request was canceled by the browser and not fully processed.`),i(new Error("Identity cookie not found.")))})),a((()=>{e()?r():i(new Error("Identity cookie not found."))}))})),si=e=>e.getPayloadsByType("identity:result").reduce(((e,n)=>(n.namespace&&n.namespace.code&&(e[n.namespace.code]=n.id),e)),{}),li=({sendEdgeNetworkRequest:e,createIdentityRequestPayload:n,createIdentityRequest:t,globalConfigOverrides:o})=>({namespaces:a,edgeConfigOverrides:r}={})=>{const i=Pa({payload:n(a),globalConfigOverrides:o,localConfigOverrides:r}),s=t(i);return e({request:s})},ci=({payload:e,datastreamIdOverride:n})=>Ca({payload:e,datastreamIdOverride:n,getAction:()=>"identity/acquire",getUseSendBeacon:()=>!1}),mi=e=>{const n={query:{identity:{fetch:e}}};return Da({content:n,addIdentity:_a(n),hasIdentity:ka(n)})};const di=/^([^?#]*)(\??[^#]*)(#?.*)$/,ui=e=>""===e?"?":"?"===e?"":"&";var fi=({dateProvider:e,orgId:n})=>(t,o)=>{const a=Math.round(e().getTime()/1e3),r=encodeURIComponent(`TS=${a}|MCMID=${t}|MCORGID=${encodeURIComponent(n)}`),[,i,s,l]=o.match(di);return`${i}${s}${ui(s)}adobe_mc=${r}${l}`};const pi=To({namespaces:vo(ko(zr,Yr)).nonEmpty().uniqueItems().default([zr]),edgeConfigOverrides:Po}).noUnknownFields().default({namespaces:[zr]});var gi=({thirdPartyCookiesEnabled:e})=>n=>{const t=pi(n);if(!e&&t.namespaces.includes(Yr))throw new Error(`namespaces: The ${Yr} namespace cannot be requested when third-party cookies are disabled.`);return t};const wi=1,hi=(e,n)=>{let t,o=0,a=0;do{if(n<0||n+a>=e.length)throw new Error("Invalid varint: buffer ended unexpectedly");if(t=e[n+a],o|=(127&t)<<7*a,a+=1,a>10)throw new Error("Invalid varint: too long")}while(128&t);return{value:o,length:a}},yi=Object.freeze({VARINT:0,I64:1,LEN:2,SGROUP:3,EGROUP:4,I32:5}),vi=e=>{let n=0,t=null;for(;n<e.length&&!t;){const{value:o,length:a}=hi(e,n);n+=a;const r=7&o;if(o>>3===wi){if(r===yi.LEN){const o=hi(e,n);return n+=o.length,t=(new TextDecoder).decode(e.slice(n,n+o.value)),n+=o.value,t}}else switch(r){case yi.VARINT:n+=hi(e,n).length;break;case yi.I64:n+=8;break;case yi.LEN:{const t=hi(e,n);n+=t.length+t.value;break}case yi.SGROUP:case yi.EGROUP:break;case yi.I32:n+=4;break;default:throw new Error(`Malformed kndctr cookie. Unknown wire type: ${r}`)}}throw new Error("No ECID found in cookie.")},bi=e=>{const n=atob(e);return Uint8Array.from(n,(e=>e.codePointAt(0)))};var Ii=({orgId:e,cookieJar:n,logger:t})=>{const o=Cn(e,"identity");return()=>{const e=n.get(o);if(!e)return null;try{const n=decodeURIComponent(e).replace(/_/g,"/").replace(/-/g,"+"),t=bi(n);return vi(t)}catch(e){return t.warn(`Unable to decode ECID from ${o} cookie`,e),null}}};const Si=({config:e,logger:n,consent:t,fireReferrerHideableImage:o,sendEdgeNetworkRequest:a,apexDomain:r,getBrowser:i})=>{const{orgId:s,thirdPartyCookiesEnabled:l,edgeConfigOverrides:c}=e,m=Qr({logger:n,orgId:s,awaitVisitorOptIn:Wr}),d=be({logger:n,cookieJar:ge}),u=$r({config:e,getEcidFromVisitor:m,apexDomain:r,cookieJar:d,isPageSsl:"https:"===window.location.protocol}),f=qn({orgId:s}),p=li({sendEdgeNetworkRequest:a,createIdentityRequestPayload:mi,createIdentityRequest:ci,globalConfigOverrides:c}),g=Rn({getBrowser:i}),w=Zr({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:g}),h=ei({getLegacyEcid:u.getEcid,addEcidToPayload:ri}),y=ai({locationSearch:window.document.location.search,dateProvider:()=>new Date,orgId:s,logger:n}),v=ii({doesIdentityCookieExist:f,orgId:s,logger:n}),b=Xr({doesIdentityCookieExist:f,setDomainForInitialIdentityPayload:w,addLegacyEcidToPayload:h,awaitIdentityCookie:v,logger:n}),I=Mr({fireReferrerHideableImage:o,logger:n}),S=Jr({processIdSyncs:I}),_=fi({dateProvider:()=>new Date,orgId:s}),C=gi({thirdPartyCookiesEnabled:l}),T=Kr({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:g}),D=Ii({orgId:s,cookieJar:d,logger:n});return Hr({addEcidQueryToPayload:T,addQueryStringIdentityToPayload:y,ensureSingleIdentity:b,setLegacyEcid:u.setEcid,handleResponseForIdSyncs:S,getNamespacesFromResponse:si,getIdentity:p,consent:t,appendIdentityToUrl:_,logger:n,getIdentityOptionsValidator:C,decodeKndctrCookie:D})};Si.namespace="Identity",Si.configValidators=Fr;const _i=({config:e,componentRegistry:n})=>{const t=[...n.getCommandNames(),ta,oa].sort(),o={...e};Object.keys(e).forEach((n=>{const t=e[n];"function"==typeof t&&(o[n]=t.toString())}));const a=n.getComponentNames();return{version:br,configs:o,commands:t,components:a}},Ci=({config:e,componentRegistry:n})=>({commands:{getLibraryInfo:{run:()=>({libraryInfo:_i({config:e,componentRegistry:n})})}}});Ci.namespace="LibraryInfo";var Ti=Object.freeze({__proto__:null,context:Rr,dataCollector:jr,identity:Si,libraryInfo:Ci});const Di=zn(window),{fetch:ki,navigator:xi}=window,Pi=ha(),Ai=In(window,ge),Oi=va({fetch:ki}),Ei=gn(),Ni=La({window:window,createNamespacedStorage:Di}),Li=Fn({userAgent:window.navigator.userAgent}),Ri=({instanceName:e,logController:{setDebugEnabled:n,logger:t,createComponentLogger:o},components:a})=>{const r=Vo(),i=Ro(r),s=a.concat(Object.values(Ti)),l=e=>{n(e.enabled,{fromConfig:!1})},c=be({logger:t,cookieJar:ge}),m=a=>{const l=da({options:a,componentCreators:s,coreConfigValidators:Pi,createConfig:fa,logger:t,setDebugEnabled:n}),{orgId:m,targetMigrationEnabled:d}=l,u=Ba({orgId:m,targetMigrationEnabled:d}),f=ja({cookieJar:c,shouldTransferCookie:u,apexDomain:Ai,dateProvider:()=>new Date}),p=je(xi.sendBeacon)?ba({sendBeacon:xi.sendBeacon.bind(xi),sendFetchRequest:Oi,logger:t}):Oi,g=jo({logger:t,sendFetchRequest:Oi,sendBeaconRequest:p,isRequestRetryable:or,getRequestRetryDelay:cr}),w=Za({logger:t}),h=qo({logger:t}),y=na({extractEdgeInfo:h}),v=er({orgId:m,cookieJar:ge}),b=Xa({config:l,lifecycle:i,cookieTransfer:f,sendNetworkRequest:g,createResponse:y,processWarningsAndErrors:w,getLocationHint:v,getAssuranceValidationTokenParams:Ni}),I=dr({lifecycle:i,cookieTransfer:f,createResponse:y,processWarningsAndErrors:w}),S=Jo({logger:t}),_=Xo({generalConsentState:S,logger:t}),C=Ua({config:l,logger:t,lifecycle:i,consent:_,createEvent:Ko,createDataCollectionRequestPayload:xa,createDataCollectionRequest:Ta,sendEdgeNetworkRequest:b,applyResponse:I});return ua({componentCreators:s,lifecycle:i,componentRegistry:r,getImmediatelyAvailableTools(n){const t=o(n);return{config:l,componentRegistry:r,consent:_,eventManager:C,fireReferrerHideableImage:Ei,logger:t,lifecycle:i,sendEdgeNetworkRequest:b,handleError:ya({errorPrefix:`[${e}] [${n}]`,logger:t}),createNamespacedStorage:Di,apexDomain:Ai,getBrowser:Li}}})},d=ya({errorPrefix:`[${e}]`,logger:t});return aa({logger:t,configureCommand:m,setDebugCommand:l,handleError:d,validateCommandOptions:ia})},Ui=({eventManager:e,lifecycle:n,handleError:t})=>o=>{if(o.s_fe)return Promise.resolve();const a=o.target,r=e.createEvent();return r.documentMayUnload(),n.onClick({event:r,clickedElement:a}).then((()=>r.isEmpty()?Promise.resolve():e.sendEvent(r))).then(Yn).catch((e=>{t(e,"click collection")}))};var Vi=({eventManager:e,lifecycle:n,handleError:t})=>{const o=Ui({eventManager:e,lifecycle:n,handleError:t});document.addEventListener("click",o,!0)};const ji="\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$",qi=Do().regexp().default(ji),Mi=To({clickCollectionEnabled:bo().default(!0),clickCollection:To({internalLinkEnabled:bo().default(!0),externalLinkEnabled:bo().default(!0),downloadLinkEnabled:bo().default(!0),sessionStorageEnabled:bo().default(!1),eventGroupingEnabled:bo().default(!1),filterClickProperties:Io()}).default({internalLinkEnabled:!0,externalLinkEnabled:!0,downloadLinkEnabled:!0,sessionStorageEnabled:!1,eventGroupingEnabled:!1}),downloadLinkQualifier:qi,onBeforeLinkClickSend:Io().deprecated('The field "onBeforeLinkClickSend" has been deprecated. Use "clickCollection.filterClickDetails" instead.')}),Fi="cppXYctnr";var Bi=(e=document)=>null!==e.getElementById(Fi),zi=e=>{let n=e;return/^https?:\/\//i.test(n)||(n=`${window.location.protocol}//${e}`),new URL(n).hostname},Hi=(e,n)=>zi(e)!==zi(n);const $i=(e,n)=>n&&("download"===n&&!e.downloadLinkEnabled||"exit"===n&&!e.externalLinkEnabled||"other"===n&&!e.internalLinkEnabled);var Wi=({config:e,logger:n,getClickedElementProperties:t,clickActivityStorage:o})=>{const{clickCollectionEnabled:a,clickCollection:r}=e;return a?({event:a,clickedElement:i})=>{const s=t({clickActivityStorage:o,clickedElement:i,config:e,logger:n}),l=s.linkType;Bi()||(s.isValidLink()&&$i(r,l)?n.info(`Cancelling link click event due to clickCollection.${l}LinkEnabled = false.`):!s.isInternalLink()||!r.eventGroupingEnabled||e.onBeforeLinkClickSend&&!r.filterClickDetails||Hi(window.location.hostname,s.linkUrl)?s.isValidLink()?(a.mergeXdm(s.xdm),a.mergeData(s.data),o.save({pageName:s.pageName,pageIDType:s.pageIDType})):s.isValidActivityMapData()&&o.save(s.properties):o.save(s.properties))}:()=>{}};const Gi=e=>({eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:e.linkName,region:e.linkRegion,type:e.linkType,URL:e.linkUrl,linkClicks:{value:1}}}}),Qi=e=>({__adobe:{analytics:{contextData:{a:{activitymap:{page:e.pageName,link:e.linkName,region:e.linkRegion,pageIDType:e.pageIDType}}}}}}),Ji=(e,n)=>{const{xdm:t,data:o,clickedElement:a}=e;if(n.clickedElement=a,t&&t.web&&t.web.webInteraction){const{name:e,region:o,type:a,URL:r}=t.web.webInteraction;n.linkName=e,n.linkRegion=o,n.linkType=a,n.linkUrl=r}if(o&&o.__adobe&&o.__adobe.analytics){const{contextData:e}=o.__adobe.analytics;if(e&&e.a&&e.a.activitymap){const{page:t,link:o,region:a,pageIDType:r}=e.a.activitymap;n.pageName=t||n.pageName,n.linkName=o||n.linkName,n.linkRegion=a||n.linkRegion,void 0!==r&&(n.pageIDType=r)}}};var Xi=({properties:e,logger:n}={})=>{let t=e||{};return{get pageName(){return t.pageName},set pageName(e){t.pageName=e},get linkName(){return t.linkName},set linkName(e){t.linkName=e},get linkRegion(){return t.linkRegion},set linkRegion(e){t.linkRegion=e},get linkType(){return t.linkType},set linkType(e){t.linkType=e},get linkUrl(){return t.linkUrl},set linkUrl(e){t.linkUrl=e},get pageIDType(){return t.pageIDType},set pageIDType(e){t.pageIDType=e},get clickedElement(){return t.clickedElement},set clickedElement(e){t.clickedElement=e},get properties(){return{pageName:t.pageName,linkName:t.linkName,linkRegion:t.linkRegion,linkType:t.linkType,linkUrl:t.linkUrl,pageIDType:t.pageIDType}},isValidLink:()=>!!(t.linkUrl&&t.linkType&&t.linkName&&t.linkRegion),isInternalLink(){return this.isValidLink()&&"other"===t.linkType},isValidActivityMapData:()=>!!t.pageName&&!!t.linkName&&!!t.linkRegion&&void 0!==t.pageIDType,get xdm(){return t.filteredXdm?t.filteredXdm:Gi(this)},get data(){return t.filteredData?t.filteredData:Qi(this)},applyPropertyFilter(e){e&&!1===e(t)&&(n&&n.info(`Clicked element properties were rejected by filter function: ${JSON.stringify(this.properties,null,2)}`),t={})},applyOptionsFilter(e){const o=this.options;if(o&&o.clickedElement&&(o.xdm||o.data)){if(e&&!1===e(o))return n&&n.info(`Clicked element properties were rejected by filter function: ${JSON.stringify(this.properties,null,2)}`),void(this.options=void 0);this.options=o,t.filteredXdm=o.xdm,t.filteredData=o.data}},get options(){const e={};if(this.isValidLink()&&(e.xdm=this.xdm),this.isValidActivityMapData()&&(e.data=this.data),this.clickedElement&&(e.clickedElement=this.clickedElement),e.xdm||e.data)return e},set options(e){t={},e&&Ji(e,t)}}},Yi=({clickActivityStorage:e})=>n=>{if(Bi())return;const t=e.load(),o=Xi({properties:t});if(o.isValidLink()||o.isValidActivityMapData()){if(o.isValidLink()){const e=o.xdm;delete e.eventType,n.mergeXdm(e)}o.isValidActivityMapData()&&n.mergeData(o.data),e.save({pageName:o.pageName,pageIDType:o.pageIDType})}},Ki=({window:e,getLinkName:n,getLinkRegion:t,getAbsoluteUrlFromAnchorElement:o,findClickableElement:a,determineLinkType:r})=>({clickedElement:i,config:s,logger:l,clickActivityStorage:c})=>{const{onBeforeLinkClickSend:m,clickCollection:d}=s,{filterClickDetails:u}=d,f=Xi({logger:l});if(i){const l=a(i);if(l){f.clickedElement=i,f.linkUrl=o(e,l),f.linkType=r(e,s,f.linkUrl,l),f.linkRegion=t(l),f.linkName=n(l),f.pageIDType=0,f.pageName=e.location.href;const a=c.load();a&&a.pageName&&(f.pageName=a.pageName,f.pageIDType=1),u?f.applyPropertyFilter(u):m&&f.applyOptionsFilter(m)}}return f};const Zi="clickData";var es=({storage:e})=>({save:n=>{const t=JSON.stringify(n);e.setItem(Zi,t)},load:()=>{let n=null;const t=e.getItem(Zi);return t&&(n=JSON.parse(t)),n},remove:()=>{e.removeItem(Zi)}}),ns=({clickActivityStorage:e})=>n=>{e.save({pageName:n.getContent().xdm.web.webPageDetails.name,pageIDType:1})},ts=(e,n)=>{const{clickCollectionEnabled:t,onBeforeLinkClickSend:o,downloadLinkQualifier:a}=e;!1===t&&(o&&n.warn("The 'onBeforeLinkClickSend' configuration was provided but will be ignored because clickCollectionEnabled is false."),a&&a!==ji&&n.warn("The 'downloadLinkQualifier' configuration was provided but will be ignored because clickCollectionEnabled is false."))},os=e=>e&&e.replace(/\s+/g," ").trim();const as=/^(SCRIPT|STYLE|LINK|CANVAS|NOSCRIPT|#COMMENT)$/i;var rs=e=>!(e&&e.nodeName&&e.nodeName.match(as));const is=e=>{let n=[],t=!1;return rs(e)?(n.push(e),e.childNodes&&Array.prototype.slice.call(e.childNodes).forEach((e=>{const o=is(e);n=n.concat(o.supportedNodes),t=t||o.includesUnsupportedNodes}))):t=!0,{supportedNodes:n,includesUnsupportedNodes:t}},ss=(e,n,t)=>{let o;return t&&t!==e.nodeName.toUpperCase()||(o=e.getAttribute(n)),o},ls=e=>{const n={texts:[]};return e.supportedNodes.forEach((e=>{e.getAttribute&&(n.alt||(n.alt=os(e.getAttribute("alt"))),n.title||(n.title=os(e.getAttribute("title"))),n.inputValue||(n.inputValue=os(ss(e,"value","INPUT"))),n.imgSrc||(n.imgSrc=os(ss(e,"src","IMG")))),e.nodeValue&&n.texts.push(e.nodeValue)})),n},cs=/^(HEADER|MAIN|FOOTER|NAV)$/i,ms=e=>{let n;return"region"===e.role&&Xn(e["aria-label"])&&(n=e["aria-label"]),n},ds=e=>{let n;return e&&e.nodeName&&e.nodeName.match(cs)&&(n=e.nodeName),n};var us=e=>!!e&&/^[a-z0-9]+:\/\//i.test(e),fs=e=>!(!e.href||"A"!==e.tagName&&"AREA"!==e.tagName||e.onclick&&e.protocol&&!(e.protocol.toLowerCase().indexOf("javascript")<0)),ps=e=>!!e&&!!e.onclick,gs=e=>{if("INPUT"===e.tagName){
const n=e.getAttribute("type");if("submit"===n)return!0;if("image"===n&&e.src)return!0}return!1},ws=e=>"BUTTON"===e.tagName&&"submit"===e.type,hs=e=>{const n=e.indexOf("?"),t=e.indexOf("#");return n>=0&&(n<t||t<0)?e.substring(0,n):t>=0?e.substring(0,t):e},ys=(e,n,t)=>{let o=!1;if(n)if(t&&t.download)o=!0;else if(e){const t=new RegExp(e),a=hs(n).toLowerCase();o=t.test(a)}return o},vs=(e,n)=>{let t=!1;if(n&&e.location.hostname){const o=e.location.hostname.toLowerCase();t=hs(n).toLowerCase().indexOf(o)<0}return t},bs=e=>{const n=e.getContent();return void 0!==n.xdm&&void 0!==n.xdm.web&&void 0!==n.xdm.web.webPageDetails&&void 0!==n.xdm.web.webPageDetails.name},Is=()=>{const e={};return{getItem:n=>e[n],setItem:(n,t)=>{e[n]=t},removeItem:n=>{delete e[n]}}};const Ss=Ki({window:window,getLinkName:e=>{let n=os(e.innerText||e.textContent);const t=is(e);if(!n||t.includesUnsupportedNodes){const e=ls(t);n=os(e.texts.join("")),n||(n=e.alt||e.title||e.inputValue||e.imgSrc)}return n||""},getLinkRegion:e=>{let n,t=e.parentNode;for(;t;){if(n=os(t.id||ms(t)||ds(t)),n)return n;t=t.parentNode}return"BODY"},getAbsoluteUrlFromAnchorElement:(e,n)=>{const t=e.location;let o=n.href||"";"string"!=typeof o&&(o="");let{protocol:a,host:r}=n;if(o&&!us(o)){a||(a=t.protocol?t.protocol:""),a=a?`${a}//`:"",r||(r=t.host?t.host:"");let e="";if("/"!==o.substring(0,1)){let n=t.pathname.lastIndexOf("/");n=n<0?0:n,e=t.pathname.substring(0,n)}o=`${a}${r}${e}/${o}`}return o},findClickableElement:e=>{let n=e;for(;n;){if(fs(n)||ps(n)||gs(n)||ws(n))return n;n=n.parentNode}return null},determineLinkType:(e,n,t,o)=>{let a="other";return Xn(t)&&(ys(n.downloadLinkQualifier,t,o)?a="download":vs(e,t)&&(a="exit")),a}});let _s;const Cs=e=>{if(!_s){const n=zn(window)(e.orgId||""),t=Is(),o=e.clickCollection.sessionStorageEnabled?n.session:t;_s=es({storage:o})}},Ts=({config:e,eventManager:n,handleError:t,logger:o})=>{ts(e,o);const a=e.clickCollection;_s||Cs(e);const r=Wi({config:e,logger:o,clickActivityStorage:_s,getClickedElementProperties:Ss}),i=Yi({clickActivityStorage:_s}),s=ns({clickActivityStorage:_s});return{lifecycle:{onComponentsRegistered(e){const{lifecycle:o}=e;Vi({eventManager:n,lifecycle:o,handleError:t})},onClick({event:e,clickedElement:n}){r({event:e,clickedElement:n})},onBeforeEvent({event:e}){bs(e)&&(a.eventGroupingEnabled&&i(e),s(e,o,_s))}}}};Ts.namespace="ActivityCollector",Ts.configValidators=Mi,Ts.buildOnInstanceConfiguredExtraParams=({config:e,logger:n})=>(_s||Cs(e),{getLinkDetails:t=>Ss({clickActivityStorage:_s,clickedElement:t,config:e,logger:n}).properties});const Ds=e=>`URL destination succeeded: ${e.spec.url}`;var ks=({fireReferrerHideableImage:e,logger:n,cookieJar:t,isPageSsl:o})=>{const a=o?{sameSite:"none",secure:!0}:{},r=e=>{e.filter((e=>"cookie"===e.type)).forEach((e=>{const{name:n,value:o,domain:r,ttlDays:i}=e.spec;t.set(n,o||"",{domain:r||"",expires:i||10,...a})}))},i=t=>{const o=t.filter((e=>"url"===e.type));return Promise.all(o.map((t=>e(t.spec).then((()=>{n.info(Ds(t))})).catch((()=>{}))))).then(Yn)};return e=>(r(e),i(e))},xs=({processDestinations:e})=>{const n=({response:n})=>{const t=n.getPayloadsByType("activation:push");return e(t)},t=({response:e})=>({destinations:e.getPayloadsByType("activation:pull")});return({response:e})=>n({response:e}).then((()=>t({response:e})))};const Ps=({logger:e,fireReferrerHideableImage:n})=>{const t=ge.withConverter({write:e=>encodeURIComponent(e)}),o=be({logger:e,cookieJar:t}),a=ks({fireReferrerHideableImage:n,logger:e,cookieJar:o,isPageSsl:"https:"===window.location.protocol});return{lifecycle:{onResponse:xs({processDestinations:a})},commands:{}}};Ps.namespace="Audiences";var As=({storedConsent:e,taskQueue:n,defaultConsent:t,consent:o,sendSetConsentRequest:a,validateSetConsentOptions:r,consentHashStore:i,doesIdentityCookieExist:s})=>{const l={[zo]:t};let c=e.read();const m=s(),d=void 0!==c[zo];m&&d||i.clear(),m||(e.clear(),c={}),o.initializeConsent(l,c);const u=()=>{if(0===n.length){const n=e.read();void 0!==n[zo]&&o.setConsent(n)}};return{commands:{setConsent:{optionsValidator:r,run:({consent:e,identityMap:t,edgeConfigOverrides:r})=>{o.suspend();const s=i.lookup(e);return n.addTask((()=>s.isNew()?a({consentOptions:e,identityMap:t,edgeConfigOverrides:r}):Promise.resolve())).then((()=>s.save())).finally(u)}}},lifecycle:{onResponse:u,onRequestFailure:u}}};const Os=e=>Array.isArray(e)?e.map((e=>Os(e))):"object"==typeof e&&null!==e?Object.keys(e).sort().reduce(((n,t)=>(n[t]=Os(e[t]),n)),{}):e;var Es=e=>Se(JSON.stringify(Os(e)));const Ns=({standard:e,version:n})=>`${e}.${n}`;var Ls=({storage:e})=>({clear(){e.clear()},lookup(n){const t={},o=e=>{const n=Ns(e),{standard:o,version:a,...r}=e;return t[n]||(t[n]=Es(r).toString()),t[n]};return{isNew:()=>n.some((n=>{const t=Ns(n),a=e.getItem(t);return null===a||a!==o(n)})),save(){n.forEach((n=>{const t=Ns(n);e.setItem(t,o(n))}))}}}}),Rs=()=>{const e={},n=Da({content:e,addIdentity:(n,t)=>{e.identityMap=e.identityMap||{},e.identityMap[n]=e.identityMap[n]||[],e.identityMap[n].push(t)},hasIdentity:n=>void 0!==(e.identityMap&&e.identityMap[n])});return n.setConsent=n=>{e.consent=n},n},Us=({payload:e,datastreamIdOverride:n})=>Ca({payload:e,datastreamIdOverride:n,getAction:()=>"privacy/set-consent",getUseSendBeacon:()=>!1}),Vs=({parseConsentCookie:e,orgId:n,cookieJar:t})=>{const o=Cn(n,Vn);return{read(){const n=t.get(o);return n?e(n):{}},clear(){t.remove(o)}}},js=({createConsentRequestPayload:e,createConsentRequest:n,sendEdgeNetworkRequest:t,edgeConfigOverrides:o})=>({consentOptions:a,identityMap:r,edgeConfigOverrides:i})=>{const s=Pa({payload:e(),globalConfigOverrides:o,localConfigOverrides:i});s.payload.setConsent(a),ue(r)&&Object.keys(r).forEach((e=>{r[e].forEach((n=>{s.payload.addIdentity(e,n)}))}));const l=n(s);return t({request:l}).then((()=>{}))},qs=e=>e.split(";").reduce(((e,n)=>{const[t,o]=n.split("=");return e[t]=o,e}),{}),Ms=To({consent:vo(yo()).required().nonEmpty(),identityMap:xo,edgeConfigOverrides:Po}).noUnknownFields().required(),Fs=To({defaultConsent:ko(Mo,Fo,Bo).default(Mo)});const Bs=({config:e,consent:n,sendEdgeNetworkRequest:t,createNamespacedStorage:o})=>{const{orgId:a,defaultConsent:r}=e,i=Vs({parseConsentCookie:qs,orgId:a,cookieJar:ge}),s=Ie(),l=js({createConsentRequestPayload:Rs,createConsentRequest:Us,sendEdgeNetworkRequest:t,edgeConfigOverrides:e.edgeConfigOverrides}),c=o(`${_n(a)}.consentHashes.`),m=Ls({storage:c.persistent}),d=qn({orgId:a});return As({storedConsent:i,taskQueue:s,defaultConsent:r,consent:n,sendSetConsentRequest:l,validateSetConsentOptions:Ms,consentHashStore:m,doesIdentityCookieExist:d})};Bs.namespace="Consent",Bs.configValidators=Fs;var zs=()=>({eventMergeId:l()});n.createEventMergeId=zs;var Hs={PAUSE:"media.pauseStart",PLAY:"media.play",BUFFER_START:"media.bufferStart",AD_START:"media.adStart",Ad_BREAK_START:"media.adBreakStart",SESSION_END:"media.sessionEnd",SESSION_START:"media.sessionStart",SESSION_COMPLETE:"media.sessionComplete",PING:"media.ping",AD_BREAK_COMPLETE:"media.adBreakComplete",AD_COMPLETE:"media.adComplete",AD_SKIP:"media.adSkip",BITRATE_CHANGE:"media.bitrateChange",CHAPTER_COMPLETE:"media.chapterComplete",CHAPTER_SKIP:"media.chapterSkip",CHAPTER_START:"media.chapterStart",ERROR:"media.error",STATES_UPDATE:"media.statesUpdate"},$s=({mediaRequestPayload:e,action:n})=>Ca({payload:e,edgeSubPath:"/va",getAction:()=>n,getUseSendBeacon:()=>!1}),Ws=({config:e,eventManager:n,consent:t,sendEdgeNetworkRequest:o,setTimestamp:a})=>({createMediaEvent({options:t}){const o=n.createEvent(),{xdm:r}=t;if(a(r),o.setUserXdm(r),r.eventType===Hs.AD_START){const{advertisingDetails:n}=t.xdm.mediaCollection;o.mergeXdm({mediaCollection:{advertisingDetails:{playerName:n.playerName||e.streamingMedia.playerName}}})}return o},createMediaSession(t){const{playerName:o,channel:a,appVersion:r}=e.streamingMedia,i=n.createEvent(),{sessionDetails:s}=t.xdm.mediaCollection;return i.setUserXdm(t.xdm),i.mergeXdm({eventType:Hs.SESSION_START,mediaCollection:{sessionDetails:{playerName:s.playerName||o,channel:s.channel||a,appVersion:s.appVersion||r}}}),i},augmentMediaEvent({event:e,playerId:n,getPlayerDetails:t,sessionID:o}){if(!n||!t)return e;const{playhead:a,qoeDataDetails:r}=t({playerId:n});return e.mergeXdm({mediaCollection:{playhead:it(a),qoeDataDetails:r,sessionID:o}}),e},trackMediaSession({event:e,mediaOptions:t,edgeConfigOverrides:o}){const a={mediaOptions:t,edgeConfigOverrides:o};return n.sendEvent(e,a)},trackMediaEvent({event:e,action:n}){const a=xa(),r=$s({mediaRequestPayload:a,action:n});return a.addEvent(e),e.finalize(),t.awaitConsent().then((()=>o({request:r}).then((()=>({})))))}}),Gs={MAIN:"main",COMPLETED:"completed"},Qs=()=>{let e;return{getSession:n=>e[n]||{},storeSession:({playerId:n,sessionDetails:t})=>{void 0===e&&(e={}),e[n]=t},stopPing:({playerId:n})=>{const t=e[n];t&&(clearTimeout(t.pingId),t.pingId=null,t.playbackState=Gs.COMPLETED)},savePing:({playerId:n,pingId:t,playbackState:o})=>{e[n]&&(e[n].pingId&&clearTimeout(e[n].pingId),e[n].pingId=t,e[n].playbackState=o)}}};const Js=(e,n)=>e===Hs.AD_START||e===Hs.Ad_BREAK_START||e===Hs.AD_SKIP||e===Hs.AD_COMPLETE?"ad":e===Hs.AD_BREAK_COMPLETE||e===Hs.CHAPTER_COMPLETE||e===Hs.CHAPTER_START||e===Hs.CHAPTER_SKIP||e===Hs.SESSION_START?"main":e===Hs.SESSION_END||e===Hs.SESSION_COMPLETE?"completed":n;var Xs=({mediaEventManager:e,mediaSessionCacheManager:n,config:t})=>{const o=a=>{const r=e.createMediaEvent({options:a}),{playerId:i,xdm:s}=a,{eventType:l}=s,c=l.split(".")[1],{getPlayerDetails:m,sessionPromise:d,playbackState:u}=n.getSession(i);return d.then((a=>a.sessionId?(e.augmentMediaEvent({event:r,eventType:l,playerId:i,getPlayerDetails:m,sessionID:a.sessionId}),e.trackMediaEvent({event:r,action:c}).then((()=>{if(i)if(l===Hs.SESSION_COMPLETE||l===Hs.SESSION_END)n.stopPing({playerId:i});else{const e=Js(l,u);if("completed"===e)return;const a="ad"===e?t.streamingMedia.adPingInterval:t.streamingMedia.mainPingInterval,r=setTimeout((()=>{const e={playerId:i,xdm:{eventType:Hs.PING}};o(e)}),1e3*a);n.savePing({playerId:i,pingId:r,playbackState:e})}}))):Promise.reject(new Error(`Failed to trigger media event: ${l}. Session ID is not available for playerId: ${i}.`))))};return e=>o(e)},Ys=({config:e,mediaEventManager:n,mediaSessionCacheManager:t,legacy:o=!1})=>a=>{if(!e.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));const{playerId:r,getPlayerDetails:i,edgeConfigOverrides:s}=a,l=n.createMediaSession(a);n.augmentMediaEvent({event:l,playerId:r,getPlayerDetails:i});const c=n.trackMediaSession({event:l,mediaOptions:{playerId:r,getPlayerDetails:i,legacy:o},edgeConfigOverrides:s});return t.storeSession({playerId:r,sessionDetails:{sessionPromise:c,getPlayerDetails:i,playbackState:Gs.MAIN}}),c},Ks=e=>!Jn(e)||!e.trim(),Zs=({mediaSessionCacheManager:e,config:n,trackMediaEvent:t})=>({response:o,playerId:a,getPlayerDetails:r})=>{const i=o.getPayloadsByType("media-analytics:new-session");if(qe(i)){const{sessionId:o}=i[0];if(Ks(o))return{};if(!a||!r)return{sessionId:o};const s=setTimeout((()=>{t({playerId:a,xdm:{eventType:Hs.PING}})}),1e3*n.streamingMedia.mainPingInterval);return e.savePing({playerId:a,pingId:s,playbackState:Gs.MAIN}),{sessionId:o}}return{}};const el={Video:"video",Audio:"audio"},nl={VOD:"vod",Live:"live",Linear:"linear",Podcast:"podcast",Audiobook:"audiobook",AOD:"aod"},tl={FullScreen:"fullScreen",ClosedCaption:"closedCaptioning",Mute:"mute",PictureInPicture:"pictureInPicture",InFocus:"inFocus"},ol={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",StateStart:"stateStart",StateEnd:"stateEnd"},al={SessionStart:"sessionStart",SessionEnd:"sessionEnd",SessionComplete:"sessionComplete",Play:"play",Pause:"pauseStart",Error:"error",StateUpdate:"statesUpdate"},rl={MediaResumed:"media.resumed",GranularAdTracking:"media.granularadtracking"},il={Show:"a.media.show",Season:"a.media.season",Episode:"a.media.episode",AssetId:"a.media.asset",Genre:"a.media.genre",FirstAirDate:"a.media.airDate",FirstDigitalDate:"a.media.digitalDate",Rating:"a.media.rating",Originator:"a.media.originator",Network:"a.media.network",ShowType:"a.media.type",AdLoad:"a.media.adLoad",MVPD:"a.media.pass.mvpd",Authorized:"a.media.pass.auth",DayPart:"a.media.dayPart",Feed:"a.media.feed",StreamFormat:"a.media.format"},sl={Artist:"a.media.artist",Album:"a.media.album",Label:"a.media.label",Author:"a.media.author",Station:"a.media.station",Publisher:"a.media.publisher"},ll={Advertiser:"a.media.ad.advertiser",CampaignId:"a.media.ad.campaign",CreativeId:"a.media.ad.creative",PlacementId:"a.media.ad.placement",SiteId:"a.media.ad.site",CreativeUrl:"a.media.ad.creativeURL"};var cl=({trackMediaEvent:e,trackMediaSession:n,mediaResponseHandler:t,logger:o,createMediaHelper:a,createGetInstance:r,config:i})=>({lifecycle:{onBeforeEvent({mediaOptions:e,onResponse:n=Yn}){if(!e)return;const{legacy:o,playerId:a,getPlayerDetails:r}=e;o&&n((({response:e})=>t({playerId:a,getPlayerDetails:r,response:e})))}},commands:{getMediaAnalyticsTracker:{run:()=>{if(!i.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));o.info("Streaming media is configured in legacy mode.");const t=a({logger:o});return Promise.resolve({getInstance:()=>r({logger:o,trackMediaEvent:e,trackMediaSession:n,uuid:l}),Event:ol,MediaType:el,PlayerState:tl,StreamType:nl,MediaObjectKey:rl,VideoMetadataKeys:il,AudioMetadataKeys:sl,AdMetadataKeys:ll,...t})}}}}),ml=({logger:e})=>{const n=(n,t,o)=>{const a={friendlyName:n,offset:t,index:o},r=To({friendlyName:Do().nonEmpty(),offset:_o(),index:_o()});try{const e=r(a);return{advertisingPodDetails:{friendlyName:e.friendlyName,offset:e.offset,index:e.index}}}catch(n){return e.warn("An error occurred while creating the Ad Break Object.",n),{}}},t=(n,t,o,a)=>{const r={friendlyName:n,name:t,podPosition:o,length:a},i=To({friendlyName:Do().nonEmpty(),name:Do().nonEmpty(),podPosition:_o(),length:_o()});try{const e=i(r);return{advertisingDetails:{friendlyName:e.friendlyName,name:e.name,podPosition:e.podPosition,length:e.length}}}catch(n){return e.warn("An error occurred while creating the Advertising Object.",n),{}}},o=(n,t,o,a)=>{const r={friendlyName:n,offset:t,length:o,index:a},i=To({friendlyName:Do().nonEmpty(),offset:_o(),length:_o(),index:_o()});try{const e=i(r);return{chapterDetails:{friendlyName:e.friendlyName,offset:e.offset,index:e.index,length:e.length}}}catch(n){return e.warn("An error occurred while creating the Chapter Object.",n),{}}},a=n=>{const t=/^[a-zA-Z0-9_]{1,64}$/,o=Do().matches(t,"This is not a valid state name.");try{return{name:o(n)}}catch(n){return e.warn("An error occurred while creating the State Object.",n),{}}},r=(n,t,o,a)=>{const r={bitrate:n,droppedFrames:t,fps:o,startupTime:a},i=To({bitrate:_o(),droppedFrames:_o(),fps:_o(),startupTime:_o()});try{const e=i(r);return{bitrate:e.bitrate,droppedFrames:e.droppedFrames,framesPerSecond:e.fps,timeToStart:e.startupTime}}catch(n){return e.warn("An error occurred while creating the QOE Object.",n),{}}};return{createMediaObject:(n,t,o,a,r)=>{const i={friendlyName:n,name:t,length:o,streamType:r,contentType:a},s=To({friendlyName:Do().nonEmpty(),name:Do().nonEmpty(),length:_o().required(),streamType:Do().nonEmpty(),contentType:Do().nonEmpty()});try{const e=s(i);return{sessionDetails:{name:e.name,friendlyName:e.friendlyName,length:e.length,streamType:e.streamType,contentType:e.contentType}}}catch(n){return e.warn("An error occurred while creating the Media Object.",n),{}}},createAdBreakObject:n,createAdObject:t,createChapterObject:o,createStateObject:a,createQoEObject:r}};const dl={"a.media.show":"show","a.media.season":"season","a.media.episode":"episode","a.media.asset":"assetID","a.media.genre":"genre","a.media.airDate":"firstAirDate","a.media.digitalDate":"firstDigitalDate","a.media.rating":"rating","a.media.originator":"originator","a.media.network":"network","a.media.type":"showType","a.media.adLoad":"adLoad","a.media.pass.mvpd":"mvpd","a.media.pass.auth":"authorized","a.media.dayPart":"dayPart","a.media.feed":"feed","a.media.format":"streamFormat","a.media.artist":"artist","a.media.album":"album","a.media.label":"label","a.media.author":"author","a.media.station":"station","a.media.publisher":"publisher","media.resumed":"hasResume"},ul={"a.media.ad.advertiser":"advertiser","a.media.ad.campaign":"campaignID","a.media.ad.creative":"creativeID","a.media.ad.placement":"placementID","a.media.ad.site":"siteID","a.media.ad.creativeURL":"creativeURL"};var fl=({logger:e,trackMediaSession:n,trackMediaEvent:t,uuid:o})=>{let a=null;const r=()=>{a={qoe:null,lastPlayhead:0,playerId:o()}},i=({eventType:e})=>e===ol.BufferComplete||e===ol.SeekComplete?al.Play:e===ol.StateStart||e===ol.StateEnd?al.StateUpdate:e===ol.SeekStart?al.Pause:e,s=({eventType:e,mediaDetails:n={},contextData:t=[]})=>{const o=i({eventType:e});if(e===ol.StateStart)return{eventType:`media.${o}`,mediaCollection:{statesStart:[n]}};if(e===ol.StateEnd)return{eventType:`media.${o}`,mediaCollection:{statesEnd:[n]}};const a={eventType:`media.${o}`,mediaCollection:{...n}},r=[];return Object.keys(t).forEach((e=>{dl[e]?a.mediaCollection.sessionDetails[dl[e]]=t[e]:ul[e]?a.mediaCollection.advertisingDetails[ul[e]]=t[e]:r.push({name:e,value:t[e]})})),qe(r)&&(a.mediaCollection.customMetadata=r),a};return{trackSessionStart:(t,o={})=>{if(de(t)||wn(t))return e.warn("Invalid media object"),{};null===a&&(e.warn("The Media Session was completed. Restarting a new session."),r());const i=s({eventType:al.SessionStart,mediaDetails:t,contextData:o});return n({playerId:a.playerId,getPlayerDetails:()=>({playhead:a.lastPlayhead,qoeDataDetails:a.qoe}),xdm:i})},trackPlay:()=>{if(null===a)return e.warn("The Media Session was completed."),{};const n=s({eventType:al.Play});return t({playerId:a.playerId,xdm:n})},trackPause:()=>{if(null===a)return e.warn("The Media Session was completed."),{};const n=s({eventType:al.Pause});return t({playerId:a.playerId,xdm:n})},trackSessionEnd:()=>{if(null===a)return e.warn("The Media Session was completed."),{};const n=s({eventType:al.SessionEnd});return t({playerId:a.playerId,xdm:n})},trackComplete:()=>{if(null===a)return e.warn("The Media Session was completed."),{};const n=s({eventType:al.SessionComplete});return t({playerId:a.playerId,xdm:n})},trackError:n=>{if(e.warn(`trackError(${n})`),null===a)return e.warn("The Media Session was completed."),{};const o={name:n,source:"player"},r=s({eventType:al.Error,mediaDetails:{errorDetails:o}});return t({playerId:a.playerId,xdm:r})},trackEvent:(n,o,r)=>{if(wn(o))return e.warn("Invalid media object."),{};if(null===a)return e.warn("The Media Session was completed."),{};if(!Object.values(ol).includes(n))return e.warn("Invalid event type"),{};const i=s({eventType:n,mediaDetails:o,contextData:r});return t({playerId:a.playerId,xdm:i})},updatePlayhead:n=>{null!==a?Wn(n)&&(a.lastPlayhead=parseInt(n,10)):e.warn("The Media Session was completed.")},updateQoEObject:n=>{null!==a?n&&(a.qoe=n):e.warn("The Media Session was completed.")},destroy:()=>{e.warn("Destroy called, destroying the tracker."),a=null}}};const pl=({eventManager:e,sendEdgeNetworkRequest:n,config:t,logger:o,consent:a})=>{const r=Qs(),i=Ws({sendEdgeNetworkRequest:n,config:t,consent:a,eventManager:e,setTimestamp:yr((()=>new Date))}),s=Xs({mediaSessionCacheManager:r,mediaEventManager:i,config:t}),l=Ys({config:t,mediaEventManager:i,mediaSessionCacheManager:r,legacy:!0}),c=Zs({mediaSessionCacheManager:r,config:t,trackMediaEvent:s});return cl({mediaResponseHandler:c,trackMediaSession:l,trackMediaEvent:s,createMediaHelper:ml,createGetInstance:fl,logger:o,config:t})};pl.namespace="Legacy Media Analytics";const gl="web",wl="webapp",hl="://",yl="#",vl=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,bl=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,Il=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,Sl=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,_l=(e="/")=>{let n=e.length;for(;n>0&&-1!=="/".indexOf(e.charAt(n-1));)n-=1;return e.substring(0,n)||"/"},Cl=e=>Xn(e)?e.toLowerCase():"",Tl=e=>Xn(e)?e.toLowerCase():"",Dl=e=>Xn(e)?_l(e):"/",kl=e=>{const n=e.match(vl);return n?{surfaceType:Cl(n[1]),authority:Tl(n[2]),path:Dl(n[3]),fragment:n[4]}:null},xl=e=>`${e.surfaceType}${hl}${e.authority}${e.path||""}${e.fragment||""}`,Pl=e=>{const n=e(),t=n.host.toLowerCase(),o=n.pathname;return gl+hl+t+_l(o)},Al=(e,n)=>e.startsWith(yl)?Pl(n)+e:e,Ol=(e,n,t)=>{const o=e=>(t.warn(e),null);if(!Xn(e))return o(`Invalid surface: ${e}`);const a=Al(e,n),r=kl(a);return null===r?o(`Invalid surface: ${e}`):[gl,wl].includes(r.surfaceType)?r.authority&&bl.test(r.authority)?r.path&&!Il.test(r.path)?o(`Invalid path ${r.path} in surface: ${e}`):r.fragment&&!Sl.test(r.fragment)?o(`Invalid fragment ${r.fragment} in surface: ${e}`):r:o(`Invalid authority ${r.authority} in surface: ${e}`):o(`Unsupported surface type ${r.surfaceType} in surface: ${e}`)},El=e=>!!e&&0===e.indexOf(gl+hl)&&-1===e.indexOf(yl),Nl=(e=[],n,t)=>e.map((e=>Ol(e,n,t))).filter((e=>!de(e))).map(xl),Ll="https://ns.adobe.com/personalization/default-content-item",Rl="https://ns.adobe.com/personalization/dom-action",Ul="https://ns.adobe.com/personalization/html-content-item",Vl="https://ns.adobe.com/personalization/json-content-item",jl="https://ns.adobe.com/personalization/ruleset-item",ql="https://ns.adobe.com/personalization/redirect-item",Ml="https://ns.adobe.com/personalization/message/in-app",Fl="https://ns.adobe.com/personalization/message/content-card",Bl=e=>{e.includes(Sa)||e.push(Sa)},zl=(e,n)=>{const t=Pl(n);e.includes(t)||e.push(t)},Hl=e=>e.filter(((n,t)=>e.indexOf(n)===t));var $l=({getPageLocation:e,renderDecisions:n,decisionScopes:t,personalization:o,event:a,isCacheInitialized:r,logger:i})=>{const s=a.getViewName();return{isRenderDecisions:()=>n,isSendDisplayEvent:()=>!!o.sendDisplayEvent,shouldIncludeRenderedPropositions:()=>!!o.includeRenderedPropositions,getViewName:()=>s,hasScopes:()=>t.length>0||qe(o.decisionScopes),hasSurfaces:()=>qe(o.surfaces),hasViewName:()=>Xn(s),createQueryDetails(){const n=[...t];qe(o.decisionScopes)&&n.push(...o.decisionScopes);const a=Nl(o.surfaces,e,i);this.shouldRequestDefaultPersonalization()&&(Bl(n),zl(a,e));const r=[Ll,Ul,Vl,ql,jl,Ml,Fl];return n.includes(Sa)&&r.push(Rl),{schemas:r,decisionScopes:Hl(n),surfaces:Hl(a)}},isCacheInitialized:()=>r,shouldFetchData(){return this.hasScopes()||this.hasSurfaces()||this.shouldRequestDefaultPersonalization()},shouldUseCachedData(){return this.hasViewName()&&!this.shouldFetchData()},shouldRequestDefaultPersonalization(){return o.defaultPersonalizationEnabled||!this.isCacheInitialized()&&!1!==o.defaultPersonalizationEnabled}}};const Wl="Rendering is disabled for authoring mode.",Gl="decisioning.propositionDisplay",Ql="decisioning.propositionInteract",Jl="decisioning.propositionTrigger",Xl="decisioning.propositionDismiss",Yl="decisioning.propositionSuppressDisplay",Kl=1,Zl={DISPLAY:"display",INTERACT:"interact",TRIGGER:"trigger",DISMISS:"dismiss",SUPPRESS:"suppressDisplay"},ec={[Gl]:Zl.DISPLAY,[Ql]:Zl.INTERACT,[Jl]:Zl.TRIGGER,[Xl]:Zl.DISMISS,[Yl]:Zl.SUPPRESS},nc={[Zl.DISPLAY]:Gl,[Zl.INTERACT]:Ql,[Zl.TRIGGER]:Jl,[Zl.DISMISS]:Xl,[Zl.SUPPRESS]:Yl},tc=e=>ec[e],oc=e=>nc[e],ac={propositions:[]};var rc=({logger:e,options:n})=>{const t=To({propositions:vo(To({id:Do().required(),scope:Do().required(),scopeDetails:To({decisionProvider:Do().required()}).required(),items:vo(To({id:Do().required(),schema:Do().required(),data:To(yo())})).nonEmpty().required()}).required()).nonEmpty().required(),metadata:To(yo()),viewName:Do()}).required();try{return t(n)}catch(n){return e.warn("Invalid options for applyPropositions. No propositions will be applied.",n),ac}},ic=({getPageLocation:e,logger:n,fetchDataHandler:t,viewChangeHandler:o,onClickHandler:a,isAuthoringModeEnabled:r,mergeQuery:i,viewCache:s,showContainers:l,applyPropositions:c,setTargetMigration:m,mergeDecisionsMeta:d,renderedPropositions:u,onDecisionHandler:f,handleConsentFlicker:p})=>({lifecycle:{onComponentsRegistered(){p()},onDecision:f,onBeforeRequest:({request:e})=>(m(e),Promise.resolve()),onBeforeEvent({event:a,renderDecisions:c,decisionScopes:m=[],personalization:f={},onResponse:p=Yn,onRequestFailure:g=Yn}){if(p((()=>({propositions:[]}))),g((()=>l())),r())return n.warn(Wl),i(a,{enabled:!1}),Promise.resolve();const w=$l({getPageLocation:e,renderDecisions:c,decisionScopes:m,personalization:f,event:a,isCacheInitialized:s.isInitialized(),logger:n}),h=[];if(w.shouldIncludeRenderedPropositions()&&h.push(u.clear()),w.shouldFetchData()){const e=s.createCacheUpdate(w.getViewName());g((()=>e.cancel())),t({cacheUpdate:e,personalizationDetails:w,event:a,onResponse:p})}else w.shouldUseCachedData()&&h.push(o({personalizationDetails:w,event:a,onResponse:p,onRequestFailure:g}));return Promise.all(h).then((e=>{const n=e.flatMap((e=>e));qe(n)&&d(a,n,[Zl.DISPLAY])}))},onClick({event:e,clickedElement:n}){a({event:e,clickedElement:n})}},commands:{applyPropositions:{optionsValidator:e=>rc({logger:n,options:e}),run:c}}}),sc=(e="undefined")=>Pe(Ne,{},{innerHTML:e});const lc=":eq(",cc=/:eq\((\d+)\)/g,mc=e=>-1===e.indexOf(lc),dc=e=>e.split(cc).filter(Xn),uc=/(#|\.)(-?\w+)/g,fc=(e,n,t)=>`${n}${CSS.escape(t)}`,pc=e=>e.replace(uc,fc),gc=e=>{const n=[],t=pc(e.trim()),o=dc(t),{length:a}=o;let r=0;for(;r<a;){const e=o[r],t=o[r+1];t?n.push({sel:e,eq:Number(t)}):n.push({sel:e}),r+=2}return n},wc=e=>{const n=document;if(mc(e))return Qe(e,n);const t=gc(e),{length:o}=t;let a=[],r=n,i=0;for(;i<o;){const{sel:e,eq:n}=t[i],s=Qe(e,r),{length:l}=s;if(0===l)break;if(null!=n&&n>l-1)break;i<o-1&&(null==n?[r]=s:r=s[n]),i===o-1&&(a=null==n?s:[s[n]]),i+=1}return a};var hc=(e,n=document)=>n.getElementById(e),yc=(e,n,t)=>{e.setAttribute(n,t)},vc=(e,n)=>e.getAttribute(n),bc=(e,n)=>{e.removeAttribute(n)},Ic=(e,n,t,o)=>{let a;a=o?`${n}:${t} !${o};`:`${n}:${t};`,e.style.cssText+=`;${a}`},Sc=e=>e.parentNode,_c=e=>e.nextElementSibling,Cc=(e,n)=>{if(!e)return;const t=Sc(e);t&&t.insertBefore(n,_c(e))},Tc=(e,n)=>{if(!e)return;const t=Sc(e);t&&t.insertBefore(n,e)},Dc=e=>{const{children:n}=e;return n?Me(n):[]},kc=e=>{const{childNodes:n}=e;return n?Me(n):[]},xc=e=>e.firstElementChild;let Pc;var Ac=(e=document)=>{if(void 0===Pc){const n=e.querySelector("[nonce]");Pc=n&&(n.nonce||n.getAttribute("nonce"))}return Pc};const Oc="src",Ec=e=>e.tagName===Ee,Nc=e=>Pe(Ee,{src:e}),Lc=e=>{Qe(Ee,e).forEach((e=>{const n=vc(e,Oc);n&&Nc(n)}))},Rc=(e,n)=>e.tagName===n,Uc=e=>Rc(e,Le)&&!vc(e,Oc);var Vc=e=>{const n=Qe(Le,e),{length:t}=n,o=Ac();if(o)for(let e=0;e<t;e+=1){const t=n[e];Uc(t)&&(t.nonce=o)}};const jc=(e,n)=>new Promise(((t,o)=>{n.onload=()=>{t(n)},n.onerror=()=>{o(new Error(`Failed to load script: ${e}`))}})),qc=e=>{const n=document.createElement("script");n.src=e,n.async=!0;const t=jc(e,n);return document.head.appendChild(n),t},Mc=(e,n)=>!!e&&e.tagName===n,Fc=e=>Mc(e,Re)&&!vc(e,Oc),Bc=e=>Mc(e,Re)&&vc(e,Oc),zc=e=>{const n=Qe(Re,e),t=[],{length:o}=n,a=Ac(),r={...a&&{nonce:a}};for(let e=0;e<o;e+=1){const o=n[e];if(!Fc(o))continue;const{textContent:a}=o;a&&t.push(Pe(Re,r,{textContent:a}))}return t},Hc=e=>{const n=Qe(Re,e),t=[],{length:o}=n;for(let e=0;e<o;e+=1){const o=n[e];if(!Bc(o))continue;const a=vc(o,Oc);a&&t.push(a)}return t},$c=(e,n)=>{n.forEach((n=>{e.appendChild(n),e.removeChild(n)}))},Wc=e=>Promise.all(e.map(qc));var Gc=(e,n,t)=>{const o=sc(n);Vc(o);const a=kc(o),r=zc(o),i=Hc(o);return Lc(o),a.forEach((n=>{ke(e,n)})),t(e),$c(e,r),Wc(i)};const Qc=e=>{kc(e).forEach(un)};var Jc=(e,n,t)=>(Qc(e),Gc(e,n,t)),Xc=(e,n,t)=>{const o=sc(n);Vc(o);const a=kc(o),r=zc(o),i=Hc(o),{length:s}=a;let l=s-1;for(Lc(o);l>=0;){const n=a[l];t(n);const o=xc(e);o?Tc(o,n):ke(e,n),l-=1}return $c(e,r),Wc(i)};const Yc="alloy-prehiding",Kc="{ visibility: hidden }",Zc={},em=e=>{if(Zc[e])return;const n=Ac(),t={...n&&{nonce:n}},o=Pe(Le,t,{textContent:`${e} ${Kc}`});ke(document.head,o),Zc[e]=o},nm=e=>{const n=Zc[e];n&&(un(n),delete Zc[e])},tm=e=>n=>{if(!n)return;if(hc(Yc))return;const t=Ac(),o={id:Yc,...t&&{nonce:t}},a=Pe(Le,o,{textContent:n});e.logOnContentHiding({status:"hide-containers",message:"Prehiding style applied to hide containers.",logLevel:"info"}),ke(document.head,a)},om=e=>()=>{const n=hc(Yc);n&&(e.logOnContentHiding({status:"show-containers",message:"Prehiding style removed to show containers.",logLevel:"info"}),un(n))};var am=(e,n,t)=>{t(e),e.textContent=n},rm=(e,n,t)=>{const o=sc(n);Vc(o);const a=kc(o),r=zc(o),i=Hc(o);return Lc(o),a.forEach((n=>{t(n),Tc(e,n)})),$c(e,r),Wc(i)},im=(e,n,t)=>rm(e,n,t).then((()=>{un(e)})),sm=(e,n,t)=>{const o=sc(n);Vc(o);const a=kc(o),r=zc(o),i=Hc(o);Lc(o);let s=e;return a.forEach((e=>{t(e),Cc(s,e),s=e})),$c(e,r),Wc(i)},lm=(e,n,t)=>{const{priority:o,...a}=n;Object.keys(a).forEach((n=>{Ic(e,n,a[n],o)})),t(e)},cm=(e,n,t)=>{Object.keys(n).forEach((t=>{yc(e,t,n[t])})),t(e)},mm=(e,n,t)=>{Ec(e)&&(Nc(n),t(e),bc(e,Oc),yc(e,Oc,n))},dm=(e,{from:n,to:t},o)=>{const a=Dc(e),r=a[n],i=a[t];r&&i&&(n<t?Cc(i,r):Tc(i,r),o(i),o(r))};const um=(e,n,t,o)=>{const a=e.map((e=>o(e,n,t)));return Promise.all(a)},fm=e=>(n,t)=>{const{selector:o,prehidingSelector:a,content:r}=n;return em(a),mn(o,wc).then((n=>um(n,r,t,e))).then((()=>{nm(a)}),(e=>{throw nm(a),e}))},pm=e=>`${e}`.endsWith("px")?e:`${e}px`;var gm=(e,n,t)=>{const{priority:o,...a}=n;Object.keys(a).forEach((n=>{let t=a[n];"left"!==n&&"top"!==n||(t=pm(t)),Ic(e,n,t,o)})),t(e)},wm=(e,n,t)=>{t(e)},hm=(e,n,t)=>{const{priority:o,...a}=n;Object.keys(a).forEach((n=>{let t=a[n];"width"!==n&&"height"!==n||(t=pm(t)),Ic(e,n,t,o)})),t(e)};const ym="setHtml",vm="customCode",bm="setText",Im="setAttribute",Sm="setImageSource",_m="setStyle",Cm="move",Tm="resize",Dm="rearrange",km="remove",xm="insertAfter",Pm="insertBefore",Am="replaceHtml",Om="prependHtml",Em="appendHtml",Nm="click",Lm="collectInteractions";var Rm=()=>({[ym]:fm(Jc),[vm]:fm(Xc),[bm]:fm(am),[Im]:fm(cm),[Sm]:fm(mm),[_m]:fm(lm),[Cm]:fm(gm),[Tm]:fm(hm),[Dm]:fm(dm),[km]:fm(un),[xm]:fm(sm),[Pm]:fm(rm),[Am]:fm(im),[Om]:fm(Xc),[Em]:fm(Gc),[Lm]:fm(wm)}),Um=({eventManager:e,mergeDecisionsMeta:n})=>({decisionsMeta:t=[],propositionAction:o,documentMayUnload:a=!1,eventType:r=Gl,propositionEventTypes:i=[tc(r)],viewName:s})=>{const l=e.createEvent(),c={eventType:r};return s&&(c.web={webPageDetails:{viewName:s}}),qe(t)&&n(l,t,i,o),l.mergeXdm(c),a&&l.documentMayUnload(),e.sendEvent(l)};const Vm="personalization:decisions";var jm=({logger:e,prehidingStyle:n,showContainers:t,hideContainers:o,mergeQuery:a,processPropositions:r,createProposition:i,notificationHandler:s,consent:l})=>({cacheUpdate:c,personalizationDetails:m,event:d,onResponse:u})=>{const{state:f,wasSet:p}=l.current();"out"===f&&p||(m.isRenderDecisions()?o(n):t()),a(d,m.createQueryDetails());const g=s(m.isRenderDecisions(),m.isSendDisplayEvent(),m.getViewName());u((({response:n})=>{const o=n.getPayloadsByType(Vm);qe(o)||e.logOnContentRendering({status:"no-offers",message:"No offers were returned.",logLevel:"info",detail:{query:m.createQueryDetails()}});const a=o.map((e=>i(e))),{page:s=[],view:l=[],proposition:d=[]}=Tn(a,(e=>e.getScopeType())),u=c.update(l);let f,p,w;return m.isRenderDecisions()?(({render:f,returnedPropositions:p,returnedDecisions:w}=r([...s,...u],d)),qe(s)&&e.logOnContentRendering({status:"rendering-started",message:"Started rendering propositions for page-wide scope.",logLevel:"info",detail:{scope:Sa,propositions:s.map((e=>e.toJSON()))}}),qe(u)&&e.logOnContentRendering({status:"rendering-started",message:`Rendering propositions started for view scope - ${m.getViewName()}.`,logLevel:"info",detail:{scope:m.getViewName(),propositions:u.map((e=>e.toJSON()))}}),f().then(g),t()):({returnedPropositions:p,returnedDecisions:w}=r([],[...s,...u,...d])),{propositions:p,decisions:w}}))},qm=(e,n)=>{if(mc(e))return dn(e,n);const t=wc(e);let o=!1;for(let e=0;e<t.length;e+=1)if(t[e]===n){o=!0;break}return o};const Mm="view",Fm="page",Bm="proposition",zm=e=>e.map((e=>{const{trackingLabel:n,scopeType:t,...o}=e;return o})),Hm=e=>e.filter(((n,t)=>{const o=JSON.stringify(n);return t===e.findIndex((e=>JSON.stringify(e)===o))})),$m=(e,n,t)=>{const{documentElement:o}=document;let a=e,r=0;for(;a&&a!==o;){if(qm(n,a)){const e=t(n),o={metas:e},a=e.find((e=>e.trackingLabel));a&&(o.label=a.trackingLabel,o.weight=r);const i=e.find((e=>e.scopeType===Mm));return i&&(o.viewName=i.scope,o.weight=r),o}a=a.parentNode,r+=1}return{metas:null}};var Wm=(e,n,t)=>{const o=[];let a,r="",i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(let l=0;l<n.length;l+=1){
const{metas:c,label:m,weight:d,viewName:u}=$m(e,n[l],t);c&&(m&&d<=i&&(r=m,i=d),u&&d<=s&&(a=u,s=d),o.push(...zm(c)))}return{decisionsMeta:Hm(o),propositionActionLabel:r,propositionActionToken:void 0,viewName:a}},Gm=(e=document)=>-1!==e.location.href.indexOf("adobe_authoring_enabled");const Qm=(e,n,t,o)=>{if(0===n.length)return;const a={};t.forEach((e=>{a[e]=Kl}));const r={_experience:{decisioning:{propositions:n,propositionEventType:a}}};o&&(r._experience.decisioning.propositionAction=o),e.mergeXdm(r)},Jm=(e,n)=>{e.mergeQuery({personalization:{...n}})},Xm=(e,n)=>{if(!n&&!e)return;const t={};return e&&(t.label=e),n&&(t.tokens=[n]),t};var Ym=({mergeDecisionsMeta:e,collectInteractions:n,collectClicks:t,getInteractionMetas:o,getClickMetas:a,getClickSelectors:r,autoCollectPropositionInteractions:i})=>({event:s,clickedElement:l})=>{const c=[];let m,d,u;if([n(l,o,i),t(l,r(),a)].forEach((({decisionsMeta:e,propositionActionLabel:n,propositionActionToken:t,viewName:o})=>{Array.prototype.push.apply(c,e),!m&&n&&(m=n),!d&&t&&(d=t),!u&&o&&(u=o)})),qe(c)){const n={eventType:Ql};u&&(n.web={webPageDetails:{viewName:u}}),s.mergeXdm(n),e(s,c,[Zl.INTERACT],Xm(m,d))}},Km=({createProposition:e})=>{let n=!1,t=Promise.resolve({});const o=(n,t)=>{const o=n[t.toLowerCase()];return o&&o.length>0?o:[e({scope:t,scopeDetails:{characteristics:{scopeType:Mm}},items:[{schema:Ll}]},!1)]};return{createCacheUpdate:e=>{const a=_e();return n=!0,t=t.then((e=>a.promise.then((n=>({...e,...n}))).catch((()=>e)))),{update(n){const t=n.filter((e=>e.getScope())),r=Tn(t,(e=>e.getScope().toLowerCase()));return a.resolve(r),e?o(r,e):[]},cancel(){a.reject()}}},getView:e=>t.then((n=>o(n,e))),isInitialized:()=>n}},Zm=({processPropositions:e,viewCache:n,logger:t})=>({personalizationDetails:o,onResponse:a})=>{let r,i;const s=o.getViewName();return a((()=>({propositions:r,decisions:i}))),n.getView(s).then((n=>{let a;return o.isRenderDecisions()?(({render:a,returnedPropositions:r,returnedDecisions:i}=e(n)),t.logOnContentRendering({status:"rendering-started",message:`Started rendering propositions for view scope - ${s}.`,logLevel:"info",detail:{scope:s,propositions:n.map((e=>e.toJSON()))}}),a()):(({returnedPropositions:r,returnedDecisions:i}=e([],n)),[])}))};const ed=e=>Object.keys(e).map((n=>({id:n,...e[n]})));var nd=()=>{const e={};return{storeClickMeta:({selector:n,meta:{id:t,scope:o,scopeDetails:a,trackingLabel:r,scopeType:i}})=>{e[n]||(e[n]={}),e[n][t]={scope:o,scopeDetails:a,trackingLabel:r,scopeType:i}},getClickSelectors:()=>Object.keys(e),getClickMetas:n=>e[n]?ed(e[n]):{}}},td=()=>{const e={},n={};return{storeInteractionMeta:(t,o,a,r,i)=>{i=parseInt(i,10),e[i]||(e[i]={},n[i]={}),n[i][t]||(n[i][t]=new Set),n[i][t].add(o),e[i][t]={...r,scopeType:a}},getInteractionMetas:t=>Array.isArray(t)&&0!==t.length?Object.values(t.map((e=>parseInt(e,10))).reduce(((t,o)=>(Object.keys(e[o]||{}).forEach((a=>{t[a]||(t[a]={proposition:e[o][a],items:new Set}),t[a].items=new Set([...t[a].items,...n[o][a]])})),t)),{})).map((({proposition:e,items:n})=>({...e,items:Array.from(n).map((e=>({id:e})))}))):[]}};const od=(e,n)=>e===Vl&&n===Lm,ad={[Rl]:()=>!0,[Ul]:()=>!0,[Vl]:od,[Ml]:()=>!0,[Ll]:()=>!0},rd=(e,n)=>"function"==typeof ad[e]&&ad[e](e,n);var id=({processPropositions:e,createProposition:n,renderedPropositions:t,viewCache:o})=>{const a=({items:e,metadataForScope:n={}})=>{const{actionType:t,selector:o}=n;return e.filter((e=>rd(e.schema,t))).map((e=>{const{schema:a}=e;return a===Ul||od(a,t)?wn(n)?void 0:{...e,schema:od(a,t)?Rl:a,data:{...e.data,selector:o,type:t}}:{...e}})).filter((e=>e))},r=e=>!(e.scope===Sa&&e.renderAttempted),i=({propositions:e,metadata:n})=>e.filter(r).map((e=>{if(qe(e.items)){const{id:t,scope:o,scopeDetails:r}=e;return{id:t,scope:o,scopeDetails:r,items:a({items:e.items,metadataForScope:n[e.scope]})}}return e})).filter((e=>qe(e.items)));return({propositions:a=[],metadata:r={},viewName:s})=>{const l=_e();t.concat(l.promise);const c=i({propositions:a,metadata:r}).map((e=>n(e)));return Promise.resolve().then((()=>s?o.getView(s):[])).then((n=>{const{render:t,returnedPropositions:o}=e([...c,...n]);return t().then(l.resolve),{propositions:o}}))}},sd=({window:e})=>()=>e.location,ld=({targetMigrationEnabled:e})=>e?e=>{e.getPayload().mergeMeta({target:{migration:!0}})}:Yn;const cd="BODY > *:eq(0)";var md=e=>{const{selector:n,type:t}=e;return t!==vm||n!==cd?e:{...e,selector:"BODY"}};const dd="SCRIPT,LINK,STYLE",ud=e=>{const n=sc(e);return Qe(dd,n).map((e=>e.outerHTML)).join("")};var fd=e=>{const n={...e},{content:t,selector:o}=n;if(Ks(t))return n;if(null==o)return n;const a=wc(o);return Mc(a[0],Ue)?(n.type=Em,n.content=ud(t),n):n},pd=e=>n=>n?e.reduce(((e,n)=>({...e,...n(e)})),n):n,gd=({preprocess:e,isPageWideSurface:n})=>{const t=(n,t)=>{const{id:o,schema:a,data:r,characteristics:{trackingLabel:i}={}}=n,s=r?r.type:void 0,l=e(r);return{getId:()=>o,getSchema:()=>a,getSchemaType:()=>s,getData:()=>l,getProposition:()=>t,getTrackingLabel:()=>i,getOriginalItem:()=>n,toString:()=>JSON.stringify(n),toJSON:()=>n}};return(e,o=!0,a=!1)=>{const{id:r,scope:i,scopeDetails:s,items:l=[]}=e,{characteristics:{scopeType:c}={}}=s||{};return{getScope:()=>i,getScopeType:()=>i===Sa||n(i)?Fm:c===Mm?Mm:Bm,getItems(){return l.map((e=>t(e,this)))},getNotification:()=>({id:r,scope:i,scopeDetails:s}),getId:()=>r,toJSON:()=>e,shouldSuppressDisplay:()=>a,addToReturnValues(n,t,a,r){o&&(n.push({...e,items:a.map((e=>e.getOriginalItem())),renderAttempted:r}),r||t.push({...e,items:a.map((e=>e.getOriginalItem()))}))}}}},wd=()=>{let e=Promise.resolve([]);return{concat(n){e=e.then((e=>n.then((n=>e.concat(n))).catch((()=>e))))},clear(){const n=e;return e=Promise.resolve([]),n}}},hd=()=>({render:Yn,setRenderAttempted:!0,includeInNotification:!0});const yd="always",vd="never",bd="decoratedElementsOnly",Id=[yd,vd,bd],Sd="data-aep-interact-id",_d="data-aep-click-label",Cd="data-aep-click-token";let Td=0;const Dd=(e,n)=>n?parseInt(n,10):++Td,kd=(e,n)=>!!e&&!!e[n]&&[yd,bd].includes(e[n]),xd=(e,n,t,o,a,r,i,s)=>{const{scopeDetails:l={}}=i,{decisionProvider:c}=l;return kd(e,c)||n===Nm?e=>{if(!e.tagName)return;const n=Dd(t,vc(e,Sd));s(t,o,r,i,n),yc(e,Sd,n),a&&!vc(e,_d)&&yc(e,_d,a)}:Yn};var Pd=({modules:e,logger:n,storeInteractionMeta:t,storeClickMeta:o,autoCollectPropositionInteractions:a})=>r=>{const{type:i,selector:s}=r.getData()||{};if(!i)return n.warn("Invalid DOM action data: missing type.",r.getData()),{setRenderAttempted:!1,includeInNotification:!1};if(i===Nm)return s?(o({selector:s,meta:{...r.getProposition().getNotification(),trackingLabel:r.getTrackingLabel(),scopeType:r.getProposition().getScopeType()}}),{setRenderAttempted:!0,includeInNotification:!1}):(n.warn("Invalid DOM action data: missing selector.",r.getData()),{setRenderAttempted:!1,includeInNotification:!1});if(!e[i])return n.warn("Invalid DOM action data: unknown type.",r.getData()),{setRenderAttempted:!1,includeInNotification:!1};const l=xd(a,i,r.getProposition().getId(),r.getId(),r.getTrackingLabel(),r.getProposition().getScopeType(),r.getProposition().getNotification(),t);return{render:()=>e[i](r.getData(),l),setRenderAttempted:!0,includeInNotification:!0}},Ad=({modules:e,logger:n,storeInteractionMeta:t,autoCollectPropositionInteractions:o})=>a=>{const{type:r,selector:i}=a.getData()||{};if(!i||!r)return{setRenderAttempted:!1,includeInNotification:!1};if(!e[r])return n.warn("Invalid HTML content data",a.getData()),{setRenderAttempted:!1,includeInNotification:!1};const s=xd(o,r,a.getProposition().getId(),a.getId(),a.getTrackingLabel(),a.getProposition().getScopeType(),a.getProposition().getNotification(),t);return{render:()=>e[r](a.getData(),s),setRenderAttempted:!0,includeInNotification:!0}};const Od="BODY";var Ed=({logger:e,executeRedirect:n,collect:t})=>o=>{const{content:a}=o.getData()||{};return a?{render:()=>(em(Od),t({decisionsMeta:[o.getProposition().getNotification()],documentMayUnload:!0}).then((()=>(e.logOnContentRendering({status:"rendering-redirect",detail:{propositionDetails:o.getProposition().getNotification(),redirect:a},message:`Redirect action ${o.toString()} executed.`,logLevel:"info"}),n(a)))).catch((e=>{throw nm(Od),e}))),setRenderAttempted:!0,onlyRenderThis:!0}:(e.warn("Invalid Redirect data",o.getData()),{})},Nd=({schemaProcessors:e,logger:n})=>{const t=(e,t)=>()=>Promise.resolve().then(e).then((()=>(n.enabled&&n.info(`Action ${t.toString()} executed.`),t.toJSON()))).catch((e=>{const{message:o,stack:a}=e,r=`Failed to execute action ${t.toString()}. ${o} ${a}`;n.logOnContentRendering({status:"rendering-failed",detail:{propositionDetails:t.getProposition().getNotification(),item:t.toJSON()},error:e,message:r,logLevel:"warn"})})),o=async(e,n)=>{const t=(await Promise.allSettled(e.map((e=>e())))).filter((e=>"fulfilled"===e.status)).map((e=>e.value));if(n&&qe(t))return{...n,items:t}},a=n=>{const t=e[n.getSchema()];return t?t(n):{}},r=({renderers:e,returnedPropositions:n,returnedDecisions:r,items:i,proposition:s})=>{let l,c,m,d,u=[...e],f=[...n],p=[...r],g=[],w=[],h=[],y=!1,v=!1,b=0;for(;i.length>b;){if(d=i[b],({render:l,setRenderAttempted:c,includeInNotification:m,onlyRenderThis:v}=a(d)),v){f=[],p=[],c?(g=[d],w=[]):(g=[],w=[d]),u=[],h=[l],y=m;break}l&&h.push(t(l,d)),m&&(y=!0),c?g.push(d):w.push(d),b+=1}if(h.length>0){const e=y?s.getNotification():void 0;u.push((()=>o(h,e)))}else y&&u.push((()=>Promise.resolve(s.getNotification())));return g.length>0&&s.addToReturnValues(f,p,g,!0),w.length>0&&s.addToReturnValues(f,p,w,!1),{renderers:u,returnedPropositions:f,returnedDecisions:p,onlyRenderThis:v}};return(e,t=[])=>{let o,a,i,s=[],l=[],c=[],m=0;for(;e.length>m&&(a=e[m],i=a.getItems(),({renderers:s,returnedPropositions:l,returnedDecisions:c,onlyRenderThis:o}=r({renderers:s,returnedPropositions:l,returnedDecisions:c,items:i,proposition:a})),!o);)m+=1;return o&&e.forEach(((e,n)=>{n!==m&&e.addToReturnValues(l,c,e.getItems(),!1)})),t.forEach((e=>{e.addToReturnValues(l,c,e.getItems(),!1)})),{returnedPropositions:l,returnedDecisions:c,render:()=>Promise.all(s.map((e=>e()))).then((e=>{const t=e.filter((e=>e)),o=t.map((e=>{const{id:n,scope:t,scopeDetails:o}=e;return{id:n,scope:t,scopeDetails:o}}));if(qe(t)){const e=Tn(t,(e=>e.scope));n.logOnContentRendering({status:"rendering-succeeded",detail:{...e},message:`Scopes: ${JSON.stringify(e)} successfully executed.`,logLevel:"info"})}return o}))}}};const Ld=()=>{let e=0;return n=>{const{items:t=[]}=n;return!!t.some((e=>e.schema===Ml))&&(e+=1,e>1)}};var Rd=({processPropositions:e,createProposition:n,notificationHandler:t})=>({renderDecisions:o,propositions:a,event:r,personalization:i={}})=>{if(!o)return Promise.resolve();const{sendDisplayEvent:s=!0}=i,l=r?r.getViewName():void 0,c=Ld(),m=a.map((e=>n(e,!0,c(e)))),{render:d,returnedPropositions:u}=e(m),f=t(o,s,l),p=m.reduce(((e,n)=>(e[n.getId()]=n,e)),{});return d().then((e=>{const n=e.filter((e=>!p[e.id].shouldSuppressDisplay())),t=e.filter((e=>p[e.id].shouldSuppressDisplay()));f(n,t)})),Promise.resolve({propositions:u})};const Ud="text/html",Vd="application/json",jd="defaultContent",qd=["content","contentType"],Md=["mobileParameters","webParameters","html"],Fd=(e,n)=>{for(let t=0;t<qd.length;t+=1){const o=qd[t];if(!Object.prototype.hasOwnProperty.call(e,o))return n.warn(`Invalid in-app message data: missing property '${o}'.`,e),!1}const{content:t,contentType:o}=e;if(o===Vd)for(let o=0;o<Md.length;o+=1){const a=Md[o];if(!Object.prototype.hasOwnProperty.call(t,a))return n.warn(`Invalid in-app message data.content: missing property '${a}'.`,e),!1}return!0};var Bd=({modules:e,logger:n})=>t=>{const o=t.getData(),a=t.getProposition(),r={...a.getNotification()},i=a.shouldSuppressDisplay();if(!o)return n.warn("Invalid in-app message data: undefined.",o),{};const{type:s=jd}=o;return e[s]?Fd(o,n)?r?{render:()=>i?null:e[s]({...o,meta:r}),setRenderAttempted:!0,includeInNotification:!0}:(n.warn("Invalid in-app message meta: undefined.",r),{}):{}:(n.warn("Invalid in-app message data: unknown type.",o),{})};const zd=e=>{const n=Qe(`#${e}`,document);n&&n.length>0&&un(n[0])},Hd=e=>{const n={};if(!e||"a"!==e.tagName.toLowerCase())return n;const{href:t}=e;if(!t||!t.startsWith("adbinapp://"))return n;const o=t.split("?"),a=o[0].split("://")[1],r=e.innerText,i=e.getAttribute("data-uuid")||"";let s,l;if(qe(o)){const e=me.default.parse(o[1]);s=e.interaction||"",l=ti(e.link||"")}return{action:a,interaction:s,link:l,label:r,uuid:i}};var $d=e=>(n,t=!1)=>(t?e.location.href=n:e.location.replace(n),new Promise((()=>{})));const Wd="alloy-messaging-container",Gd="alloy-overlay-container",Qd="alloy-content-iframe",Jd=()=>[Wd,Gd].forEach(zd),Xd=(e,n=$d(window))=>t=>{t.preventDefault(),t.stopImmediatePropagation();const{target:o}=t,a="a"===o.tagName.toLowerCase()?o:o.closest("a");if(!a)return;const{action:r,interaction:i,link:s,label:l,uuid:c}=Hd(a);e(r,{label:l,id:i,uuid:c,link:s}),"dismiss"===r&&Jd(),Xn(s)&&s.length>0&&n(s,!0)},Yd=(e,n)=>{const t=(new DOMParser).parseFromString(e,Ud),o=t.querySelector("script");o&&o.setAttribute("nonce",Ac());const a=Pe("iframe",{src:URL.createObjectURL(new Blob([t.documentElement.outerHTML],{type:"text/html"})),id:Qd});return a.addEventListener("load",(()=>{const{addEventListener:e}=a.contentDocument||a.contentWindow.document;e("click",n)})),a},Kd=(e,n,t,o)=>{[{id:Gd,element:o},{id:Wd,element:t},{id:Qd,element:e}].forEach((({id:e,element:t})=>{const{style:o={},params:a={}}=n[e];t.style={...t.style,...o};const{parentElement:r="body",insertionMethod:i="appendChild",enabled:s=!0}=a,l=document.querySelector(r);s&&l&&"function"==typeof l[i]&&l[i](t)}))},Zd=e=>{const{verticalAlign:n,width:t,horizontalAlign:o,backdropColor:a,height:r,cornerRadius:i,horizontalInset:s,verticalInset:l,uiTakeover:c=!1}=e,m={width:t?`${t}%`:"100%",backgroundColor:a||"rgba(0, 0, 0, 0.5)",borderRadius:i?`${i}px`:"0px",border:"none",position:c?"fixed":"relative",overflow:"hidden"};return"left"===o?m.left=s?`${s}%`:"0":"right"===o?m.right=s?`${s}%`:"0":"center"===o&&(m.left="50%",m.transform="translateX(-50%)"),"top"===n?m.top=l?`${l}%`:"0":"bottom"===n?(m.position="fixed",m.bottom=l?`${l}%`:"0"):"center"===n&&(m.top="50%",m.transform=("center"===o?`${m.transform} `:"")+"translateY(-50%)",m.display="flex",m.alignItems="center",m.justifyContent="center"),m.height=r?`${r}vh`:"100%",m},eu=e=>{const{backdropOpacity:n,backdropColor:t}=e;return{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"transparent",opacity:n||.5,backgroundColor:t||"#FFFFFF"}},nu=["enabled","parentElement","insertionMethod"],tu=e=>{if(!e)return!1;const n=Object.keys(e);if(!n.includes(Wd))return!1;if(!n.includes(Gd))return!1;const t=Object.values(e);for(let e=0;e<t.length;e+=1){if(!To(t[e],"style"))return!1;if(!To(t[e],"params"))return!1;for(let n=0;n<nu.length;n+=1)if(!To(t[e].params,nu[n]))return!1}return!0},ou=e=>{if(!e)return;const{uiTakeover:n=!1}=e;return{[Qd]:{style:{border:"none",width:"100%",height:"100%"},params:{enabled:!0,parentElement:"#alloy-messaging-container",insertionMethod:"appendChild"}},[Wd]:{style:Zd(e),params:{enabled:!0,parentElement:"body",insertionMethod:"appendChild"}},[Gd]:{style:eu(e),params:{enabled:!0===n,parentElement:"body",insertionMethod:"appendChild"}}}},au=(e={},n)=>{Jd();const{content:t,contentType:o,mobileParameters:a}=e;let{webParameters:r}=e;if(o!==Ud)return;const i=Pe("div",{id:Wd}),s=Yd(t,Xd(n)),l=Pe("div",{id:Gd});tu(r)||(r=ou(a)),r&&Kd(s,r,i,l)};var ru=(e,n)=>new Promise((t=>{const{meta:o}=e;au(e,((e,t)=>{const a={};a[Zl.INTERACT]=Kl,-1!==Object.values(Zl).indexOf(e)&&(a[e]=Kl),n({decisionsMeta:[o],propositionAction:t,eventType:Ql,propositionEventTypes:Object.keys(a)})})),t({meta:o})})),iu=e=>({defaultContent:n=>ru(n,e)}),su=(e,n)=>(t,o,a)=>{if(!t)return()=>{};if(!o){const e=_e();return n.concat(e.promise),e.resolve}return(n=[],t=[])=>{qe(n)&&e({decisionsMeta:n,viewName:a}),qe(t)&&e({decisionsMeta:t,eventType:Yl,propositionAction:{reason:"Conflict"},viewName:a})}},lu=({showContainers:e,consent:n})=>()=>{const{state:t,wasSet:o}=n.current();t===Fo&&o?e():n.awaitConsent().catch(e)};const cu=e=>{const{documentElement:n}=document;let t=e;const o=new Set;let a,r;for(;t&&t!==n;){const e=vc(t,Sd);e&&o.add(e),a=a||vc(t,_d),r=r||vc(t,Cd),t=t.parentNode}return{interactIds:[...o],clickLabel:a,clickToken:r}},mu=e=>{const n=e.find((e=>e.scopeType===Mm));return n?n.scope:void 0},du=(e,n,t)=>o=>{const{scopeDetails:a={}}=o,{decisionProvider:r}=a;return e[r]===yd||e[r]===bd&&(n||t)};var uu=(e,n,t)=>{const{interactIds:o,clickLabel:a="",clickToken:r}=cu(e),i=du(t,a,r);if(0===o.length)return{};const s=n(o).filter(i);return{decisionsMeta:zm(s),propositionActionLabel:a,propositionActionToken:r,viewName:mu(s)}};const fu="AJO",pu="TGT",gu=({config:e,logger:n,eventManager:t,consent:o})=>{const{targetMigrationEnabled:a,prehidingStyle:r,autoCollectPropositionInteractions:i}=e,s=Um({eventManager:t,mergeDecisionsMeta:Qm}),l=om(n),c=tm(n),{storeInteractionMeta:m,getInteractionMetas:d}=td(),{storeClickMeta:u,getClickSelectors:f,getClickMetas:p}=nd(),g=sd({window:window}),w=Rm(),h=pd([fd,md]),y=gd({preprocess:h,isPageWideSurface:El}),v=Km({createProposition:y}),b=$d(window),I={[Ll]:hd,[Rl]:Pd({modules:w,logger:n,storeInteractionMeta:m,storeClickMeta:u,autoCollectPropositionInteractions:i}),[Ul]:Ad({modules:w,logger:n,storeInteractionMeta:m,autoCollectPropositionInteractions:i}),[ql]:Ed({logger:n,executeRedirect:b,collect:s}),[Ml]:Bd({modules:iu(s),logger:n})},S=Nd({schemaProcessors:I,logger:n}),_=wd(),C=su(s,_),T=jm({prehidingStyle:r,showContainers:l,hideContainers:c,mergeQuery:Jm,processPropositions:S,createProposition:y,notificationHandler:C,consent:o,logger:n}),D=Ym({mergeDecisionsMeta:Qm,collectInteractions:uu,collectClicks:Wm,getInteractionMetas:d,getClickMetas:p,getClickSelectors:f,autoCollectPropositionInteractions:i}),k=Zm({processPropositions:S,viewCache:v,logger:n}),x=id({processPropositions:S,createProposition:y,renderedPropositions:_,viewCache:v}),P=ld({targetMigrationEnabled:a}),A=Rd({processPropositions:S,createProposition:y,notificationHandler:C}),O=lu({showContainers:l,consent:o});return ic({getPageLocation:g,logger:n,fetchDataHandler:T,viewChangeHandler:k,onClickHandler:D,isAuthoringModeEnabled:Gm,mergeQuery:Jm,viewCache:v,showContainers:l,applyPropositions:x,setTargetMigration:P,mergeDecisionsMeta:Qm,renderedPropositions:_,onDecisionHandler:A,handleConsentFlicker:O})};gu.namespace="Personalization";const wu=Id.map((e=>So(e)));gu.configValidators=To({prehidingStyle:Do().nonEmpty(),targetMigrationEnabled:bo().default(!1),autoCollectPropositionInteractions:To({[fu]:ho(wu).default(yd),[pu]:ho(wu).default(vd)}).default({[fu]:yd,[pu]:vd}).noUnknownFields()});const hu="personalization:decisions",yu=e=>null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype,vu=(e,n={},t=[])=>(Object.keys(e).forEach((o=>{yu(e[o])||Array.isArray(e[o])?vu(e[o],n,[...t,o]):n[[...t,o].join(".")]=e[o]})),n);var bu=e=>yu(e)?vu(e):e,Iu=({renderDecisions:e,decisionProvider:n,applyResponse:t,event:o,personalization:a,decisionContext:r})=>{const i={...bu(o.getContent()),...r};return({response:r})=>{if(n.addPayloads(r.getPayloadsByType(hu)),!o.hasQuery())return{propositions:[]};const s=n.evaluate(i);return t({renderDecisions:e,propositions:s,event:o,personalization:a})}};const Su={MATCHER:"matcher",GROUP:"group",HISTORICAL:"historical"},_u={EQUALS:"eq",NOT_EQUALS:"ne",EXISTS:"ex",NOT_EXISTS:"nx",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"ge",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"le",CONTAINS:"co",NOT_CONTAINS:"nc",STARTS_WITH:"sw",ENDS_WITH:"ew"},Cu={AND:"and",OR:"or"},Tu={ORDERED:"ordered"},Du={[_u.EQUALS]:m(),[_u.NOT_EQUALS]:d(),[_u.EXISTS]:u(),[_u.NOT_EXISTS]:f(),[_u.GREATER_THAN]:g(),[_u.GREATER_THAN_OR_EQUAL_TO]:w(),[_u.LESS_THAN]:h(),[_u.LESS_THAN_OR_EQUAL_TO]:y(),[_u.CONTAINS]:v(),[_u.NOT_CONTAINS]:b(),[_u.STARTS_WITH]:I(),[_u.ENDS_WITH]:S()},ku=["iam.eventType","eventType","type"],xu=["iam.id","id"],Pu="TGT",Au="DEFAULT",Ou="ECID",Eu="<key>",Nu="<identity>",Lu=ee(te,(e=>e.join("-"))),Ru=100,Uu=ee(oe),Vu=(e,n)=>t=>{const o=e.getItem(n);if(!o)return t;try{return JSON.parse(o)}catch{return t}},ju=(e,n,t=(e=>e))=>o=>{e.setItem(n,JSON.stringify(t(o)))},qu=e=>{const n=new Date;return n.setDate(n.getDate()-e),n},Mu=e=>{const{scopeDetails:n={}}=e,{activity:t={}}=n,{id:o}=t;return o},Fu=()=>{const e={};return{getItem:n=>n in e?e[n]:null,setItem:(n,t)=>{e[n]=t}}},Bu=e=>{e.clear()},zu=(e={})=>{const{_experience:n}=e;return!(!n||"object"!=typeof n)},Hu=e=>{const{scopeDetails:n={}}=e,{decisionProvider:t}=n;return t},$u=(e=[])=>{const n=[];return Array.isArray(e)?(e.forEach((e=>{Array.isArray(e)?n.push(...$u(e)):n.push(e)})),n):e};var Wu=(e,n,t)=>{const{html:o,mobileParameters:a}=t;return{schema:Ml,data:{mobileParameters:a,webParameters:{},content:o,contentType:Ud},id:e}},Gu=(e,n,t)=>{const{schema:o,data:a,id:r}=t;return{schema:o,data:a,id:r||e}};const Qu="cjmiam",Ju="schema",Xu={[Qu]:Wu,[Ju]:Gu};var Yu=()=>e=>{const{id:n,type:t,detail:o}=e;return"function"==typeof Xu[t]?Xu[t](n,t,o):o};const Ku=e=>{const{schema:n,data:t}=e;if(n===jl)return!0;if(n!==Vl)return!1;try{const e="string"==typeof t.content?JSON.parse(t.content):t.content;return e&&Object.prototype.hasOwnProperty.call(e,"version")&&Object.prototype.hasOwnProperty.call(e,"rules")}catch{return!1}};var Zu=(e,n,t)=>{const o=Yu(),a=Mu(e),r=[],i=e=>{const{data:n={},schema:t}=e,o=t===jl?n:n.content;o&&r.push(ce("string"==typeof o?JSON.parse(o):o))},s=i=>{const s=n.getEvent(Gl,a),l=s?s.firstTimestamp:void 0,c=$u(r.map((e=>e.execute(i)))).map(o).map((e=>{const{firstTimestamp:n}=t.recordQualified(a)||{};return{...e,data:{...e.data,qualifiedDate:n,displayedDate:l}}}));return{...e,items:c}};return Array.isArray(e.items)&&e.items.filter(Ku).forEach(i),{rank:e?.scopeDetails?.rank||1/0,evaluate:s,isEvaluable:r.length>0}},ef=({eventRegistry:e})=>({recordQualified:n=>{if(n)return e.addEvent({},Zl.TRIGGER,n)}}),nf=({eventRegistry:e})=>{const n={},t=ef({eventRegistry:e}),o=o=>{const a=Mu(o);if(!a)return;const r=Zu(o,e,t);r.isEvaluable&&(n[a]=r)};return{addPayload:o,addPayloads:e=>{e.forEach(o)},evaluate:(e={})=>Object.values(n).sort((({rank:e},{rank:n})=>e-n)).map((n=>n.evaluate(e))).filter((e=>e.items.length>0))}},tf=e=>({renderDecisions:n=!1,propositions:t=[],event:o,personalization:a})=>(e&&e.onDecision({renderDecisions:n,propositions:t,event:o,personalization:a}),{propositions:t});const of="events",af=1e3,rf=30,sf=e=>`iam.${e}`,lf=(e=af,n=rf)=>t=>{const o={};return Object.keys(t).forEach((a=>{o[a]={},Object.values(t[a]).filter((e=>new Date(e.firstTimestamp)>=qu(n))).sort(((e,n)=>e.firstTimestamp-n.firstTimestamp)).slice(-1*e).forEach((e=>{o[a][e.event[sf("id")]]=e}))})),o};var cf=({storage:e})=>{let n,t,o,a=e;const r=e=>{a=e,n=Vu(a,of),t=ju(a,of,lf(af,rf)),o=n({})};r(e);const i=(e,n,a,r)=>{if(!n||!a)return;o[n]||(o[n]={});const i=o[n][a],s=i?i.count:0,l=(new Date).getTime(),c=i?i.firstTimestamp||i.timestamp:l;return o[n][a]={event:{...e,[sf("id")]:a,[sf("eventType")]:n,[sf("action")]:r},firstTimestamp:c,timestamp:l,count:s+1},t(o),o[n][a]};return{addExperienceEdgeEvent:e=>{const{xdm:n={}}=e.getContent(),{_experience:t}=n;if(!zu(n))return;const{decisioning:o={}}=t,{propositionEventType:a={},propositionAction:r={},propositions:s=[]}=o,l=Object.keys(a);if(0===l.length)return;const c=e=>a[e]===Kl,{id:m}=r;l.filter(c).forEach((e=>{s.forEach((n=>{Hu(n)===fu&&i({},e,Mu(n),m)}))}))},addEvent:i,getEvent:(e,n)=>{if(o[e])return o[e][n]},toJSON:()=>o,setStorage:r}},mf=({eventRegistry:e,window:n,getBrowser:t})=>{const o=(new Date).getTime(),a=()=>({title:n.title,url:n.url,...et(n.url)}),r=()=>({url:n.referrer,...et(n.referrer)}),i=()=>{const e=new Date,n=e.getTime();return{pageLoadTimestamp:o,currentTimestamp:n,currentDate:e.getDate(),"~state.com.adobe.module.lifecycle/lifecyclecontextdata.dayofweek":e.getDay()+1,"~state.com.adobe.module.lifecycle/lifecyclecontextdata.hourofday":e.getHours(),currentMinute:e.getMinutes(),currentMonth:e.getMonth(),currentYear:e.getFullYear(),pageVisitDuration:n-o,"~timestampu":n/1e3,"~timestampz":e.toISOString()}},s=()=>({height:n.height,width:n.width,scrollY:n.scrollY,scrollX:n.scrollX}),l={browser:{name:t()},page:a(),referringPage:r()},c=()=>({...l,...i(),window:s(),"~sdkver":br});return{getContext:(n={})=>{const t={...c(),...n};return{...bu(t),events:e.toJSON()}}}};const df=(e,...n)=>n,uf=()=>!0,ff=()=>{let e=df,n=uf,t=0;const o={},a=e=>()=>{delete o[e]},r=(e,n)=>"function"!=typeof e?()=>{}:(t+=1,o[t]={callback:e,params:n},{id:t,unsubscribe:a(t)}),i=(...t)=>{Object.values(o).forEach((({callback:o,params:a})=>{const r=e(a,...t);n(a,...r)&&o(...r)}))},s=(t,...a)=>{if(!t||!o[t])return;const{callback:r,params:i}=o[t],s=e(i,...a);n(i,...s)&&r(...s)};return{add:r,emit:i,emitOne:s,hasSubscriptions:()=>Object.keys(o).length>0,setEmissionPreprocessor:n=>{"function"==typeof n&&(e=n)},setEmissionCondition:e=>{"function"==typeof e&&(n=e)}}},pf=({options:e})=>To({surfaces:vo(Do()).uniqueItems(),schemas:vo(Do()).uniqueItems(),callback:Io().required()}).noUnknownFields()(e),gf=e=>{const{id:n,scope:t,scopeDetails:o}=e;return{id:n,scope:t,scopeDetails:o}};var wf=({collect:e})=>{let n=()=>{};const t=new Set,o=e=>[Zl.INTERACT,Zl.DISMISS].includes(e),a=(e,n,a)=>{const r=[e,n].join("-"),i=!a.has(r)&&(o(e)||!t.has(r));return a.add(r),t.add(r),i},r=(n,t=[])=>{if(!(t instanceof Array))return Promise.resolve();if(!Object.values(Zl).includes(n))return Promise.resolve();const o=[],r=new Set;return t.forEach((e=>{const t=gf(e);a(n,t.id,r)&&o.push(t)})),o.length>0?e({decisionsMeta:o,eventType:oc(n),documentMayUnload:!0}):Promise.resolve()},i=ff(),s=(e,n)=>{const{surfacesFilter:t,schemasFilter:o}=e;return[{propositions:n.filter((e=>!t||t.includes(e.scope))).map((e=>{const{items:n=[]}=e;return{...e,items:n.filter((e=>!o||o.includes(e.schema)))}})).filter((e=>e.items.length>0))},r]};i.setEmissionPreprocessor(s);const l=({surfaces:e,schemas:t,callback:o})=>{const{id:a,unsubscribe:r}=i.add(o,{surfacesFilter:e instanceof Array?e:void 0,schemasFilter:t instanceof Array?t:void 0});return n(a),Promise.resolve({unsubscribe:r})};return{refresh:e=>{n=n=>{n?i.emitOne(n,e):i.emit(e)},n()},command:{optionsValidator:e=>pf({options:e}),run:l}}};const hf={TYPE:"~type",SOURCE:"~source"},yf={EDGE:"com.adobe.eventType.edge",RULES_ENGINE:"com.adobe.eventType.rulesEngine"},vf={REQUEST:"com.adobe.eventSource.requestContent"},bf=({options:e})=>To({renderDecisions:bo(),personalization:To({decisionContext:To({})})}).noUnknownFields()(e);var If=({contextProvider:e,decisionProvider:n})=>({optionsValidator:e=>bf({options:e}),run:({renderDecisions:t,decisionContext:o,applyResponse:a})=>a({renderDecisions:t,propositions:n.evaluate(e.getContext(o))})});const Sf=({config:e,eventManager:n,createNamespacedStorage:t,consent:o,getBrowser:a})=>{const{orgId:r,personalizationStorageEnabled:i}=e,s=Um({eventManager:n,mergeDecisionsMeta:Qm}),l=t(`${_n(r)}.decisioning.`);i||Bu(l.persistent);const c=cf({storage:Fu()}),m=nf({eventRegistry:c}),d=mf({eventRegistry:c,window:window,getBrowser:a}),u=If({contextProvider:d,decisionProvider:m}),f=wf({collect:s});let p;return{lifecycle:{onDecision({propositions:e}){f.refresh(e)},onComponentsRegistered(e){p=tf(e.lifecycle),i&&o.awaitConsent().then((()=>{c.setStorage(l.persistent)})).catch((()=>{l&&Bu(l.persistent)}))},onBeforeEvent({event:e,renderDecisions:n,personalization:t={},onResponse:o=Yn}){const{decisionContext:a={}}=t;o(Iu({renderDecisions:n,decisionProvider:m,applyResponse:p,event:e,personalization:t,decisionContext:d.getContext({[hf.TYPE]:yf.EDGE,[hf.SOURCE]:vf.REQUEST,...a})}))},onBeforeRequest({request:e}){const n=e.getPayload().toJSON(),{events:t=[]}=n;0!==t.length&&t.forEach((e=>c.addExperienceEdgeEvent(e)))}},commands:{evaluateRulesets:{run:({renderDecisions:e,personalization:n={}})=>{const{decisionContext:t={}}=n;return u.run({renderDecisions:e,decisionContext:{[hf.TYPE]:yf.RULES_ENGINE,[hf.SOURCE]:vf.REQUEST,...t},applyResponse:p})},optionsValidator:u.optionsValidator},subscribeRulesetItems:f.command}}};Sf.namespace="RulesEngine",Sf.configValidators=To({personalizationStorageEnabled:bo().default(!1)});var _f=To({streamingMedia:To({channel:Do().nonEmpty().required(),playerName:Do().nonEmpty().required(),appVersion:Do(),mainPingInterval:_o().minimum(10).maximum(50).default(10),adPingInterval:_o().minimum(1).maximum(10).default(10)}).noUnknownFields()}),Cf=({options:e})=>ho([To({playerId:Do().required(),getPlayerDetails:Io().required(),xdm:To({mediaCollection:To({sessionDetails:To(yo()).required()})}),edgeConfigOverrides:To({})}).required(),To({xdm:To({mediaCollection:To({playhead:_o().required(),sessionDetails:To(yo()).required()})}),edgeConfigOverrides:To({})}).required()],"Error validating the createMediaSession command options.")(e),Tf=({options:e})=>ho([To({playerId:Do().required(),xdm:To({eventType:ko(...Object.values(Hs)).required(),mediaCollection:To(yo())}).required()}).required(),To({xdm:To({eventType:ko(...Object.values(Hs)).required(),mediaCollection:To({playhead:_o().integer().required(),sessionID:Do().required()}).required()}).required()}).required()],"Error validating the sendMediaEvent command options.")(e),Df=({config:e,trackMediaEvent:n,trackMediaSession:t,mediaResponseHandler:o})=>({lifecycle:{onBeforeEvent({mediaOptions:e,onResponse:n=Yn}){if(!e)return;const{legacy:t,playerId:a,getPlayerDetails:r}=e;t||n((({response:e})=>o({playerId:a,getPlayerDetails:r,response:e})))}},commands:{createMediaSession:{optionsValidator:e=>Cf({options:e}),run:t},sendMediaEvent:{optionsValidator:e=>Tf({options:e}),run:t=>e.streamingMedia?n(t):Promise.reject(new Error("Streaming media is not configured."))}}});const kf=({config:e,logger:n,eventManager:t,sendEdgeNetworkRequest:o,consent:a})=>{const r=Qs(),i=Ws({config:e,eventManager:t,consent:a,sendEdgeNetworkRequest:o,setTimestamp:yr((()=>new Date))}),s=Xs({mediaSessionCacheManager:r,mediaEventManager:i,config:e}),l=Ys({config:e,mediaEventManager:i,mediaSessionCacheManager:r}),c=Zs({mediaSessionCacheManager:r,config:e,trackMediaEvent:s});return Df({config:e,trackMediaEvent:s,mediaResponseHandler:c,trackMediaSession:l})};kf.namespace="Streaming media",kf.configValidators=_f;const{console:xf}=window,Pf=zn(window),Af=(e={})=>{const n=To({name:Do().default("alloy"),monitors:vo(To({})).default([]),components:vo(Io())}).noUnknownFields(),{name:t,monitors:o,components:a}=n(e),r=()=>(window.__alloyMonitors||[]).concat(o),i=Oo({console:xf,locationSearch:window.location.search,createLogger:Ia,instanceName:t,createNamespacedStorage:Pf,getMonitors:r}),s=Ri({instanceName:t,logController:i,components:a});return i.logger.logOnInstanceCreated({instance:s}),s};n.createCustomInstance=Af,n.components=[Ts,Ps,Bs,pl,gu,Sf,kf]}},"adobe-alloy/dist/lib/instanceManager/createInstanceManager.js":{script:function(e){"use strict";e.exports=({turbine:e,window:n,createCustomInstance:t,components:o,createEventMergeId:a,orgId:r,wrapOnBeforeEventSend:i,getConfigOverrides:s})=>{const{instances:l}=e.getExtensionSettings(),c={},m={};return n.__alloyMonitors=n.__alloyMonitors||[],n.__alloyMonitors.push({onInstanceCreated:(...e)=>{m.onInstanceCreated||=[],m.onInstanceCreated.push(e)},onInstanceConfigured:(...e)=>{m.onInstanceConfigured||=[],m.onInstanceConfigured.push(e)},onBeforeCommand(...e){const{commandName:n}=e[0];"configure"===n&&(m.onBeforeCommand||=[],m.onBeforeCommand.push(e))}}),l.forEach((({name:a,edgeConfigId:l,stagingEdgeConfigId:m,developmentEdgeConfigId:d,onBeforeEventSend:u,...f})=>{const p=t({name:a,components:o});n[a]=p,n.__alloyNS||(n.__alloyNS=[]),n.__alloyNS.push(a),c[a]=p;const g=e.environment&&e.environment.stage,w="development"===g&&d||"staging"===g&&m||l;f.edgeConfigOverrides=s(f),p("configure",{...f,datastreamId:w,debugEnabled:e.debugEnabled,orgId:f.orgId||r,onBeforeEventSend:i(u)}),e.onDebugChanged((e=>{p("setDebug",{enabled:e})}))})),{getInstance:e=>c[e],createEventMergeId:()=>a(),addMonitor(e){n.__alloyMonitors.push(e),Object.keys(m).forEach((n=>{e[n]&&m[n].forEach((t=>{e[n](...t)}))}))}}}}},"adobe-alloy/dist/lib/instanceManager/injectWrapOnBeforeEventSend.js":{script:function(e){"use strict";e.exports=({version:e})=>n=>t=>{if(t.xdm.implementationDetails.name=`${t.xdm.implementationDetails.name}/reactor`,t.xdm.implementationDetails.version=`${t.xdm.implementationDetails.version}+${e}`,n)return n(t)}}},"adobe-alloy/dist/lib/createEventMergeIdCache.js":{script:function(e){"use strict";e.exports=()=>{const e={};return{set(n,t){e[n]=t},getByCacheId:n=>e[n],clearByEventMergeId(n){Object.keys(e).forEach((t=>{e[t]===n&&delete e[t]}))}}}}},"adobe-alloy/dist/lib/createSendEventCallbackStorage.js":{script:function(e){"use strict";e.exports=()=>{const e=[];return{add(n){e.push(n)},triggerEvent(n){e.forEach((e=>{e(n)}))}}}}},
"adobe-alloy/dist/lib/createMediaCollectionSessionStorage.js":{script:function(e){"use strict";e.exports=()=>{const e={};return{add({playerId:n,sessionDetails:t}){if(e[n])throw new Error(`Player Id ${n} already exists`);e[n]=t},remove({playerId:n}){e[n]=void 0},get:({playerId:n})=>e[n]}}}},"adobe-alloy/dist/lib/createVariableStore.js":{script:function(e){"use strict";e.exports=()=>({})}}}}},company:{orgId:"EA76ADE95776D2EC7F000101@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"M365 PreCons",settings:{domains:["microsoft.com"],undefinedVarsReturnEmpty:!1,ruleComponentSequencingEnabled:!0},id:"PR4e444f70e9fb4965b879a1365b5c8762"},rules:[{id:"RL08cbbb6fd49845c2845df93e6ae24cff",name:"All Pages (ACDL pageView) - Page View Handler (Custom Trigger)",events:[{modulePath:"core/src/lib/events/customCode.js",settings:{source:function(e){var n=function(n){var t=_satellite.getVar("ACDL - Page ID");if(n.hasOwnProperty("eventInfo")&&n.eventInfo.hasOwnProperty("path")&&n.hasOwnProperty("page")&&n.page.hasOwnProperty(t)&&n.page[t].hasOwnProperty("msftPageViewFlag")&&-1!==n.eventInfo.path.indexOf("page.")&&0==n.page[t].msftPageViewFlag){console.debug("pageView event: "+n.eventInfo.path);var o={message:{eventInfo:n.eventInfo}};e(o)}};window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer.push((function(e){e.addEventListener("pageView",n)}))}},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(e){if(e){adobeSatelliteName.setVar("dl_eventName",e.message.eventName),adobeSatelliteName.setVar("dl_eventDataName",e.message.eventInfo._mscom.eventData.eventName),adobeSatelliteName.setVar("dl_eventActionType",e.message.eventInfo._mscom.eventData.actionType),adobeSatelliteName.setVar("dl_eventBehaviorID",e.message.eventInfo._mscom.eventData.behaviorID),adobeSatelliteName.setVar("dl_eventCategory",e.message.eventInfo._mscom.eventData.eventCategory),adobeSatelliteName.setVar("dl_eventBehaviorCategory",e.message.eventInfo._mscom.eventData.eventBehaviorCategory);var n=void 0,t=e.message.eventInfo.web._mscom.webSession.entryReferrer,o=adobeSatelliteName.getVar("ACDL - Entry Referrer");void 0!==t?n=t:void 0!==o&&(n=o),""!=n&&null!=n||(n=void 0),adobeSatelliteName.setVar("dl_entryReferrer",n);var a=void 0,r=e.message.eventInfo.web._mscom.webSession.entryReferrerTypeDetails.referrerType,i=adobeSatelliteName.getVar("ACDL - Entry Referrer Type");void 0!==r?a=r:void 0!==i&&(a=i),adobeSatelliteName.setVar("dl_entryReferrerType",a);var s=void 0,l=e.message.eventInfo.web._mscom.webSession.entryReferrerTypeDetails.customReferrerType,c=adobeSatelliteName.getVar("ACDL - Entry Custom Referrer Type");void 0!==l?s=l:void 0!==i&&(s=c),adobeSatelliteName.setVar("dl_entryCustomReferrerType",s);var m=void 0,d=e.message.eventInfo.web._mscom.webSession.entryUrl,u=adobeSatelliteName.getVar("ACDL - Entry URL");void 0!==d?m=d:void 0!==entryUrlrDE&&(m=u),adobeSatelliteName.setVar("dl_entryUrl",m);var f=void 0,p=e.message.eventInfo.web._mscom.webSession.entryUrlQS,g=adobeSatelliteName.getVar("ACDL - Entry URLQS");void 0!==p?f=p:void 0!==g&&(f=g),adobeSatelliteName.setVar("dl_entryUrlQS",f);var w=void 0,h=e.message.eventInfo.web._mscom.webSession.sessionID,y=adobeSatelliteName.getVar("ACDL - Session ID");void 0!==h?w=h:void 0!==y&&(w=y),adobeSatelliteName.setVar("dl_sessionID",w);var v=void 0,b=e.message.eventInfo.web.webInteraction.hitNumber,I=adobeSatelliteName.getVar("ACDL - Hit Number");void 0!==b?v=b:void 0!==I&&(v=I),adobeSatelliteName.setVar("dl_hitNumber",v),null!=e.message.eventInfo.environment._dc?null!=e.message.eventInfo.environment._dc.language&&adobeSatelliteName.setVar("dl_environmentLanguage",e.message.eventInfo.environment._dc.language):adobeSatelliteName.setVar("dl_environmentLanguage",void 0),adobeSatelliteName.setVar("dl_userAgent",e.message.eventInfo.environment.browserDetails.userAgent),e.message.eventInfo.marketing&&(e.message.eventInfo.marketing.trackingCode&&adobeSatelliteName.setVar("dl_ocidTrackingCode",e.message.eventInfo.marketing.trackingCode),e.message.eventInfo.marketing._mscom&&e.message.eventInfo.marketing._mscom.ICID&&adobeSatelliteName.setVar("dl_icidTrackingCode",e.message.eventInfo.marketing._mscom.ICID)),adobeSatelliteName.setVar("dl_countryCode",e.message.eventInfo.placeContext.geo.countryCode),adobeSatelliteName.setVar("dl_identityMap",e.message.eventInfo.identityMap),adobeSatelliteName.setVar("dl_currentIdentitiesANON",e.message.eventInfo._mscom.currentIdentities.ANON),adobeSatelliteName.setVar("dl_currentIdentitiesECID",e.message.eventInfo._mscom.currentIdentities.ECID),adobeSatelliteName.setVar("dl_currentIdentitiesMC1GUID",e.message.eventInfo._mscom.currentIdentities.MC1GUID),adobeSatelliteName.setVar("dl_currentIdentitiesMarketoLeadId",e.message.eventInfo._mscom.currentIdentities.marketoLeadId),adobeSatelliteName.setVar("dl_currentIdentitiesMarketoMunchkinCookie",e.message.eventInfo._mscom.currentIdentities.marketoMunchkinCookie),adobeSatelliteName.setVar("dl_errorPageFlag",e.message.eventInfo.web.webPageDetails.isErrorPage),adobeSatelliteName.setVar("dl_urlQS",e.message.eventInfo.web.webPageDetails._mscom.pageInfo.URLQS),adobeSatelliteName.setVar("dl_urlWithoutQS",e.message.eventInfo.web.webPageDetails._mscom.pageInfo.URLWithoutQS),adobeSatelliteName.setVar("dl_pageName",e.message.eventInfo.web.webPageDetails.name),adobeSatelliteName.setVar("dl_siteBrand",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteBrand),adobeSatelliteName.setVar("dl_siteDomain",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteDomain),adobeSatelliteName.setVar("dl_siteID",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteID),adobeSatelliteName.setVar("dl_siteLanguage",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteLanguage),adobeSatelliteName.setVar("dl_siteLocale",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteLocale),adobeSatelliteName.setVar("dl_siteMarket",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteMarket),adobeSatelliteName.setVar("dl_siteName",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteName)}return!0}},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){var e=adobeSatelliteName.getVar("ACDL - Page View Flag");return(null==e||0==e)&&(a_setPageViewFlag(),!0)}},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return-1!=adobeSatelliteName.getVar("ACDL - URL").indexOf("/microsoft-365")}},timeout:2e3}],actions:[{modulePath:"adobe-alloy/dist/lib/actions/sendEvent/index.js",settings:{xdm:"%XDM - All Pages%",type:"web.webpagedetails.pageViews",instanceName:"alloy"},timeout:3e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:"https://assets.adobedtm.com/5ef092d1efb5/d6d76b37b476/3478c350b630/RC8c3af5b49d4c404795161e1e68c4f991-source.min.js",language:"javascript",isExternal:!0},timeout:3e3,delayNext:!0}]},{id:"RL216fce2294814797bf75368cd2cf21dc",name:"All Pages (Click) - All Clicks - Page Action Handler",events:[{modulePath:"gcoe-adobe-client-data-layer/src/lib/events/datalayerPushListener.js",settings:{scope:"all",method:"specificEvent",eventKey:"cmp:click-enhanced"},ruleOrder:1}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(e){if(e&&e.message.eventInfo.pageActionInfo&&e.message.eventInfo.pageActionInfo.elementInfo&&e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName){var n=void 0,t=e.message.eventInfo.web._mscom.webSession.entryReferrer,o=adobeSatelliteName.getVar("ACDL - Entry Referrer");void 0!==t?n=t:void 0!==o&&(n=o),""!=n&&null!=n||(n=void 0),adobeSatelliteName.setVar("dl_entryReferrer",n);var a=void 0,r=e.message.eventInfo.web._mscom.webSession.entryReferrerTypeDetails.referrerType,i=adobeSatelliteName.getVar("ACDL - Entry Referrer Type");void 0!==r?a=r:void 0!==i&&(a=i),adobeSatelliteName.setVar("dl_entryReferrerType",a);var s=void 0,l=e.message.eventInfo.web._mscom.webSession.entryReferrerTypeDetails.customReferrerType,c=adobeSatelliteName.getVar("ACDL - Entry Custom Referrer Type");void 0!==l?s=l:void 0!==i&&(s=c),adobeSatelliteName.setVar("dl_entryCustomReferrerType",s);var m=void 0,d=e.message.eventInfo.web._mscom.webSession.entryUrl,u=adobeSatelliteName.getVar("ACDL - Entry URL");void 0!==d?m=d:void 0!==entryUrlrDE&&(m=u),adobeSatelliteName.setVar("dl_entryUrl",m);var f=void 0,p=e.message.eventInfo.web._mscom.webSession.entryUrlQS,g=adobeSatelliteName.getVar("ACDL - Entry URLQS");void 0!==p?f=p:void 0!==g&&(f=g),adobeSatelliteName.setVar("dl_entryUrlQS",f);var w=void 0,h=e.message.eventInfo.web._mscom.webSession.sessionID,y=adobeSatelliteName.getVar("ACDL - Session ID");void 0!==h?w=h:void 0!==y&&(w=y),adobeSatelliteName.setVar("dl_sessionID",w);var v=void 0,b=e.message.eventInfo.web.webInteraction.hitNumber,I=adobeSatelliteName.getVar("ACDL - Hit Number");if(void 0!==b?v=b:void 0!==I&&(v=I),adobeSatelliteName.setVar("dl_hitNumber",v),e.message.eventInfo.marketing&&(e.message.eventInfo.marketing.trackingCode&&adobeSatelliteName.setVar("dl_ocidTrackingCode",e.message.eventInfo.marketing.trackingCode),e.message.eventInfo.marketing._mscom&&e.message.eventInfo.marketing._mscom.ICID&&adobeSatelliteName.setVar("dl_icidTrackingCode",e.message.eventInfo.marketing._mscom.ICID)),adobeSatelliteName.setVar("dl_elementContentName",e.message.eventInfo.web.webInteraction._mscom.elementInfo.contentName),adobeSatelliteName.setVar("dl_elementContentNameEn",e.message.eventInfo.web.webInteraction._mscom.elementInfo.contentNameEn),adobeSatelliteName.setVar("dl_elementContentType",e.message.eventInfo.web.webInteraction._mscom.elementInfo.contentType),adobeSatelliteName.setVar("dl_elementID",e.message.eventInfo.web.webInteraction._mscom.elementInfo.elementID),adobeSatelliteName.setVar("dl_elementType",e.message.eventInfo.web.webInteraction._mscom.elementInfo.elementType),adobeSatelliteName.setVar("dl_elementAction",e.message.eventInfo.pageActionInfo.elementInfo.elementAction),adobeSatelliteName.setVar("dl_elementText",e.message.eventInfo.pageActionInfo.elementInfo.elementText),adobeSatelliteName.setVar("dl_elementCTA",e.message.eventInfo.web.webInteraction._mscom.elementInfo.elementCTA),adobeSatelliteName.setVar("dl_elementLinkName",e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName),adobeSatelliteName.setVar("dl_elementLinkType",e.message.eventInfo.pageActionInfo.elementInfo.elementLinkType),adobeSatelliteName.setVar("dl_nodeType",e.message.eventInfo.web.webInteraction._mscom.elementInfo.nodeType),adobeSatelliteName.setVar("dl_formFieldName",e.message.eventInfo.pageActionInfo.elementInfo.formFieldName),adobeSatelliteName.setVar("dl_destinationUrl",e.message.eventInfo.web.webInteraction._mscom.elementInfo.destinationUrl),adobeSatelliteName.setVar("dl_clickUUID",e.message.eventInfo.web.webInteraction.linkClicks.id),adobeSatelliteName.setVar("dl_componentName",e.message.eventInfo.web.webInteraction._mscom.componentInfo.componentName),adobeSatelliteName.setVar("dl_componentType",e.message.eventInfo.web.webInteraction._mscom.componentInfo.componentType),adobeSatelliteName.setVar("dl_templateName",e.message.eventInfo.web.webInteraction._mscom.componentInfo.templateName),adobeSatelliteName.setVar("dl_containerID",e.message.eventInfo.web.webInteraction._mscom.containerInfo.containerID),adobeSatelliteName.setVar("dl_containerParentId",e.message.eventInfo.web.webInteraction._mscom.containerInfo.containerParentID),adobeSatelliteName.setVar("dl_containerTitle",e.message.eventInfo.web.webInteraction._mscom.containerInfo.containerTitle),adobeSatelliteName.setVar("dl_containerType",e.message.eventInfo.web.webInteraction._mscom.containerInfo.containerType),adobeSatelliteName.setVar("dl_containerItemID",e.message.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemID),adobeSatelliteName.setVar("dl_containerItemImage",e.message.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemImage),adobeSatelliteName.setVar("dl_containerItemTitle",e.message.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemTitle),adobeSatelliteName.setVar("dl_containerItemType",e.message.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemType),adobeSatelliteName.setVar("dl_slotNumber",e.message.eventInfo.web.webInteraction._mscom.containerItemInfo.slotNumber),adobeSatelliteName.setVar("dl_pageLocation",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.pageLocation),adobeSatelliteName.setVar("dl_pageSectionID",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.pageSectionID),adobeSatelliteName.setVar("dl_pageSection",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.pageSection),adobeSatelliteName.setVar("dl_headerName",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.headerName),adobeSatelliteName.setVar("dl_headerNameEn",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.headerNameEn),adobeSatelliteName.setVar("dl_pageArea",e.message.eventInfo.web.webInteraction._mscom.sectionInfo.pageArea),adobeSatelliteName.setVar("dl_formDetails",e.message.eventInfo.formInfo.formDetails),adobeSatelliteName.setVar("dl_formID",e.message.eventInfo.formInfo.formID),adobeSatelliteName.setVar("dl_formName",e.message.eventInfo.formInfo.formName),adobeSatelliteName.setVar("dl_eventName",e.message.event),adobeSatelliteName.setVar("dl_eventDataName",e.message.eventInfo._mscom.eventData.eventName),adobeSatelliteName.setVar("dl_eventCategory",e.message.eventInfo._mscom.eventData.eventCategory),adobeSatelliteName.setVar("dl_eventBehaviorCategory",e.message.eventInfo._mscom.eventData.eventBehaviorCategory),adobeSatelliteName.setVar("dl_actionType",e.message.eventInfo._mscom.eventData.actionType),adobeSatelliteName.setVar("dl_behaviorID",e.message.eventInfo._mscom.eventData.behaviorID),adobeSatelliteName.setVar("dl_hitNumber",e.message.eventInfo.web.webInteraction._mscom.hitNumber),adobeSatelliteName.setVar("dl_countryCode",e.message.eventInfo.placeContext.geo.countryCode),null!=e.message.eventInfo.environment._dc?null!=e.message.eventInfo.environment._dc.language&&adobeSatelliteName.setVar("dl_environmentLanguage",e.message.eventInfo.environment._dc.language):adobeSatelliteName.setVar("dl_environmentLanguage",void 0),adobeSatelliteName.setVar("dl_identityMap",e.message.eventInfo.identityMap),adobeSatelliteName.setVar("dl_currentIdentitiesANON",e.message.eventInfo._mscom.currentIdentities.ANON),adobeSatelliteName.setVar("dl_currentIdentitiesECID",e.message.eventInfo._mscom.currentIdentities.ECID),adobeSatelliteName.setVar("dl_currentIdentitiesMC1GUID",e.message.eventInfo._mscom.currentIdentities.MC1GUID),adobeSatelliteName.setVar("dl_currentIdentitiesMarketoLeadId",e.message.eventInfo._mscom.currentIdentities.marketoLeadId),adobeSatelliteName.setVar("dl_currentIdentitiesMarketoMunchkinCookie",e.message.eventInfo._mscom.currentIdentities.marketoMunchkinCookie),adobeSatelliteName.setVar("dl_errorPageFlag",e.message.eventInfo.web.webPageDetails.isErrorPage),adobeSatelliteName.setVar("dl_urlQS",e.message.eventInfo.web.webPageDetails._mscom.pageInfo.URLQS),adobeSatelliteName.setVar("dl_urlWithoutQS",e.message.eventInfo.web.webPageDetails._mscom.pageInfo.URLWithoutQS),adobeSatelliteName.setVar("dl_pageName",e.message.eventInfo.web.webPageDetails.name),adobeSatelliteName.setVar("dl_siteBrand",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteBrand),adobeSatelliteName.setVar("dl_siteDomain",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteDomain),adobeSatelliteName.setVar("dl_siteID",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteID),adobeSatelliteName.setVar("dl_siteLanguage",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteLanguage),adobeSatelliteName.setVar("dl_siteLocale",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteLocale),adobeSatelliteName.setVar("dl_siteMarket",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteMarket),adobeSatelliteName.setVar("dl_siteName",e.message.eventInfo.web.webPageDetails._mscom.siteInfo.siteName),"Accordion (No href)"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Button (No href)"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Internal Site Link"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Download Link"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Exit Link"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Link (No href)"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName||"Anchor Tag"===e.message.eventInfo.pageActionInfo.elementInfo.elementLinkName)return!0}return!1}},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return-1!=adobeSatelliteName.getVar("ACDL - URL").indexOf("/microsoft-365")}},timeout:2e3}],actions:[{modulePath:"adobe-alloy/dist/lib/actions/sendEvent/index.js",settings:{xdm:"%XDM - All Clicks%",type:"web.webinteraction.linkClicks",instanceName:"alloy"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/5ef092d1efb5/d6d76b37b476/3478c350b630/RC29fe1d5f46044f989d91799cdf49197f-source.min.js",language:"javascript",isExternal:!0},timeout:2e3,delayNext:!0}]},{id:"RL8279c05518fd4ac4b4cd0dbee1611685",name:"All Pages (Page Top) - Set eventPayload for mousedown, keydown, and clicks",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:10}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return-1!=adobeSatelliteName.getVar("ACDL - URL").indexOf("/microsoft-365")}},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:'// Set eventPayload for click on mousedown or key down with swipe detection\n// Trigger on library loaded and put code in a condition (to have it load in <head>) or remove the \'return true;\' and put it in acation (to have it load in <body>).\n\n/*\nvar adobeSatelliteName;\nif (typeof window._satellite !== \'undefined\' && window._satellite !== null) {\n  adobeSatelliteName = window._satellite;\n} else if (typeof window._satellite2 !== \'undefined\' && window._satellite2 !== null) {\n  adobeSatelliteName = window._satellite2;\n}\n*/\n\ndocument.addEventListener(\'keydown\', function (e) { \n  //if (e.keyCode === 13) {\n  if (e.code === "Enter") {\n    var keyPressCode = e.code;\n    console.log("Keydown on enter key triggered");\n    console.log(e.target);\n    adobeSatelliteName.setVar("enterKeyPressFlag", "Y");\n\n    var siteBrandDE = adobeSatelliteName.getVar(\'ACDL - Site Brand\');\n\n    // checking if search term is null or filled out & setting value\n    if (e.target.closest(\'input#cli_shellHeaderSearchInput\') !== null \n    || e.target.closest(\'input#search-field\') !== null) {\n      var searchTerm = "Unknown searchTerm";\n      var searchSubmitTrigger = 0;\n      // if value is not null\n      if (typeof e.target.closest(\'input#cli_shellHeaderSearchInput\').querySelector(\'input[type="search"]\').innerText != "undefined" \n      || typeof e.target.closest(\'input#search-field\').querySelector(\'input[type="search"]\').innerText != "undefined") {\n          searchTerm = e.target.closest(\'input#cli_shellHeaderSearchInput\').querySelector(\'input[type="search"]\').innerText;\n      }\n      if (searchTerm !== "Unknown searchTerm") {\n          searchSubmitTrigger = 1;\n      }\n      adobeSatelliteName.setVar(\'Search Term\',searchTerm);\n    }\n    a_setClickPayload(e,\'Y\',keyPressCode,searchSubmitTrigger);\n  }\n});\n\n//Function to set swipe payload\nfunction a_setSwipePayload() {\n  console.log("Enter a_setSwipePayload");\n  //var element = e.target;\n  document.isSwipeFlag = false;\n  document.gesture = {\n    x: [],\n    y: [],\n    match: \'\'\n  }\n\n  document.addEventListener(\'pointerdown\', function (e) {\n    document.gesture.x.push(e.clientX)\n    document.gesture.y.push(e.clientY)\n  });\n\n  document.addEventListener(\'pointerup\', function (e) {\n    document.gesture.x.push(e.clientX)\n    document.gesture.y.push(e.clientY)\n    //var dots = document.querySelectorAll(\'em\'),\n    document.xTravel = document.gesture.x[document.gesture.x.length - 1] - document.gesture.x[0],\n      console.log("xTravel: " + document.xTravel);\n    document.yTravel = document.gesture.y[document.gesture.y.length - 1] - document.gesture.y[0];\n    console.log("yTravel: " + document.yTravel);\n    //if (document.xTravel<document.tolerance && document.xTravel>-document.tolerance && document.yTravel<-document.tolerance){\n    if (document.yTravel < 0) {\n      document.gesture.match = \'Swiped Up\';\n      console.log(document.gesture.match);\n    }\n    //if (document.xTravel<document.tolerance && document.xTravel>-document.tolerance && document.yTravel>document.tolerance){\n    if (document.yTravel > 0) {\n      document.gesture.match = \'Swiped Down\';\n      console.log(document.gesture.match);\n    }\n    //if (document.yTravel<document.tolerance && document.yTravel>-document.tolerance && document.xTravel<-document.tolerance){\n    if (document.xTravel < 0) {\n      document.gesture.match = \'Swiped Left\';\n      console.log(document.gesture.match);\n    }\n    //if (document.yTravel<document.tolerance && document.yTravel>-document.tolerance && document.xTravel>document.tolerance){\n    if (document.xTravel > 0) {\n      document.gesture.match = \'Swiped Right\';\n      console.log(document.gesture.match);\n    }\n    if (document.gesture.match !== \'\') {\n      //output.innerHTML = gesture.match\n      //output.style.opacity = 1\n      document.isSwipeFlag = true;\n      //document.isSwipe = true;\n      //console.log(document.isSwipe);    \n    }\n    console.log("isSwipeFlag: " + document.isSwipeFlag);\n    if (document.isSwipeFlag == false) {\n      a_setClickPayload(e);\n    }\n    document.isSwipeFlag = false;\n    document.gesture = {\n      x: [],\n      y: [],\n      match: \'\'\n    }\n    document.gesture.match = document.xTravel = document.yTravel = \'\';\n  });\n}\na_setSwipePayload();\n  \n//Function to set click payload\nfunction a_setClickPayload(e,keyPressFlagPassed,keyPressCodePassed,searchTriggerFlagPassed) {\n\n  //Reset on-the-fly (OTF) variables\n  a_resetOtfVars();\n\n  //-Bring in data elements\n  var deviceDetailsDE = adobeSatelliteName.getVar("ACDL - Device Details"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n  var environmentDE = adobeSatelliteName.getVar("ACDL - Environment Details"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n  var faxPhoneDE = adobeSatelliteName.getVar("ACDL - Fax Phone"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n  var homeAddressDE = adobeSatelliteName.getVar("ACDL - Home Address"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n  var homePhoneDE = adobeSatelliteName.getVar("ACDL - Home Phone"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n  var implementationDetailsDE = adobeSatelliteName.getVar("ACDL - Implementation Details"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n  var mailingAddressDE = adobeSatelliteName.getVar("ACDL - Mailing Address");\n  var marketingDetailsDE = adobeSatelliteName.getVar("ACDL - Marketing Details");  // Campaign marketing details. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/campaign-marketing-details\n  var mobilePhoneDE = adobeSatelliteName.getVar("ACDL - Mobile Phone"); \n  var organizationsArrayDE = adobeSatelliteName.getVar("ACDL - Organizations Array"); // An array of free-form strings that represent the organizations the person is a member of. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n  var personDE = adobeSatelliteName.getVar("ACDL - Person Details"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/demographic-details\n  var personalEmailDE = adobeSatelliteName.getVar("ACDL - Personal Email"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n  var segmentListArrayDE = adobeSatelliteName.getVar("ACDL - Segment List Array");\n  var shippingAddressDE = adobeSatelliteName.getVar("ACDL - Shipping Address");\n  var shippingAddressPhoneDE = adobeSatelliteName.getVar("ACDL - Shipping Address");\n  var userActivityRegionDE = adobeSatelliteName.getVar("ACDL - User Activity Region");\n  var pageNameDE = adobeSatelliteName.getVar("ACDL - Page Name"); // v1 in AA.\n  var pageUrlDE = adobeSatelliteName.getVar("ACDL - URL"); // Full URL including query string\n  var isErrorPageDE = adobeSatelliteName.getVar("ACDL - Error Page Flag");\n  var isHomePageDE = adobeSatelliteName.getVar("ACDL - Home Page Flag");\n  var serverNameDE = adobeSatelliteName.getVar("ACDL - Server Name");\n  var siteSectionDE = adobeSatelliteName.getVar("ACDL - Site Section");\n\n  //Place Context\n  var longitudeDE = adobeSatelliteName.getVar("longitude");\n  var latitudeDE = adobeSatelliteName.getVar("latitude");\n  var countryCodeDE = adobeSatelliteName.getVar("ACDL - Country Code");\n\n  //Site Info\n  var siteIdDE = adobeSatelliteName.getVar("ACDL - Site ID"); // This is a custom field. Represents an ID for the site assigned by MSFT or created with logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n  var siteNameDE = adobeSatelliteName.getVar("ACDL - Site Name");\n  var siteBrandDE = adobeSatelliteName.getVar("ACDL - Site Brand"); // This is a custom field. Represents a brand for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n  var siteMarketDE = adobeSatelliteName.getVar("ACDL - Site Market"); // This is a custom field. Represents a market (usually aligned with countries, but not always) for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n  var siteLanguageDE = adobeSatelliteName.getVar("ACDL - Site Language"); // This is a custom field. Represents the language for the site assigned by MSFT or derived from custom logic, possibly scraped from the browser. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n  var siteLocaleDE = adobeSatelliteName.getVar("ACDL - Site Locale"); // This is a custom field. Represents a combination of the market and language for the site assigned by MSFT or derived from logic (possibly from the url since it includes the locale). We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n  \n  var webReferrerObjDE = adobeSatelliteName.getVar("ACDL - Web Referrer");\n  var pageReferrerDE = adobeSatelliteName.getVar(\'ACDL - Referrer\');\n  var pageReferrerTypeDE = adobeSatelliteName.getVar(\'ACDL - Referrer Type\');\n  var billingAddressDE = adobeSatelliteName.getVar("ACDL - Billing Address");\n  var billingAddressPhoneDE = adobeSatelliteName.getVar("ACDL - Billing Address Phone");\n  var sessionIDDE = adobeSatelliteName.getVar("ACDL - Session ID");\n  var hitNumberDE = adobeSatelliteName.getVar("ACDL - Hit Number");\n  var workAddressDE = adobeSatelliteName.getVar("ACDL - Work Address"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n  var workEmailDE = adobeSatelliteName.getVar("ACDL - Work Email"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n  var workPhoneDE = adobeSatelliteName.getVar("ACDL - Work Phone"); // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n  //var _id = adobeSatelliteName.getVar("ACDL - Billing Address"); // Not a person ID.\n  var eventMergeId; // Session ID.\n  var eventType;\n  var visitorECIDDE = adobeSatelliteName.getVar("ECID");\n  var anonIdDE = adobeSatelliteName.getVar("ACDL - ANON Cookie");\n  var mc1GUIDDE = adobeSatelliteName.getVar("ACDL - MC1 GUID");\n  var marketoLeadIdDE = adobeSatelliteName.getVar("ACDL - Marketo Lead ID");\n  var marketoMunchkinCookieDE = adobeSatelliteName.getVar("ACDL - Munchkin Cookie");\n  var identityMapDE = adobeSatelliteName.getVar("ACDL - Identity Map");\n  var commerceObj = {};\n  var consentsDE = adobeSatelliteName.getVar("ACDL - Consents and Preferences Snapshot");\n  var environmentLanguageDE = adobeSatelliteName.getVar("ACDL - Environment Language");\n  //var identityMapDE = adobeSatelliteName.getVar("ACDL - Identity Map");\n  var siteBrandDE = adobeSatelliteName.getVar("ACDL - Site Brand");\n  var siteDomainDE = adobeSatelliteName.getVar("ACDL - Site Domain");\n\n  //Web Session\n  var webSessionDetailsObjDE = adobeSatelliteName.getVar("ACDL - Web Session Details");\n  var entryReferrerDE = adobeSatelliteName.getVar("ACDL - Entry Referrer");\n  var entryReferrerTypeDE = adobeSatelliteName.getVar("ACDL - Entry Referrer Type");\n  var entryUrlDE = adobeSatelliteName.getVar("ACDL - Entry URL");\n\n\n  var viewNameDE = adobeSatelliteName.getVar("ACDL - View Name");\n  var URLWithoutQsDE = adobeSatelliteName.getVar("ACDL - URL Without QS"); // Custom field. URL with any query string stripped from it. v41 in AA.\n  var URLQsDE = adobeSatelliteName.getVar("ACDL - URLQS"); // Custom field. Only the query string value from the URL. "Page URL Query Strings (v16)" in AA.\n  var prevPageURLDE = adobeSatelliteName.getVar("ACDL - Previous Page URL"); // Custom field. Populated with the URL without a query string for the previous page (if available). May require custom client side code to store this value in a cookie and reference that cookie at each event.\n  var userAgentDE = adobeSatelliteName.getVar("ACDL - User Agent"); // Custom field. v44 in AA.\n  var pageTypeDE = adobeSatelliteName.getVar("ACDL - Page Type"); // Custom field. v13 in AA.\n  var pageGroupDE = adobeSatelliteName.getVar("ACDL - Page Group"); // Custom field. v14 in AA.\n  var pageTitleDE = adobeSatelliteName.getVar("ACDL - Page Title"); // Custom field. v15 in AA.\n  var pageNameDE = adobeSatelliteName.getVar("ACDL - Page Name");\n  var pageUrlDE = adobeSatelliteName.getVar("ACDL - URL");\n  var metaOgTitleDE = adobeSatelliteName.getVar("Meta - OG Title");\n  var metaOgUrlDE = adobeSatelliteName.getVar("Meta - OG URL");\n  var metaPageTemplateDE = adobeSatelliteName.getVar("Meta - Page Template");\n  var metaDescriptionDE = adobeSatelliteName.getVar("Meta - Description");\n  var metaAwaCmsDE = adobeSatelliteName.getVar("Meta - AWA CMS");\n  var metaAwaMarketDE = adobeSatelliteName.getVar("Meta - AWA Market");\n  var metaAwaPageTypeDE = adobeSatelliteName.getVar("Meta - AWA Page Type");\n  var metaAwaPageTemplateDE = adobeSatelliteName.getVar("Meta - AWA Page Template");\n  var metaAwaIsTentedFlagDE = adobeSatelliteName.getVar("Meta - AWA Is Tented Flag");\n  var metaAwaCanvasTypeDE = adobeSatelliteName.getVar("Meta - AWA Canvas Type");\n  var msftConsentBannerVisibilityFlagDE = adobeSatelliteName.getVar("ACDL - Consent Banner Visibility Flag");\n\n  var campaignIDDE = adobeSatelliteName.getVar("ACDL - Campaign ID");\n  var a_campaignDetailsDE = adobeSatelliteName.getVar("ACDL - Campaign Details");\n  var ocidTrackingCode = adobeSatelliteName.getVar("ACDL - OCID");\n  var icidTrackingCodeDE = adobeSatelliteName.getVar("ACDL - ICID (Internal Campaign ID)");\n  var ECIDDE = adobeSatelliteName.getVar("ECID");\n  //var FederatedIDDE = adobeSatelliteName.getVar("Federated ID");\n  var enterKeyPressFlag = adobeSatelliteName.getVar("enterKeyPressFlag");  \n  var searchTriggerFlag = "0";\n  var sendForReportingFlag = false;\n\n  //Set searchTiggerFlag if passsed a_setClickPayload\n  if (searchTriggerFlagPassed !== undefined) {\n    searchTriggerFlag = searchTriggerFlagPassed;\n  }  \n  //Set default values\n  var eventPayloadObj = {\n    "event": "Unknown eventName",\n    "eventInfo": {\n      "path": null,\n      "eventID": "Unknown eventID",\n      "pageInfo": {\n        "pageUrl": "Unknown pageUrl",\n        "pageName": "Unknown pageName",\n        "siteSection1": "Unknown siteSection1",\n        "siteSection2": "Unknown siteSection2",\n        "siteSection3": "Unknown siteSection3",\n        "siteSection4": "Unknown siteSection4",\n        "siteSection5": "Unknown siteSection5",\n        "viewport": "Unknown viewport",\n        "orientation": "Unknown orientation"\n      }, //end pageInfo\n      "campaignInfo": {\n        "campaignID": "Unknown campaignID",\n        "campaignName": "Unknown campaignName",\n        "campaignType": "Unknown campaignType"\n      }, //end campaignInfo\n      "formInfo": {\n        "form": "Unknown form",\n        "formID": "Unknown formID",\n        "formName": "Unknown formName",\n        "formFriendlyName": "Unknown formFriendlyName",\n        "formClass": "Unknown formClass",\n        "formDetails": "Unknown formDetails"\n      }, //end formInfo\n      "carouselInfo": {\n        "carousel": "Unknown carousel",\n        "carouselID": "Unknown carouselID",\n        "carouselTitle": "Unknown carouselTitle",\n        "carouselItem": "Unknown carouselItem",\n        "carouselItemTitle": "Unknown carouselItemTitle",\n        "carouselItemImage": "Unknown carouselItemImage"\n      }, //end carouselInfo\n      "gridInfo": {\n        "grid": "Unknown grid",\n        "gridID": "Unknown gridID",\n        "gridTitle": "Unknown gridTitle",\n        "gridTileItem": "Unknown gridTileItem",\n        "gridTileItemTitle": "Unknown gridTileItemTitle",\n        "gridTileItemImage": "Unknown gridTileItemImage"\n      }, //end gridInfo\n      "newsArticleInfo": {\n        "newsArticleID": "Unknown newsArticleID",\n        "newsArticleName": "Unknown newsArticleName",\n        "newsArticleCategory": "Unknown newsArticleCategory"\n      }, //end newsArticleInfo\n      "accordionInfo": {\n        "accordionText": "Unknown accordionText",\n        "expansionState": "Unknown expansionState",\n        "expansionAction": "Unknown expansionAction"\n      }, //end accordionInfo\n      "productInfo": {\n        "productID": "Unknown productID",\n        "productName": "Unknown productName",\n        "productBrand": "Unknown productBrand",\n        "productCategory": "Unknown productCategory",\n        "productDescription": "Unknown productDescription",\n        "productPrice": "Unknown productPrice",\n      }, //end productInfo\n      "rewardInfo": {\n        "rewardID": "Unknown rewardID",\n        "rewardName": "Unknown rewardName",\n        "rewardCategory": "Unknown rewardCategory"\n      }, //end rewardInfo\n      "visitorProfile": {\n        "visitorECID": "Unknown visitorECID",\n        "visitorNameID": "Unknwon visitorNameID",\n        "visitorFederatedId": "Unknown visitorFederatedId",\n        "userProfileStateAuthentication": "Unknown userProfileStateAuthentication",\n        "lastSearchedTerm": "Unknown lastSearchedTerm",\n        "locationInfo": {\n          "postalCode": "Unknown postalCode",\n          "country": "Unknown country",\n          "state": "Unknown state",\n          "city": "Unknown city"\n        }, //end locationInfo\n        "brandPreferences": {\n          "userPreferredBrand": {\n            "brandInfo": {\n              "brandID": "Unknown brandID",\n              "brandName": "Unknown brandName"\n            }\n          }, //end userPreferredBrand\n          "userLikedBrands": []\n        } //end brandPreferences\n      }, //end visitorProfile\n      "shoppingCart": {\n        "numberOfProductsInCart": "Unknown numberOfProdutsInCart",\n        "cartTotal": "Unknown cartTotal",\n        "productsInCart": []\n      }, //end shoppingCart\n      "errors": [],\n      "filters": [],\n      "searches": [],\n      "videosDisplayed": [],\n      "productsDisplayed": [],\n      "errorInfo": {\n        "errorID": "Unknown errorID",\n        "errorMessage": "Unknown errorMessage"\n      }, //end errorInfo\n      "filterInfo": {\n        "filterID": "Unknown filterID",\n        "filterType": "Unknown filterType",\n        "filterValue": "Unknown filterValue",\n        "filterSelected": "Unknown filterSelected"\n      }, //end filterInfo\n      "searchInfo": {\n        "searchTerm": "Unknown searchTerm",\n        "searchResultsTotal": "Unknown searchResultsTotal",\n        "searchResultsPageNumber": "Unknown searchResultsPageNumber",\n        "searchResultIndex": "Unknown searchResultIndex"\n      }, //end searchInfo\n      "videoInfo": {\n        "videoID": "Unknown videoID",\n        "videoName": "Unknown videoName",\n        "videoPlatform": "Unknown videoPlatform",\n        "videoFileFormat": "Unknown videoFileFormat",\n        "videoLength": "Unknown videoLength"\n      }, //end videoInfo\n      "pageActionInfo": {\n        "sectionInfo": {\n          //"dataLoc": "Unknown dataLoc",\n          //"canvasSectionID": "Unknown canvasSectionID",\n          //"canvasControlZoneID": "Unknown canvasControlZoneID",\n          //"viewportID": "Unknown viewportID",\n          //"webPartID": "Unknown webPartID",\n          //"spFeatureTag": "Unknown spFeatureTag",\n          "pageLocation": "Unknown pageLocation",\n          "pageSectionID": "Unknown pageSectionID",\n          "pageSection": "Unknown pageSection",\n          "submenuParent": "Unknown submenuParent",\n          "submenuParentLink": "Unknown submenuParentLink",\n          "submenuParentLinkText": "Unknown submenuParentLinkText",\n          "searchResultIndex": "Unknown searchResultIndex"\n        }, //end sectionInfo\n        "containerInfo":{\n          "containerID": "Unknown containerID",\n          "containerType": "Unknown containerType", // \'Carousel\' or \'Tabs\' or \'Accordion\' or \'Card Grid\' etc.\n          "containerTitle": "Unknown containerTitle",\n          "containerParentId":"Unknown containerParentId",\n          //"shownItems":[] // array of the displayed item IDs\n      }, //end containerInfo\n        "elementInfo": {\n          "elementID": "Unknown elementID",\n          //"dataAnalyticsClick": "Unknown dataAnalyticsClick",\n          //"elementAnalyticsID": "Unknown elementAnalyticsID",\n          "nodeType": "Unknown nodeType",\n          "elementType": "Unknown elementType",\n          "elementState": "Unknown elementState",\n          "elementAction": "Unknown elementAction",\n          "elementText": "Unknown elementText",\n          "elementIcon": "Unknown elementIcon",\n          "elementCTA": "Unknown elementCTA",\n          "elementName": "Unknown elementName",\n          "elementLinkName": "Unknown elementLinkName",\n          "elementLinkType": "Unknown elementLinkType",\n          "elementDataDisplayName": "Unknown elementDataDisplayName",\n          "elementDataNamePlaceholder": "Unknown elementDataNamePlaceholder",\n          "elementDataSlideTo": "Unknown elementDataSlideTo",\n          "elementVal": "Unknown elementVal",\n          "elementLabel": "Unknown elementLabel",\n          "formFieldName": "Unknown formFieldName",\n          "imageInfo": {\n            "imageFilePath": "Unknown imageFilePath",\n            "imageFilename": "Unknown imageFilename",\n            "imageAlt": "Unknown imageAlt",\n            "imageTitle": "Unknown imageTitle",\n            "svgDetails": "Unknown svgDetails",\n          }, //end imageInfo\n          "toggleInfo": {\n            "toggleTitle": "Unknown toggleTitle",\n            "toggleState": "Unknown toggleState",\n            "toggleAction": "Unknown toggleAction"\n          }, //end toggleInfo\n          "checkboxInfo": {\n            "checkboxState": "Unknown checkboxState",\n            "checkboxAction": "Unknown checkboxAction",\n            "checkboxesItemsSelected": "Unknown checkboxesItemsSelected",\n          }, //end checkboxInfo\n          "selectListInfo": {\n            "multiSelectItemsSelected": "Unknown multiSelectItemsSelected"\n          }, //end selectListInfo\n          "cmpDataLayer": {} //end cmpDataLayer\n        }, //end elementInfo\n        "clickStr": "Unknown clickStr",\n        "clickDetails": "Unknown clickDetails",\n        "mouseButton": "Unknown mouseButton",\n        "enterKeyPressFlag": "Unknown enterKeyPressFlag",\n        "keyPressCode": "Unknown keyPressCode",\n        "destinationUrl": "Unknown destinationUrl"\n      }, //end pageActionInfo\n      "_mscom": {\n        "consentsSnapshot": {},\n        "eventData":{\n            "eventName": "Unknown eventName", // Custom field.\n            "eventDataName": "Unknown eventDataName",\n            "eventCategory": "Unknown eventCategory", // Custom field.\n            "eventBehaviorCategory": "Unknown eventBehaviorCategory",\n            "actionType": "O", // CUstom field. CL is Left Mouse Click. Reference actionType library from MS MarTech portal. Default to \'O\' for other\n            "behaviorID": "Unknown behaviorID", // Custom field. Noting the ID values are predefined and Accenture can provide a map for us. For link interactions it will be scraped from data-bi-bhvr attribute on the element that was acted on.\n        } // end eventData\n      },\n      "billingAddress": {}, // end billingAddress\n      "billingAddressPhone": {}, // end billingAddressPhone\n      "botDetection": {}, // Reference https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/bot-detection-information\n      "commerce": {}, // end commerce\n      "device": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "environment": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "faxPhone": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "homeAddress": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "homePhone": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "implementationDetails": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "mailingAddress": {},\n      "marketing": {},  // Campaign marketing details. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/campaign-marketing-details\n      "mobilePhone": {}, \n      "organizations": [], // An array of free-form strings that represent the organizations the person is a member of. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "person": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/demographic-details\n      "personalEmail": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "placeContext": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "segmentList": [],\n      "shippingAddress": {},\n      "shippingAddressPhone": {},\n      "userActivityRegion": "Unknown userActivityRegion",\n      "web": {\n          "webPageDetails": {\n              "name": "Unknown pageName", // v1 in AA.\n              "URL": "Unknown pageUrl", // Full URL including query string\n              "isErrorPage": "Unknown isErrorPage",\n              "isHomePage": "Unknown isHomePage",\n              "server": "Unknown serverName",\n              "siteSection": "Unknown siteSection",\n              "viewName": "Unknown viewName",\n              "_mscom": {\n                  "pageInfo": {\n                      "URLWithoutQS": "Unknown URLWithoutQS", // Custom field. URL with any query string stripped from it. v41 in AA.\n                      "URLQS": "Unknown URLQS", // Custom field. Only the query string value from the URL. "Page URL Query Strings (v16)" in AA.\n                      "prevPageURL": "Unknown prevPageURL", // Custom field. Populated with the URL without a query string for the previous page (if available). May require custom client side code to store this value in a cookie and reference that cookie at each event.\n                      "userAgent": "Unknown userAgent", // Custom field. v44 in AA.\n                      "pageType": "Unknown pageType", // Custom field. v13 in AA.\n                      "pageGroup": "Unknown pageGroup", // Custom field. v14 in AA.\n                      "pageTitle": "Unknown pageTitle", // Custom field. v15 in AA.\n                  },\n                  "siteInfo": {\n                      //"language": "siteLanguage", // This is a custom field. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteID": "Unknown siteId", // This is a custom field. Represents an ID for the site assigned by MSFT or created with logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteBrand": "Unknown siteBrand", // This is a custom field. Represents a brand for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteMarket": "Unknown siteMarket", // This is a custom field. Represents a market (usually aligned with countries, but not always) for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteLanguage": "Unknown siteLanguage", // This is a custom field. Represents the language for the site assigned by MSFT or derived from custom logic, possibly scraped from the browser. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteLocale": "Unknown siteLocale", // This is a custom field. Represents a combination of the market and language for the site assigned by MSFT or derived from logic (possibly from the url since it includes the locale). We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                  }\n              }\n          },\n          "webInteraction": {\n              "linkClicks": {\n                  //"id": "", // May not be required\n                  //"region": "", // Is this needed if they are using pageArea?\n                  "value": 1\n              },\n              "name": "Unknown linkClicks.name", // Scraped from data-bi-cn attribute\n              "type": "Unknown linkClicks.type",\n              "URL": "Unknown URL", // Scraped from href attribute. This is often referred to as destinationURL, but there may be some limitations to how this standard field value can be reported on in AA. If the same problem is found in AEP datasets, we can add a custom destinationURL field.\n              "_mscom": {\n                  //"botFlag": false, // This is a custom field. It will likely require some custom logic in data collection. We may also choose to use https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/bot-detection-information\n                  "componentInfo": {\n                      "componentName": "Unknown componentName", // Custom field. Scraped from data-bi-compnm attribute\n                      "componentType": "Unknown componentType", // Custom field. Is this needed? Not scraped from page. Would need logic or a lookup table.\n                      "templateName": "Unknown templateName", // Custom field. Scraped from data-bi-tn attrubute (when available)\n                      "componentView": "Unknown componentView" // Custom field. Scraped from data-bi-view attrubute\n                  },\n                  "containerInfo": {\n                      "containerTitle": "Unknown containerTitle", // Custom field. Core component would take from "dc:title" attribute.\n                      "containerID": "Unknown containerID", // Custom field.\n                      "containerType": "Unknown containerType", // \'Carousel\' or \'Tabs\' or \'Accordion\' or \'Card Grid\' etc.\n                      "containerParentId": "Unknown containerParentId", // Custom field.\n                      "shownItems": [] // Custom field. Array of the displayed item IDs\n                  },\n                  "containerItemInfo": {\n                      "containerItemID": "Unknown containerItemID", // Custom field. Scraped from ID attribute of container item if available.\n                      "containerItemImage": "Unknown containerItemImage", // Custom field. Scraped from HTML if container item includes an image.\n                      "containerItemTitle": "Unknown containerItemTitle", // Custom field. Scraped from HTML if container item includes a title.\n                      "containerItemType": "Unknown containerItemType", // Custom field. Inferred value from custom logic or scraped from HTML.\n                      "slotNumber": "Unknown slotNumber", // Custom field. Scraped from data-bi-sn attribute\n                  },\n                  "elementInfo": {\n                      "contentType": "Unknown elementContentType", // Custom field. Scraped from data-bi-ct attribute\n                      "contentName": "Unknown elementContentName", // Custom field. \n                      "contentNameEn": "Unknown elementContentNameEn", // Custom field. Scraped from data-bi-ecn attribute\n                      "elementID": "Unknown elementID", // Custom field. Scraped from id attribute.\n                      "elementCTA": "Unknown elementCTA", // Custom field. If link is text, the text of the link. If an icon, the icon class or name. If link is an image, the image filename. This will always be in the language rendered on the page.\n                      "elementType": "Unknown elementType", // Custom field. Friendly version of the element type such as \'button\' or \'link\' or could be more specific like \'text link\' or \'image link\'\n                      "destinationUrl": "Unknown destinationUrl",\n                      "nodeType": "Unknown nodeType" // Custom field. The HTML node type of the element that was acted on.\n                  },\n                  //"hitNumber": "Unknown hitNumber", // Used for Sequence Number\n                  "hitNumber": hitNumberDE, // Used for Sequence Number\n                  "sectionInfo": {\n                      "headerName": "Unknown headerName", // Custom field. Scraped from data-bi-hn attribute\n                      "headerNameEn":"Unknown headerNameEn", // Custom field. Scraped from data-bi-ehn attribute\n                      "pageArea": "Unknown pageArea", // Custom field. Scraped from data-bi-an attribute. Often referred to as Page Section // Noting that some objects in the tagging spec use a variable called sectionID. Is that different?\n                  }\n              }\n          },\n          "webReferrer": {\n              "URL": "Unknown webReferrer",\n              "type": "Unknown webReferrerType"\n          },\n          "_mscom": {\n            "webSession": {\n              "sessionID": "Unknown sessionID",\n              "entryReferrer": "Unknown entryReferrer",\n              "entryReferrerType": "Unknown entryReferrerType",\n              "entryUrl": "Unknown entryUrl"\n            }\n          }\n      },\n      "workAddress": "Unknown workAddress", // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "workEmail": "Unknown workEmail", // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "workPhone": "Unknown workPhone", // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      //"_id": "", // Not a person ID.\n      "eventMergeId": "", // Session ID. Auto-collected by Web SDK.\n      "eventType": "Unknown eventType",\n      "identityMap": "Unknown identityMap"\n    }, //end eventInfo\n  }\n\n\n  //-Initialize Variables\n\n  //--Bot Detection\n  var botDetectionScore = eventPayloadObj.eventInfo.botDetection.botDetectionScore;\n\n  //--Event Variables\n  var eventID = eventPayloadObj.eventInfo.eventID;\n  var eventName = eventPayloadObj.eventInfo.eventName;\n  var eventDataName = eventPayloadObj.eventInfo._mscom.eventData.eventDataName;\n  var eventNameACDL = eventPayloadObj.eventInfo.eventNameACDL;\n  var eventCategory = eventPayloadObj.eventInfo._mscom.eventData.eventCategory;\n  var eventBehaviorCategory = eventPayloadObj.eventInfo._mscom.eventData.eventBehaviorCategory;\n  var eventActionType = eventPayloadObj.eventInfo._mscom.eventData.actionType;\n  var eventBehaviorID = eventPayloadObj.eventInfo._mscom.eventData.behaviorID;\n  var eventHitNumber = eventPayloadObj.eventInfo.web.webInteraction._mscom.hitNumber;\n\n  //--Visitor Level (visitorProfile)\n  var visitorECID = eventPayloadObj.eventInfo.visitorProfile.visitorECID;\n  //var visitorECID = ECIDDE;\n  var visitorNameID = eventPayloadObj.eventInfo.visitorProfile.visitorNameID;\n  var visitorFederatedId = eventPayloadObj.eventInfo.visitorProfile.visitorFederatedId;\n  var userProfileStateAuthentication = eventPayloadObj.eventInfo.visitorProfile.userProfileStateAuthentication;\n  var lastSearchedTerm = eventPayloadObj.eventInfo.visitorProfile.lastSearchedTerm;\n  //---Location Level (visitorProfile.locationInfo)\n  var visitorProfilePostalCode = eventPayloadObj.eventInfo.visitorProfile.visitorProfilePostalCode;\n  var visitorProfileCountry = eventPayloadObj.eventInfo.visitorProfile.visitorProfileCountry;\n  var visitorProfileState = eventPayloadObj.eventInfo.visitorProfile.visitorProfileState;\n  var visitorProfileCity = eventPayloadObj.eventInfo.visitorProfile.visitorProfileCity;\n  //--Brand Preferences (visitorProfile.brandPreferences)\n  var visitorProfilePreferredBrandID = eventPayloadObj.eventInfo.visitorProfile.brandPreferences.userPreferredBrand.brandInfo.brandID;\n  var visitorProfilePreferredBrandName = eventPayloadObj.eventInfo.visitorProfile.brandPreferences.userPreferredBrand.brandInfo.brandName;\n\n  //--Site Level (siteInfo)\n  var siteID = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteID;\n  var siteDomain = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteDomain;\n  var siteName = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteName;\n  var siteBrand = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteBrand;\n  var siteLocale = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteLocale;\n  var siteLanguage = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteLanguage;\n  var siteMarket = eventPayloadObj.eventInfo.web.webPageDetails._mscom.siteInfo.siteMarket;\n\n  //--Page Level (pageInfo)\n  var pageUrl = eventPayloadObj.eventInfo.pageInfo.pageUrl;\n  var pageName = eventPayloadObj.eventInfo.pageInfo.pageName;\n  var siteSection1 = eventPayloadObj.eventInfo.pageInfo.siteSection1;\n  var siteSection2 = eventPayloadObj.eventInfo.pageInfo.siteSection2;\n  var siteSection3 = eventPayloadObj.eventInfo.pageInfo.siteSection3;\n  var siteSection4 = eventPayloadObj.eventInfo.pageInfo.siteSection4;\n  var siteSection5 = eventPayloadObj.eventInfo.pageInfo.siteSection5;\n  var viewport = eventPayloadObj.eventInfo.pageInfo.viewport;\n  var orientation = eventPayloadObj.eventInfo.pageInfo.orientation;\n  var prevPageURL = eventPayloadObj.eventInfo.web.webPageDetails._mscom.pageInfo.prevPageURL;\n\n  //--Form Level (formInfo)\n  var form = eventPayloadObj.eventInfo.formInfo.form;\n  var formID = eventPayloadObj.eventInfo.formInfo.formID;\n  var formName = eventPayloadObj.eventInfo.formInfo.formName;\n  var formFriendlyName = eventPayloadObj.eventInfo.formInfo.formFriendlyName;\n  var formClass = eventPayloadObj.eventInfo.formInfo.formClass;\n  var formDetails = eventPayloadObj.eventInfo.formInfo.formDetails;\n\n  //--Accordion Level (accordionInfo)\n  var accordionText = eventPayloadObj.eventInfo.accordionInfo.accordionText;\n  var expansionState = eventPayloadObj.eventInfo.accordionInfo.expansionState;\n  var expansionAction = eventPayloadObj.eventInfo.accordionInfo.expansionAction;\n\n  //--Page Section Level (pageActionInfo)\n  //var canvasSectionID = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.canvasSectionID;\n  //var canvasControlZoneID = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.canvasControlZoneID;\n  //var viewportID = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.viewportID;\n  //var webPartID = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.webPartID;\n  //var spFeatureTag = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.spFeatureTag;\n  var pageLocation = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.pageLocation;\n  var pageSectionID = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.pageSectionID;\n  var pageSection = eventPayloadObj.eventInfo.web.webInteraction._mscom.sectionInfo.headerName;\n  var submenuParent = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.submenuParent;\n  var submenuParentLink = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.submenuParentLink;\n  var submenuParentLinkText = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.submenuParentLinkText;\n  var searchResultIndex = eventPayloadObj.eventInfo.pageActionInfo.sectionInfo.searchResultIndex;\n  var sectionHeaderName = eventPayloadObj.eventInfo.web.webInteraction._mscom.sectionInfo.sectionHeaderName; // Scraped from data-bi-hn attribute\n  var sectionHeaderNameEn = eventPayloadObj.eventInfo.web.webInteraction._mscom.sectionInfo.sectionHeaderNameEn; // Scraped from data-bi-ehn attribute\n  var sectionPageArea = eventPayloadObj.eventInfo.web.webInteraction._mscom.sectionInfo.sectionPageArea;\n  //--Element Level (pageActionInfo.elementInfo)\n  //var element = jQuery(this);\n  var element = e.target;\n  var elementPath = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementPath;\n  //var dataLoc = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.dataLoc;\n  var elementID = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementID;\n  var dataAnalyticsClick = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.dataAnalyticsClick;\n  //var elementAnalyticsID = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementAnalyticsID;\n  var nodeType = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.nodeType;\n  var elementContentType = eventPayloadObj.eventInfo.web.webInteraction._mscom.elementInfo.contentType; // Scraped from data-bi-ct attribute\n  var elementContentName = eventPayloadObj.eventInfo.web.webInteraction._mscom.elementInfo.contentName;\n  var elementContentNameEn = eventPayloadObj.eventInfo.web.webInteraction._mscom.elementInfo.contentNameEn; // Scraped from data-bi-ecn attribute\n  var elementType = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementType;\n  var elementState = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementState;\n  var elementAction = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementAction;\n  var elementText = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementText;\n  var elementIcon = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementIcon;\n  var elementCTA = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementCTA;\n  var elementName = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementName;\n  var elementLinkName = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementLinkName;\n  var elementLinkType = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementLinkType;\n  //var elementLinkType = eventPayloadObj.eventInfo.web.webInteraction.type;\n  var elementDataDisplayName = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementDataDisplayName;\n  var elementDataNamePlaceholder = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementDataNamePlaceholder;\n  var elementDataSlideTo = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementDataSlideTo;\n  var elementVal = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementVal;\n  var elementLabel = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementLabel;\n  var formFieldName = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.formFieldName;\n  var imageFilePath = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.imageInfo.imageFilePath;\n  var imageFilename = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.imageInfo.imageFilename;\n  var imageAlt = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.imageInfo.imageAlt;\n  var imageTitle = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.imageInfo.imageTitle;\n  var svgDetails = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.imageInfo.svgDetails;\n  //var checkboxStatus = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.checkboxInfo.checkboxStatus;\n  var checkboxState = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.checkboxInfo.checkboxState;\n  var checkboxAction = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.checkboxInfo.checkboxAction;\n  var checkboxesItemsSelected = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.checkboxInfo.checkboxesItemsSelected;\n  var multiSelectItemsSelected = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.selectListInfo.multiSelectItemsSelected;\n  var toggleTitle = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.toggleInfo.toggleTitle;\n  var toggleState = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.toggleInfo.toggleState;\n  var toggleAction = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.toggleInfo.toggleAction;\n  var clickStr = eventPayloadObj.eventInfo.pageActionInfo.clickStr;\n  var clickDetails = eventPayloadObj.eventInfo.pageActionInfo.clickDetails;\n  var destinationUrl = eventPayloadObj.eventInfo.pageActionInfo.destinationUrl;\n  var cmpDataLayer = eventPayloadObj.eventInfo.pageActionInfo.cmpDataLayer;\n  var mouseButton = eventPayloadObj.eventInfo.pageActionInfo.mouseButton;\n  var enterKeyPressFlag = eventPayloadObj.eventInfo.pageActionInfo.enterKeyPressFlag;\n  var keyPressCode = eventPayloadObj.eventInfo.pageActionInfo.keyPressCode;\n\n  //--Component Variables (componentInfo)\n  var componentName = eventPayloadObj.eventInfo.web.webInteraction._mscom.componentInfo.componentName; // Scraped from data-bi-compnm attribute\n  var componentType = eventPayloadObj.eventInfo.web.webInteraction._mscom.componentInfo.componentType;\n  var cmpTags;\n  var templateName = eventPayloadObj.eventInfo.web.webInteraction._mscom.componentInfo.templateName; // Scraped from data-bi-tn attrubute (when available)\n  var componentView = eventPayloadObj.eventInfo.web.webInteraction._mscom.componentInfo.componentView; // Scraped from data-bi-view attrubute\n\n  //--Container Item Variables (containerItemInfo)\n  var containerItemID = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemID;\n  var containerItemImage = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemImage;\n  var containerItemTitle = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemTitle;\n  var containerItemType = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerItemInfo.containerItemType;\n  var containerSlotNumber = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerItemInfo.slotNumber; // Scraped from data-bi-sn attribute\n\n  //--Container Variables (containerInfo)\n  var containerTitle = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.containerTitle;\n  var containerID = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.containerID;\n  var containerType = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.containerType;\n  var containerTitle = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.containerTitle;\n  var containerParentId = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.containerParentId;\n  var shownItemsArray = eventPayloadObj.eventInfo.web.webInteraction._mscom.containerInfo.shownItems;\n\n  //--Carousel Variables (carouselInfo)\n  var carousel = eventPayloadObj.eventInfo.carouselInfo.carcarousel;\n  var carouselID = eventPayloadObj.eventInfo.carouselInfo.carouselID;\n  var carouselTitle = eventPayloadObj.eventInfo.carouselInfo.carouselTitle;\n  var carouselItem = eventPayloadObj.eventInfo.carouselInfo.carouselItem;\n  var carouselItemTitle = eventPayloadObj.eventInfo.carouselInfo.carouselItemTitle;\n  var carouselItemImage = eventPayloadObj.eventInfo.carouselInfo.carouselItemImage;\n\n  //--Grid Variables (gridInfo)\n  var grid = eventPayloadObj.eventInfo.gridInfo.grid;\n  var gridID = eventPayloadObj.eventInfo.gridInfo.gridID;\n  var gridTitle = eventPayloadObj.eventInfo.gridInfo.gridTitle;\n  var gridTileItem = eventPayloadObj.eventInfo.gridInfo.gridTileItem;\n  var gridTileItemTitle = eventPayloadObj.eventInfo.gridInfo.gridTileItemTitle;\n  var gridTileItemImage = eventPayloadObj.eventInfo.gridInfo.gridTileItemImage;\n\n  //--Video Variables (videoInfo)\n  var videoID = eventPayloadObj.eventInfo.videoInfo.videoID;\n  var videoName = eventPayloadObj.eventInfo.videoInfo.videoName;\n  var videoPlatform = eventPayloadObj.eventInfo.videoInfo.videoPlatform;\n  var videoFileFormat = eventPayloadObj.eventInfo.videoInfo.videoFileFormat;\n  var videoLength = eventPayloadObj.eventInfo.videoInfo.videoLength;\n\n  //--News Article Variables (newsArticleInfo)\n  var newsArticleID = eventPayloadObj.eventInfo.newsArticleInfo.newsArticleID;\n  var newsArticleName = eventPayloadObj.eventInfo.newsArticleInfo.newsArticleName;\n  var newsArticleCategory = eventPayloadObj.eventInfo.newsArticleInfo.newsArticleCategory;\n\n  //--Product Information Variables (productInfo)\n  var productID = eventPayloadObj.eventInfo.productInfo.productID;\n  var productName = eventPayloadObj.eventInfo.productInfo.productName;\n  var productBrand = eventPayloadObj.eventInfo.productInfo.productBrand;\n  var productCategory = eventPayloadObj.eventInfo.productInfo.productCategory;\n  var productDescription = eventPayloadObj.eventInfo.productInfo.productDescription;\n  var productPrice = eventPayloadObj.eventInfo.productInfo.productPrice;\n\n  //--Reward Item Variables (rewardInfo)\n  var rewardID = eventPayloadObj.eventInfo.rewardInfo.rewardID;\n  var rewardName = eventPayloadObj.eventInfo.rewardInfo.rewardName;\n  var rewardCategory = eventPayloadObj.eventInfo.rewardInfo.rewardCategory;\n\n  //--Campaign Variables\n  var campaignID = eventPayloadObj.eventInfo.campaignInfo.campaignID;\n  var campaignName = eventPayloadObj.eventInfo.campaignInfo.campaignName;\n  var campaignType = eventPayloadObj.eventInfo.campaignInfo.campaignType;\n\n  //--Error Variables\n  var errorID = eventPayloadObj.eventInfo.errorInfo.errorID;\n  var errorMessage = eventPayloadObj.eventInfo.errorInfo.errorMessage;\n\n  //--Filter Variables\n  var filterID = eventPayloadObj.eventInfo.filterInfo.filterID;\n  var filterType = eventPayloadObj.eventInfo.filterInfo.filterType;\n  var filterValue = eventPayloadObj.eventInfo.filterInfo.filterValue;\n  var filterSelected = eventPayloadObj.eventInfo.filterInfo.filterSelected;\n\n  //--Search Variables\n  var searchTerm = eventPayloadObj.eventInfo.searchInfo.searchTerm;\n  var searchResultsTotal = eventPayloadObj.eventInfo.searchInfo.searchResultsTotal;\n  var searchResultsPageNumber = eventPayloadObj.eventInfo.searchInfo.searchResultsPageNumber;\n  var searchResultIndex = eventPayloadObj.eventInfo.searchInfo.searchResultIndex;\n\n  //--Shopping Cart Variables\n  var numberOfProductsInCart = eventPayloadObj.eventInfo.shoppingCart.numberOfProductsInCart;\n  var cartTotal = eventPayloadObj.eventInfo.shoppingCart.cartTotal;\n\n  //--Data Layer Array Variables (meant to pull from the data layer to capture what is there at the time any given event vs feed the data layer at the time of an event)\n  var userLikedBrandsArrayDL = [];\n  var errorsArrayDL = [];\n  var filtersArrayDL = [];\n  var searchesArrayDL = [];\n  var videosDisplayedArrayDL = [];\n  var productsDisplayedArrayDL = [];\n\n  //--Array Variables (meant to feed the data layer for certain events vs pull from dayalayer as with above DL variables)\n  var userLikedBrandsArray = [];\n  var productsInCartArray = [];\n\n  //Set elementAction, eventName\n  elementAction = "Click";\n  eventName = "Click";\n  eventDataName = "Click"\n  eventNameACDL = "cmp:click-enhanced";\n\n  //Set mouseButton\n  if (e.button != "undefined") {\n    mouseButton = e.button;\n  }\n\n  //Set KeyPress Details if passed in a_setClickPayload\n  if (keyPressFlagPassed !== undefined) {\n    enterKeyPressFlag = keyPressFlagPassed;\n  }\n  if (keyPressCodePassed !== undefined) {\n    keyPressCode = keyPressCodePassed;\n  }  \n\n  //Set actionType\n  if (mouseButton == 0) {\n    eventActionType = "CL"\n  }\n  if (mouseButton == 1) {\n    eventActionType = "CM"\n  }\n  if (mouseButton == 2) {\n    eventActionType = "CR"\n  }\n\n  //Set eventBehaviorCategory \n  if (elementAction == "Click") {\n    eventCategory = "Page Experience";\n    eventBehaviorCategory = "Page Experience";\n  }\n\n  //Set the destination URL\n  if (element.getAttribute("href") != null && element.getAttribute("href") != "") {\n    destinationUrl = element.getAttribute("href");\n  } else if (element.closest(\'a\') != null) {\n    if (element.closest(\'a\').getAttribute("href") != null) {\n      if (element.closest(\'a\').getAttribute("href") != "") {\n        destinationUrl = element.closest(\'a\').getAttribute("href");\n      }\n    }\n  } else if (element.getAttribute("data-switch-screen") != null) {\n    if (element.getAttribute("data-switch-screen") != null) {\n      destinationUrl = element.getAttribute("data-switch-screen");\n    }\n  } else if (element.getAttribute("onclick") != null && element.getAttribute("onclick") != "") {\n    destinationUrl = element.getAttribute("onclick");\n  } else if (element.closest(\'[data-automation-id="HeroPatternElement"]\') !== null) {\n    if (element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroCallToAction"]\') !== null) {\n      if (element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroCallToAction"]\').getAttribute(\'href\') !== null) {\n        destinationUrl = element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroCallToAction"]\').getAttribute(\'href\');\n      }\n    }\n  } else if (element.closest(\'.ms-DocumentCardTile\') !== null) {\n    if (element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardLocation\') !== null) {\n      if (element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardLocation\').getAttribute(\'href\') !== null) {\n        destinationUrl = element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardLocation\').getAttribute(\'href\');\n      }\n    }\n  }\n\n//Remove the "https://" or "http://" from destinationUrl if needed\n\nif (destinationUrl.indexOf("https://") !== -1){\n  destinationUrl = destinationUrl.split("https://")[1];\n} else if (destinationUrl.indexOf("http://") !== -1) {\n  destinationUrl = destinationUrl.split("http://")[1];\n} \n  //Set the general page location to body, footer, or header. This order counts since most header/footer elements are now nested in the body tag so it goes first an serves as a fallback\n  if ((element.closest("body") !== null)) {\n    pageLocation = "Body";\n  }\n  if ((element.closest("footer") !== null) //Element is within a <footer>\n    || (element.closest("#uhf-footer") !== null) //Element is within a container of class \'footer\'\n    || (element.closest(".universalfooter ") !== null)) {\n    pageLocation = "Footer";\n  }\n  if (((element.closest("header") !== null) //Element is within a <header>\n      || (element.closest(".c-uhfh") !== null) //Element is within a container of class \'header\'\n      )) {\n    pageLocation = "Header";\n  }\n\n  //Set form\n  //if (element.closest("form") !== null) {\n  if (element.closest("form") !== null) {\n    form = element.closest("form");\n\n    //Set formName\n    if (typeof form.getAttribute("name") !== undefined) { //The form has a name attribute\n      formName = form.getAttribute("name");\n    }\n\n    //Set formID\n    if (typeof form.getAttribute("id") !== undefined) { //The form has an id attribute\n      formID = form.getAttribute("id");\n    }\n    if (element.closest(".xForm") !== null) { //The form is an xForm (Wayin)\n      formID = element.closest(".xForm").getAttribute(\'data-ngx-id\');\n    }\n  }\n\n  //Set pageSection, formFriendlyName\n  //--Header\n  if (pageLocation == "Header") {\n    pageSection = "Top Navigation";\n    if (\n      (element.closest(".wf-menu") !== null) // mobile nav\n    ) {\n      pageSection = "Mobile Navigation";\n    }\n  }\n  if (element.closest("#headerRegion") !== null) {\n    pageSection = "Top Navigation";\n  }\n  if (element.closest(".f-sub-menu") !== null) {\n    pageSection = "Navigation Flyout"\n  }\n  if (element.closest(".secondary-nav ") !== null) {\n    pageSection = "Secondary Navigation";\n  }\n\n  // Top Nav > Category Titles\n  if(pageSection.indexOf("Top Navigation") !== -1){\n    if(element.closest(".uhf-menu-item") !== null){ \n      if (element.closest(".uhf-menu-item").querySelector(\'button\') !== null) {\n        pageSection += element.closest(".uhf-menu-item").querySelector(\'button\').innerText;\n      }\n      if (element.closest(".uhf-menu-item").querySelector(\'a\') !== null) {\n        pageSection += element.closest(".uhf-menu-item").querySelector(\'a\').innerText;\n      }\n    }\n  }\n\n  // Top Nav > Sub-Category Titles\n  if(pageSection.indexOf("Navigation Flyout") !== -1){\n    if(element.closest(".f-sub-menu") == null){\n      if (element.closest(".f-sub-menu").querySelector("span") !== null) {\n        pageSection += "_"+element.closest(".f-sub-menu").querySelector("span").innerText;  \n      } \n    }\n  }\n\n  //--Footer, Bottom Navigation\n  if (pageLocation == "Footer") {\n    if (\n      (element.closest("#footerArea") !== null) //Variant 1\n    ) {\n      pageSection = "Bottom Navigation";\n      if ((element.closest(".c-uhff-nav-row") !== null) //element is in the primary-links-container within the bottom navigation\n      ) {\n        pageSection += " Primary";\n      }\n    }\n  }\n\n  if ((element.closest(".c-uhfh-alert") !== null) //element is in the secondary-links-container within the bottom navigation\n  ) {\n    pageSection += "Alert";\n  }\n\n  //-- Economic Impact Map Page\n  if (element.closest(\'#economic-impact-map-app-body\') !== null) {\n    pageSection = \'Economic Impact Map\';\n    //--- Economic Impact Map\n    if (element.closest(\'div.mapWrapper\') !== null) {\n      pageSection = \'Economic Impact Map_Map\';\n    }\n\n    //--- State Selector\n    if (element.closest(\'section.state-selector\') !== null) {\n      pageSection = \'Economic Impact Map_State Selector\';\n    }\n\n    //---- State Selector Options\n    if (element.closest(\'.stateOptionDropdown\') !== null) {\n      pageSection = \'Economic Impact Map_State Selector_Options\';\n    }\n\n    //--- State Statistics\n    if (element.closest(\'section.state-stats\') !== null) {\n      pageSection = \'Economic Impact Map_State Statistics\';\n    }\n\n    //--- Economoic Impact Artciles\n    if (element.closest(\'section.articles\') !== null) {\n      pageSection = \'Economic Impact Map_Articles\';\n\n      //---- Article Category Titles\n      if (element.closest(\'#articles\') !== null) {\n        //----- Mobile\n        if (element.closest(\'div.mobile\') !== null) {\n          if (element.closest(\'div.mobile\').parentNode.querySelector(\'.category-headline\') !== null) {\n            pageSection += "_" + element.closest(\'div.mobile\').parentNode.querySelector(\'.category-headline\').innerText.trim();\n          }\n        }\n        //----- Desktop\n        if (element.closest(\'div.desktop\') !== null) {\n          if (element.closest(\'div.desktop\').parentNode.querySelector(\'.category-headline\') !== null) {\n            pageSection += "_" + element.closest(\'div.desktop\').parentNode.querySelector(\'.category-headline\').innerText.trim();\n          }\n        }\n\n        //----- Article Teasers\n        if (element.closest(\'.swiper-slide\') !== null) {\n          if (element.closest(\'.swiper-slide\').querySelector(\'.article-headline\') !== null) {\n            pageSection += "_" + element.closest(\'.swiper-slide\').querySelector(\'.article-headline\').innerText.trim();\n          }\n        }\n        //----- Swiper Navigation\n        if (element.closest(\'.swiper-pagination\') !== null) {\n          pageSection += "_Swiper Navigation";\n        }\n      }\n    }\n\n    //--- Bottom Section (Downloads and Share)\n    if (element.closest(\'section.bottom\') !== null) {\n      pageSection = \'Economic Impact Map_Bottom\';\n      //---- Downloads\n      if (element.closest(\'div.download-wrapper\') !== null) {\n        pageSection = \'Economic Impact Map_Bottom_Downloads\';\n      }\n      //---- Share\n      if (element.closest(\'div#share\') !== null) {\n        pageSection = \'Economic Impact Map_Bottom_Share\';\n      }\n    }\n  }\n\n  //-- Suggestions / Digital Assistant\n  if (element.closest(".tcccda1_container") !== null) {\n    pageSection = "Digital Assistant";\n    if (\n      (element.closest(".tcccda1_button") !== null) //Desktop\n      || (element.closest(".tcccda1_blob_button") !== null) //Mobile\n    ) {\n      pageSection += "_Button";\n    }\n  }\n\n  //--Social Links\n  if (\n    (element.closest(".socialfollow ") !== null)\n    || (element.closest(".wp-block-social-links") !== null)) {\n    pageSection = element.closest(\'.socialfollow\').querySelector(\'h2\').innerText \n    || element.closest(\'.cmp-teaserwp-block-social-links\').previousElementSibling.innerText;\n  }\n  if (element.closest(\'.social-share\') !== null) { //Legacy Social Share Bar\n    pageSection = element.closest(\'.social-share\').querySelector(\'.social-share__headline\').innerText;\n  }\n  \n  //--Tabbed Navigation\n  if (element.closest(".tabbed-navigation-container") !== null) {\n    pageSection = "Tabbed Navigation";\n  }\n\n    //Check if the closest div with the id container- contains title, if yes, use that; if not, check if the next closest container id has title \n  if (element.closest(\'div[id*="container-"]\') !== null)  {\n    /*if (element.closest(\'div[id*="container-"]> .title\').querySelector(\'.cmp-title__text\')!== null) {\n      pageSectionID = element.closest(\'div[id*="container-"]> .title\').getAttribute("id");\n      if (element.closest(\'div[id*="container-"]> .title\').querySelector(\'.cmp-title__text\') !== null) {\n        pageSection = element.closest(\'div[id*="container-"]> .title\').querySelector(\'.cmp-title__text\').innerText.trim();\n      }*/\n      var teaserContainer = element.closest(\'div[id*="container-"]\');\n      if (teaserContainer.querySelector(\'.title\') !== null) {\n        //set pageSection to title value\n        if (\n          (teaserContainer.querySelector(\'.title .cmp-title__text:not(#related-content-title .cmp-title__text)\') !== null) &&\n          (teaserContainer.querySelector(\'.title .cmp-title__text:not(#related-content-title .cmp-title__text)\') != \'undefined\')\n        ) {\n          pageSectionID = teaserContainer.getAttribute("id");\n          pageSection = teaserContainer.querySelector(\'.title .cmp-title__text\').innerText.trim();\n        }\n      } else if (teaserContainer.parentNode.closest(\'div[id*="container-"]\') !== null) {\n          var outerContainer = teaserContainer.parentNode.closest(\'div[id*="container-"]\');\n          if (outerContainer.querySelector(\'.title\') !== null) {    \n            //set pageSection to title value\n            if (\n              (outerContainer.querySelector(\'.title .cmp-title__text:not(#related-content-title .cmp-title__text)\') !== null) &&\n              (outerContainer.querySelector(\'.title .cmp-title__text:not(#related-content-title .cmp-title__text)\') != \'undefined\')\n            ) {\n              pageSectionID = outerContainer.getAttribute("id");\n              pageSection = outerContainer.querySelector(\'.title .cmp-title__text\').innerText.trim();\n            }\n          } \n        }   \n      if (element.closest(\'.cmp-teaser\') !== null) {\n        if (\n          (element.closest(\'.cmp-teaser\').querySelector(\'.cmp-teaser__title\') !== null) &&\n          (element.closest(\'.cmp-teaser\').querySelector(\'.cmp-teaser__title\') != \'undefined\')\n        ) {\n          pageSectionID = element.closest(\'.cmp-teaser\').getAttribute("id");\n          if ( \n            //(pageSection == null) ||\n            //(pageSection ==\'undefined\') ||\n            (pageSection ==\'Unknown pageSection\')\n          ) { \n            pageSection = element.closest(\'.cmp-teaser\').querySelector(\'.cmp-teaser__title\').innerText.trim();\n          } else if (\n            //(pageSection !== null) &&\n            //(pageSection !==\'undefined\') &&\n            (pageSection !==\'Unknown pageSection\')\n          ) {\n            pageSection += "_" + element.closest(\'.cmp-teaser\').querySelector(\'.cmp-teaser__title\').innerText.trim();\n          } \n        } \n      }\n  }  \n\n  //-- Filters\n  if (element.closest(".filter") !== null) {\n    pageSection = "Filter Controls";\n  }\n    // -- Brands page \n    if (\n      (element.closest(\'.brands-list li.cmp-tabs__tab\') !== null)\n    ) {\n      if (element.closest(\'.brands-list li.cmp-tabs__tab\').getAttribute("id") != \'undefined\') {\n        pageSectionID = element.closest(\'.brands-list li.cmp-tabs__tab\').getAttribute("id");\n      }\n      pageSection = "Filter Controls";\n    }\n\n    if (\n      (element.closest(\'.brands-list .dropdown-selector\') !== null)\n    ) {\n      if (element.closest(\'.brands-list .dropdown-selector\').getAttribute("id") != \'undefined\') {\n        pageSectionID = element.closest(\'.brands-list .dropdown-selector\').getAttribute("id");\n      }\n      pageSection = "Filter Controls";\n    }\n\n    // -- Media center page \n    if (\n      (element.closest(\'.options__input-wrapper\') !== null)\n    ) {\n      if (element.closest(\'.options__input-wrapper\').getAttribute("id") != \'undefined\') {\n        pageSectionID = element.closest(\'.options__input-wrapper\').getAttribute("id");\n      }\n      pageSection = "Filter Controls";\n    }\n\n    if (\n      (element.closest(\'.options__button\') !== null)\n    ) {\n      if (element.closest(\'.options__button\').getAttribute("id") != \'undefined\') {\n        pageSectionID = element.closest(\'.options__button\').getAttribute("id");\n      }\n      pageSection = "Filter Controls";\n    }\n\n  //--Recommendations\n  if (element.closest(".recommendations-container") !== null) {\n    pageSection = "Recommendations";\n  }\n\n  //--Related Content\n  if (element.closest("#related-content") !== null) {\n    pageSection = "Related Content";\n    if (element.closest(\'.content-card\') !== null) {\n      if (element.closest(\'*[id*="container-"]\') !== null) {\n        pageSectionID = element.closest(\'*[id*="container-"]\').getAttribute("id");\n      }\n      if (element.closest(\'.content-card\').querySelector(\'.cmp-teaser__description\') !== null) {\n        pageSection += "_" + element.closest(\'.content-card\').querySelector(\'.cmp-teaser__description\').innerText.trim();\n      }\n    }\n  }\n\n  //---Embedded Recommendations\n  if (\n    (element.closest(".embedded-recommendation") !== null)\n    || (element.closest(".embedded-promotion") !== null)\n  ) {\n    pageSection = "Embedded Recommendation";\n    if (element.closest("div.cmp-teaser[id*=\'teaser-embedded\']") !== null) {\n      pageSectionID = element.closest("div.cmp-teaser[id*=\'teaser-embedded\']").getAttribute("id");\n      if (element.closest("div.cmp-teaser[id*=\'teaser-embedded\']").querySelector(".cmp-teaser__title") !== null) {\n        pageSection += "_" + element.closest("div.cmp-teaser[id*=\'teaser-embedded\']").querySelector(".cmp-teaser__title").innerText.trim();\n      }\n    }\n  }\n\n  //--Page Sections\n  if (element.closest("section.normal-section") !== null) {\n    if (element.closest("section.normal-section").querySelector(".title-component") !== null) {\n      if (element.closest("section.normal-section").querySelector(".title-component").innerText !== null) {\n        pageSection = element.closest("section.normal-section").querySelector(".title-component").innerText.trim();\n      }\n    }\n  }\n  if (element.closest("section.full-section") !== null) {\n    if (element.closest("section.full-section").querySelector(\'.title-component\') !== null) {\n      if (element.closest(\'section.full-section\').querySelector(\'.title-component\').innerText !== null)\n        pageSection = element.closest(\'section.full-section\').querySelector(\'.title-component\').innerText.trim();\n    }\n  }\n  if (element.closest("#indicator") !== null) {\n    pageSection = "Page Section Indicator Container";\n  }\n\n  //--SharePoint Home Page\n  if (element.closest("#SPHomeHeader") !== null) {\n    pageSection = "SharePoint Home Page Header";\n  }\n  if (element.closest("#homePageView") !== null) {\n    pageSection = "SharePoint Home Page View Content";\n    if (element.closest("#leftPane") !== null) {\n      pageSection += "_Left";\n    }\n    if (element.closest("#homeContentView") !== null) {\n      pageSection += "_Main";\n    }\n  }\n\n  //--Canvas Section Titles\n  if (element.closest(".CanvasSection") !== null) {\n    if (element.closest(".CanvasSection").querySelector(".ControlZone h2") !== null) {\n      if (element.closest(".CanvasSection").querySelector(".ControlZone h2").innerText !== null) {\n        if (element.closest(".CanvasSection").querySelector(".ControlZone h2").innerText !== "") {\n          pageSection = element.closest(".CanvasSection").querySelector(".ControlZone h2").innerText.trim();\n        }\n      }\n    } else if (element.closest(".CanvasSection").querySelector(".ControlZone h3") !== null) {\n      if (element.closest(".CanvasSection").querySelector(".ControlZone h3").innerText !== null) {\n        if (element.closest(".CanvasSection").querySelector(".ControlZone h3").innerText !== "") {\n          pageSection = element.closest(".CanvasSection").querySelector(".ControlZone h3").innerText.trim();\n        }\n      }\n    } else if (element.closest(".CanvasSection").querySelector(".ControlZone h4") !== null) {\n      if (element.closest(".CanvasSection").querySelector(".ControlZone h4").innerText !== null) {\n        if (element.closest(".CanvasSection").querySelector(".ControlZone h4").innerText !== "") {\n          pageSection = element.closest(".CanvasSection").querySelector(".ControlZone h4").innerText.trim();\n        }\n      }\n    } else if (element.closest(".CanvasSection").querySelector(".ControlZone span[class*=\'title_\']") !== null) { // Homepage Variation\n      if (element.closest(".CanvasSection").querySelector(".ControlZone span[class*=\'title_\']").innerText !== null) {\n        if (element.closest(".CanvasSection").querySelector(".ControlZone span[class*=\'title_\']").innerText !== "") {\n          pageSection = element.closest(".CanvasSection").querySelector(".ControlZone span[class*=\'title_\']").innerText.trim();\n        }\n      }\n    } else if (element.closest(".CanvasSection").querySelector("*[data-automation-id] span[role=heading]") !== null) { // Homepage Variation\n      if (element.closest(".CanvasSection").querySelector("*[data-automation-id] span[role=heading]").innerText !== null) {\n        if (element.closest(".CanvasSection").querySelector("*[data-automation-id] span[role=heading]").innerText !== "") {\n          pageSection = element.closest(".CanvasSection").querySelector("*[data-automation-id] span[role=heading]").innerText.trim();\n        }\n      }\n    }\n  }\n\n  //Work-arounds for section titles with IDs\n  if (element.closest(".CanvasSection") !== null) {\n    if (element.closest(".CanvasSection").querySelector("#how-we-can-assist-you") !== null) {\n      if (element.closest(".CanvasSection").querySelector("#how-we-can-assist-you").innerText !== null) {\n        pageSection = element.closest(".CanvasSection").querySelector("#how-we-can-assist-you").innerText.trim();\n      }\n    }\n  }\n\n  //--ms-Fabric Section Titles\n  /*\n  if (\n    (pageLocation != "Header")\n    && (pageLocation != "Footer")  \n  ) {\n    if(element.closest(".ms-Fabric") !== null) {\n        if(element.closest(".ms-Fabric").querySelector("*[data-automation-id] span[role=heading]") !== null) {\n            if(element.closest(".ms-Fabric").querySelector("*[data-automation-id] span[role=heading]").innerText !== null) {\n                pageSection = element.closest(".ms-Fabric").querySelector("*[data-automation-id] span[role=heading]").innerText.trim();\n            }\n        }\n    }\n  }\n  */\n\n  //--WebPart Header Titles\n  if (element.closest(\'*[data-viewport-id*="WebPart"]\') !== null) {\n    if (element.closest(\'*[data-viewport-id*="WebPart"]\').querySelector(\'[data-automation-id="webPartHeader"] *[role="heading"]\') !== null) {\n      if (element.closest(\'*[data-viewport-id*="WebPart"]\').querySelector(\'[data-automation-id="webPartHeader"] *[role="heading"]\').innerText !== null) {\n        pageSection = element.closest(\'*[data-viewport-id*="WebPart"]\').querySelector(\'[data-automation-id="webPartHeader"] *[role="heading"]\').innerText.trim() + " Web Part";\n      }\n    }\n  }\n\n  //--Immersive Profiles\n  if (element.closest(\'[data-log-region="ImmersiveProfile"]\') !== null) {\n    if (element.closest(\'[data-log-region="ImmersiveProfile"]\').querySelector(\'[data-log-name="Title"]\') !== null) {\n      if (element.closest(\'[data-log-region="ImmersiveProfile"]\').querySelector(\'[data-log-name="Title"]\').innerText !== null) {\n        pageSection = "Profile_" + element.closest(\'[data-log-region="ImmersiveProfile"]\').querySelector(\'[data-log-name="Title"]\').innerText.trim();\n      }\n    }\n  }\n\n  //--CardFeed Titles\n  if (element.closest(".CardFeed") !== null) {\n    if (element.closest(".CardFeed").querySelector(\'.CardFeed-header *[role="heading"]\') !== null) {\n      if (element.closest(".CardFeed").querySelector(\'.CardFeed-header *[role="heading"]\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(".CardFeed").querySelector(\'.CardFeed-header *[role="heading"]\').innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(".CardFeed").querySelector(\'.CardFeed-header *[role="heading"]\').innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--Card List Titles\n  if (element.closest(\'.ms-DocumentCardTile\') !== null) {\n    if (element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardTitle\') !== null) {\n      if (element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardTitle\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardTitle\').innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'.ms-DocumentCardTile\').querySelector(\'.ms-DocumentCardTitle\').innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--Hero Card Titles\n  if (element.closest(\'[data-automation-id="HeroPatternElement"]\') !== null) {\n    if (element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroTitle"]\') !== null) {\n      if (element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroTitle"]\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroTitle"]\').innerText.trim() + " Hero Card";\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'[data-automation-id="HeroPatternElement"]\').querySelector(\'[data-automation-id="HeroTitle"]\').innerText.trim() + " Hero Card";\n        }\n      }\n    }\n  }\n\n  //--Item Scope List Titles\n  if (element.closest(\'.od-ItemsScopeList-content\') !== null) {\n    if (element.closest(\'.od-ItemsScopeList-content\').querySelector(\'.od-ItemContent-title\') !== null) {\n      if (element.closest(\'.od-ItemsScopeList-content\').querySelector(\'.od-ItemContent-title\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'.od-ItemsScopeList-content\').querySelector(\'.od-ItemContent-title\').innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'.od-ItemsScopeList-content\').querySelector(\'.od-ItemContent-title\').innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--List View Titles\n  if (element.closest(".ListView") !== null) {\n    if (element.closest(".ListView").querySelector(\'*[role="heading"]\') !== null) {\n      if (element.closest(".ListView").querySelector(\'*[role="heading"]\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(".ListView").querySelector(\'*[role="heading"]\').innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(".ListView").querySelector(\'*[role="heading"]\').innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--List Item Titles\n  if (element.closest("div[role=\'listitem\']") !== null) {\n    if (element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']") !== null) {\n      if (element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']").innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']").innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']").innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--Quick Look Containers\n  if (element.closest(\'[class*="quickLookContainer"]\') !== null) {\n    if (element.closest(\'[class*="quickLookContainer"]\').querySelector(\'[class*="quickLookPageBarTitle"]\') !== null) {\n      if (element.closest(\'[class*="quickLookContainer"]\').querySelector(\'[class*="quickLookPageBarTitle"]\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'[class*="quickLookContainer"]\').querySelector(\'[class*="quickLookPageBarTitle"]\').innerText.trim() + " Quick Look";\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'[class*="quickLookContainer"]\').querySelector(\'[class*="quickLookPageBarTitle"]\').innerText.trim() + " Quick Look";\n        }\n      }\n    }\n  }\n\n  //--Bookmark Item Cards\n  if (element.closest(".BookmarkItemCard") !== null) {\n    if (element.closest(".BookmarkItemCard").querySelector(".BookmarkItemCard-details-title-text") !== null) {\n      if (element.closest(".BookmarkItemCard").querySelector(".BookmarkItemCard-details-title-text").innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(".BookmarkItemCard").querySelector(".BookmarkItemCard-details-title-text").innerText.trim();\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(".BookmarkItemCard").querySelector(".BookmarkItemCard-details-title-text").innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--Adaptive Cards\n  if (element.closest(\'.ac-adaptiveCard\') !== null) {\n    if (element.closest(\'.ac-adaptiveCard\').querySelector(\'.ac-textBlock-title\') !== null) {\n      if (element.closest(\'.ac-adaptiveCard\').querySelector(\'.ac-textBlock-title\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'.ac-adaptiveCard\').querySelector(\'.ac-textBlock-title\').innerText.trim() + " Card";\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'.ac-adaptiveCard\').querySelector(\'.ac-textBlock-title\').innerText.trim() + " Card";\n        }\n      }\n    }\n  }\n\n  //--Image Frames\n  if (element.closest(\'[data-automation-id="imageFrame"]\') !== null) {\n    if (element.closest(\'[data-automation-id="imageFrame"]\').querySelector(\'[data-automation-id="overlay-text-wrapper"]\') !== null) {\n      if (element.closest(\'[data-automation-id="imageFrame"]\').querySelector(\'[data-automation-id="overlay-text-wrapper"]\').innerText !== null) {\n        if (pageSection == "Unknown pageSection") {\n          pageSection = element.closest(\'[data-automation-id="imageFrame"]\').querySelector(\'[data-automation-id="overlay-text-wrapper"]\').innerText.trim() + " Image Frame";\n        } else if (pageSection !== "Unknown pageSection") {\n          pageSection += "_" + element.closest(\'[data-automation-id="imageFrame"]\').querySelector(\'[data-automation-id="overlay-text-wrapper"]\').innerText.trim() + " Image Frame";\n        }\n      }\n    }\n  }\n\n  //--reactour Tutorial Container\n  if (element.closest(\'.reactour-portal\') !== null) {\n    pageSection = "Tutorial Modal"\n    if (element.closest(\'.reactour-portal\').querySelector(\'h2\') !== null) {\n      if (element.closest(\'.reactour-portal\').querySelector(\'h2\').innerText !== null) {\n        pageSection += "_" + element.closest(\'.reactour-portal\').querySelector(\'h2\').innerText.trim();\n      }\n    }\n  }\n\n  //--Filter Controls\n  if (element.closest(\'[class*="filterResultsPanel"]\') !== null) {\n    pageSection = "Filter Control Panel";\n  }\n\n  //--Videos\n  if (element.closest(".youtube") !== null) { //Link is in a youtube container\n    if (element.closest(".youtube > div.yt") !== null) { //The youtube container has a div.yt immediately within it\n      if (typeof (element.closest(".youtube > div.yt").getAttribute("id")) != "undefined") { //The immeditately nested div has an id attribute\n        videoID = element.closest(".youtube > div.yt").getAttribute("id");\n      }\n    }\n    pageSection = videoID;\n  }\n\n  //--Grids\n  //Set grid, gridID, gridTitle\n  //AEM Grids Variant 1\n  if (element.closest(".aem-Grid") !== null) {\n    grid = element.closest(".aem-Grid");\n    //gridID code needed\n    /*\n      if (grid.querySelector(".title") !== null) {\n        if (grid.querySelector(".title").innerText !== null) {\n          gridTitle = grid.querySelector(".title").innerText.trim();\n        }\n        pageSection = gridTitle;\n      }\n      if (element.closest(".content-area") !== null) {\n        if (element.closest(".content-area").querySelector(".title") !== null) {\n          if (element.closest(".content-area").querySelector(".title").innerText !== null) {\n            gridTitle = element.closest(".content-area").querySelector(".title").innerText.trim();\n          }\n          pageSection = gridTitle;\n        }\n        if (typeof(element.closest(".content-area").querySelector(".title h1").first()) != "undefined") {\n          if (element.closest(".content-area").querySelector(".title h1").first().innerText !== null) {\n            gridTitle = element.closest(".content-area").querySelector(".title h1").first().innerText.trim();\n          }\n          pageSection = gridTitle;      \n        }\n      }\n    */\n    //Set gridTileItem, gridTileItemTitle, gridTileItemImage\n    if (element.closest(".card") !== null) { //Element is in a card (within a grid)\n      gridTileItem = element.closest(".card");\n      if (gridTileItem.querySelector(".card-title") !== null) {\n        if (gridTileItemTitle = gridTileItem.querySelector(".card-title").innerText !== null) {\n          gridTileItemTitle = gridTileItem.querySelector(".card-title").innerText.trim();\n        }\n      }\n      if (gridTileItem.querySelector("picture > img") !== null) {\n        if (typeof (gridTileItem.querySelector("picture > img").getAttribute("src")) != "undefined") {\n          gridTileItemImage = gridTileItem.querySelector("picture > img").getAttribute("src").toLowerCase().split("/").pop(); //getting image source then splitting url and getting filename with file extension\n        }\n      }\n      if (gridTitle !== "Unknown gridTitle") {\n        pageSection = gridTitle + "_" + gridTileItemTitle;\n      } else {\n        pageSection = gridTileItemTitle;\n      }\n    }\n  }\n  //AEM Grids Variant 2\n  if (element.closest(".responsivegrid.section") !== null) { //Element is in a section (variant 2)\n    grid = element.closest(".responsivegrid.section");\n    //gridID code needed\n    //Set gridTileItem, gridTileItemTitle, gridTileItemImage\n    if (element.closest(".responsivegrid.section.nutritionfacts__grid") !== null) { //Element is in a nutrition facts section\n      if (element.closest(".aem-Grid") !== null) { //Element is in a aem-Grid (within a within a nutrition facts grid)\n        gridTileItem = element.closest(".aem-Grid");\n        if (gridTileItem.querySelector("div.bt-nutrition__main > h2") !== null) {\n          if (gridTileItem.querySelector("div.bt-nutrition__main > h2").innerText !== null) {\n            gridTileItemTitle = gridTileItem.querySelector("div.bt-nutrition__main > h2").innerText.trim();\n          }\n        }\n        pageSection = gridTileItemTitle + " Nutrition Facts";\n      }\n    }\n    if (element.closest(".card") !== null) { //Element is in a card (within a grid)\n      gridTileItem = element.closest(".card");\n      if (gridTileItem.querySelector(".title") !== null) {\n        if (gridTileItem.querySelector(".title").innerText !== null) {\n          gridTileItemTitle = gridTileItem.querySelector(".title").innerText.trim();\n        }\n      }\n      if (gridTileItem.querySelector("picture > img") !== null) {\n        if (typeof (gridTileItem.querySelector("picture > img").getAttribute("src")) != "undefined") {\n          gridTileItemImage = gridTileItem.querySelector("picture > img").getAttribute("src").toLowerCase().split("/").pop(); //getting image source then splitting url and getting filename with file extension\n        }\n      }\n      pageSection = gridTileItemTitle;\n    }\n  }\n  //---Content Wall Grids\n  //content-wall__container, content-wall__title\n  if (element.closest(".content-wall__container") !== null) {\n    grid = element.closest(".content-wall__container");\n    if (element.closest(".content-wall__container").querySelector(".content-wall__title") !== null) {\n      if (element.closest(".content-wall__container").querySelector(".content-wall__title").innerText !== null) {\n        gridTitle = element.closest(".content-wall__container").querySelector(".content-wall__title").innerText.trim();\n      }\n    }\n    //gridID code needed\n    //section.content-wall__wrapper, content-wall__sort-order, content-wall__filter-by, content-wall__content\n    //Set gridTileItem, gridTileItemTitle, gridTileItemImage\n    //grid-item, list-item__wrapper\n    //-list-item__link\n    //--list-item\n    //--list-item__media\n    //--list-item__content-wrapper\n    //---list-item__headline\n    //---list-item__subheadline\n    if (element.closest(".list-item__wrapper") !== null) {\n      gridTileItem = element.closest(".list-item__wrapper");\n      if (gridTileItem.querySelector(".list-item__headline") !== null) {\n        if (gridTileItem.querySelector(".list-item__headline").innerText !== null) {\n          gridTileItemTitle = gridTileItem.querySelector(".list-item__headline").innerText.trim();\n        }\n      }\n      pageSection = gridTileItemTitle\n      if (gridTitle != "Unknown gridTitle") {\n        pageSection = gridTitle + "_" + gridTileItemTitle;\n      }\n    }\n    if (element.closest(".card") !== null) { //Element is in a card (within a grid)\n      gridTileItem = element.closest(".card");\n      if (gridTileItem.querySelector(".title") !== null) {\n        if (gridTileItem.querySelector(".title").innerText !== null) {\n          gridTileItemTitle = gridTileItem.querySelector(".title").innerText.trim();\n        }\n      }\n      if (gridTileItem.querySelector("img.list-item__media") !== null) {\n        if (typeof (gridTileItem.querySelector("img.list-item__media").getAttribute("src")) != "undefined") {\n          gridTileItemImage = gridTileItem.querySelector("img.list-item__media").getAttribute("src").toLowerCase().split("/").pop(); //getting image source then splitting url and getting filename with file extension\n        }\n      }\n      pageSection = gridTileItemTitle;\n      if (gridTitle != "Unknown gridTitle") {\n        pageSection = gridTitle + "_" + gridTileItemTitle;\n      }\n    }\n  }\n\n  //personItem Grids\n  if (element.closest(".personItem") !== null) {\n    gridTileItem = element.closest(".personItem");\n    if (element.closest(".root") !== null) {\n      if (element.closest(".root").querySelector(".tabbed-navigation-container") !== null) {\n        if (element.closest(".root").querySelector(".tabbed-navigation-container li.active") !== null) {\n          if (element.closest(".root").querySelector(".tabbed-navigation-container li.active").innerText !== null) {\n            gridTitle = element.closest(".root").querySelector(".tabbed-navigation-container li.active").innerText.trim();\n          }\n        }\n      }\n    }\n    if (gridTileItem.querySelector(".personName") !== null) {\n      if (gridTileItem.querySelector(".personName").innerText !== null) {\n        gridTileItemTitle = gridTileItem.querySelector(".personName").innerText.trim();\n      }\n    }\n    pageSection = gridTileItemTitle;\n    if (gridTitle != "Unknown gridTitle") {\n      pageSection = gridTitle + "_" + gridTileItemTitle;\n    }\n  }\n\n  //c-lists\n  if (element.closest(".c-list") !== null) {\n    if (element.closest(".c-list").querySelector(".c-list__title") !== null) {\n      if (element.closest(".c-list").querySelector(".c-list__title").innerText !== null) {\n        pageSection = element.closest(".c-list").querySelector(".c-list__title").innerText.trim();\n      }\n    }\n  }\n\n  //Search Input Containers\n  //--Asset Search Input\n  if (element.closest(\'[data-viewport-id*="WebPart.AssetSearchWebPart"]\') !== null) {\n    pageSection = "Asset Search Input";\n  }\n  //Search Result Filter Containers\n  //--Asset Search Result Filters\n  if (element.closest(\'[data-viewport-id*="WebPart.AssetFilterWebPart"]\') !== null) {\n    pageSection = "Asset Search Result Filters";\n  }\n\n  //Search Results\n  if (element.closest(".searchResult__result-container") !== null) {\n    if (element.closest(".searchResult__result-container").querySelector(".searchResult__title") !== null) {\n      if (element.closest(".searchResult__result-container").querySelector(".searchResult__title").innerText) {\n        pageSection = element.closest(".searchResult__result-container").querySelector(".searchResult__title").innerText.trim();\n      }\n    }\n  }\n  if (element.closest(".search__result-list") !== null) {\n      pageSection = "Search Results";\n      if (element.closest(".search__list-item") !== null) {\n        if (element.closest(".search__list-item").querySelector(".single-item__header") !== null) {\n          if (element.closest(".search__list-item").querySelector(".single-item__header").innerText) {\n            pageSection += "_"+element.closest(".search__list-item").querySelector(".single-item__header").innerText;\n          }\n        }\n      }\n  }\n\n  //Search UX (Groups)\n  if (\n    (element.closest("div.ms-searchux") !== null)\n  ) {\n    pageSection = "Search UX";\n    if (element.closest("main") !== null) {\n      //Search UX Results\n      if (element.closest("article") !== null) {\n        if (element.closest("article").querySelector("header") !== null) {\n          if (element.closest("article").querySelector("header").innerText !== null) {\n            //Result Title (non-bookmark)\n            pageSection += "_Result_" + element.closest("article").querySelector("header").innerText.trim();\n          }\n        }\n      }\n      //Search UX Bookmark Results\n      if (element.closest(".ms-search-bookmarkContent") !== null) {\n        if (element.closest(".ms-search-bookmarkContent").querySelector(".ms-search-bookmarkTitle") !== null) {\n          if (element.closest(".ms-search-bookmarkContent").querySelector(".ms-search-bookmarkTitle").innerText !== null) {\n            //Result Title (bookmark)\n            pageSection += "_Bookmark Result_" + element.closest(".ms-search-bookmarkContent").querySelector(".ms-search-bookmarkTitle").innerText.trim();\n          }\n        }\n      }\n    }\n    //Result Type Tabs Toolbar\n    if (element.closest(\'div[role="toolbar"]\') !== null) {\n      pageSection += "_Result Type Tabs";\n    }\n    //Pagination Controls\n    if (element.closest(\'nav[aria-label="Result pages"]\') !== null) {\n      pageSection += "_Pagination Controls";\n    }\n  }\n\n  //--Asset Search Results Web Parts\n  if (\n    (element.closest(\'[data-viewport-id*="WebPart.AssetSearchResultWebPart"]\') !== null)\n  ) {\n    pageSection = "Asset Search";\n    //Asset Search Results\n    if (element.closest("tr[data-search-result-index]") !== null) {\n      if (element.closest("tr[data-search-result-index]").querySelector("td.header") !== null) {\n        if (element.closest("tr[data-search-result-index]").querySelector("td.header").firstChild.innerText !== null) {\n          //Result Title (non-bookmark)\n          pageSection += "_Result_" + element.closest("tr[data-search-result-index]").querySelector("td.header").firstChild.innerText.trim();\n        }\n      }\n    }\n    //Pagination Controls\n    if (element.closest(".pagination-container") !== null) {\n      pageSection += "_Pagination Controls";\n    }\n  }\n\n\n  //--Carousels\n  //Set carousel, carouselID, carouselTitle\n  if (\n    (element.closest(".carousel") !== null) //Element is in a carousel (Variant 1)\n    || (element.closest(".carousels") !== null) //Element is in a carousel (Variant 2)\n    || (element.closest(\'[class*="carousel"]\') !== null) //Element is in a carousel (Variant 3)\n  ) {\n    if (element.closest(".carousel") !== null) {//(Variant 1)\n      carousel = element.closest(".carousel");\n    }\n    if (element.closest(".carousels") !== null) {//(Variant 2)\n      carousel = element.closest(".carousels");\n    }\n    if (element.closest(\'[class*="carousel"]\') !== null) {//(Variant 3)\n      carousel = element.closest(\'[class*="carousel"]\');\n    }\n    if (element.closest(".carousel > div") !== null) {\n      if (typeof (element.closest(".carousel > div").getAttribute("id")) != "undefined") {\n        carouselID = element.closest(".carousel > div").getAttribute("id");\n      }\n    }\n    if (element.closest(\'[data-automation-id*="Carousel"]\') !== null) {\n      carouselID = element.closest(\'[data-automation-id*="Carousel"]\').getAttribute("data-automation-id");\n      pageSection = carouselID;\n    }\n    if (element.closest(\'.cmp-carousel\') !== null) {\n      if (element.closest(\'.cmp-carousel\').getAttribute(\'id\') !== null) {\n        carouselID = element.closest(\'.cmp-carousel\').getAttribute(\'id\');\n        pageSectionID = carouselID;\n      } \n      if(\n        (element.closest(\'div[id*="carousel-"].cmp-carousel\') !== null)\n      ) {\n        if (element.closest(\'div[id*="carousel-"].cmp-carousel\').querySelector(".cmp-teaser__title")!== null) {\n            pageSection = element.closest(\'div[id*="carousel-"].cmp-carousel\').querySelector(".cmp-teaser__title").innerText.trim();\n        } else if (carouselID !== \'Unknown carouselID\') {\n          pageSection = carouselID;\n        }\n      }\n    }\n\n    //Set carouselItem, carouselItemTitle, carouselItemImage\n    if (element.closest(".card") !== null) { //Element is in a card (within a carousel)\n      carouselItem = element.closest(".card");\n      if (carouselItem.querySelector(".title") !== null) {\n        if (carouselItem.querySelector(".title").innerText !== null) {\n          carouselItemTitle = carouselItem.querySelector(".title").innerText.trim();\n        }\n      }\n      if (carouselItem.querySelector("picture > img") !== null) {\n        if (typeof (carouselItem.querySelector("picture > img").getAttribute("src")) != "undefined") {\n          carouselItemImage = carouselItem.querySelector("picture > img").getAttribute("src").toLowerCase().split("/").pop(); //getting image source then splitting url and getting filename with file extension\n        }\n      }\n      pageSection = carouselTitle + "_" + carouselItemTitle;\n    }\n    if (element.closest(\'.carouselItemWrapper\') !== null) {\n      carouselItem = element.closest(\'.carouselItemWrapper\');\n      if (carouselItem.querySelector(\'[data-automation-id="newsItemTitle"]\') !== null) {\n        if (carouselItem.querySelector(\'[data-automation-id="newsItemTitle"]\').innerText !== null) {\n          carouselItemTitle = carouselItem.querySelector(\'[data-automation-id="newsItemTitle"]\').innerText;\n          if (pageSection == "Unknown pageSection") {\n            pageSection = carouselItemTitle;\n          } else if (pageSection !== "Unknown pageSection") {\n            pageSection += "_" + carouselItemTitle + " Slide";\n          }\n        }\n      }\n    }\n    if (element.closest(\'.cmp-carousel__item\') !== null) {\n      carouselItem = element.closest(\'.cmp-carousel__item\');\n      if (carouselItem.getAttribute(\'id\') !== null) {\n        var carouselItemId = carouselItem.getAttribute(\'id\');\n        if (carouselItem.getAttribute(\'data-cmp-data-layer\') !== null) {\n          var carouselItemCmpDataLayer = JSON.parse(carouselItem.getAttribute(\'data-cmp-data-layer\'));\n          //console.log(carouselItemCmpDataLayer[carouselItemId]);\n          if (carouselItemCmpDataLayer[carouselItemId] != \'undefined\' && carouselItemCmpDataLayer[carouselItemId] != undefined) {\n            if (carouselItemCmpDataLayer[carouselItemId]["dc:title"] != undefined) {\n              carouselItemTitle = carouselItemCmpDataLayer[carouselItemId]["dc:title"];\n              if (pageSection == "Unknown pageSection") {\n                pageSection = carouselItemTitle;\n              } else if (pageSection !== "Unknown pageSection") {\n                pageSection += "_" + carouselItemTitle + " Slide";\n              }\n            }\n          } else {\n            pageSection = carouselItemId;\n          }\n        }\n      }\n      if (carouselItem.querySelector("picture > img") !== null) {\n        if (typeof (carouselItem.querySelector("picture > img").getAttribute("src")) != "undefined") {\n          carouselItemImage = carouselItem.querySelector("picture > img").getAttribute("src").toLowerCase().split("/").pop(); //getting image source then splitting url and getting filename with file extension\n        }\n      }\n    }\n    //Set pageSection, elementDataSlideTo for carousel indicators\n    if (element.closest(".slick-dots") !== null) { //Element is within the slick dots for a slick slider carousel\n      pageSection = carouselTitle + "_Navigation Dots";\n      if (typeof (element.closest("button[aria-label]")) != "undefined") { //Element is a button with an aria-label attribute\n        elementDataSlideTo = element.closest("button[aria-label]").getAttribute("button[aria-label]");\n      }\n    }\n    if (element.closest(\'[data-automation-id*="carouselDot"]\') !== null) {\n      elementDataSlideTo = element.closest(\'[data-automation-id*="carouselDot"]\').getAttribute(\'data-automation-id\');\n    }\n    //Set pageSection, elementDataSlideTo for carousel indicators\n    if (element.closest(".slick-dots") !== null) { //Element is within the slick dots for a slick slider carousel\n      if (carouselID !== "Unknown carouselID") { //If the carousel has an ID, set the page section to use the id\n        pageSection = carouselID + "_Navigation Dots";\n      }\n      if (carouselTitle !== "Unknown carouselTitle") { //If the carousel has a title, set the page section to use that instead of the id\n        pageSection = carouselTitle + "_Navigation Dots";\n      }\n      if (typeof (element.closest("button[aria-label]")) != "undefined") { //Element is a button with an aria-label attribute\n        elementDataSlideTo = element.closest("button").getAttribute("aria-label");\n      }\n    }\n    if (element.closest(\'[data-automation-id="SP-carouselDotsContainer"]\') !== null) {\n      if (carouselID !== "Unknown carouselID") {\n        pageSection = carouselID + "_Navigation Dots";\n      }\n    }\n    if (element.closest(\'.swiper-pagination-bullet\') !== null) {\n      if (carouselID !== "Unknown carouselID") { //If the carousel has an ID, set the page section to use the id\n        pageSection = carouselID + "_Navigation Dots";\n      }\n      if (carouselTitle !== "Unknown carouselTitle") { //If the carousel has a title, set the page section to use that instead of the id\n        pageSection = carouselTitle + "_Navigation Dots";\n      }\n      if (element.closest(\'.swiper-pagination-bullet\').getAttribute("aria-label") !== null) {\n        elementDataSlideTo = element.closest("button").getAttribute("aria-label");\n      }\n    }\n  }\n\n  if (element.closest(".primary-carousel") !== null) { //Link is in the primary-carousel \n    pageSection = "Primary Carousel";\n  }\n  if (element.closest(".onboarding-modal-container") !== null) { //Link is in Onboarding Modal (this clause must come after primary-carousel)\n    pageSection = "Onboarding Carousel";\n  }\n  if (element.closest(".news-carousel") !== null) { //Link is in news-carousel (Legacy)\n    pageSection = "News Carousel";\n  }\n\n  //--Forms\n\n  //---Search\n  if (\n    (element.closest(".searchBar") !== null)\n    || (element.closest(".searchFilter") !== null)\n    || (element.closest("form.search-panel__input-wrapper") !== null)\n    || (element.closest("form.search__form") !== null)\n  ) {\n    formFriendlyName = "Search Form";\n    pageSection = formFriendlyName;\n    if (element.closest(".searchFilter__container") !== null) {\n      pageSection += "_Filter";\n    }\n  }\n\n  //---Search UX Form\n  if (element.closest(".ms-suiteux-search-box") !== null) {\n    formFriendlyName = "Search UX Form";\n    pageSection = formFriendlyName;\n    if (element.closest("ul") !== null) { // Suggestion Link\n      if (element.closest("ul").getAttribute("id") !== null) {\n        pageSection = pageSection + "_Suggestion_" + element.closest("ul").getAttribute("id"); // Concat form with suggestion ID\n      }\n    }\n  }\n\n  if (element.closest(".gigya-register-form") !== null) { //Element is on the Registration Form\n    formFriendlyName = "Registration Form";\n    pageSection = formFriendlyName;\n  }\n  if (\n    (element.closest("#registrationForm") !== null) //The element is in the page section containing the register form\n    && (element.closest("#formHeading") !== null) //The element is in the formHeading\n  ) {\n    pageSection = "Registration Form Heading";\n  }\n  if (element.closest(".gigya-login-form") !== null) { //Element is on the Login Form\n    formFriendlyName = "Login Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".age-checker-form") !== null) { //Element is on the Age Checker Form\n    formFriendlyName = "Age Checker Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".gigya-reset-password-form") !== null) { //Element is on the Reset Password Form\n    formFriendlyName = "Reset Password Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".change-password-container") !== null) { //Element is in the Change Password Form\n    formFriendlyName = "Change Password Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".personal-info-detail-container") !== null) { //Element is within the Contact Info form within the Personal Details page (no actual <form>)\n    formFriendlyName = "Contact Info Form";\n    pageSection = formFriendlyName;\n  }\n  //Note: Address Form is on the page in an iFrame\n  if (element.closest(".address-form") !== null) { //Element is on the Address Form\n    formFriendlyName = "Address Form";\n    pageSection = formFriendlyName;\n  }\n  if (\n    (element.closest(\'form\') !== null) //The elment is within a form\n    && (element.closest(\'form\').getAttribute(\'name\') == "zip-entry") //Element is on the zipcode entry form\n  ) {\n    formFriendlyName = "Zip Code Entry Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".ps-product-selector") !== null) { //Element is on the Product Selector "Form" (PriceSpider, not wrapped in <form>)\n    formFriendlyName = "Product Selector \'Form\'";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(".product-locator-modal-container") !== null) { //Element is within the product locator modal container\n    formFriendlyName = "Zip Code Entry Form";\n    pageSection = "Zip Code Entry Modal"; //Specifying the modal here instead of giving value of formFriendlyName\n  }\n  if (element.closest(".product-locator-form") !== null) { //Element is on the Product Locator Form\n    formFriendlyName = "Product Locator Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest("#gigya-email-code-verification-screen") !== null) { //Element is on the Email Code Verification Screen\n    pageSection = "Email Code Verification Screen";\n    if (element.closest(".gigya-otp-update-form") !== null) { //Element is on the Email Code Verification Form\n      formFriendlyName = "Email Code Verification Form";\n      pageSection = formFriendlyName;\n    }\n  }\n  if (element.closest(".order-form-wrapper") !== null) { //Element is on the Reward Order Details Form\n    formFriendlyName = "Order Details Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest(\'#pointsCodeSection\') !== null) { //Element is on the Code Redemption Form\n    formFriendlyName = "Code Redemption Form"\n    pageSection = "Code Redemption Form";\n  }\n  if (element.closest(\'.campaign-form\') !== null) { //Element is on the Email List Sign-up form (aka campaign-form)\n    formFriendlyName = "Email List Signup Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest("#xCampaignForm") !== null) { //Element is on a Wayin form (aka xCampaignForm)\n    if (formID == "form_1579190265441") { //Team Ultra Application Form\n      formFriendlyName = "Application Form (" + formID + ")";\n      pageSection = formFriendlyName;\n    } else {\n      formFriendlyName = "Wayin Form (" + formID + ")";\n      pageSection = formFriendlyName;\n    }\n  }\n  if (element.closest("form[name=\'myForm\']") !== null) { //Element is on the Contact Us form\n    formFriendlyName = "Contact Us Form";\n    pageSection = formFriendlyName;\n  }\n  if (element.closest("form[name=\'contactUsForm\']") !== null) { //Element is on the Contact Us form\n    formFriendlyName = "Contact Us Form";\n    pageSection = formFriendlyName;\n  }\n  //Set formDetails\n  //formDetails = siteBrand + " " + formFriendlyName;\n  formDetails = siteBrandDE + " " + formFriendlyName;\n\n  //Set formName\n  //Should this be set to the \'name\' attribute of the form or just another formDetails?\n  //formName = formDetails;\n  if (element.closest("form") !== null) {\n    if (element.closest("form").getAttribute("name") !== null) {\n      formName = element.closest("form").getAttribute("name");\n    }\n  }\n\n  //Appended _disclaimer to pageSection for items in the form-disclaimer\n  if (element.closest(\'.form-disclaimer\') !== null) {\n    pageSection += "_Disclaimer";\n  }\n\n  //Set accordionText and concatenate to pageSection\n  if (element.closest(".collapse-header") !== null) {\n    if (element.closest(".collapse-header").innerText !== null) {\n      accordionText = element.closest(".collapse-header").innerText.trim();\n      if (pageSection == "Unknown pageSection") {\n        pageSection = accordionText;\n      } else {\n        pageSection += "_" + accordionText;\n      }\n    }\n  }\n  if (element.closest(".panel") !== null) {\n    if (element.closest(".panel").querySelector(".panel-title") !== null) {\n      if (element.closest(".panel").querySelector(".panel-title").innerText !== null) {\n        accordionText = element.closest(".panel").querySelector(".panel-title").innerText.trim();\n        if (pageSection == "Unknown pageSection") {\n          pageSection = accordionText;\n        } else {\n          pageSection += "_" + accordionText;\n        }\n      }\n    }\n  }\n  if (element.closest(".title-collapsible") !== null) {\n    if (element.closest(".title-collapsible").querySelector("h2") !== null) {\n      if (element.closest(".title-collapsible").querySelector("h2").innerText !== null) {\n        accordionText = element.closest(".title-collapsible").querySelector("h2").innerText.trim();\n        if (pageSection == "Unknown pageSection") {\n          pageSection = accordionText;\n        } else {\n          pageSection += "_" + accordionText;\n        }\n      }\n    }\n  }\n  if (element.closest(\'[data-sp-feature-tag*="AccordionWebPart"]\') !== null) {\n    if (element.closest(\'[class*="section_"]\') !== null) {\n      if (element.closest(\'[class*="section_"]\').querySelector(\'[class*="sectionTitle_"]\') !== null) {\n        if (element.closest(\'[class*="section_"]\').querySelector(\'[class*="sectionTitle_"]\').innerText !== null) {\n          accordionText = element.closest(\'[class*="section_"]\').querySelector(\'[class*="sectionTitle_"]\').innerText.trim();\n          if (pageSection == "Unknown pageSection") {\n            pageSection = accordionText;\n          } else {\n            pageSection += "_" + accordionText;\n          }\n        }\n      }\n    }\n  }\n  if (element.closest(".cmp-accordion__item") !== null) {\n    if (element.closest(".cmp-accordion__item").querySelector(".cmp-accordion__header") !== null) {\n      accordionText = element.closest(".cmp-accordion__item").querySelector(".cmp-accordion__header").innerText.trim();\n      if (pageSection == "Unknown pageSection") {\n        pageSection = accordionText;\n      } else {\n        pageSection += "_" + accordionText;\n      }\n    }\n    if (element.closest(".cmp-accordion__item[data-cmp-expanded]")) {\n      expansionAction = "Collapse"\n      expansionState = "Expanded"\n    } else {\n      expansionAction = "Expand"\n      expansionState = "Collapsed"\n    }\n    destinationUrl = expansionAction+"_"+accordionText;\n    if (element.closest(".cmp-accordion__item[id]") !== null) {\n      elementID = element.closest(".cmp-accordion__item[id]").getAttribute("id");\n    }\n  }\n  //Append _Submenu to dataSection value\n  //--Variant 1\n  if (element.closest(\'.mh-mn-submenu\') !== null) {\n    if (element.closest(\'.mh-mn-menu-item\') !== null) {\n      if (element.closest(\'.mh-mn-menu-item\').querySelector(\'.mh-mn-menu-link\') !== null) {\n        submenuParent = element.closest(\'.mh-mn-menu-item\');\n        submenuParentLink = submenuParent.querySelector(\'.mh-mn-menu-link\');\n        if (submenuParent.querySelector(\'.mh-mn-menu-link\').innerText !== null) {\n          submenuParentLinkText = submenuParent.querySelector(\'.mh-mn-menu-link\').innerText.trim();\n        }\n      }\n    }\n    pageSection += "_" + submenuParentLinkText + " Submenu";\n  }\n  //--Variant 2\n  if (element.closest(".bt-nav__menu__item__submenu") !== null) {\n    if (element.closest(".bt-nav__menu__item") !== null) {\n      if (element.closest(".bt-nav__menu__item").querySelector("a") !== null) {\n        submenuParent = element.closest(".bt-nav__menu__item");\n        submenuParentLink = submenuParent.querySelector("a")[0];\n        if (submenuParentLink.closest(".bt-nav__menu__item__submenu") == null) { // The submenuParentLink (the first link in the submenuParent) is not within a submenu item\n          if (submenuParentLink.innerText !== null) {\n            submenuParentLinkText = submenuParentLink.innerText.trim();\n          }\n        }\n      }\n    }\n    pageSection += "_" + submenuParentLinkText + " Submenu"\n  }\n\n  //Append carouselTitle to pageSection where it makes sense\n  if (element.closest(\'.ecommerce-scroll-buttons-container\') !== null) { // Shop products carousel\n    pageSection = carouselTitle + " Products Carousel";\n  }\n\n  //Append News Item Title to pageSection where it makes sense (excluding Carousels)\n  if (element.closest(\'[data-automation-id*="Carousel"]\') == null) {\n    if (element.closest("*[data-automation-id=newsItem]") !== null) {\n      if (element.closest("*[data-automation-id=newsItem]").querySelector("*[data-automation-id=newsItemTitle]") !== null) {\n        if (element.closest("*[data-automation-id=newsItem]").querySelector("*[data-automation-id=newsItemTitle]").innerText !== null) {\n          pageSection += "_" + element.closest("*[data-automation-id=newsItem]").querySelector("*[data-automation-id=newsItemTitle]").innerText.trim();\n        }\n      }\n    }\n  }\n\n  //Set containerInfo vairables\n  if (element.closest(\'.container\') !== null) {\n    if (element.closest(\'.container\').getAttribute("id") !== null) {\n      containerID = element.closest(\'.container\').getAttribute("id");\n    }\n  }\n\n  //Set elementID if it has one then set elementPath for ACDL event using elementID\n  if (element.getAttribute(\'id\') !== null) { //Element has an id attribute\n    elementID = element.getAttribute(\'id\');\n  }\n\n  //Set cmpDataLayer object if there is one and set componentId. Use componentId for elementIDif needed\n  if (element.closest(\'*[data-cmp-data-layer]\')) {\n    cmpDataLayer = element.closest("*[data-cmp-data-layer]").getAttribute("data-cmp-data-layer");\n    var cmpDataLayerParsed = JSON.parse(cmpDataLayer);\n    if (element.closest("*[data-cmp-data-layer]").getAttribute("id") !== null) {\n      var componentID = element.closest("*[data-cmp-data-layer]").getAttribute("id");\n      if (elementID == "Unknown elementID") {\n        elementID = componentID;\n      }\n    }\n  }\n\n  //Set data-bi and/or data-m attributes if they exist.\n\n  // Set data-m attributes into an object if they exist\n  if (element.closest(\'*[data-m]\')) {\n    var dataList = JSON.parse(element.closest("*[data-m]").getAttribute("data-m"));\n  }\n\n  //--data-bi-ecn (contentNameEn)\n  if (element.closest(\'*[data-bi-ecn]\')) {\n    elementContentNameEn = element.closest("*[data-bi-ecn]").getAttribute("data-bi-ecn");\n  }\n\n  //--data-bi-ehn (headerNameEn)\n  if (element.closest(\'*[data-bi-ehn]\')) {\n    sectionHeaderNameEn = element.closest("*[data-bi-ehn]").getAttribute("data-bi-ehn");\n  }\n\n  //--data-bi-tags (cmpTags)\n  if (element.closest(\'*[data-bi-tags]\')) {\n    cmpTags = element.closest("*[data-bi-tags]").getAttribute("data-bi-tags");\n  }\n\n  //--tabindex\n\n  //--data-bi-hn (headerName)\n  if (element.closest(\'*[data-bi-hn]\')) {\n    seactionHeaderName = element.closest("*[data-bi-hn]").getAttribute("data-bi-hn");\n  }\n\n  //--data-bi-bhvr (eventBehaviorID)\n  if (element.closest(\'*[data-bi-bhvr]\')) {\n    eventBehaviorID = element.closest("*[data-bi-bhvr]").getAttribute("data-bi-bhvr");\n  }\n\n  //--data-bi-cn (contentName)\n  if (element.closest(\'*[data-bi-cn]\')) {\n    elementContentName = element.closest("*[data-bi-cn]").getAttribute("data-bi-cn");\n  }\n  //--data-m.cN (conentName) - Override with data-m if available.\n  if (dataList) {\n    if (dataList.cN) {\n      elementContentName = dataList.cN;\n    }\n  }\n\n  //--data-bi-compnm (componentName)\n  if (element.closest(\'*[data-bi-compnm]\')) {\n    componentName = element.closest("*[data-bi-compnm]").getAttribute("data-bi-compnm");\n  }\n\n  //--data-bi-an (pageArea)\n  if (element.closest(\'*[data-bi-an]\')) {\n    sectionPageArea = element.closest("*[data-bi-an]").getAttribute("data-bi-an");\n  }\n  //--data-m.aN (pageArea) - Override with data-m if available.\n  if (dataList) {\n    if (dataList.aN) {\n      sectionPageArea = dataList.aN;\n    }\n  }\n  //--data-oc\n  if (element.closest(\'*[data-oc]\')) {\n    //dataOc = element.closest("*[data-oc]").getAttribute("data-oc");\n  }\n\n  //--data-bi-ct (contentType)\n  if (element.closest(\'*[data-bi-ct]\')) {\n    elementContentType = element.closest("*[data-bi-ct]").getAttribute("data-bi-ct");\n  }\n  //--data-m.cT (conentType) - Override with data-m if available.\n  if (dataList) {\n    if (dataList.cT) {\n      elementContentType = dataList.cT;\n    }\n  }\n\n  //--data-bi-sn (slotNumber)\n  if (element.closest(\'*[data-bi-sn]\')) {\n    containerSlotNumber = element.closest("*[data-bi-sn]").getAttribute("data-bi-sn");\n  }\n  //--data-m.sN (slotNumber) - Override with data-m if available.\n  if (dataList) {\n    if (dataList.sN) {\n      containerSlotNumber = dataList.sN;\n    }\n  }\n\n  //--aria-label\n\n  //--data-bi-view (templateName)\n  if (element.closest(\'*[data-bi-view]\')) {\n    //templateName = element.closest("*[data-bi-view]").getAttribute("data-bi-view"); //Note: We were using an override previously having templateName be either from view or tn with priority to tn when available. Switched to sending them separately.\n    componentView = element.closest("*[data-bi-view]").getAttribute("data-bi-view");\n  }\n\n  //--data-bi-tn (templateName) - Not always available.\n  if (element.closest(\'*[data-bi-tn]\')) {\n    templateName = element.closest("*[data-bi-tn]").getAttribute("data-bi-tn");\n  }\n\n  //if (elementId == "Unknown elementID") {\n  //???\n  //} else {\n    elementPath = "component." + elementID;\n  //}\n\n  /*\n  //Set elementAnalyticsID if it has one\n  if (\n    (element.closest("*[data-analytics-click]") !== null)\n    || (element.closest(".mh-mn-language-item") !== null)\n  ) {\n    if (element.closest("*[data-analytics-click]") !== null) {\n      dataAnalyticsClick = JSON.parse(element.closest("*[data-analytics-click]").getAttribute("data-analytics-click").replace(/\\\\/g, \'\\\\\\\\\')); //Parse JSON for the data-analytics-click attribute with regex to handle escape characters\n    }\n    if (element.closest(".mh-mn-language-item") !== null) {\n      if (element.closest(".mh-mn-language-item").querySelector("*[data-analytics-click]") !== null) {\n        dataAnalyticsClick = JSON.parse(element.closest(".mh-mn-language-item").querySelector("*[data-analytics-click]").getAttribute("data-analytics-click").replace(/\\\\/g, \'\\\\\\\\\')); //Parse JSON for the data-analytics-click attribute with regex to handle escape characters\n      }\n    }\n    if (dataAnalyticsClick.analyticsId !== null) {\n      elementAnalyticsID = dataAnalyticsClick.analyticsId;\n    }\n    //  elementAnalyticsID = ("000000" + parseInt(elementAnalyticsID, 10)).slice(-6); //Used to add zero padding, but will cause errors for non-numeric ID values. This code is being moved to the dev side so they always provide a zero padded value\n    if (elementAnalyticsID === "") {\n      elementAnalyticsID = eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementAnalyticsID; //If the id is blank, reset to the default value\n    }\n  }\n*/\n  //Set elementCTA, nodeType, elementName, elementDataDisplayName, elementDataNamePlaceholder, elementVal, elementText (if the element has those attributes) then set elementType\n\n  //Set nodeType\n  if (!element.getAttribute("type")) { //Input does not have a type attribute\n    nodeType = element.nodeName;\n  } else if (element.getAttribute("type")) { //Input has a type attribute\n    nodeType = element.nodeName + "_" + element.getAttribute("type");\n  } else { //Fallback to just "Input"\n    nodeType = "Input";\n  }\n\n  //Set elementType\n  elementType = nodeType;\n\n  //--Links\n  ///--Text Links\n  if (typeof element.innerText != "undefined") {\n    if (element.innerText !== null && element.innerText !== "") { //If the element has text\n      elementType = "Text Link";\n      elementText = element.innerText.trim();\n      elementCTA = elementText;\n    }\n  }\n\n  //--Workaround for \'Powered by OneTrust\' logo link in Privacy Preference Center\n  if (element.closest("#optanon-popup-bottom-logo") !== null) {\n    elementType = "Text Link";\n    elementText = "Powered by OneTrust"\n    elementCTA = elementText;\n  }\n\n\n  ///--Image Links\n  if (element.nodeName == "IMG") { //If element is an image\n    elementType = "Image";\n    if (destinationUrl != "Unknown destinationUrl") {\n      elementType = "Image Link";\n    }\n    if (element.getAttribute("src") !== null) {\n      imageFilePath = element.getAttribute("src").toLowerCase(); //getting image source \n      imageFilename = imageFilePath.split("/").pop(); //splitting url and getting filename with file extension\n      if (imageFilename.indexOf("?") !== -1) {\n        imageFilename = imageFilename.split("?")[0];\n        if (imageFilename === "content") {\n          imageFilename = "image (no filename in src)";\n        }\n      }\n      elementCTA = imageFilename;\n    }\n    if (element.getAttribute("srcset") !== null) {\n      imageFilePath = element.getAttribute("srcset").toLowerCase(); //getting image source \n      imageFilename = imageFilePath.split("/").pop(); //splitting url and getting filename with file extension\n      imageFilename = imageFilename.replace(" 1512w", ""); //remove the excess copy from the last item in the srcset\n      if (imageFilename.indexOf("?") !== -1) {\n        imageFilename = imageFilename.split("?")[0];\n        if (imageFilename === "content") {\n          imageFilename = "image (no filename in src)";\n        }\n      }\n      elementCTA = imageFilename;\n    }\n    if (element.closest("picture") !== null) {\n      if (element.closest("picture").querySelector("source[srcset]") !== null) {\n        if (element.closest("picture").querySelector("source[srcset]").getAttribute("srcset") != null) {\n          imageFilePath = element.closest("picture").querySelector("source[srcset]").getAttribute("srcset").toLowerCase(); //getting image source \n          imageFilename = imageFilePath.split("/").pop(); //splitting url and getting filename with file extension\n          if (imageFilename.indexOf("?") !== -1) {\n            imageFilename = imageFilename.split("?")[0];\n            if (imageFilename === "content") {\n              imageFilename = "image (no filename in src)";\n            }\n          }\n          elementCTA = imageFilename;\n        }\n      }\n    }\n    //Note that img src should take priority over source srcset when available\n    if (element.closest("picture") !== null) {\n      if (element.closest("picture").querySelector("img[src]") !== null) {\n        if (element.closest("picture").querySelector("img[src]").getAttribute("src") != null) {\n          imageFilePath = element.closest("picture").querySelector("img[src]").getAttribute("src").toLowerCase(); //getting image source \n          if (imageFilePath.indexOf("/width") !== -1) {\n            imageFilePath = imageFilePath.split("/").splice(-1);\n          }\n          imageFilename = imageFilePath.split("/").pop(); //splitting url and getting filename with file extension\n          if (imageFilename.indexOf("?") !== -1) {\n            imageFilename = imageFilename.split("?")[0];\n            if (imageFilename === "content") {\n              imageFilename = "image (no filename in src)";\n            }\n          }\n          elementCTA = imageFilename;\n        }\n      }\n    }\n    if (element.getAttribute("data-sp-originalimgsrc") !== null) {\n      imageFilePath = element.getAttribute("data-sp-originalimgsrc").toLowerCase(); //getting image source \n      imageFilename = imageFilePath.split("/").pop(); //splitting url and getting filename with file extension\n      if (imageFilename.indexOf("?") !== -1) {\n        imageFilename = imageFilename.split("?")[0];\n        if (imageFilename === "content") {\n          imageFilename = "image (no filename in src)";\n        }\n      }\n      elementCTA = imageFilename;\n    }\n  }\n\n  /*\n  //The code below can be used to grab the alt or title text of an image to use instead of the image filename\n  if ((element.prop("tagName") == "IMG") && (element.getAttribute("alt"))) { //If element is an image and has a alt attribute\n    imageAlt = element.getAttribute("alt"); //getting image alt attribute\n    elementCTA = imageAlt;\n  } else if ((element.prop("tagName") == "IMG") && (element.getAttribute("title"))) { //If element is an image and has a title attribute\n    imageTitle = element.getAttribute("title"); //getting image title attribute\n    elementCTA = imageTitle;\n  } else if ((element.prop("tagName") == "IMG") && (!element.getAttribute("title")) && (!element.getAttribute("alt"))) { //If element is an image and does not have a title attribute\n    imageTitle = "No Title";\n    imageAlt = "No Alt";\n    elementCTA = imageFilename;\n  }\n  */\n\n  if (element.nodeName == "svg") { //If element is an svg\n    elementType = "Image Link";\n    if (element.classList.contains("fa-toggle-off")) {\n      svgDetails = "fa-toggle-off";\n    }\n    if (element.classList.contains("fa-toggle-on")) {\n      svgDetails = "fa-toggle-on";\n    }\n    elementCTA = svgDetails;\n  } else if (element.closest("svg") !== null) {\n    elementType = "Image Link";\n    if (element.closest(\'.sc-bxivhb\') !== null) {\n      svgDetails = "X (Path)";\n    }\n    elementCTA = svgDetails;\n  }\n  if (element.nodeName == "path") { //If element is a path\n    elementType = "Image Link";\n  }\n\n  /*\n  //--elementCTA Economic Impact Map State Paths\n  if (element.closest(\'path.state\') !== null) {\n    if (element.closest(\'path.state\').getAttribute(\'id\') !== null && element.closest(\'path.state\').getAttribute(\'id\') !== \'\') {\n        elementCTA = \'State Shape_\'+element.closest(\'path.state\').getAttribute(\'id\');\n    }\n  }\n  */\n\n  //---Work-around for O365 svg tenant logo\n  if (element.closest("#O365_MainLink_TenantLogo") !== null) {\n    elementCTA = "Coca-Cola Logo SVG";\n  }\n\n  //---Company Mobile Nav Open and Close Buttons \n  if (element.closest(\'button#company-mobile-menu\') !== null) { \n    if (element.closest(".show-company-nav") == null) {\n    elementType = "Icon Link";\n    elementIcon = "company-mobile-menu (Sandwich Icon)";\n    elementCTA = elementIcon;\n  } else {\n    elementType = "Icon Link";\n    elementIcon = "company-mobile-menu (X Icon)";\n    elementCTA = elementIcon;\n  }\n}\n\n  //--Brand Page Caret Open and Close Buttons \n  if (element.closest(\'.dropdown-selector\') !== null) {\n    if (element.closest(\'.dropdown-selector\').classList.contains(\'expanded\')) { \n      elementType = "Icon Link";\n      elementIcon = "Brand-menu (Caret Close Icon)";\n      elementCTA = "Filter Close";\n    } else {\n      elementType = "Icon Link";\n      elementIcon = "Brand-menu (Caret Open Icon)";\n      elementCTA = "Filter Open";\n    }\n  }\n\n  //--Media Center Caret Open and Close Buttons \n  if (element.closest(\'.options__button\') !== null) {\n    if (element.closest(\'.options__button\').classList.contains(\'options__button--active\')) { \n      elementType = "Icon Link";\n      elementIcon = "Media-Center-menu (Caret Close Icon)";\n      elementCTA = "Filter Close";\n    } else {\n      elementType = "Icon Link";\n      elementIcon = "Media-Center-menu (Caret Open Icon)";\n      elementCTA = "Filter Open";\n    }\n  }\n\n  //--Button Links\n  if (\n    (element.nodeName == "BUTTON") //element is a button\n    || (element.closest("button") !== null) //element is nested in a button\n  ) {\n    elementType = "Button";\n  }\n\n  //--Text Link (btn) Links\n  if (\n    (element.classList.contains("btn")) //Element has class of btn (aka is text link with class btn)\n    && (element.nodeName !== "BUTTON") //Element is not a button node\n  ) {\n    elementType = "Text Link (btn)";\n  }\n  if (\n    (element.classList.contains("xBluePill")) //Element has class of btn (aka is text link with class btn)\n    && (element.nodeName !== "BUTTON") //Element is not a button node\n  ) {\n    elementType = "Text Link (btn)";\n  }\n  if (\n    (element.classList.contains("xPagingButton")) //Element has class of xPagingButton (aka is text link with class xPagingButton)\n    && (element.nodeName !== "BUTTON") //Element is not a button node\n  ) {\n    elementType = "Text Link (btn)";\n  }\n  if (element.nodeName == "LI") { //If element is a list item (Li)\n    elementType = "Li Link";\n  }\n  if (element.nodeName == "UL") { //If element is an unordered list (ul)\n    elementType = "Ul Link";\n  }\n\n  //--Icon Links\n  if (\n    (element.closest(".icon-menu") !== null) //If element is a menu icon loaded via css\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "icon-menu (Sandwich Icon)";\n    elementCTA = elementIcon;\n  }\n  if (\n    (element.closest(".icon--menu") !== null) //Shop Beer Gear (Shopify)\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "icon--menu (Sandwich Icon)";\n    elementCTA = elementIcon;\n  }\n  if (\n    (element.querySelector(".close-new") !== null) //If element is a close icon loaded via css\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "close-new (X Icon)";\n    elementCTA = elementIcon;\n  }\n  if (\n    (element.closest(".icon-close") !== null) //If element is a close icon loaded via css\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "icon-close (X Icon)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".css-182") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Close Icon (X)";\n    elementCTA = elementIcon;\n  }\n  if (\n    (element.closest(".optanon-alert-box-close") !== null) //If element is a close icon loaded via css\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "optanon-alert-box-close (X Icon)";\n    elementCTA = elementIcon;\n  }\n  if (\n    (element.closest(".icon--close") !== null) // (Shopify)\n    || (element.classList.contains("mfp-close")) // (Shopify) - Close mobile flyout menu button\n  ) {\n    elementType = "Icon Link";\n    elementIcon = "icon--close (X Icon)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-search") !== null) { //If element is a search icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-search (Magnifying Glass)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--search") !== null) { //If element is a search icon loaded via css (Shopify)\n    elementType = "Icon Link";\n    elementIcon = "icon--search (Magnifying Glass)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".search") !== null) { //If element is a search icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "search (Magnifying Glass)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".searchBar__button") !== null) { //If element is a search icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "searchBar__button (Magnifying Glass)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".search-panel__search-button") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "search-panel__search-button (Magnifying Glass)";\n      elementCTA = elementIcon;\n  }\n  if (element.closest("#search-button") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "search-button (Magnifying Glass)";\n      elementCTA = elementIcon;\n  }\n  if (element.closest(".country") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "country (Globe)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".world-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "world-new (Globe)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".share-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "share-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-share") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon-share";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".share_icon") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "share_icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".preview") !== null) { //If element is a eye/preview icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-eye";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".download-new") !== null) { //If element is a download icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-download-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-arrow-up") !== null) { //If element is an up icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-arrow-up";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-arrow-down") !== null) { //If element is a down icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-arrow-down";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-arrow-left") !== null) { //If element is an left icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-arrow-left";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-arrow-right") !== null) { //If element is a right icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-arrow-right";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".chevron-83") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Arrow (Chevron)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".cmp-accordion__icon") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "cmp-accordion__icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".flickity-button-icon") !== null) { //If element is a flickity-button-icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "flickity-button-icon (Arrow)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".arrow-icon") !== null) { //If element is a arrow-icon icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "arrow-icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".angle-left-circle") !== null) { //If element is an angle left circle icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-angle-left-circle";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".angle-right-circle") !== null) { //If element is a angle right circle icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-angle-right-circle";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-play") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon-play";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--play") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--play";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_play") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_play";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".hubPlayIcon") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "hubPlayIcon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".hub2PlayIcon") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "hub2PlayIcon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="link"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Link Icon (Chain Links)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Edit"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Edit Icon (Pencil)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".root-175") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Ellipses Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-242") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Yammer Logo Icon (Grey)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="FavoriteStar"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Favorites Star Icon (Unfilled)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="FavoriteStarFill"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Favorites Star Icon (Filled)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="GlobalNavButton"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Sandwich Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="userwarning"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "User Warning Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'.bookmarkListItemIcon\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Bookmark Banner Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'.SearchBoxExitButton\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Arrow Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'.submitSearchButton-252\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "submitSearchButton-252 (Magnifying Glass)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronleft"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Chevronleft"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronLeft"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronLeft"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronLeftMed"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Left Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronright"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Right Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Chevronright"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Right Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronRight"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Right Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronRightMed"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Right Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronRight"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Right Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronup"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Up Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Chevronup"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Up Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronUp"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Up Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronUpMed"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Up Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronUp"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Up Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevrondown"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Chevrondown"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronDown"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ChevronDownMed"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="chevronDown"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Down Chevron";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="More"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Ellipses Icon (More)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="ClearFilter"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Funnel X Icon (Clear Filters)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Filter"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Funnel Icon (Filter)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Cancel"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "X Icon (Cancel)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Clear"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "X Icon (Clear)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Message"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Message Box Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Flag"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Flag Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Like"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Thumbs Up Icon (Like)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(\'[data-icon-name="Dislike"]\') !== null) {\n    elementType = "Icon Link";\n    elementIcon = "Thumbs Down Icon (Dislike)";\n    elementCTA = elementIcon;\n  }\n\n  //---SP Icons\n  if (element.closest("#sp-appBar-link-sites") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "SP Sites Icon (Globe)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("#sp-appBar-link-news") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "SP News Icon (Newspaper)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("#sp-appBar-link-files") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "SP Files Icon (Page)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("#sp-appBar-link-create") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "SP Create Icon (Circle Plus)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("#sp-appBar-link-remove") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "SP Remove Icon (Circle Minus)";\n    elementCTA = elementIcon;\n  }\n\n  //---MS Office App Logos\n  if (element.closest(".ms-Icon--WaffleOffice365") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Waffle Icon (Dots Grid)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--Help") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Help Icon (Question Mark)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--Settings") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Settings Icon (Gear)";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--OutlookLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Outlook Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--OneDrive") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS OneDrive Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--WordLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Word Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--PowerPointLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS PowerPoint Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--ExcelLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Excel Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--OneNoteLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS OneNote Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--SharepointLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS SharePoint Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--TeamsLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Teams Logo Icon";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".ms-Icon--YammerLogo") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "MS Yammer Logo Icon";\n    elementCTA = elementIcon;\n  }\n\n  //---Social Icons Variant 1\n  if (element.closest(".icon-facebook") !== null) {//If element is a facebook icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-facebook";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-twitter") !== null) {//If element is a twitter icon loaded via css\n    elementType = "Icon Link";\n    elementText = "icon-twitter";\n    elementIcon = elementIcon;\n  }\n  if (element.closest(".icon-youtube") !== null) {//If element is a youtube icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-youtube";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-instagram") !== null) {//If element is a instagram icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-instagram";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-pinterest") !== null) {//If element is a pinterest icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-pinterest";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon-linkedin") !== null) {//If element is a linkedIn icon loaded via css\n    elementType = "Icon Link";\n    elementIcon = "icon-linkedIn";\n    elementCTA = elementIcon;\n  }\n\n  //---Social Icons Variant 2_A\n  if (element.closest(".icon--facebook") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--facebook";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--twitter") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--twitter";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--instagram") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--instagram";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--pinterest") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--pinterest";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--linkedin") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--linkedin";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon--youtube") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--youtube";\n    elementCTA = elementIcon;\n  }\n\n  //---Social Icons Variant 2_B\n  if (element.closest("*[class*=\'icon--facebook\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--facebook";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("*[class*=\'icon--twitter\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--twitter";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("*[class*=\'icon--instagram\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--instagram";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("*[class*=\'icon--pinterest\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--pinterest";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("*[class*=\'icon--linkedin\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--linkedin";\n    elementCTA = elementIcon;\n  }\n  if (element.closest("*[class*=\'icon--youtube\']") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon--youtube";\n    elementCTA = elementIcon;\n  }\n\n  //---Social Icons Variant 3\n  if (element.closest(".at-icon-facebook") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "at-icon-facebook";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".at-icon-twitter") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "at-icon-twitter";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".at-icon-instagram") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "at-icon-instagram";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".at-icon-pinterest") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "at-icon-pinterest";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".at-icon-linkedin") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "at-icon-linkedin";\n    elementCTA = elementIcon;\n  }\n  //---Social Icons Variant 4\n  if (element.closest(".icon_facebook") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_facebook";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_twitter") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_twitter";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_instagram") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_instagram";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_pinterest") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_pinterest";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_linkedin") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_linkedin";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".icon_youtube") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "icon_youtube";\n    elementCTA = elementIcon;\n  }\n\n  //---Social Icons Variant 5\n  if (element.closest(".facebook-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "facebook-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".twitter-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "twitter-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".instagram-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "instagram-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".pinterest-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "pinterest-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".linkedin-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "linkedin-new";\n    elementCTA = elementIcon;\n  }\n  if (element.closest(".youtube-new") !== null) {\n    elementType = "Icon Link";\n    elementIcon = "youtube-new";\n    elementCTA = elementIcon;\n  }\n\n  //Work-arounds for when icon is within <a>\n  if (\n    (elementCTA == "undefined") ||\n    (elementCTA === undefined) ||\n    (elementCTA === null) ||\n    (elementCTA == "") ||\n    (elementCTA == "Unknown elementCTA")\n  ) {\n    if (element.querySelector(".search") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "search (Magnifying Glass)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".searchBar__button") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "searchBar__button (Magnifying Glass)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".search-panel__search-button") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "search-panel__search-button (Magnifying Glass)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector("#search-button") !== null) { //If element is a search icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "search-button (Magnifying Glass)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".close-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "close-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".country") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "country (Globe)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".world-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "world-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".share-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "share-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".icon-share") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "icon-share";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".share_icon") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "share_icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".icon.download-new") !== null) { //If element is a download icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "icon-download-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".icon.preview") !== null) { //If element is a eye/preview icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "icon-eye";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".icon.angle-left-circle") !== null) { //If element is an angle left circle icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "icon-angle-left-circle";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".icon.angle-right-circle") !== null) { //If element is a angle right circle icon loaded via css\n      elementType = "Icon Link";\n      elementIcon = "icon-angle-right-circle";\n      elementCTA = elementIcon;\n    }\n    //---Social Icons (nested) Variant 5\n    if (element.querySelector(".facebook-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "facebook-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".twitter-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "twitter-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".instagram-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "instagram-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".pinterest-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "pinterest-new";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".linkedin-new") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "linkedin-new";\n      elementCTA = elementIcon;\n    }\n\n    //---SP Icons\n    if (element.querySelector("#sp-appBar-link-sites") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "SP Sites Icon (Globe)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector("#sp-appBar-link-news") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "SP News Icon (Newspaper)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector("#sp-appBar-link-files") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "SP Files Icon (Page)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector("#sp-appBar-link-create") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "SP Create Icon (Circle Plus)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector("#sp-appBar-link-remove") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "SP Remove Icon (Circle Minus)";\n      elementCTA = elementIcon;\n    }\n\n    //---MS Office App Logos\n    if (element.querySelector(".ms-Icon--WaffleOffice365") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Waffle Icon (Dots Grid)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--Help") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Help Icon (Question Mark)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--Settings") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Settings Icon (Gear)";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--OutlookLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Outlook Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--OneDrive") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS OneDrive Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--WordLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Word Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--PowerPointLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS PowerPoint Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--ExcelLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Excel Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--OneNoteLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS OneNote Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--SharepointLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS SharePoint Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--TeamsLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Teams Logo Icon";\n      elementCTA = elementIcon;\n    }\n    if (element.querySelector(".ms-Icon--YammerLogo") !== null) {\n      elementType = "Icon Link";\n      elementIcon = "MS Yammer Logo Icon";\n      elementCTA = elementIcon;\n    }\n  }\n\n  //Scroll Left\n  if (\n    (element.closest("div.scrollLeft button") !== null)\n    || (element.closest("div#scrollLeft") !== null)\n    || (element.closest("div.slick-slider > a.prev") !== null)\n    || (element.closest("a.left") !== null)\n  ) {\n    elementText = "left arrow (path)";\n    if (element.classList.contains("prev")) { //Element is a .prev (aka in a slick-slider)\n      elementType = "Text Link (Btn)";\n      elementText = "icon-arrow-left";\n    }\n    if (typeof element.innerText != "undefined") {\n      if (element.innerText !== null) { //If the element has text\n        elementText = element.innerText.trim();\n      }\n    }\n  }\n  //Scroll Right\n  if (\n    (element.closest("div.scrollRight button") !== null)\n    || (element.closest("div#scrollRight") !== null)\n    || (element.closest("div.slick-slider > a.next") !== null)\n    || (element.closest("a.right") !== null)\n  ) {\n    elementText = "right arrow (path)";\n    if (element.classList.contains(\'next\')) { //Element is a .next (aka in a slick-slider)\n      elementType = "Text Link (Btn)";\n      elementText = "icon-arrow-right";\n    }\n    if (typeof element.innerText != "undefined") {\n      if (element.innerText !== null) { //If the element has text\n        elementText = element.innerText.trim();\n      }\n    }\n  }\n\n  //Workaround for hero carousel teaser content that is blank but an image is used as the CTA\n  if (carouselItemImage != "Unknown carouselItemImage") {\n    if (element.closest(\'.cmp-teaser__image\') !== null || element.closest(\'.cmp-teaser__link\') !== null) {\n      if (element.closest(\'.teaser.hero\') !== null) {\n        if (elementText == "Unknown elementText" || elementText == "") {\n          elementType = "Image Link"; //Need this to override the blank content text links since the hero teaser is only an image.\n          elementCTA = carouselItemImage;\n        }\n      }\n    }\n  }\n\n  //--Button Cards\n  if (element.closest(".ButtonCard") !== null) {\n    if (element.closest("div[role=\'listitem\']") !== null) {\n      if (element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']") !== null) {\n        if (element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']").innerText !== null) {\n          elementCTA = element.closest("div[role=\'listitem\']").querySelector("*[data-automation-id=\'quick-links-item-title\']").innerText.trim();\n        }\n      }\n    }\n  }\n\n  //--Forms\n  ///--Form Fields\n  if (element.closest(".xComboWrapper") != null) {\n    if (element.closest(".xComboWrapper").querySelector("input") != null) {\n      if (element.closest(".xComboWrapper").querySelector("input").getAttribute("data-api-ignore") != null) { //Element has a data-api-ignore attribute\n        elementDataApiIgnore = element.closest(".xComboWrapper").querySelector("input").getAttribute("data-api-ignore");\n        formFieldName = elementDataApiIgnore;\n        elementCTA = elementDataApiIgnore;\n      }\n    }\n  }\n  if (element.getAttribute("data-name-placeholder")) { //Element has a data-name-placeholder attribute\n    elementDataNamePlaceholder = element.getAttribute("data-name-placeholder");\n    formFieldName = elementDataNamePlaceholder;\n    elementCTA = elementDataNamePlaceholder;\n  }\n  if (element.getAttribute("placeholder")) { //Element has a placeholder attribute\n    elementDataNamePlaceholder = element.getAttribute("placeholder");\n    formFieldName = elementDataNamePlaceholder;\n    elementCTA = elementDataNamePlaceholder;\n  }\n  if (element.getAttribute("data-display-name")) { //Element has a data-display-name attribute\n    elementDataDisplayName = element.getAttribute("data-display-name");\n    formFieldName = elementDataDisplayName;\n    elementCTA = elementDataDisplayName;\n  }\n  if (element.getAttribute("name")) { //Element has a name attribute\n    elementName = element.getAttribute("name");\n    if (elementName == "data.programType") {\n      elementName = "Account Type";\n    }\n    formFieldName = elementName;\n    elementCTA = elementName;\n  }\n\n  //Work-around for country \'select\' list\n  if (element.closest(\'#countries\') !== null) { //Element is or is within the age-year ul\n    //formFieldName = "Country Selector";\n    if (element.closest(\'.countrySelector\') !== null) {\n      if (element.closest(\'.countrySelector\').querySelector(\'.select-country span.language-select\') !== null) {\n        if (element.closest(\'.countrySelector\').querySelector(\'.select-country span.language-select\').innerText !== null) {\n          formFieldName = element.closest(\'.countrySelector\').querySelector(\'.select-country span.language-select\').innerText.trim();\n        }\n      }\n    }\n    elementCTA = elementText;\n    //elementCTA = "Select Your Country";\n  }\n  //Work-around for province \'select\' list with no name attribute or equivalent\n  if (element.closest("#age-list-addon") !== null) { //Element is or is within the age-list-addon div\n    formFieldName = "State/Province";\n    elementCTA = "Province";\n    //optionSelected = element.querySelector("option:selected").innerText.trim();\n  }\n  //Work-around for month \'select\' list\n  if (element.closest("#age-list-months") !== null) { //Element is or is within the age-list-months ul\n    formFieldName = "Birth Month";\n    elementCTA = "Birth Month";\n    //optionSelected = element.querySelector("option:selected").innerText.trim();\n  }\n  //Work-around for day \'select\' list\n  if (element.closest("#age-list-days") !== null) { //Element is or is within the age-list-days ul\n    formFieldName = "Birth Day";\n    elementCTA = "Birth Day";\n    //optionSelected = element.querySelector("option:selected").innerText.trim();\n  }\n  //Work-around for year \'select\' list\n  if (element.closest(".age-year") !== null) { //Element is or is within the age-year ul\n    formFieldName = "Birth Year";\n    elementCTA = "Birth Year";\n    //optionSelected = element.querySelector("option:selected").innerText.trim();\n  }\n  /*\n  //Work-around for when the elementText/CTA is a unicode character\n  if (elementCTA == "\ue711") {\n    elementCTA = "X (U+E711)"\n  }\n  if (elementCTA == "\ue948") {\n    elementCTA = "+ (U+FF0B)"\n  }\n  */\n  if (element.getAttribute("value") !== null) { //Element has a value attribute\n    elementVal = element.getAttribute("value");\n  }\n  if (element.value !== null) { //Element has a value attribute\n    elementVal = element.value;\n  }\n\n  //Set elementVal for inputs in PriceSpider Ribbon\n  if (\n    (element.closest(".ps-local-tab-button") !== null) //The element is a local tab button\n    || (element.closest(".ps-online-tab-button") !== null) //The element is a online tab button\n  ) {\n    if (elementID !== "Unknown elementID") { //The element has an ID value\n      if (element.closest(".ps-widget") !== null) {\n        if (element.closest(".ps-widget").querySelector("label[for=\'" + elementID + "\']").innerText !== null) {\n          elementVal = element.closest(".ps-widget").querySelector("label[for=\'" + elementID + "\']").innerText.trim();\n        }\n      }\n    }\n  }\n  //Set formFieldName, elementVal & update elementCTA to include brand/beverage name (workarounds for PriceSpider select nodes)\n  if (elementID == "__ps-sku-selector-1_0") { //Element is the PriceSpider Brand selector\n    formFieldName = elementID;\n   // elementVal = beverageBrand;\n    elementCTA += "_" + elementVal;\n  }\n  if (elementID == "__ps-sku-selector-2_0") { //Element is the PriceSpider Product(Beverage) selector\n    formFieldName = elementID;\n   // elementVal = beverageName;\n    elementCTA += "_" + elementVal;\n  }\n  if (element.getAttribute("type") == "file") { //Element is a file upload field\n    formFieldName = "File Upload";\n    if (typeof element.innerText != "undefined") {\n      if (element.innerText !== null) { //If the element has text\n        elementText = element.innerText.trim();\n      } else if (element.closest("label") !== null) { //If the element has a label\n        if (element.closest("label").innerText !== null) {\n          elementText = element.closest("label").innerText;\n        }\n      }\n    }\n    elementCTA = elementText;\n  }\n\n  if (element.getAttribute("type") == "radio") { //Element is a radio button input\n    //  formFieldName = elementDataDisplayName;\n    if (elementDataDisplayName !== "Unknown elementDataDisplayName") {\n      elementCTA = elementDataDisplayName + "_" + elementVal;\n    } else {\n      elementCTA = elementName + "_" + elementVal;\n    }\n  } else if (element.getAttribute("type") == "checkbox") { //Element is a checkbox input\n    //Commenting out below for now. We may be able to use gigya-empty, but the class doesn\'t appear until after checking on then off then on and off again.\n    /*\n    if (element.hasClass("gigya-empty")){\n        checkboxState = "Unchecked";\n      } else {\n        checkboxState = "Checked";\n      }\n    */\n    //  formFieldName = elementDataDisplayName;\n    //  elementCTA = elementDataDisplayName+":"+checkboxState;\n    /*\n    if (elementDataDisplayName !== "Unknown elementDataDisplayName") {\n        elementCTA = elementDataDisplayName;\n    }\n    if (elementDataNamePlaceholder !== "Unknown elementDataNamePlaceholder") {\n        elementCTA = elementDataNamePlaceholder;\n    }\n    */\n  } else if (element.getAttribute("type") == "text") { //Element is a textbox field\n    //  formFieldName = elementDataDisplayName;\n    if (elementName !== "Unknown elementName") {\n      elementCTA = elementName;\n    } else if (elementDataDisplayName !== "Unknown elementDataDisplayName") {\n      elementCTA = elementDataDisplayName;\n    } else if (elementDataNamePlaceholder !== "Unknown elementDataNamePlaceholder") {\n      elementCTA = elementDataNamePlaceholder;\n    }\n  } else if (element.getAttribute("type") == "password") { //Element is a password field\n    if (elementDataDisplayName !== "Unknown elementDataDisplayName") { //If element has a data-display-name\n      elementCTA = elementDataDisplayName;\n    } else {\n      elementCTA = elementName;\n    }\n  }\n\n  if (element.getAttribute("type") == "submit") { //Element is a submit \'button\'\n    elementCTA = elementText;\n    if (elementVal != "Unknown elementVal") {\n      elementCTA = elementVal;\n    }\n  }\n\n  // Search UX Form Submit Button\n  if (element.closest("button[class*=\'submitSearchButton\']") !== null) {\n    elementCTA = "Search Submit";\n  }\n\n  // Search UX Form Exit Button\n  if (element.closest("button.SearchBoxExitButton") !== null) {\n    elementCTA = "Search Exit";\n  }\n\n  //Set variables for Mobile Sandwhich menu\n  if (element.closest(".mh-main-nav-button") !== null) {//Legacy sandwich menu before 2020 templates\n    if (element.closest(".mh-main-nav-button-selected") !== null) { //Element is \'selected\' (aka the mobile flyout is expanded)\n      expansionState = "Opened";\n      expansionAction = "Close";\n      elementType = "Image Link";\n      elementText = "X";\n      elementCTA = elementText;\n    } else {\n      expansionState = "Closed";\n      expansionAction = "Open";\n      elementType = "Image Link";\n      elementCTA = "Sandwich Icon";\n    }\n  }\n  if (\n    //Element is the nav bar toggle button\n    (element.closest(".bt-nav__toggle__btn") !== null)\n    || (element.closest(".navbar-toggler") !== null)\n  ) {\n    elementType = "Icon Link";\n    elementCTA = "Sandwich Icon";\n    if (element.closest(".navbar__open") !== null) {\n      elementCTA = "Sandwich Icon";\n    }\n    if (element.closest(".navbar__close") !== null) {\n      elementCTA = "Close Icon (X)";\n    }\n  }\n  //AEM Accordion Component\n  if (element.closest(".cmp-accordion") !== null) {\n\n  }\n\n  //Set elementLabel and set elementCTA to elementLabel where appropriate\n  /*--PriceSpider Product Selector labels\n  if (element.closest(".ps-product-selector") !== null) {\n    if (element.closest("label + *").prev() !== null) {\n      elementLabel = element.closest("label + *").prev().innerText.trim();\n      elementCTA = elementLabel;\n    }\n  }*/\n\n  /*--Brand Templates form labels\n  if (element.closest("div").closest("div + *").prev() !== null) { //Element has a div as the immediate previous object\n    if (element.closest("div").closest("div + *").prev().classList.contains("TextFieldLabelHeader")) { //Element has a label of class TextFieldLabelHeader in the immediate previous dv (e.g. Comments field on Contact Us Form)\n      elementLabel = element.closest("div").closest("div + *").prev().innerText.trim();\n      elementCTA = elementLabel;\n    }\n  }\n  if (element.closest("div").querySelector(".TextFieldLabel") !== null) { //Element has a label of class TextFieldLabel\n    elementLabel = element.closest("div").querySelector(".TextFieldLabel").innerText.trim();\n    elementCTA = elementLabel;\n  }\n  if (element.closest(".divPositionOptIn") !== null) { //Element is in an optin container\n    if (element.closest(".divPositionOptIn").querySelector(".TextFooter") !== null) { //Element has a TextFooter within it\n      elementLabel = element.closest(".divPositionOptIn").querySelector(".TextFooter").innerText.trim();\n      elementCTA = elementLabel;\n    }\n  }*/\n\n  //Set element CTA for YouTube video play buttons\n  if (element.closest(".yt__meta__play") !== null) {\n    elementCTA = "Click To Play Icon"\n  }\n\n  //Set elementDataSlideTo then set elementCTA\n  if (carousel !== eventPayloadObj.eventInfo.carouselInfo.carousel) {\n    if (elementDataSlideTo !== eventPayloadObj.eventInfo.pageActionInfo.elementInfo.elementDataSlideTo) {\n      elementCTA = "Slide indicator " + elementDataSlideTo;\n    }\n  }\n  if (\n    (typeof (element.getAttribute("data-slide-to")) != "undefined")\n    && (element.getAttribute("data-slide-to") !== null)\n  ) { //Fallback forcarousels\n    elementDataSlideTo = element.getAttribute(\'data-slide-to\');\n    elementCTA = "Slide " + elementDataSlideTo + " indicator";\n  }\n\n  //Set formDetails to N/A if element is not in a <form>\n  if (element.closest("form") == null) {\n    formDetails = "N/A";\n  }\n\n  //Set searchTerm for MS Search Box Fields\n  if (eventName == "Change") {\n    if (\n      (element.closest(".ms-SearchBox-field") !== null)\n      || (element.closest(\'[type="search"]\') !== null)\n      || (element.closest(".search-panel__input") !== null)\n      || (element.closest(".search__input") !== null)\n    ) {\n      if (elementVal != "Unknown elementVal") {\n        searchTerm = elementVal;\n      }\n    }\n  }\n  //Set searchTerm\n  if (eventName == "Click") {\n  //MS Suite UX Search Box Fields on submit search clicks\n    if (element.closest(".ms-suiteux-search-box") !== null) {\n      if (element.closest(".ms-suiteux-search-box").querySelector(\'input[type="search"]\') !== null) {\n        if (typeof element.closest(".ms-suiteux-search-box").querySelector(\'input[type="search"]\').value != "undefined") {\n          searchTerm = element.closest(".ms-suiteux-search-box").querySelector(\'input[type="search"]\').value;\n        }\n      }\n    }\n    //OneXP\n    //--Main Nav/flyout\n    if (element.closest("form.search-panel__input-wrapper") !== null) {\n      if (element.closest("form.search-panel__input-wrapper").querySelector(\'input[class="search-panel__input"]\') !== null) {\n        if (typeof element.closest("form.search-panel__input-wrapper").querySelector(\'input[class="search-panel__input"]\').value != "undefined") {\n          searchTerm = element.closest("form.search-panel__input-wrapper").querySelector(\'input[class="search-panel__input"]\').value;\n        }\n      }\n    }\n    //--SERP\n    if (element.closest("form.search__form") !== null) {\n      if (element.closest("form.search__form").querySelector(\'input[class="search__input"]\') !== null) {\n        if (typeof element.closest("form.search__form").querySelector(\'input[class="search__input"]\').value != "undefined") {\n          searchTerm = element.closest("form.search__form").querySelector(\'input[class="search__input"]\').value;\n        }\n      }\n    }\n  }\n\n\n  //Set searchResultIndex if there is one\n  if (element.closest("[data-search-result-index]") !== null) {\n    searchResultIndex = element.closest("[data-search-result-index]").getAttribute(\'data-search-result-index\');\n  } else {\n    searchResultIndex = "N/A"\n  }\n\n  //Set qualifyingSegment and push it into the data layer if user clicks on a qualifying element\n  //Exclude visits with the following utms present social-dark,social-boost,paid social,search,email (these are associated with non-organic visits)\n  //--Using Campaign Details element to ensure it is for all visitors with the non-qualifying campaign values and not just on the landing page (as with document.location.href)\n  if (\n    (a_campaignDetailsDE == null) ||\n    (\n      (a_campaignDetailsDE !== null) &&\n      (a_campaignDetailsDE.indexOf(\'social-dark\') !== -1) &&\n      (a_campaignDetailsDE.indexOf(\'social-boost\') !== -1) &&\n      (a_campaignDetailsDE.indexOf(\'paid social\') !== -1) &&\n      (a_campaignDetailsDE.indexOf(\'search\') !== -1) &&\n      (a_campaignDetailsDE.indexOf(\'email\') !== -1)\n    )\n  ) {\n    //Segments 1-5 are set at page load\n    //Segment 6 - Financial\n    //There is also a Financial audience segment, but is is based on a click and will need to be set in the click payload script. Element CTA must equal \'Investors\'. Possibly case sensitive.\n    //Note that the Financial segment may be on page view when we switch to OneXP\n    if (elementCTA == "Investors") {\n      qualifyingSegment = "Financial";\n\n      //push current qualifyingSegment into the end of the array for all segments (not last touch) and if the page view flag is set to 0 so this won\'t be pushed twice when digital data is set again at DOM Ready.\n      if (qualifyingSegment !== null && qualifyingSegment != "null") {\n        //if (a_tcccSegmentQualificationFlag == 0) {\n        //Create an array to hold the audience segments a user qualifies for - All\n        var a_currentAudienceSegments = [];\n        //Populate the array with the local storage value if there is one\n        if (typeof (localStorage.getItem("a_profileAudienceSegmentsArray")) != undefined) {\n          if (localStorage.getItem("a_profileAudienceSegmentsArray") !== null && localStorage.getItem("a_profileAudienceSegmentsArray") !== \'null\' && localStorage.getItem("a_profileAudienceSegmentsArray") !== \'undefined\' && localStorage.getItem("a_profileAudienceSegmentsArray") !== \'\') {\n            a_currentAudienceSegments = JSON.parse(localStorage.getItem("a_profileAudienceSegmentsArray"));\n            //a_currentAudienceSegments = localStorage.getItem("a_profileAudienceSegmentsArray");\n          }\n        }\n\n        //Create an array to hold the audience segments a user qualifies for - last touch\n        var a_currentAudienceSegmentsLastTouch = [];\n        //Populate the array with the local storage value if there is one\n        if (typeof (localStorage.getItem("a_profileAudienceSegmentsLastTouchArray")) != undefined) {\n          if (localStorage.getItem("a_profileAudienceSegmentsLastTouchArray") !== null && localStorage.getItem("a_profileAudienceSegmentsLastTouchArray") !== \'null\' && localStorage.getItem("a_profileAudienceSegmentsLastTouchArray") !== \'undefined\' && localStorage.getItem("a_profileAudienceSegmentsLastTouchArray") !== \'\') {\n            a_currentAudienceSegmentsLastTouch = JSON.parse(localStorage.getItem("a_profileAudienceSegmentsLastTouchArray"));\n            //a_currentAudienceSegmentsLastTouch = localStorage.getItem("a_profileAudienceSegmentsLastTouchArray");\n          }\n        }\n\n        //push current qualifyingSegment into the end of the array for all segments (not last touch) and if the page view flag is set to 0 so this won\'t be pushed twice when digital data is set again at DOM Ready.\n        if (qualifyingSegment !== null && qualifyingSegment != "null") {\n          //if (a_tcccSegmentQualificationFlag == 0) {\n          a_currentAudienceSegments.push(qualifyingSegment);\n          //}\n        }\n\n        //Check existing last touch array for the audience segment, if already in then splice it to the front from the current location, if not, push it into the front of the array.\n        if (typeof (a_currentAudienceSegmentsLastTouch) != undefined) {\n          if (a_currentAudienceSegmentsLastTouch !== null && a_currentAudienceSegmentsLastTouch != "undefined") {\n            if (a_currentAudienceSegmentsLastTouch.length !== 0) {\n              if (a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment) !== -1) {\n                //Move the audienceSegment item to the front of the array\n                a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n              } else {\n                console.log("Type: " + typeof (a_currentAudienceSegmentsLastTouch) + " | Value:");\n                console.log(a_currentAudienceSegmentsLastTouch);\n                a_currentAudienceSegmentsLastTouch.push(qualifyingSegment);\n                a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n              }\n            } else if (a_currentAudienceSegmentsLastTouch.length == 0) {\n              if (qualifyingSegment !== null && qualifyingSegment != "null") {\n                //if (a_tcccSegmentQualificationFlag == 0) {\n                a_currentAudienceSegmentsLastTouch.push(qualifyingSegment);\n                a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n                //}\n              }\n            }\n          }\n        }\n\n        //Clean out null values in the arrays\n        const a_currentAudienceSegmentsClean = a_currentAudienceSegments.filter(function (x) {\n          return (x != null);\n        });\n        console.log("Audience Segments Clean:");\n        console.log(a_currentAudienceSegmentsClean);\n\n        const a_currentAudienceSegmentsLastTouchClean = a_currentAudienceSegmentsLastTouch.filter(function (x) {\n          return x != null;\n        });\n        console.log("Audience Segments Last Touch Clean:");\n        console.log(a_currentAudienceSegmentsLastTouchClean);\n\n        //set local storage to new array values\n        //--All\n        //set local storage to new array values\n        localStorage.setItem("a_profileAudienceSegmentsArray", JSON.stringify(a_currentAudienceSegmentsClean));\n        //--Last Touch\n        localStorage.setItem("a_profileAudienceSegmentsLastTouchArray", JSON.stringify(a_currentAudienceSegmentsLastTouchClean));\n\n        //Create a var to hold the current primary and secondary audience segment values\n        var a_currentPrimaryAudienceSegment;\n        var a_currentSecondaryAudienceSegment;\n        if (typeof (a_currentAudienceSegmentsLastTouchClean) != undefined && a_currentAudienceSegmentsLastTouchClean != "undefined") {\n          if (a_currentAudienceSegmentsLastTouchClean !== null) {\n            if (a_currentAudienceSegmentsLastTouchClean.length !== 0) {\n              a_currentPrimaryAudienceSegment = a_currentAudienceSegmentsLastTouchClean[0];\n            }\n\n            if (a_currentAudienceSegmentsLastTouchClean.length >= 1) {\n              a_currentSecondaryAudienceSegment = a_currentAudienceSegmentsLastTouchClean[1];\n            }\n          }\n        }\n        //window.adobeDataLayer.visitorProfile.audienceSegments = a_currentAudienceSegmentsClean;\n        //window.adobeDataLayer.visitorProfile.audienceSegmentPrimary = a_currentPrimaryAudienceSegment;\n        //window.adobeDataLayer.visitorProfile.audienceSegmentSecondary = a_currentSecondaryAudienceSegment;\n        var eventPayloadObj = {\n          "event": "visitorProfile:change",\n          "visitorProfile": {\n            "audienceSegments": a_currentAudienceSegmentsClean,\n            "audienceSegmentsLastTouch": a_currentAudienceSegmentsLastTouchClean,\n            "audienceSegmentPrimary": a_currentPrimaryAudienceSegment,\n            "audienceSegmentSecondary": a_currentSecondaryAudienceSegment\n          } //end visitorProfile\n        } //end eventpPayloadObj\n        window.adobeDataLayer.push(eventPayloadObj); //end push script\n        //}\n      }\n    }\n  }\n\n  //Set clickStr, clickDetails\n  //clickStr = pageLocation.replace(/:\\s*/g, "&#58") + ":" + pageSection.replace(/:\\s*/g, "&#58") + ":" + elementType.replace(/:\\s*/g, "&#58") + ":" + elementAction.replace(/:\\s*/g, "&#58") + ":" + elementAnalyticsID.replace(/:\\s*/g, "&#58") + ":" + elementCTA.replace(/:\\s*/g, "&#58");\n  //clickDetails = clickStr.toLowerCase();\n\n  //Set elementLinkName and elementLinkType\n  elementLinkType = "other";\n\n  if (\n    (destinationUrl.indexOf(\'.pdf\') !== -1) || //the element href attribute does include .pdf (aka is a pdf)\n    (destinationUrl.indexOf(\'.doc\') !== -1) || //the element href attribute does include .doc (aka is a doc)\n    (destinationUrl.indexOf(\'.docx\') !== -1) || //the element href attribute does include .docx (aka is a docx)\n    (destinationUrl.indexOf(\'.jpg\') !== -1) || //the element href attribute does include .jpg (aka is a jpg)\n    (destinationUrl.indexOf(\'.png\') !== -1) ||  //the element href attribute does include .png (aka is a png)  \n    (destinationUrl.indexOf(\'.svg\') !== -1) || //the element href attribute does include .svg (aka is a svg)  \n    (destinationUrl.indexOf(\'.xls\') !== -1) || //the element href attribute does include .xls (aka is a xls)\n    (destinationUrl.indexOf(\'.xlsx\') !== -1) || //the element href attribute does include .xlsx (aka is a xlsx)\n    (destinationUrl.indexOf(\'.ppt\') !== -1) || //the element href attribute does include .ppt (aka is a ppt)\n    (destinationUrl.indexOf(\'.pptx\') !== -1) || //the element href attribute does include .pptx (aka is a pptx)\n    (destinationUrl.indexOf(\'.tab\') !== -1) || //the element href attribute does include .tab (aka is a tab)\n    (destinationUrl.indexOf(\'.csv\') !== -1) || //the element href attribute does include .csv (aka is a csv)\n    (destinationUrl.indexOf(\'.zip\') !== -1) || //the element href attribute does include .zip (aka is a zip)\n    (destinationUrl.indexOf(\'.txt\') !== -1) || //the element href attribute does include .txt (aka is a txt)\n    (destinationUrl.indexOf(\'.vsd\') !== -1) || //the element href attribute does include .vsd (aka is a vsd)\n    (destinationUrl.indexOf(\'.vxd\') !== -1) || //the element href attribute does include .vxd (aka is a vxd)\n    (destinationUrl.indexOf(\'.xml\') !== -1) || //the element href attribute does include .xml (aka is a xml)\n    (destinationUrl.indexOf(\'.js\') !== -1) || //the element href attribute does include .js (aka is a js)\n    (destinationUrl.indexOf(\'.css\') !== -1) || //the element href attribute does include .vsd (aka is a vsd)\n    (destinationUrl.indexOf(\'.rar\') !== -1) || //the element href attribute does include .rar (aka is a rar)\n    (destinationUrl.indexOf(\'.exe\') !== -1) || //the element href attribute does include .exe (aka is a exe)\n    (destinationUrl.indexOf(\'.wma\') !== -1) || //the element href attribute does include .wma (aka is a wma)\n    (destinationUrl.indexOf(\'.mov\') !== -1) || //the element href attribute does include .mov (aka is a mov)\n    (destinationUrl.indexOf(\'.avi\') !== -1) || //the element href attribute does include .avi (aka is a avi)\n    (destinationUrl.indexOf(\'.wmv\') !== -1) || //the element href attribute does include .wmv (aka is a wmv)\n    (destinationUrl.indexOf(\'.mp3\') !== -1) || //the element href attribute does include .mp3 (aka is a mp3)\n    (destinationUrl.indexOf(\'.wav\') !== -1) || //the element href attribute does include .wav (aka is a wav)\n    (destinationUrl.indexOf(\'.m4v\') !== -1) //the element href attribute does include .m4v (aka is a m4v)\n  ) {\n    elementLinkName = "Download Link";\n    elementLinkType = "download";\n  }\n\n  if (\n    (destinationUrl.indexOf(\'.pdf\') == -1) && //the element href attribute does include .pdf (aka is a pdf)\n    (destinationUrl.indexOf(\'.doc\') == -1) && //the element href attribute does include .doc (aka is a doc)\n    (destinationUrl.indexOf(\'.docx\') == -1) && //the element href attribute does include .docx (aka is a docx)\n    (destinationUrl.indexOf(\'.jpg\') == -1) && //the element href attribute does include .jpg (aka is a jpg)\n    (destinationUrl.indexOf(\'.png\') == -1) && //the element href attribute does include .png (aka is a png)  \n    (destinationUrl.indexOf(\'.svg\') == -1) && //the element href attribute does include .svg (aka is a svg)  \n    (destinationUrl.indexOf(\'.xls\') == -1) && //the element href attribute does include .xls (aka is a xls)\n    (destinationUrl.indexOf(\'.xlsx\') == -1) && //the element href attribute does include .xlsx (aka is a xlsx)\n    (destinationUrl.indexOf(\'.ppt\') == -1) && //the element href attribute does include .ppt (aka is a ppt)\n    (destinationUrl.indexOf(\'.pptx\') == -1) && //the element href attribute does include .pptx (aka is a pptx)\n    (destinationUrl.indexOf(\'.tab\') == -1) && //the element href attribute does include .tab (aka is a tab)\n    (destinationUrl.indexOf(\'.csv\') == -1) && //the element href attribute does include .csv (aka is a csv)\n    (destinationUrl.indexOf(\'.zip\') == -1) && //the element href attribute does include .zip (aka is a zip)\n    (destinationUrl.indexOf(\'.txt\') == -1) && //the element href attribute does include .txt (aka is a txt)\n    (destinationUrl.indexOf(\'.vsd\') == -1) && //the element href attribute does include .vsd (aka is a vsd)\n    (destinationUrl.indexOf(\'.vxd\') == -1) && //the element href attribute does include .vxd (aka is a vxd)\n    (destinationUrl.indexOf(\'.xml\') == -1) && //the element href attribute does include .xml (aka is a xml)\n    (destinationUrl.indexOf(\'.js\') == -1) && //the element href attribute does include .js (aka is a js)\n    (destinationUrl.indexOf(\'.css\') == -1) && //the element href attribute does include .vsd (aka is a vsd)\n    (destinationUrl.indexOf(\'.rar\') == -1) && //the element href attribute does include .rar (aka is a rar)\n    (destinationUrl.indexOf(\'.exe\') == -1) && //the element href attribute does include .exe (aka is a exe)\n    (destinationUrl.indexOf(\'.wma\') == -1) && //the element href attribute does include .wma (aka is a wma)\n    (destinationUrl.indexOf(\'.mov\') == -1) && //the element href attribute does include .mov (aka is a mov)\n    (destinationUrl.indexOf(\'.avi\') == -1) && //the element href attribute does include .avi (aka is a avi)\n    (destinationUrl.indexOf(\'.wmv\') == -1) && //the element href attribute does include .wmv (aka is a wmv)\n    (destinationUrl.indexOf(\'.mp3\') == -1) && //the element href attribute does include .mp3 (aka is a mp3)\n    (destinationUrl.indexOf(\'.wav\') == -1) && //the element href attribute does include .wav (aka is a wav)\n    (destinationUrl.indexOf(\'.m4v\') == -1) //the element href attribute does include .m4v (aka is a m4v)\n  ) {\n    //--Internal Site Links\n    if (\n      (destinationUrl != "undefined") &&\n      (destinationUrl !== undefined) &&\n      (destinationUrl !== "Unknown destinationUrl")\n    ) {\n      if (\n        (destinationUrl.indexOf(window.location.hostname.replace(/^www\\./, \'\')) !== -1) || //the href domain does match the domain of the current page\n        (\n          (destinationUrl.indexOf("?") == 0) //the element href attribute does start with a ? (Filter and Search Result Links)\n          || //OR\n          (destinationUrl.indexOf("/") == 0) //the element href attribute does start with a relative link (/)\n          || //OR\n          (destinationUrl.indexOf("#mobile-sub") == 0) //The href does start with "#mobile-sub" (mobile menu items)\n          || //OR\n          (element.closest(\'a[onclick="btNavSubmenu(event)"]\') !== null) //Element is within a dropdown in the mobile menu\n          || //OR\n          (destinationUrl.indexOf(\'gigya-forgot-password-screen\') == 0) // Element href (gigya-screen-switcher) does start with gigya-forgot-password-screen\n          || //OR\n          (destinationUrl.indexOf(\'gigya-login-screen\') == 0) // Element href (gigya-screen-switcher) does start with gigya-login-form\n          || //OR\n          (\n            (destinationUrl.indexOf(\'#\') !== 0) //the href doesn\'t start with # (Page Anchor)\n            && (destinationUrl.indexOf("mailto:") !== 0) //the href doesn\'t start with mailto: (email link)\n            && (destinationUrl.indexOf("tel:") !== 0) //the href doesn\'t start with tel: (phone number link)\n            //    && (destinationUrl.indexOf(\'javascript:\') !== 0) //the href doesn\'t start with javascript: (javascript action link)\n            //    && (destinationUrl != "") //the href isn\'t blank\n            && (!element.closest(\'div\').classList.contains("socialLinks")) //the link is not a social link in the footer\n            //    && (!element.not("href*=\'/\']")) //the link does not have a href value without any forward slashes\n            && (element.closest(".widget-modal-container") == null) //the link is not in a modal container\n            && (element.closest(".mh-mn-language-item") == null) //the element is not within a language selector item\n          )\n        )\n      ) {\n        elementLinkName = "Internal Site Link";\n      }\n    }\n\n    //--Exit Links\n    if (\n      (destinationUrl != "undefined") &&\n      (destinationUrl !== undefined) &&\n      (destinationUrl !== "Unknown destinationUrl")\n    ) {\n      if (\n        (destinationUrl.indexOf(window.location.hostname.replace(/^www\\./, \'\')) == -1) && //the href domain does not match the domain of the current page\n        (destinationUrl.indexOf(\'#\') !== 0) && //the href doesn\'t start with # (Page Anchor)\n        (destinationUrl.indexOf(\'/\') !== 0) && //the element href attribute does not start with / (aka is a relative link)\n        (destinationUrl.indexOf(\'Expand_\') == -1) && //the href isn\'t for a component expansion\n        (destinationUrl.indexOf(\'Collapse_\') == -1) && //the href isn\'t for a component collapse\n        (destinationUrl != "") && //the href isn\'t blank\n        (destinationUrl !== null) //the href isn\'t null\n      ) {\n        elementLinkName = "Exit Link";\n        elementLinkType = "exit";\n      }\n    }\n\n    //--Links without a href\n    if (element.closest("a") !== null) {\n      if (element.closest("a").getAttribute("href") == null) {\n        elementLinkName = "Link (No href)";\n      } else if (element.closest("a").getAttribute("href") !== null) {\n        if (\n          (element.closest("a").getAttribute("href") == "") ||\n          (element.closest("a").getAttribute("href") == "undefined")\n        ) {\n          elementLinkName = "Link (No href)";\n        }\n      }\n    }\n\n    //---Economic Impact Map\n    if(element.closest(\'svg.svg-states\') !== null) {\n      elementLinkName = "Link (No href)"; \n    }\n\n  }\n\n  if (destinationUrl.indexOf(\'mamilto:\') == 0) {\n    elementLinkName = "Mailto Link";\n  }\n\n  if (destinationUrl.indexOf(\'tel:\') == 0) {\n    elementLinkName = "Tel Link";\n  }\n\n  if (destinationUrl.indexOf(\'sms:\') == 0) {\n    elementLinkName = "SMS Link";\n  }\n\n  //--Buttons\n  if (element.closest("button") !== null) {\n    if (\n      (element.closest("a") == null) && //The element is not nested within an <a>\n      (!element.getAttribute(\'href\')) && //The element doesn\'t have a href attribute\n      (element.closest(\'form\') == null) && //The element is not a button on a form\n      (element.getAttribute(\'type\') !== "submit") && //The element is not a button of type \'submit\'\n      (element.closest(\'.radio-dropdown-button\') == null) && //The element is not a radio dropdown button\n      (element.closest(\'.widget-modal-close\') == null) && //The element is not a modal close button in a .widget-modal-close\n      (element.closest(\'.close\') == null) && //The element is not a modal close button\n      (element.closest(\'.collapse-toggle-button\') == null) && //The element is not a modal expand/collapse button\n      (element.closest(\'.scrollLeft\') == null && element.closest(\'#scrollLeft\') == null && element.closest(\'.prev\') == null && element.closest(\'.left\') == null) && //The element is not a scroll left button\n      (element.closest(\'.scrollRight\') == null && element.closest(\'#scrollRight\') == null && element.closest(\'.next\') == null && element.closest(\'.right\') == null) && //The element is not a scroll right button \n      (element.closest(\'.active-filters-container\') == null) && //The element is not an active filter button (e.g. Active filters on product catalog)\n      (element.closest(\'.results-header-nav\') == null) && //The element is not in the product finder map results navigation\n      (element.closest(\'#map-canvas\') == null) && //The element is not in the product finder map\n      (element.closest(\'.slick-dots\') == null) //The element is not in the slick slider carousel indicator dots\n    ) {\n      elementLinkName = "Button (No href)";\n    }\n    if (\n      (element.closest(\'button[class*="submitSearchButton"]\') !== null) ||\n      (element.closest(\'button.SearchBoxExitButton\') !== null) ||\n      (element.closest(\'button.search__search-button\') !== null) ||\n      (element.closest(\'button.search-panel__search-button\') !== null) ||\n      (element.closest(\'button.search__clear-button\') !== null)\n    ) {\n      elementLinkName = "Button (No href)";\n    }\n    if (\n      (\n        (element.closest(\'button[class*="submitSearchButton"]\') !== null) ||\n        (element.closest(\'button[class="search-panel__search-button"]\') !== null) ||\n        (element.closest(\'button[class="search__search-button"]\') !== null)\n      ) &&\n      (mouseButton == 0) ||\n      (keyPressCode == "Enter")\n    ) {\n      searchTriggerFlag = "1";\n    }\n  }\n  \n  if (destinationUrl.indexOf(\'#\') == 0) {\n    elementLinkName = "Anchor Tag";\n  }\n\n  //--Other elements without hrefs that mimic button trigger actions\n  if (\n    (element.closest("span#AddLinks") !== null) ||\n    (element.closest(\'[data-automation-id="SP-carouselArrowRight"]\') !== null) ||\n    (element.closest(\'[data-automation-id="SP-carouselArrowLeft"]\') !== null) ||\n    (element.closest(\'.navbar-toggler\') !== null) || \n    (element.closest(\'.brands-list li.cmp-tabs__tab\') !== null) ||\n    (element.closest(\'#tabs-05e4f3af22.cmp-tabs li.cmp-tabs__tab\') !== null) ||\n    (element.closest(\'#tabs-b44935d701.cmp-tabs li.cmp-tabs__tab\') !== null) ||\n    (element.closest(\'#tabs-4999d227a3.cmp-tabs li.cmp-tabs__tab\') !== null)\n  ) {\n    elementLinkName = "Button (No href)";\n  }\n\n  //--Digital Assistant, Feedback "Button" Triggers, Carousel Navigation Dots\n  if (\n    (element.closest(".tcccda1_button") !== null) //Desktop DA\n    || (element.closest(".tcccda1_blob_button") !== null) //Mobile DA\n    || (element.closest(\'.tccc_feedback_button\') !== null) //Feedback Open\n    || (element.closest(\'.tccc_vote_button\') !== null) //Feedback Vote\n    || (element.closest(\'[data-automation-id*="carouselDot"]\') !== null) //Carousel Dot\n  ) {\n    elementLinkName = "Button (No href)";\n  }\n\n  //--Accordion Triggers\n  if (\n    (\n      (element.closest(\'.title-collapsible\') !== null) ||\n      (\n        (element.closest(\'[data-sp-feature-tag*="AccordionWebPart"]\') !== null)\n        && (element.closest(\'[class*="sectionHeader_"]\') !== null)\n        && (destinationUrl == "Unknown destinationUrl")\n      )\n      && (element.closest(\'[class*="sectionHeader_"]\') !== null)\n    ) ||\n    (element.closest(\'.cmp-accordion\') !== null)\n    && (destinationUrl == "Unknown destinationUrl")\n    /*\n    && (\n      (destinationUrl.indexOf(\'Expand_\') == 0) //the href is for a component expansion\n      || //OR\n      (destinationUrl.indexOf(\'Collapse_\') == 0) //the href is for a component collapse\n    )\n    */\n  ) {\n    elementLinkName = "Accordion (No href)";\n  }\n\n  //--Hero Cards (no href)\n  if (\n    (element.closest(\'[data-automation-id="HeroPatternElement"]\') !== null)\n    && (destinationUrl == "Unknown destinationUrl")\n  ) {\n    elementLinkName = "Hero Card (No href)";\n  }\n  if (\n    (element.closest(\'.ac-adaptiveCard\') !== null)\n    && (element.closest(\'.ac-selectable\') !== null)\n    && (destinationUrl == "Unknown destinationUrl")\n  ) {\n    elementLinkName = "Adaptive Card (No href)";\n  }\n\n  //--Inputs\n  if (element.closest("input") !== null) {\n    elementLinkName = "Input";\n    /*\n    if (\n        (element.closest(\'form[role="search"]\') !== null)\n        && (element.closest(\'input[role="combobox"]\') !== null)\n        && (enterKeyPressFlag == "Y")\n    ) {\n      searchTriggerFlag = "1";\n    }\n    */\n  }\n\n  //--Textareas\n  if (element.closest("textarea") !== null) {\n    elementLinkName = "Textarea";\n  }\n\n  //--Select Lists\n  if (element.closest("select") !== null) {\n    elementLinkName = "Select List";\n  }\n\n  //Set flag to see if the item clicked is something that should be sent for reporting\n  if(\n      /* Existence of documentation for different click types including CR (Right Click) indicates no need to filter out clicks other than left clicks.\n      (\n        (event.message.eventInfo.pageActionInfo.mouseButton == "0") ||\n        (event.message.eventInfo.pageActionInfo.keyPressCode == "Enter")\n      ) &&\n      */\n    (\n       elementLinkName === \'Accordion (No href)\' ||\n       elementLinkName === \'Button (No href)\' ||\n       elementLinkName === \'Internal Site Link\'  ||\n       elementLinkName === \'Download Link\'  ||\n       elementLinkName === \'Exit Link\'  ||\n       elementLinkName === \'Link (No href)\' ||\n       elementLinkName === \'Anchor Tag\'\n     )\n  ) {\n    //Set sendForReportingFlag\n    sendForReportingFlag = true;\n    //Increment hitNumber and update the eventHitNumber for the current action\n    a_incrementHitNumber();\n    eventHitNumber++;\n  }\n\n\n  //Set eventInfo and push it to the events array in the data layer\n  eventPayloadObj = {\n    "event": eventNameACDL,\n    "eventInfo": {\n      "path": elementPath,\n      "eventID": eventID,\n      "sendForReportingFlag": sendForReportingFlag,\n      "siteInfo": {\n        "siteID": siteIdDE,\n        "siteDomain": siteDomainDE,\n        "siteName": siteNameDE,\n        "siteBrand": siteBrandDE,\n        "siteLocale": siteLocaleDE,\n        "siteLanguage": siteLanguageDE,\n        "siteMarket": siteMarketDE\n      }, //end siteInfo\n      "marketing" : {\n        "trackingCode": ocidTrackingCode,\n        "_mscom": {\n          "ICID": icidTrackingCodeDE\n        }\n      }, \n      "pageInfo": {\n        "pageUrl": pageUrl,\n        "pageName": pageName,\n        "siteSection1": siteSection1,\n        "siteSection2": siteSection2,\n        "siteSection3": siteSection3,\n        "siteSection4": siteSection4,\n        "siteSection5": siteSection5,\n        "viewport": viewport,\n        "orientation": orientation,\n        "URLWithoutQS": URLWithoutQsDE, // Custom field. URL with any query string stripped from it. v41 in AA.\n        "URLQS": URLQsDE, // Custom field. Only the query string value from the URL. "Page URL Query Strings (v16)" in AA.\n        "prevPageURL": prevPageURLDE, // Custom field. Populated with the URL without a query string for the previous page (if available). May require custom client side code to store this value in a cookie and reference that cookie at each event.\n        "userAgent": userAgentDE, // Custom field. v44 in AA.\n        "pageType": pageTypeDE, // Custom field. v13 in AA.\n        "pageGroup": pageGroupDE, // Custom field. v14 in AA.\n        "pageTitle": pageTitleDE, // Custom field. v15 in AA.\n        "msftConsentBannerVisibilityFlag":msftConsentBannerVisibilityFlagDE,\n        "metaOgTitle":metaOgTitleDE,\n        "metaOgUrl":metaOgUrlDE,\n        "metaPageTemplate":metaPageTemplateDE,\n        "metaDescription":metaDescriptionDE,\n        "metaAwaCms":metaAwaCmsDE,\n        "metaAwaMarket":metaAwaMarketDE,\n        "metaAwaPageType":metaAwaPageTypeDE,\n        "metaAwaPageTemplate":metaAwaPageTemplateDE,\n        "metaAwaIsTentedFlag":metaAwaIsTentedFlagDE,\n        "metaAwaCanvasType":metaAwaCanvasTypeDE  \n      }, //end pageInfo\n      "placeContext": {\n        "geo": {\n          "_schema" : {\n            "longitude": longitudeDE,\n            "latitude": latitudeDE\n          },\n          "countryCode": countryCodeDE\n        }\n    }, // end placeContext\n      "campaignInfo": {\n        "campaignID": campaignID,\n        "campaignName": campaignName,\n        "campaignType": campaignType\n      }, //end campaignInfo\n      "formInfo": {\n        "form": form,\n        "formID": formID,\n        "formName": formName,\n        "formFriendlyName": formFriendlyName,\n        "formClass": formClass,\n        "formDetails": formDetails\n      }, //end formInfo\n      "carouselInfo": {\n        "carousel": carousel,\n        "carouselID": carouselID,\n        "carouselTitle": carouselTitle,\n        "carouselItem": carouselItem,\n        "carouselItemTitle": carouselItemTitle,\n        "carouselItemImage": carouselItemImage\n      }, //end carouselInfo\n      "gridInfo": {\n        "grid": grid,\n        "gridID": gridID,\n        "gridTitle": gridTitle,\n        "gridTileItem": gridTileItem,\n        "gridTileItemTitle": gridTileItemTitle,\n        "gridTileItemImage": gridTileItemImage\n      }, //end gridInfo\n      "newsArticleInfo": {\n        "newsArticleID": newsArticleID,\n        "newsArticleName": newsArticleName,\n        "newsArticleCategory": newsArticleCategory\n      }, //end newsArticleInfo\n      "accordionInfo": {\n        "accordionText": accordionText,\n        "expansionState": expansionState,\n        "expansionAction": expansionAction\n      }, //end accordionInfo\n      "productInfo": {\n        "productID": productID,\n        "productName": productName,\n        "productBrand": productBrand,\n        "productCategory": productCategory,\n        "productDescription": productDescription,\n        "productPrice": productPrice,\n      }, //end productInfo\n/*\n      "rewardInfo": {\n        "rewardID": rewardID,\n        "rewardName": rewardName,\n        "rewardCategory": rewardCategory\n      }, //end rewardInfo\t\n*/\n      "visitorProfile": {\n        "visitorECID": visitorECID,\n        "visitorNameID": visitorNameID,\n        "visitorFederatedId": visitorFederatedId,\n        "userProfileStateAuthentication": userProfileStateAuthentication,\n        "lastSearchedTerm": lastSearchedTerm,\n        "locationInfo": {\n          "postalCode": visitorProfilePostalCode,\n          "country": visitorProfileCountry,\n          "state": visitorProfileState,\n          "city": visitorProfileCity\n        }, //end locationInfo\n        "brandPreferences": {\n          "userPreferredBrand": {\n            "brandInfo": {\n              "brandID": visitorProfilePreferredBrandID,\n              "brandName": visitorProfilePreferredBrandName\n            }\n          }, //end userPreferredBrand\n          "userLikedBrands": userLikedBrandsArrayDL\n        }, //end brandPreferences\n        "webSessionDetails": webSessionDetailsObjDE //end webSessionDetails\n      }, //end visitorProfile\n      "shoppingCart": {\n        "numberOfProductsInCart": numberOfProductsInCart,\n        "cartTotal": cartTotal,\n        "productsInCart": productsInCartArray\n      }, //end shoppingCart\n      "errors": errorsArrayDL,\n      "filters": filtersArrayDL,\n      "searches": searchesArrayDL,\n      "videosDisplayed": videosDisplayedArrayDL,\n      "productsDisplayed": productsDisplayedArrayDL,\n      "errorInfo": {\n        "errorID": errorID,\n        "errorMessage": errorMessage\n      }, //end errorInfo\n      "filterInfo": {\n        "filterID": filterID,\n        "filterType": filterType,\n        "filterValue": filterValue,\n        "filterSelected": filterSelected\n      }, //end filterInfo\n      "searchTriggerFlag": searchTriggerFlag,\n      "searchInfo": {\n        "searchTerm": searchTerm,\n        "searchResultsTotal": searchResultsTotal,\n        "searchResultsPageNumber":searchResultsPageNumber,\n        "searchResultIndex":searchResultIndex\n      }, //end searchInfo\n      "videoInfo": {\n        "videoID": videoID,\n        "videoName": videoName,\n        "videoPlatform": videoPlatform,\n        "videoFileFormat": videoFileFormat,\n        "videoLength": videoLength\n      }, //end videoInfo\n      "pageActionInfo": {\n        "sectionInfo": {\n          //"dataLoc": dataLoc,\n          //"canvasSectionID": canvasSectionID,\n          //"canvasControlZoneID": canvasControlZoneID,\n          //"viewportID": viewportID,\n          //"webPartID": webPartID,\n          //"spFeatureTag": spFeatureTag,\n          "pageLocation": pageLocation,\n          "pageSectionID": pageSectionID,\n          "pageSection": pageSection,\n          "submenuParent": submenuParent,\n          "submenuParentLink": submenuParentLink,\n          "submenuParentLinkText": submenuParentLinkText,\n          "searchResultIndex": searchResultIndex\n        },\n        "elementInfo": {\n          "elementID": elementID,\n          "dataAnalyticsClick": dataAnalyticsClick,\n          //"elementAnalyticsID": elementAnalyticsID,\n          "nodeType": nodeType,\n          "elementType": elementType,\n          "elementState": elementState,\n          "elementAction": elementAction,\n          "elementText": elementText,\n          "elementIcon": elementIcon,\n          "elementCTA": elementCTA,\n          "elementName": elementName,\n          "elementLinkName": elementLinkName,\n          "elementLinkType": elementLinkType,\n          "elementDataDisplayName": elementDataDisplayName,\n          "elementDataNamePlaceholder": elementDataNamePlaceholder,\n          "elementDataSlideTo": elementDataSlideTo,\n          "elementVal": elementVal,\n          "elementLabel": elementLabel,\n          "formFieldName": formFieldName,\n          "imageInfo": {\n            "imageFilePath": imageFilePath,\n            "imageFilename": imageFilename,\n            "imageAlt": imageAlt,\n            "imageTitle": imageTitle,\n            "svgDetails": svgDetails,\n          }, //end imageInfo\n          "toggleInfo": {\n            "toggleTitle": toggleTitle,\n            "toggleState": toggleState,\n            "toggleAction": toggleAction\n          }, //end toggleInfo\n          "checkboxInfo": {\n            "checkboxState": checkboxState,\n            "checkboxAction": checkboxAction,\n            "checkboxesItemsSelected": checkboxesItemsSelected,\n          }, //end checkboxInfo\n          "selectListInfo": {\n            "multiSelectItemsSelected": multiSelectItemsSelected\n          }, //end selectListInfo\n          "cmpDataLayer": cmpDataLayerParsed\n          //end cmpDataLayer\n        }, //end elementInfo\n        "clickStr": clickStr,\n        "clickDetails": clickDetails,\n        "mouseButton": mouseButton,\n        "enterKeyPressFlag": enterKeyPressFlag,\n        "keyPressCode": keyPressCode,\n        "destinationUrl": destinationUrl\n      }, //end pageActionInfo\n      "_mscom": {\n        "consentsSnapshot": consentsDE,\n        "currentIdentities" :{\n          "ANON" : anonIdDE,\n          "ECID": visitorECIDDE,\n          "MC1GUID" : mc1GUIDDE,\n          "marketoLeadId": marketoLeadIdDE,\n          "marketoMunchkinCookie": marketoMunchkinCookieDE,\n        },\n        "eventData":{\n            "eventName": eventName, // Custom field.\n            "eventDataName": eventDataName,\n            "eventCategory": eventCategory, // Custom field.\n            "eventBehaviorCategory":eventBehaviorCategory, // Custom field.\n            "actionType": eventActionType, // CUstom field. CL is Left Mouse Click. Reference actionType library from MS MarTech portal.\n            "behaviorID": eventBehaviorID, // Custom field. We may need to create a field group for something like \'enhanced behavior details\' or similar. Noting the ID values are predefined and Accenture can provide a map for us. For link interactions it will be scraped from data-bi-bhvr attribute on the element that was acted on.\n        } // end eventData\n      },\n      "billingAddress": billingAddressDE, // end billingAddress\n      "billingAddressPhone": billingAddressPhoneDE, // end billingAddressPhone\n      "botDetection": { // Reference https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/bot-detection-information\n          "score": botDetectionScore\n      }, // end botDetection\n      "commerce": commerceObj, // end commerce\n      "device": deviceDetailsDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "environment" : {\n        "browserDetails": {\n            "userAgent": userAgentDE \n        },\n        "_dc": {\n            "language": environmentLanguageDE    \n        }\n      }, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "faxPhone": faxPhoneDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "homeAddress": homeAddressDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "homePhone": homePhoneDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "implementationDetails": implementationDetailsDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n      "mailingAddress": mailingAddressDE,\n      //"marketing": marketingDetailsDE,  // Campaign marketing details. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/campaign-marketing-details\n      "mobilePhone": mobilePhoneDE, \n      "organizations": organizationsArrayDE, // An array of free-form strings that represent the organizations the person is a member of. Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "person": personDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/demographic-details\n      "personalEmail": personalEmailDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/personal-contact-details\n      "segmentList": segmentListArrayDE,\n      "shippingAddress": shippingAddressDE,\n      "shippingAddressPhone": shippingAddressPhoneDE,\n      "userActivityRegion": userActivityRegionDE,\n      "web": {\n          "webPageDetails": {\n              "name": pageNameDE, // v1 in AA.\n              "URL": pageUrlDE, // Full URL including query string\n              "isErrorPage": isErrorPageDE,\n              "isHomePage": isHomePageDE,\n              "server": serverNameDE,\n              "siteSection": siteSectionDE,\n              "viewName": viewNameDE,\n              "_mscom": {\n                  "pageInfo": {\n                      "URLWithoutQS": URLWithoutQsDE, // Custom field. URL with any query string stripped from it. v41 in AA.\n                      "URLQS": URLQsDE, // Custom field. Only the query string value from the URL. "Page URL Query Strings (v16)" in AA.\n                      "prevPageURL": prevPageURLDE, // Custom field. Populated with the URL without a query string for the previous page (if available). May require custom client side code to store this value in a cookie and reference that cookie at each event.\n                      "userAgent": userAgentDE, // Custom field. v44 in AA.\n                      "pageType": pageTypeDE, // Custom field. v13 in AA.\n                      "pageGroup": pageGroupDE, // Custom field. v14 in AA.\n                      "pageTitle": pageTitleDE, // Custom field. v15 in AA.\n                      "msftConsentBannerVisibilityFlag":msftConsentBannerVisibilityFlagDE,\n                      "metaOgTitle":metaOgTitleDE,\n                      "metaOgUrl":metaOgUrlDE,\n                      "metaPageTemplate":metaPageTemplateDE,\n                      "metaDescription":metaDescriptionDE,\n                      "metaAwaCms":metaAwaCmsDE,\n                      "metaAwaMarket":metaAwaMarketDE,\n                      "metaAwaPageType":metaAwaPageTypeDE,\n                      "metaAwaPageTemplate":metaAwaPageTemplateDE,\n                      "metaAwaIsTentedFlag":metaAwaIsTentedFlagDE,\n                      "metaAwaCanvasType":metaAwaCanvasTypeDE  \n                  },\n                  "siteInfo": {\n                      //"language": "siteLanguage", // This is a custom field. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteID": siteIdDE, // This is a custom field. Represents an ID for the site assigned by MSFT or created with logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteBrand": siteBrandDE, // This is a custom field. Represents a brand for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteMarket": siteMarketDE, // This is a custom field. Represents a market (usually aligned with countries, but not always) for the site assigned by MSFT or derived from some custom logic. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteLanguage": siteLanguageDE, // This is a custom field. Represents the language for the site assigned by MSFT or derived from custom logic, possibly scraped from the browser. We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                      "siteLocale": siteLocaleDE // This is a custom field. Represents a combination of the market and language for the site assigned by MSFT or derived from logic (possibly from the url since it includes the locale). We may need to create a field group for something like \'enhanced web page details\' or \'enhanced site details\'\n                  }\n              }\n          },\n          "webInteraction": {\n              "linkClicks": {\n                  //"id": "", // May not be required\n                  //"region": "", // Is this needed if they are using pageArea?\n                  "value": 1\n              },\n              "name": elementName, // Scraped from data-bi-cn attribute\n              "type": elementLinkType,\n              "URL": destinationUrl, // Scraped from href attribute. This is often referred to as destinationURL, but there may be some limitations to how this standard field value can be reported on in AA. If the same problem is found in AEP datasets, we can add a custom destinationURL field.\n              "_mscom": {\n                  //"botFlag": botFlag, // This is a custom field. It will likely require some custom logic in data collection. We may also choose to use https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/event/bot-detection-information\n                  "componentInfo": {\n                      "componentName": componentName, // Custom field. Scraped from data-bi-compnm attribute\n                      "componentType": componentType, // Custom field. Is this needed? Not scraped from page. Would need logic or a lookup table.\n                      "templateName": templateName, // Custom field. Scraped from data-bi-tn attrubute (when available)\n                      "componentView": componentView // Custom field. Scraped from data-bi-view attrubute\n                  },\n                  "containerInfo": {\n                      "containerTitle": containerTitle, // Custom field. Core component would take from "dc:title" attribute.\n                      "containerID": containerID, // Custom field.\n                      "containerType": containerType, // \'Carousel\' or \'Tabs\' or \'Accordion\' or \'Card Grid\' etc.\n                      "containerTitle": containerTitle, // Custom field.\n                      "containerParentId": containerParentId, // Custom field.\n                      "shownItems": shownItemsArray // Custom field. Array of the displayed item IDs\n                  },\n                  "containerItemInfo": {\n                      "containerItemID": containerItemID, // Custom field. Scraped from ID attribute of container item if available.\n                      "containerItemImage": containerItemImage, // Custom field. Scraped from HTML if container item includes an image.\n                      "containerItemTitle": containerItemTitle, // Custom field. Scraped from HTML if container item includes a title.\n                      "containerItemType": containerItemType, // Custom field. Inferred value from custom logic or scraped from HTML.\n                      "slotNumber": containerSlotNumber.toString() // Custom field. Scraped from data-bi-sn attribute\n                  },\n                  "elementInfo": {\n                      "contentType": elementContentType, // Custom field. Scraped from data-bi-ct attribute\n                      "contentName": elementContentName, // Custom field. \n                      "contentNameEn": elementContentNameEn, // Custom field. Scraped from data-bi-ecn attribute\n                      "elementID": elementID, // Custom field. Scraped from id attribute.\n                      "elementCTA": elementCTA, // Custom field. If link is text, the text of the link. If an icon, the icon class or name. If link is an image, the image filename. This will always be in the language rendered on the page.\n                      "elementType": elementType, // Custom field. Friendly version of the element type such as \'button\' or \'link\' or could be more specific like \'text link\' or \'image link\'\n                      "destinationUrl": destinationUrl,\n                      "nodeType": nodeType // Custom field. The HTML node type of the element that was acted on.\n                  },\n                  "hitNumber": eventHitNumber, // Used for Sequence Number\n                  "sectionInfo": {\n                      "headerName": sectionHeaderName, // Custom field. Scraped from data-bi-hn attribute\n                      "headerNameEn":sectionHeaderNameEn, // Custom field. Scraped from data-bi-ehn attribute\n                      "pageArea": sectionPageArea // Custom field. Scraped from data-bi-an attribute. Often referred to as Page Section // Noting that some objects in the tagging spec use a variable called sectionID. Is that different?\n                  }\n              }\n          },\n          //"webReferrer": webReferrerObjDE\n          "webReferrer":{\n            "URL": pageReferrerDE,\n            "type": pageReferrerTypeDE\n          },\n          "_mscom": {\n            "webSession":webSessionDetailsObjDE\n          }\n      },\n      "workAddress": workAddressDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "workEmail": workEmailDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      "workPhone": workPhoneDE, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/work-contact-details\n      //"_id": "", // Not a person ID.\n      "eventMergeId": eventMergeId, // Session ID. Auto-collected by Web SDK.\n      "eventType": eventType,\n      "identityMap": identityMapDE\n      //"producedBy": "",\n      //"segmentMembership": {}, // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/xdm/field-groups/profile/segmentation\n      //"timestamp": "2025-01-22T13:30:31Z", // Reference: https://experienceleague.adobe.com/en/docs/experience-platform/web-sdk/commands/configure/context\n    } //end eventInfo\n  } //end eventpPayloadObj\n  window.adobeDataLayer.push(eventPayloadObj); //end push script\n  \n \n\n  //Set on-the-fly data elements (Click)\n  //--Element Info\n  adobeSatelliteName.setVar("dl_elementID", elementID);\n  //adobeSatelliteName.setVar("elementAnalyticsID", elementAnalyticsID);\n  adobeSatelliteName.setVar("dl_elementType", elementType);\n  adobeSatelliteName.setVar("dl_elementAction", elementAction);\n  adobeSatelliteName.setVar("dl_elementText", elementText);\n  adobeSatelliteName.setVar("dl_elementCTA", elementCTA);\n  adobeSatelliteName.setVar("dl_elementLinkName", elementLinkName);\n  adobeSatelliteName.setVar("dl_elementLinkType", elementLinkType);\n  adobeSatelliteName.setVar("dl_elementVal", elementVal);\n  adobeSatelliteName.setVar("dl_nodeType", nodeType);\n  adobeSatelliteName.setVar("dl_formFieldName", formFieldName);\n  //adobeSatelliteName.setVar("dl_clickDetails", clickDetails);\n  adobeSatelliteName.setVar("dl_destinationUrl", destinationUrl);\n  adobeSatelliteName.setVar("dl_elementContentName", elementContentName);\n  adobeSatelliteName.setVar("dl_elementContentNameEn", elementContentNameEn);\n  adobeSatelliteName.setVar("dl_elementContentType", elementContentType);\n\n  //--Section Info\n  adobeSatelliteName.setVar("dl_pageLocation", pageLocation);\n  adobeSatelliteName.setVar("dl_pageSectionID", pageSectionID);\n  adobeSatelliteName.setVar("dl_pageSection", pageSection);\n  adobeSatelliteName.setVar("dl_headerName", sectionHeaderName);\n  adobeSatelliteName.setVar("dl_headerNameEn", sectionHeaderNameEn);\n  adobeSatelliteName.setVar("dl_pageArea", sectionPageArea);\n  //adobeSatelliteName.setVar("dl_canvasSectionID", canvasSectionID);\n  //adobeSatelliteName.setVar("dl_canvasControlZoneID", canvasControlZoneID);\n  //adobeSatelliteName.setVar("dl_viewportID", viewportID);\n  //adobeSatelliteName.setVar("dl_webPartID", webPartID);\n  //adobeSatelliteName.setVar("dl_spFeatureTag", spFeatureTag);\n\n  //--Component Info\n  adobeSatelliteName.setVar("dl_componentName", componentName);\n  adobeSatelliteName.setVar("dl_componentType", componentType);\n  adobeSatelliteName.setVar("dl_componentView", componentView);\n  adobeSatelliteName.setVar("dl_templateName", templateName);\n\n  //--Container Info\n  adobeSatelliteName.setVar("dl_containerID", containerID);\n  adobeSatelliteName.setVar("dl_containerParentId", containerParentId);\n  adobeSatelliteName.setVar("dl_containerTitle", containerTitle);\n  adobeSatelliteName.setVar("dl_containerType", containerType);\n\n  //--Container Item Info\n  adobeSatelliteName.setVar("dl_containerItemID", containerItemID);\n  adobeSatelliteName.setVar("dl_containerItemImage", containerItemImage);\n  adobeSatelliteName.setVar("dl_containerItemTitle", containerItemTitle);\n  adobeSatelliteName.setVar("dl_containerItemType", containerItemType);\n  adobeSatelliteName.setVar("dl_slotNumber", containerSlotNumber.toString());\n\n  //--Form Info\n  adobeSatelliteName.setVar("dl_formFriendlyName", formFriendlyName);\n  adobeSatelliteName.setVar("dl_formDetails", formDetails);\n  adobeSatelliteName.setVar("dl_formID", formID);\n  adobeSatelliteName.setVar("dl_formName", formName);\n\n  //--Video Info\n  adobeSatelliteName.setVar("dl_videoID", videoID);\n\n  //--Event Info\n  adobeSatelliteName.setVar("dl_eventName", eventName);\n  adobeSatelliteName.setVar("dl_eventDataName", eventDataName);\n  adobeSatelliteName.setVar("dl_eventActionType", eventActionType);\n  adobeSatelliteName.setVar("dl_eventBehaviorID", eventBehaviorID);\n  adobeSatelliteName.setVar("dl_eventCategory", eventCategory);\n  adobeSatelliteName.setVar("dl_eventBehaviorCategory", eventBehaviorCategory);\n  adobeSatelliteName.setVar("dl_hitNumber", eventHitNumber);\n\n  //--Product Info\n  //adobeSatelliteName.setVar("dl_storeID", storeID);\n  adobeSatelliteName.setVar("dl_productCategory", productCategory);\n  adobeSatelliteName.setVar("dl_productName", productName);\n  //adobeSatelliteName.setVar("dl_rewardCategory", rewardCategory);\n  //adobeSatelliteName.setVar("dl_rewardName", rewardName);\n\n  //--Search Info\n  adobeSatelliteName.setVar("dl_searchTerm", searchTerm);\n  adobeSatelliteName.setVar("dl_searchResultsTotal", searchResultsTotal);\n  adobeSatelliteName.setVar("dl_searchTriggerFlag", searchTriggerFlag);\n  adobeSatelliteName.setVar("dl_searchResultsPageNumber", searchResultsPageNumber);\n  adobeSatelliteName.setVar("dl_searchResultIndex", searchResultIndex);\n  //adobeSatelliteName.setVar("eventPayloadObj", eventPayloadObj);\n\n  //Send analyticsTrigger Event\n  var analyticsBeaconTrigger = new CustomEvent(\'Analytics Beacon Trigger\', { \'detail\': eventPayloadObj })\n  window.dispatchEvent(analyticsBeaconTrigger);\n  console.log(\'Analytics Beacon Trigger (Click) Event Dispatched!\');\n\n  //console.log(\'Analytics Beacon Trigger Event Dispatched!\');\n  //Send Internal Search Initiated for MS Search Box Field changes\n  if (eventName == "Change") {\n    if (\n      (element.closest(".ms-SearchBox-field") !== null)\n      //|| (element.closest(\'[type="search"]\') !== null)\n    ) {\n      var a_InternalSearchInitTrigger = new CustomEvent(\'Internal Search Submitted\', { \'detail\': eventPayloadObj });\n      window.dispatchEvent(a_InternalSearchInitTrigger);\n      console.log(\'Internal Search Submitted (Change) Event Dispatched!\');\n    }\n  }\n\n  //Conditionally dispatch Download Initiated\n  if (eventName == "Click") {\n    //Send Download Initiated event on download links clicks\n    if (elementLinkName == "Download Link") {\n      var a_DownloadInitTrigger = new CustomEvent(\'Download Initiated\', { \'detail\': eventPayloadObj });\n      window.dispatchEvent(a_DownloadInitTrigger);\n      console.log(\'Download Initiated Event Dispatched!\');\n    }\n    //Send Internal Search Initiated for search submit button clicks\n    if (searchTriggerFlag == "1") {\n      var a_InternalSearchInitTrigger = new CustomEvent(\'Internal Search Submitted\', { \'detail\': eventPayloadObj });\n      window.dispatchEvent(a_InternalSearchInitTrigger);\n      console.log(\'Internal Search Submitted (Click Button without a href) Event Dispatched!\');\n    }\n\n    //Send Internal Search Pagination Nav Trigger when paginated search results are navigated through\n    if (element.closest(\'.pagination__button,.pagination__page-button\') !== null) {\n      var a_InternalSearchPaginationNavTrigger = new CustomEvent(\'Internal Search Pagination Nav Trigger\', { \'detail\': eventPayloadObj });\n      window.dispatchEvent(a_InternalSearchPaginationNavTrigger);\n      console.log(\'Internal Search Pagination Nav Trigger Dispatched!\');\n    }\n\n  }\n  //Send Internal Search Initiated for search submit input enter key presses\n  /*\n  console.log("Enter Key Pressed?: "+enterKeyPressFlag);\n  if (eventName == "Click") {\n    if (\n        (element.closest(\'form[role="search"]\') !== null)\n        && (element.closest(\'input[role="combobox"]\') !== null)\n        && (enterKeyPressFlag == "Y")\n    ) {\n        var a_InternalSearchInitTrigger = new CustomEvent(\'Internal Search Submitted\',{\'detail\':eventPayloadObj});\n        window.dispatchEvent(a_InternalSearchInitTrigger);\n        console.log(\'Internal Search Submitted Event Dispatched!\');\n    }\n  }\n  */\n  //console.log(eventInfo);\n  adobeSatelliteName.logger.log(eventPayloadObj);\n}\n//return true;',
language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL9573716e658b43dc99d72f3961b8eada",name:"All Pages (Site Consent Found Trigger) - Page View - Push to ACDL",events:[{modulePath:"core/src/lib/events/customEvent.js",settings:{type:"Site Consent Found Trigger",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:20},{modulePath:"core/src/lib/events/customEvent.js",settings:{type:"Site Consent Timeout Trigger",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return-1!=adobeSatelliteName.getVar("ACDL - URL").indexOf("/microsoft-365")&&(a_incrementHitNumber(),a_incrementPageView(),!0)}},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"https://assets.adobedtm.com/5ef092d1efb5/d6d76b37b476/3478c350b630/RCd2aa0d0acb114581af5f1fa172bb91ac-source.min.js",language:"javascript",isExternal:!0},timeout:2e3,delayNext:!0}]},{id:"RLbdd1e8f61a8e494bb93a021c1eebeca3",name:"Page Experience (Library Loaded (Page Top)) \u2013 Setup Initial Data Layer Values, Global Functions, Event Listeners",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:1}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){var e=window._satellite;return void 0!==window._satellite&&null!==window._satellite?e=window._satellite:void 0!==window._satellite2&&null!==window._satellite2&&(e=window._satellite2,void 0!==window._satellite&&null!=window._satellite||(window._satellite=window._satellite2)),window.adobeSatelliteName=e,console.log("_satellite typeof:"+typeof window._satellite),console.log("_satellite2 typeof:"+typeof window._satellite2),-1!=e.getVar("ACDL - URL").indexOf("/microsoft-365")}},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"window.__alloyMonitors = window.__alloyMonitors || [];\nwindow.rypayloads = [];\nwindow.__alloyMonitors.push({\n    onNetworkResponse(data) {\n        window.rypayloads.push(data.payload);\n    }\n});",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'if (alloy) {\n  alloy("getIdentity")\n    .then(function(result) {\n      adobeSatelliteName.setVar("ECID", result.identity.ECID);\n  });\n}\n\n/*\n//Commenting this out until we have approval for the location consent banner. The code does work.\n\nfunction a_getGeoCoordinates() {\n\xa0\xa0\xa0 return new Promise((resolve, reject) => {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 if (navigator.geolocation) {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 navigator.geolocation.getCurrentPosition(function(result) {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 var geoLatitude = result.coords.latitude;\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 var geoLongitude = result.coords.longitude;\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 var returnObj = {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "position": {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "coords": {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "latitude": geoLatitude,\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "longitude": geoLongitude\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 };\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 resolve(returnObj);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }, function(error) {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 console.error("Error getting geolocation: ", error);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 reject(error);\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 });\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 } else {\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 console.error("Geolocation is not supported by this browser.");\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 reject(new Error("Geolocation is not supported by this browser."));\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 }\n\xa0\xa0\xa0 });\n}\n\n//Get coordinates and wait for response then set OTF vars\na_getGeoCoordinates().then(function(returnObj) {\n    adobeSatelliteName.setVar("latitude", returnObj.position.coords.latitude);\n    adobeSatelliteName.setVar("longitude", returnObj.position.coords.longitude);\n    //console.log("Geolocation data:", returnObj);\n}).catch(function(error) {\n\xa0\xa0\xa0 console.error("Failed to get geolocation:", error);\n});\n*/\n',language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"//Backup before merging Elisa's changeds from 2025/05/02\n// Setup Global Functions\n// Execute Globally should be checked\n\nvar adobeSatelliteName = window.adobeSatelliteName;\n//var adobeSatelliteName = window._satellite;\n//var adobeSatelliteName = window._satellite2;\n\nif (typeof window._satellite !== 'undefined' && window._satellite !== null) {\n  adobeSatelliteName = window._satellite;\n} else if (typeof window._satellite2 !== 'undefined' && window._satellite2 !== null) {\n  adobeSatelliteName = window._satellite2;\n  //window._satellite = window._satellite2;\n  if (typeof window._satellite == 'undefined' || window._satellite == null) {\n    window._satellite = window._satellite2;\n  }\n}\n\n/***Video Tracking***/\n//Helper method to clean a video ID value so it has a path that is readable by ACDL\n\nfunction cleanVideoSRC(item) {\n  // Remove the '//' after the protocol\n  let cleanedItem = item.replace('//', '');\n  // Replace all remaining '/' with '_'\n  cleanedItem = cleanedItem.replace(/\\//g, ':');\n  return cleanedItem;\n}\n  \n\n//Function to loop through an array of ump objects and add video action event listeners for each one\nfunction a_setVideoEventListeners(item,index) {\n  var umpShadowHost = item;\n\n  /***Universal Media Player Details***/\n\n  //UMP ID | Scraped from umpid attribute\n  var umpid = umpShadowHost.getAttribute('umpid');\n\n  //UMP Options | Scraped from options attribute\n  var umpOptions = umpShadowHost.getAttribute('options');\n  //Parse UMP options attribute\n  var umpOptionsJSON = JSON.parse(umpOptions);\n\n  //Get Shadow Root for UMP\n  var umpShadowRoot = umpShadowHost.shadowRoot;\n\n  /***Video Interaction Details***/\n\n  //Get video element in the shadow root\n  var videoElement = umpShadowRoot.querySelector('video');\n\n  //--Video Player Title\n  var videoPlayerTitle;\n  if (umpOptionsJSON.title) {\n    videoPlayerTitle = umpOptionsJSON.title\n  }\n\n  //--Video Source\n  var videoSrc;\n  if (videoElement.currentSrc !== undefined) {\n    videoSrc = videoElement.currentSrc;\n  }\n\n  //--Video Name | data-bi-vidnm | vidnm | v11 / c11\n  var videoName;\n  if (videoElement.closest('*[data-bi-vidnm]')) {\n    videoName = element.closest(\"*[data-bi-vidnm]\").getAttribute(\"data-bi-vidnm\");\n  }\n\n  //--Video ID | data-bi-vidid | vidid | v11 (Duplicate? It is labeled this way in the martech portal)\n  var videoID;\n  if (videoElement.closest('*[data-bi-vidid]')) {\n    videoID = element.closest(\"*[data-bi-vidid]\").getAttribute(\"data-bi-vidid\");\n  }\n\n  //--Video Percentage Complete | data-bi-vidpct | vidpct | v12\n  var videoPctComplete;\n  if (videoElement.closest('*[data-bi-vidpct]')) {\n    videoPctComplete = element.closest(\"*[data-bi-vidpct]\").getAttribute(\"data-bi-vidpct\");\n  }\n\n  //--Video Watchtime | data-bi-vidwt | vidwt | v131\n  var videoWatchTime;\n  if (videoElement.closest('*[data-bi-vidwt]')) {\n    videoWatchTime = element.closest(\"*[data-bi-vidwt]\").getAttribute(\"data-bi-vidwt\");\n  }\n\n  //--Video Duration | data-bi-viddur | viddur | v131 (Duplicate? It is labeled this way in the martech portal)\n  var videoDuration;\n  if (videoElement.closest('*[data-bi-viddur]')) {\n    videoDuration = element.closest(\"*[data-bi-viddur]\").getAttribute(\"data-bi-viddur\");\n  }\n\n  //Registers the video component object into adobeDataLayer\n  var eventName = \"videoPlayerRegistered\";\n  var componentID = \"videoPlayer_\"+cleanVideoSRC(videoElement.currentSrc);\n  var componentPath = \"component.\"+componentID;\n  var componentDetails = {\n    \"@type\":\"components/universal-media-player/video\",\n    \"videoDetails\": videoElement,\n    \"videoPlayerDetails\": {\n      \"umpid\":umpid,\n      \"umpOptions\":umpOptionsJSON\n    }\n  };\n  /*\n  var videosArrayDL = window.adobeDataLayer.getSate('video');\n  if (videosArrayDL.length == 0) {\n    videosArrayDL = [];\n  }\n  videosArrayDL.push(componentDetails);\n */\n  var videoComponentRegisterPayload = {\n      \"event\": eventName,\n      //\"path\": componentPath,\n      //\"video\": videosArrayDL\n      \"component\":{\n        [componentID]:componentDetails\n      }\n  }\n  window.adobeDataLayer.push(videoComponentRegisterPayload);\n\n\n  /***Events to listen for***/\n\n  //--Video Start | Behavior Category: Video | Behavior ID: 240 | awa.behavior.VIDEOSTART | e11\n  //Add event listener to videoElement for play event\n  videoElement.addEventListener(\"play\", (e) => {\n      console.log('Video Play Triggered');\n      var eventName = \"videoPlay\";\n      var behaviorCategory = \"Video\";\n      var behaviorID = \"240\";\n      var componentPath = \"component.videoPlayer_\"+cleanVideoSRC(videoElement.currentSrc);\n      var videoInteractionPayload = {\n          \"event\": eventName,\n          \"videoInteractionDetails\": {\n            \"videoDetails\": videoElement,\n            /*\n            \"video\": {\n                \"name\": videoElement.currentSrc,\n                \"time\": videoElement.currentTime,\n                \"duration\": videoElement.duration\n            },\n            */\n            \"videoPlayerDetails\": {\n                \"umpid\":umpid,\n                \"umpOptions\":umpOptionsJSON\n            },\n            \"behaviorDetails\": {\n              \"behaviorCategory\": behaviorCategory,\n              \"behaviorID\": behaviorID\n            }\n          } //end videoInteractionDetails\n      }\n      setAdobeDataLayer(eventName,componentPath,videoInteractionPayload);\n  });\n\n\n\n  //--Video Pause | Behavior Category: Video | Behavior ID: 241 | awa.behavior.VIDEOPAUSE | e12\n  //Add event listener to videoElement for play event\n  videoElement.addEventListener(\"pause\", (e) => {\n    console.log('Video Pause Triggered');\n    var eventName = \"videoPause\";\n    var behaviorCategory = \"Video\";\n    var behaviorID = \"241\";\n    var componentPath = \"component.videoPlayer_\"+cleanVideoSRC(videoElement.currentSrc);\n    var videoInteractionPayload = {\n        \"event\": eventName,\n        \"videoInteractionDetails\": {\n          \"videoDetails\": videoElement,\n          /*\n          \"video\": {\n              \"name\": videoElement.currentSrc,\n              \"time\": videoElement.currentTime,\n              \"duration\": videoElement.duration\n          },\n          */\n          \"videoPlayerDetails\": {\n              \"umpid\":umpid,\n              \"umpOptions\":umpOptionsJSON\n          },\n          \"behaviorDetails\": {\n            \"behaviorCategory\": behaviorCategory,\n            \"behaviorID\": behaviorID\n          }\n        }\n    }\n    setAdobeDataLayer(eventName,componentPath,videoInteractionPayload);\n  });\n\n  //--Video Continue | Behavior Category: Video | Behavior ID: 242 | awa.behavior.VIDEOCONTINUE | e13\n  //Resume\n  videoElement.addEventListener(\"resume\", (e) => {\n    console.log('Video Resume Triggered');\n    var eventName = \"videoResume\";\n    var behaviorCategory = \"Video\";\n    var behaviorID = \"242\";\n    var componentPath = \"component.videoPlayer_\"+cleanVideoSRC(videoElement.currentSrc);\n    var videoInteractionPayload = {\n        \"event\": eventName,\n        \"videoInteractionDetails\": {\n          \"videoDetails\": videoElement,\n          /*\n          \"video\": {\n              \"name\": videoElement.currentSrc,\n              \"time\": videoElement.currentTime,\n              \"duration\": videoElement.duration\n          },\n          */\n          \"videoPlayerDetails\": {\n              \"umpid\":umpid,\n              \"umpOptions\":umpOptionsJSON\n          },\n          \"behaviorDetails\": {\n            \"behaviorCategory\": behaviorCategory,\n            \"behaviorID\": behaviorID\n          }\n        }\n    }\n    setAdobeDataLayer(eventName,componentPath,videoInteractionPayload);\n  });\n  \n  //--Video Checkpoint | Behavior Category: Video | Behavior ID: 243 | awa.behavior.VIDEOCHECKPOINT\n\n  //--Video Jump | Behavior Category: Video | Behavior ID: 244 | awa.behavior.VIDEOJUMP | e14\n\n  //--Video Complete | Behavior Category: Video | Behavior ID: 245 | awa.behavior.VIDEOCOMPLETE | e15\n\n  //--Video Buffering | Behavior Category: Video | Behavior ID: 246 | awa.behavior.VIDEOBUFFERING\n\n  //--Video Error | Behavior Category: Video | Behavior ID: 247 | awa.behavior.VIDEOERROR\n\n  //--Video Mute | Behavior Category: Video | Behavior ID: 248 | awa.behavior.VIDEOMUTE\t\n\n  //--Video Unmute | Behavior Category: Video | Behavior ID: 249 | awa.behavior.VIDEOUNMUTE\n\n  //--Video Full Screen | Behavior Category: Video | Behavior ID: 250 | awa.behavior.VIDEOFULLSCREEN\t\n\n  //--Video Un-full Screen | Behavior Category: Video | Behavior ID: 251 | awa.behavior.VIDEOUNFULLSCREEN\t\n\n  //--Video Replay | Behavior Category: Video | Behavior ID: 252 | awa.behavior.VIDEOREPLAY\t\n\n  //--Video Player Load | Behavior Category: Video | Behavior ID: 253 | awa.behavior.VIDEOPLAYERLOAD\n}\n\n//Function to create an array of all universal-media-player objects\nfunction a_getAndSetUmpEventListeners() {\n  var umpShadowHostNodeListRaw = document.querySelectorAll('universal-media-player');\n  var umpShadowHostArray = Array.from(umpShadowHostNodeListRaw);\n  umpShadowHostArray.forEach(a_setVideoEventListeners);\n  //var umpShadowHostArrayStr = umpShadowHostArray.toString();\n  var eventName = \"UMP Event Listeners Set\";\n  var eventPayloadObj = {\n      \"event\":eventName,\n      \"eventInfo\": {\n          \"mediaPlayers\":umpShadowHostArray\n      }\n  }\n  window.adobeDataLayer.push(eventPayloadObj);\n}\n//Call a_getAndSetUmpEventListeners() on page load event end trigger to ensure video players have loaded in\nwindow.addEventListener('Page Load Event End Trigger',a_getAndSetUmpEventListeners);\n\n//Function to get and set the last viewed url in localStorage\nfunction a_getAndSetLastViewedUrl(){\n    var a_profileCurrentUrl = location.href;\n    var a_profileLastViewedUrl;\n    //If local storage has a value, set the js and datalayer variable value\n    if (typeof(localStorage.getItem(\"a_profileLastViewedUrl\")) != undefined) {\n        a_profileLastViewedUrl = localStorage.getItem(\"a_profileLastViewedUrl\");\n        if (typeof(window.adobeDataLayer) != undefined) {\n            if (typeof(window.adobeDataLayer.getState('visitorProfile')) != undefined) {\n                var eventPayloadObj = {\n                    \"event\":\"visitorProfile:change\",\n                      \"visitorProfile\":{\n                          \"profileLastViewedUrl\":a_profileLastViewedUrl,\n                      } //end visitorProfile\n                  } //end eventpPayloadObj\n                  window.adobeDataLayer.push(eventPayloadObj); //end push script\n            }\n        }\n    }\n    //Set the local storage to the current url\n    localStorage.setItem(\"a_profileLastViewedUrl\",a_profileCurrentUrl);\n} \na_getAndSetLastViewedUrl()\n\n//Function to parse pageLoadTime into ranges\nfunction getPageLoadTimeRange(time) {\n  if (time < 0) {\n    return 'invalid pageLoadTime (negative number)';\n  } else if (time == 0) {\n    return 'more than 10 seconds'; //This is because the timeout for polling the load event end is set to 10 seconds\n  } else if (time > 0 && time < 1000) {\n    return 'less than 1 second';\n  } else if (time <= 2000) {\n    return '1-2 seconds';\n  } else if (time <= 3000) {\n    return '2-3 seconds';\n  } else if (time <= 4000) {\n    return '3-4 seconds';\n  } else if (time <= 5000) {\n    return '4-5 seconds';\n  } else if (time <= 6000) {\n    return '5-6 seconds';\n  } else if (time <= 7000) {\n    return '6-7 seconds';\n  } else if (time <= 8000) {\n    return '7-8 seconds';\n  } else if (time <= 9000) {\n    return '8-9 seconds';\n  } else if (time <= 10000) {\n    return '9-10 seconds';\n  } else {\n    return 'more than 10 seconds';\n  }\n}\n\n//Function to get page load time\nfunction checkLoadEventEnd() {\n  var maxPollingTime = 10000; // 10 seconds\n  var startTime = Date.now();\n  var pageLoadTime;\n  var pageLoadTimeRange;\n  var performanceTiming = window.performance.timing;\n  if (performanceTiming.loadEventEnd > 0) {\n      pageLoadTime = performanceTiming.loadEventEnd - performanceTiming.navigationStart;\n      //if (pageLoadTime < 0) {\n      //  pageLoadTime = -1;\n      //}\n      pageLoadTimeRange = getPageLoadTimeRange(pageLoadTime);\n      //console.log('Page Load Time: ' + pageLoadTime + ' ms');\n      adobeSatelliteName.setVar('dl_pageLoadTime',pageLoadTime);\n      adobeSatelliteName.setVar('dl_pageLoadTimeRange',pageLoadTimeRange);\n      var eventPayloadObj = {\n        \"event\": \"Page Load Event Trigger\",\n        \"eventInfo\": {\n          \"eventTimestamp\":Date.now(),\n          \"pageLoadTime\":pageLoadTime,\n          \"pageLoadTimeRange\":pageLoadTimeRange\n        }\n      }\n      var a_pageLoadEventEndTrigger = new CustomEvent('Page Load Event End Trigger', { 'detail': eventPayloadObj });\n      window.adobeDataLayer.push(eventPayloadObj);\n      window.dispatchEvent(a_pageLoadEventEndTrigger);\n      console.log('Page Load Event End Trigger Dispatched!');\n  } else if (Date.now() - startTime < maxPollingTime) {\n      setTimeout(checkLoadEventEnd, 10); // Poll every 10 milliseconds\n  } else {\n      console.log('Failed to retrieve loadEventEnd within 10 seconds.');\n      pageLoadTime = 0;\n      pageLoadTimeRange = getPageLoadTimeRange(pageLoadTime);\n      //console.log('Page Load Time: ' + pageLoadTime + ' ms');\n      adobeSatelliteName.setVar('dl_pageLoadTime',pageLoadTime);\n      adobeSatelliteName.setVar('dl_pageLoadTimeRange',pageLoadTimeRange);\n      var eventPayloadObj = {\n        \"event\": \"Page Load Event Trigger\",\n        \"eventInfo\": {\n          \"eventTimestamp\":Date.now(),\n          \"pageLoadTime\":pageLoadTime,\n          \"pageLoadTimeRange\":pageLoadTimeRange\n        }\n      }\n      var a_pageLoadEventEndTrigger = new CustomEvent('Page Load Event End Trigger', { 'detail': eventPayloadObj });\n     window.adobeDataLayer.push(eventPayloadObj);\n      window.dispatchEvent(a_pageLoadEventEndTrigger);\n      console.log('Page Load Event End Trigger Dispatched!');\n  }\n}\n\n//Function to check if siteConsent object is avialable\nfunction checkForSiteConsent() {\n  var maxPollingTime = 5000; // 5 seconds\n  var startTime = Date.now();\n  var siteConsentApiObjectFlagDE = adobeSatelliteName.getVar(\"ACDL - Consent API Object Flag\");\n  //var siteConsentObjFlag = false;\n  //if (window.siteConsent !== undefined) {\n  if (siteConsentApiObjectFlagDE == true) {\n      //siteConsentObjFlag = true;\n      //adobeSatelliteName.setVar('siteConsentObjFlag',siteConsentObjFlag);\n      var eventPayloadObj = {\n        \"event\": \"Site Consent Found Trigger\",\n        \"eventInfo\": {\n          \"eventTimestamp\":Date.now(),\n          //\"siteConsentObjFlag\":siteConsentObjFlag\n          \"siteConsentApiObjFlag\":siteConsentApiObjectFlagDE\n        }\n      }\n      var a_siteConsentFoundTrigger = new CustomEvent('Site Consent Found Trigger', { 'detail': eventPayloadObj });\n     window.adobeDataLayer.push(eventPayloadObj);\n      window.dispatchEvent(a_siteConsentFoundTrigger);\n      console.log('Site Consent Found Trigger Dispatched!');\n  } else if (Date.now() - startTime < maxPollingTime) {\n      setTimeout(checkForSiteConsent, 10); // Poll every 10 milliseconds\n  } else {\n      console.log('Failed to retrieve siteConsent within 5 seconds.');\n      //adobeSatelliteName.setVar('siteConsentObjFlag',siteConsentObjFlag);\n      var eventPayloadObj = {\n        \"event\": \"Site Consent Timeout Trigger\",\n        \"eventInfo\": {\n          \"eventTimestamp\":Date.now(),\n          //\"siteConsentObjFlag\":siteConsentObjFlag\n          \"siteConsentApiObjFlag\":siteConsentApiObjFlagDE\n        }\n      }\n      var a_siteConsentTimeoutTrigger = new CustomEvent('Site Consent Timeout Trigger', { 'detail': eventPayloadObj });\n      window.adobeDataLayer.push(eventPayloadObj);\n      window.dispatchEvent(a_siteConsentTimeoutTrigger);\n      console.log('Site Consent Timeout Trigger Dispatched!');\n  }\n}\n\n\n//Add event listeners\n\n//--Event listener to get page load time.\nwindow.addEventListener('load', checkLoadEventEnd);\n\n//--Event Listener to wait for siteConsent\nwindow.addEventListener('Page Load Event End Trigger', checkForSiteConsent);\n\n\n\n//Function to reset the event-level on-the-fly (OTF) variables\nfunction a_resetOtfVars() {\n  //Element Info\n\n  //Web Session\n  adobeSatelliteName.setVar(\"dl_entryReferrer\", undefined);\n  adobeSatelliteName.setVar(\"dl_entryUrl\", undefined);\n  adobeSatelliteName.setVar(\"dl_sessionID\", undefined);\n\n  //Marketing\n  adobeSatelliteName.setVar(\"dl_ocidTrackingCode\", undefined);\n  adobeSatelliteName.setVar(\"dl_icidTrackingCode\", undefined);\n\n  //Element Info\n  //adobeSatelliteName.setVar(\"dl_elementAnalyticsID\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementContentName\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementContentNameEn\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementContentType\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementID\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementType\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementAction\",  undefined);\n  adobeSatelliteName.setVar(\"dl_elementText\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementCTA\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementLinkName\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementLinkType\", undefined);\n  adobeSatelliteName.setVar(\"dl_elementVal\", undefined);\n  adobeSatelliteName.setVar(\"dl_nodeType\", undefined);\n  adobeSatelliteName.setVar(\"dl_formFieldName\", undefined);\n  adobeSatelliteName.setVar(\"dl_destinationUrl\", undefined);\n  adobeSatelliteName.setVar(\"dl_clickUUID\", undefined);\n\n  //Component Info\n  adobeSatelliteName.setVar(\"dl_componentName\", undefined);\n  adobeSatelliteName.setVar(\"dl_componentType\", undefined);\n  adobeSatelliteName.setVar(\"dl_componentView\", undefined);\n  adobeSatelliteName.setVar(\"dl_templateName\", undefined);\n \n  //Container Info\n  adobeSatelliteName.setVar(\"dl_containerID\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerParentId\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerTitle\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerType\", undefined);\n\n  //Container Item Info\n  adobeSatelliteName.setVar(\"dl_containerItemID\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerItemImage\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerItemTitle\", undefined);\n  adobeSatelliteName.setVar(\"dl_containerItemType\", undefined);\n  adobeSatelliteName.setVar(\"dl_slotNumber\", undefined);\n\n  //Section Info\n  adobeSatelliteName.setVar(\"dl_pageLocation\", undefined);\n  adobeSatelliteName.setVar(\"dl_pageSectionID\", undefined);\n  adobeSatelliteName.setVar(\"dl_pageSection\", undefined);\n  adobeSatelliteName.setVar(\"dl_headerName\", undefined);\n  adobeSatelliteName.setVar(\"dl_headerNameEn\", undefined);\n  adobeSatelliteName.setVar(\"dl_pageArea\", undefined);\n  //adobeSatelliteName.setVar(\"dl_canvasSectionID\", undefined);\n  //adobeSatelliteName.setVar(\"dl_canvasControlZoneID\", undefined);\n  //adobeSatelliteName.setVar(\"dl_viewportID\", undefined);\n  //adobeSatelliteName.setVar(\"dl_webPartID\", undefined);\n  //adobeSatelliteName.setVar(\"dl_spFeatureTag\", undefined);\n\n  //Form Info\n  adobeSatelliteName.setVar(\"dl_formFriendlyName\", undefined);\n  adobeSatelliteName.setVar(\"dl_formDetails\", undefined);\n  adobeSatelliteName.setVar(\"dl_formID\", undefined);\n  adobeSatelliteName.setVar(\"dl_formName\", undefined);\n\n  //Video Info\n  adobeSatelliteName.setVar(\"dl_videoID\", undefined);\n\n  //Page Info\n  adobeSatelliteName.setVar(\"dl_errorPageFlag\", undefined);\n  adobeSatelliteName.setVar(\"dl_urlQS\", undefined);\n  adobeSatelliteName.setVar(\"dl_urlWithoutQS\", undefined);\n  adobeSatelliteName.setVar(\"dl_pageName\", undefined);\n\n  //Site Info\n  adobeSatelliteName.setVar(\"dl_siteBrand\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteDomain\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteID\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteLanguage\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteLocale\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteMarket\", undefined);\n  adobeSatelliteName.setVar(\"dl_siteName\", undefined);\n\n  //Event Info\n  adobeSatelliteName.setVar(\"dl_eventName\", undefined);\n  adobeSatelliteName.setVar(\"dl_eventDataName\", undefined);\n  adobeSatelliteName.setVar(\"dl_eventCategory\", undefined);\n  adobeSatelliteName.setVar(\"dl_eventBehaviorCategory\", undefined);\n  adobeSatelliteName.setVar(\"dl_eventActionType\", undefined);\n  adobeSatelliteName.setVar(\"dl_eventBehaviorID\", undefined);\n  adobeSatelliteName.setVar(\"dl_hitNumber\", undefined);\n\n  //Product Info\n  //adobeSatelliteName.setVar(\"dl_storeID\", undefined);\n  adobeSatelliteName.setVar(\"dl_productCategory\", undefined);\n  adobeSatelliteName.setVar(\"dl_productName\", undefined);\n  //adobeSatelliteName.setVar(\"dl_rewardCategory\", undefined);\n  //adobeSatelliteName.setVar(\"dl_rewardName\", undefined);\n \n  //--Search Info\n  adobeSatelliteName.setVar(\"dl_searchTerm\", undefined);\n  adobeSatelliteName.setVar(\"dl_searchResultsTotal\", undefined);\n  adobeSatelliteName.setVar(\"dl_searchTriggerFlag\", undefined);\n  adobeSatelliteName.setVar(\"dl_searchResultsPageNumber\", undefined);\n  adobeSatelliteName.setVar(\"dl_searchResultIndex\", undefined);\n\n  //--Environment\n  adobeSatelliteName.setVar(\"dl_environmentLanguage\", undefined);\n\n  //Place Context\n  adobeSatelliteName.setVar(\"dl_countryCode\", undefined);\n}\n\n//Function to push pageView event into the ACDL.\nfunction a_incrementPageView() {\n  var pv_eventName = \"pageView\";\n  setAdobeDataLayer(pv_eventName);\n  //console.log('Page View Pushed to ACDL');\n}\n\n//Function to set the page view flag for use in suppressing double-firing\nfunction a_setPageViewFlag() {\n  //Set eventPayload and push it to the events array in the data layer\n  var pageIDDE = adobeSatelliteName.getVar('ACDL - Page ID');\n  var eventPayloadObj = {\n    \"event\":\"cmp:page-view-flag\",\n    \"page\":{\n      [pageIDDE]:{\n        \"msftPageViewFlag\":1\n      }\n    }\n  } //end eventpPayloadObj\n  window.adobeDataLayer.push(eventPayloadObj); //end push script\n}\n\n// Generate and store session ID and hit number if it doesn't exist\nfunction a_generateWebSessionDetails(hitNumberPassed) {\n  var sessionID = a_generateSessionID();\n  var hitNumber = 0;\n  if (hitNumberPassed !== undefined) {\n    hitNumber = hitNumberPassed;\n  }\n  var entryUrl = adobeSatelliteName.getVar('ACDL - URL');\n  var entryUrlQS = adobeSatelliteName.getVar('ACDL - URLQS');\n  var entryReferrer = document.referrer;\n  var entryReferrerTypeDetails = a_getReferrerType(entryReferrer);\n  var entryCampaignDetails = {\n    \"entry__ocid\": adobeSatelliteName.getVar('ACDL - OCID'),\n    \"entry__icid\": adobeSatelliteName.getVar('ACDL - ICID (Internal Campaign ID)'),\n    \"entry__wt.mc_id\": adobeSatelliteName.getVar('QSP - wt.mc_id'),\n    \"entry__cm_mmc\": adobeSatelliteName.getVar('QSP - cm_mmc'),\n    \"entry__cr_cc\": adobeSatelliteName.getVar('QSP - cr_cc'),\n    \"entry__sc_id\": adobeSatelliteName.getVar('QSP - sc_id')\n  };\n  var entryTrafficDetails = a_getTrafficDetails(entryUrl,entryReferrerTypeDetails);\n  //var webSessionDetailsStr = JSON.stringify({ sessionID, hitNumber });\n  var webSessionDetailsStr = JSON.stringify({ sessionID, hitNumber, entryUrl, entryUrlQS, entryReferrer, entryReferrerTypeDetails, entryTrafficDetails, entryCampaignDetails });\n  //var webSessionDetailsStr = JSON.stringify({ entryUrl, entryReferrer });\n  var webSessionCookieDetailsStr = JSON.stringify({ sessionID, hitNumber });\n  //console.log(\"Web Session Details: \");\n  //console.log(webSessionDetailsStr);\n  setCookie('webSessionDetails', webSessionCookieDetailsStr, 30); // Set cookie to expire in 30 minutes\n  localStorage.setItem('webSessionDetails', webSessionDetailsStr);\n}\n\n// Function to generate a unique session ID using MC1 cookie GUID and Unix timestamp\nfunction a_generateSessionID() {\n  const mc1GUID = adobeSatelliteName.getVar('ACDL - MC1 GUID');\n  if (mc1GUID) {\n      const guid = mc1GUID.split('|')[0]; // Assuming GUID is the first part of the MC1 cookie value\n      const timestamp = Date.now(); // Unix timestamp in milliseconds\n      //console.log(`${guid}_${timestamp}`);\n      return `${guid}_${timestamp}`;\n  } else {\n      const randomNum = Math.floor(Math.random() * 1000); // Generate a random number\n      const timestamp = Date.now(); // Unix timestamp in milliseconds\n      //console.log(`no-guid-${randomNum}_${timestamp}`);\n      return `no-guid-${randomNum}_${timestamp}`; // Fallback session ID\n  }\n}\n\n//Function to increment hitNumber, called in pre-processing rules or when setting the send event vars in the handler rules\n/*\nfunction a_incrementHitNumber() {\n  var hitNumber = 0;\n  if (sessionStorage) {\n    var storedHitNumber = sessionStorage.getItem('hitNumber');\n    if (storedHitNumber !== undefined && storedHitNumber !== null && !isNaN(storedHitNumber)) {\n      hitNumber = parseInt(storedHitNumber);\n    }\n  }\n  hitNumber++;\n  sessionStorage.setItem('hitNumber', hitNumber.toString());\n}\n*/\n\nfunction a_incrementHitNumber() {\n  var hitNumber = 0;\n  var sessionID;\n  var entryUrl;\n  var entryUrlQS;\n  var entryReferrer;\n  var entryReferrerType;\n  var entryCustomReferrerType;\n  var entryCampaignDetails;\n  var entryTrafficDetails;\n  const now = Date.now();// Get the current time in Unix timestamp (milliseconds)\n  //var webSessionDetails = getCookie('webSessionDetails');\n  var webSessionDetails = adobeSatelliteName.getVar('ACDL - Web Session Details');\n  //console.log(\"webSessionDetails at incrementHitNumber:\");\n  //console.log(webSessionDetails);\n  if (webSessionDetails != undefined && webSessionDetails != null) {\n    //var webSessionDetailsJSON = JSON.parse(webSessionDetails);\n    var webSessionDetailsJSON = webSessionDetails;\n    sessionID = webSessionDetailsJSON.sessionID\n    entryUrl = webSessionDetailsJSON.entryUrl\n    entryUrlQS = webSessionDetailsJSON.entryUrlQS\n    entryReferrer = webSessionDetailsJSON.entryReferrer\n    entryReferrerTypeDetails = webSessionDetailsJSON.entryReferrerTypeDetails\n    entryTrafficDetails = webSessionDetailsJSON.entryTrafficDetails\n    entryCampaignDetails = webSessionDetailsJSON.entryCampaignDetails\n\n    // Split the string to extract the timestamp\n    if (sessionID !== undefined) {\n      const parts = sessionID.split('_');\n      const sessionStartTime = parseInt(parts[1], 10);\n      //console.log(\"sessionStartTime: \" + sessionStartTime);\n\n      // Calculate the difference in hours\n      const differenceInHours = (now - sessionStartTime) / (1000 * 60 * 60);\n      //console.log(\"differenceInHours: \" + differenceInHours);\n      const differenceInSeconds = (now - sessionStartTime) / 1000;\n      //console.log(\"differenceInSeconds: \" + differenceInSeconds);\n\n      if (!isNaN(webSessionDetailsJSON.hitNumber)) {\n        hitNumber = parseInt(webSessionDetailsJSON.hitNumber);\n        hitNumber++\n        var webSessionDetailsStr = JSON.stringify({ sessionID, hitNumber, entryUrl, entryUrlQS, entryReferrer, entryReferrerTypeDetails, entryTrafficDetails, entryCampaignDetails });\n        var webSessionCookieDetailsStr = JSON.stringify({ sessionID, hitNumber });\n        //console.log(\"Web Session Details: \");\n        //console.log(webSessionDetailsStr);\n        //console.log(sessionID);\n        //console.log(hitNumber);\n        if (differenceInSeconds !== undefined && differenceInHours !== undefined) {\n          if (differenceInSeconds <= 100 && hitNumber >= 100) {\n            a_generateWebSessionDetails();\n          } else if (differenceInHours <= 12) {\n            if (hitNumber <= 2500) {\n              setCookie('webSessionDetails', webSessionCookieDetailsStr, 30); // Refresh cookie expiration date\n              localStorage.setItem('webSessionDetails', webSessionDetailsStr);\n            } else {\n              a_generateWebSessionDetails(1);\n            }\n          } else {\n            a_generateWebSessionDetails(1);\n          }\n        }\n      }\n    } else {\n      a_generateWebSessionDetails(1);\n    }\n  } else {\n    a_generateWebSessionDetails(1);\n  }\n}\n\n/*\n// Function to refresh the hit number in the cookie\nfunction a_refreshHitNumber() {\n  let webSessionDetails = getCookie('webSessionDetails');\n  if (webSessionDetails) {\n      webSessionDetails = JSON.parse(webSessionDetails);\n      webSessionDetails.hitNumber++; // Update hit number\n      setCookie('webSessionDetails', JSON.stringify(webSessionDetails), 30); // Refresh cookie expiration date\n  }\n}\n*/\n\n//Helper method for getting specific query string params\nfunction getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  var urlParamVal = undefined;\n  if (urlParams.get(param) !== null) {\n    urlParamVal = urlParams.get(param);\n  }\n  return urlParamVal;\n}\n\n//Helper method for setting a cookie\nfunction setCookie(name, value, minutes) {\n  const date = new Date();\n  date.setTime(date.getTime() + (minutes * 60 * 1000));\n  const expires = \"expires=\" + date.toUTCString();\n  document.cookie = name + \"=\" + value + \";\" + expires + \";path=/\";\n}\n\n\n// Function to refresh the cookie expiration date\nfunction refreshCookieExpiration(name, minutes) {\n const value = getCookie(name);\n if (value) {\n  setCookie(name, value, minutes); // Refresh cookie expiration date\n }\n}\n\n//Helper function to truncate strings to accommodate character limits\n//--Adobe Target entity.id limited to 128 chars\nfunction truncate(str, maxlength) {\n    return (str.length > maxlength) ?\n      str.slice(0, maxlength) : str;\n  }\n  \n  //Helper method to get a data object from an event sent to ACDL\n  function getDataObjectHelper(event, filter) {\n      if (event.hasOwnProperty(\"eventInfo\") && event.eventInfo.hasOwnProperty(\"path\")) {\n          var dataObject = window.adobeDataLayer.getState(event.eventInfo.path);\n          if (dataObject != null) {\n              for (var property in filter) {\n                  if (!dataObject.hasOwnProperty(property) || (filter[property] !== null && filter[property] !== dataObject[property])) {\n                      return;\n                  }\n                  return dataObject;\n              }\n          }\n      }\n      return;\n  }\n\n  //Function to get and set the page category history array in session storage\n  function a_getAndSetPageCategoryHistory(){\n      //var a_profilePageCategoryHistoryArray = [];\n      //If session storage has a value, set the js and datalayer variable value\n      if (typeof(sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\")) != undefined) {\n        if (sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== 'null' && sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== 'undefined' && sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== '') {\n          let a_profilePageCategoryHistoryArray = JSON.parse(sessionStorage.a_profilePageCategoryHistoryArray || '[]');\n          if (typeof(window.adobeDataLayer) != undefined) {\n              if (typeof(window.adobeDataLayer.getState('visitorProfile')) != undefined) {\n                //window.digitalData.visitorProfile.pageCategoryHistory = a_profilePageCategoryHistoryArray;\n                var eventPayloadObj = {\n                  \"event\":\"visitorProfile:change\",\n                    \"visitorProfile\":{\n                        \"pageCategoryHistory\":a_profilePageCategoryHistoryArray,\n                    } //end visitorProfile\n                } //end eventpPayloadObj\n                window.adobeDataLayer.push(eventPayloadObj); //end push script\n            }\n          }\n        }\n      }\n  }  \n\n  //Function to get and set the audience segments array in local storage\n  function a_getAndSetAudienceSegments(){\n      //var a_profileAudienceSegmentsArray = [];\n      //If local storage has a value, set the js and datalayer variable value\n      if (typeof(localStorage.getItem(\"a_profileAudienceSegmentsArray\")) != undefined) {\n        if (localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== 'null' && localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== 'undefined' && localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== '') {\n          let a_profileAudienceSegmentsArray = JSON.parse(localStorage.a_profileAudienceSegmentsArray || '[]');\n          //if (typeof(window.digitalData) != undefined) {\n          if (typeof(window.adobeDataLayer) != undefined) {\n            //if (typeof(window.digitalData.visitorProfile) != undefined) {\n            if (typeof(window.adobeDataLayer.getState('visitorProfile')) != undefined) {\n                //window.digitalData.visitorProfile.audienceSegments = a_profileAudienceSegmentsArray;\n                var eventPayloadObj = {\n                  \"event\":\"visitorProfile:change\",\n                    \"visitorProfile\":{\n                        \"audienceSegments\":a_profileAudienceSegmentsArray,\n                    } //end visitorProfile\n                } //end eventpPayloadObj\n                window.adobeDataLayer.push(eventPayloadObj); //end push script\n            }\n          }\n        }\n      }\n  }\n\n  //Function to get and set the audience segments last touch array in local storage\n  function a_getAndSetAudienceSegmentsLastTouch(){\n      //var a_profileAudienceSegmentsLastTouchArray = [];\n      //If local storage has a value, set the js and datalayer variable value\n      if (typeof(localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\")) != undefined) {\n        if (localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== 'null' && localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== 'undefined' && localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== '') {\n          let a_profileAudienceSegmentsLastTouchArray = JSON.parse(localStorage.a_profileAudienceSegmentsLastTouchArray || '[]');\n          //if (typeof(window.digitalData) != undefined) {\n          if (typeof(window.adobeDataLayer) != undefined) {\n            //if (typeof(window.digitalData.visitorProfile) != undefined) {\n            if (typeof(window.adobeDataLayer.getState('visitorProfile')) != undefined) {\n                //window.digitalData.visitorProfile.audienceSegmentsLastTouch = a_profileAudienceSegmentsLastTouchArray;\n                var eventPayloadObj = {\n                  \"event\":\"visitorProfile:change\",\n                    \"visitorProfile\":{\n                        \"audienceSegmentsLastTouch\":a_profileAudienceSegmentsLastTouchArray,\n                    } //end visitorProfile\n                } //end eventpPayloadObj\n                window.adobeDataLayer.push(eventPayloadObj); //end push script\n            }\n          }\n        }\n      }\n  }\n\n  //Create helper function for moving items in an array with first touch methodology\n  function a_reorderArray(arr, from, to) {\n  \n      // Make sure a valid array is provided\n      if (Object.prototype.toString.call(arr) !== '[object Array]') {\n          throw new Error('Please provide a valid array');\n      }\n  \n      // Delete the item from it's current position\n      var item = arr.splice(from, 1);\n  \n      // Make sure there's an item to move\n      if (!item.length) {\n          throw new Error('There is no item in the array at index ' + from);\n      }\n  \n      // Move the item to its new position\n      arr.splice(to, 0, item[0]);\n  \n  }\n  \n  //Create helper function to get number of occurrences for specific values in an array\n  function a_countArrayVals(arr,targetVal) {\n      let counter = 0;\n      for (var arrVal of arr) {\n      if (arrVal == targetVal) {\n              counter++;\n          }\n      }\n      return counter;\n  }\n\n  //Function to return referrerType details for a referrer url passed. The object containes the standard web.webReferrer.type and a custom referrer type\n  //--Custom referrer type based on MSFT standard\n  \n  function a_getReferrerType(referrerPassed) {\n    var referrer;\n    var referrerDE = adobeSatelliteName.getVar(\"ACDL - Referrer\");\n    //var referrerDE = adobeSatelliteName.getVar(\"ACDL - Referrer Test\"); //Used for testing since referrer can't be changed manually\n    //var referrerType = undefined;\n    var referrerType = 'unknown';\n    var customReferrerType = 'unknown'\n    if (referrerPassed !== undefined && referrerPassed !== null) {\n      referrer = referrerPassed;\n    } else {\n      referrer = referrerDE;\n    }\n    var url = document.URL;\n    var socialChannel = false;\n    var searchEnginesChannel = false;\n    var microsoftChannel = false;\n    var socials = ['tiktok', 'weixinbridge.com', 'minecraft.', 'microsoftonline.','onenote.com','microsoftcasualgames.','microsoftstream',\n      'xbox.','live.com','powerapps.com', 'powershellgallery.com', 'make.gov',\n      'make.power', 'make.preview', '.powerautomate.com','Ideas.power','zune.net','riskiq.com','powerup.microsoft.com',\n      'app-Info://platform/microsoft-', 'badoo.', 'blog.','cafemom.','deviantart.', 'digg.','facebook.','linkedin.',\n      'livejournal.','myspace.','ning.com','orkut.','pinterest.','tagged.com','twitter.','t.co/','yelp.','youtube.com',\n      '.reddit.com','.tumblr.com','.sina.com','.taringa.net','.tuenti.com','.odnoklassniki.ru','.vk.com','.vkontakte.ru',\n      '.flickr.com', '.renren.com','plus.google.com','.me2day.net','me2day.net','.kaixin001.com','.mixi.jp','.hi5.com',\n      '.vimeo.com','.delicious.com','500px.com','stackoverflow.com','instagram.com','www.whatsapp.com','airtelforum.com',\n      'androidforums.com','arstechnica.com','aspoc.net','axforum.info','bbs.winos.cn','bytes.com','clever-forum.de',\n      'community.bamboosolutions.com','community.spiceworks.com','computerhelpforums.net','connect.nintex.com','deforum.ru',\n      'dotnet-forum.de','dotnetforum.lk','eforum.idg.se','eightwone.com','en.wikipedia.org','entwickler-forum.de',\n      'exchangepedia.com','exchangeserverpro.com','forum','forum.0day.kiev.ua','forum.4programmers.net','forum.advice.inf.br',\n      'forum.ahsay.com','forum.alsacreations.com','forum.aspitalia.com','forum.aspvn.net','forum.chip.de',\n      'forum.clubedohardware.com.br','forum.codecall.net','forum.commvalut.com','forum.computerbild.de',\n      'forum.computeridee.nl','forum.corproot.net','forum.darkhardware.com','forum.de.selfhtml.org','forum.dobreprogramy.pl',\n      'forum.eclarsys.com','forum.enteo.com','forum.fok.nl','forum.foxclub.ru','forum.funkysouls.com','forum.ge',\n      'forum.generation-nt.com','forum.gigaset.com','forum.gpit.fr','forum.hardware.fr','forum.hostingcontroller.com',\n      'forum.html.it','forum.hwsw.hu','forum.imasters.com.br','forum.infostart.ru','forum.itlab.com.vn',\n      'forum.it-share.ro','forum.ixbt.com','forum.joomla.org.hu','forum.kaspersky.com','forum.katarincic.com',\n      'forum.ks-ekspert.pl','forum.lrytas.lt','forum.mailenable.com','forum.masterdrive.it','forum.mazzy.ru',\n      'forum.ms.com','forum.nic.ru','forum.notebookreview.com','forum.oszone.net','forum.parallels.com',\n      'forum.pcastuces.com','forum.persiannetworks.com','forum.root.cz','forum.ru-board.com','forum.saabsportclub.com',\n      'forum.script-coding.com','forum.sistemuzmani.com','forum.softpedia.com','forum.sources.ru','forum.spamcop.net',\n      'forum.specopssoft.com','forum.sudrf.ru','forum.swzone.it','forum.sysinternals.com','forum.sysman.ru',\n      'forum.techzine.nl','forum.telecharger.01net.com','forum.ultrabac.com','forum.vingrad.ru','forum.winadmin.ro',\n      'forum.windowsfaq.ru','forum.wordreference.com','forum.xda-developers.com','forum.zebulon.fr','forum.zive.cz',\n      'forum.zwame.pt','forums.4d.fr','forums.anandtech.com','forums.asp.net','forums.aspfree.com','forums.autodesk.com',\n      'forums.avalon.ru','forums.cnet.com','forums.cnetfrance.fr','forums.cpanel.net','forums.crackberry.com',\n      'forums.datatel.com','forums.daypilot.org','forums.devarticles.com','forums.devshed.com','forums.digitalpoint.com',\n      'forums.epmfaq.com','forums.gfi.com','forums.guru3d.com','forums.hardwarezone.com.sg','forums.iis.net',\n      'forums.isaserver.org','forums.juniper.net','forums.kemptechnologies.com','forums.kerio.com','forums.macnn.com',\n      'forums.macrumors.com','forums.madcapsoftware.com','forums.majorgeeks.com','forums.manageengine.com',\n      'forums.mozillazine.org','forums.msexchange.org','forums.mydigitallife.info','forums.ni.com','forums.ocsinventory-ng.org',\n      'forums.overclockers.co.uk','forums.overclockers.com.au','forums.overclockers.ru','forums.pentaho.com',\n      'forums.phplist.com','forums.renewedvision.com','forums.smartertools.com','forums.somethingawful.com',\n      'forums.speedguide.net','forums.techarena.in','forums.techguy.org','forums.techsoup.org','forums.toshiba.com',\n      'forums.untangle.com','forums.whirlpool.net.au','forum-tn.ovh.com','gathering.tweakers.net','geeks.ms',\n      'get-spscripts.com','hardforum.com','itknowledgeexchange.techtarget.com','johanveldhuis.nl','kin.naver.com',\n      'lnkd.in','mathforum.org','maximoaccess.maisforum.com','mobile.experts-exchange.com','msexchangeguru.com',\n      'msgroups.net','msmvps.com','ms-office-forum.de','ms-office-forum.net','mssharepointtips.com','msunified.net',\n      'myforums.oracle.com','myitforum.com','objectmix.com','officedeveloper.net','openxmldeveloper.org','pcforum.hu',\n      'programmersforum.ru','pspcommunity.org','searchexchange.techtarget.com','serverfault.com','serversupportforum.de',\n      'sharepoint.stackexchange.com','sharepointcommunity.de','sharepointforum.com','sharepointgeorge.com',\n      'sharepoint-sandbox.com','spservices.codeplex.com','stackoverflow.com','superuser.com','supportforums.blackberry.com',\n      'sympmarc.com','sysadmins.ru','theessentialexchange.com','thinkpad-forum.de','ubuntuforums.org','uforum.uz',\n      'vmware-forum.de','windowsforum.kr','windowsforums.org','windowssecrets.com','wssv4faq.mindsharp.com',\n      'www.accessforums.net','www.access-programmers.co.uk','www.accessribbon.de','www.administrator.de',\n      'www.andrewconnell.com','www.astaticstate.com','www.avforums.com','www.axforum.info','www.benjaminathawes.com',\n      'www.bhargavs.com','www.bizsupportonline.net','www.blackberryforums.com','www.blackberryforums.com.au',\n      'www.chaholl.com','www.chandima.net','www.cmswire.com','www.codeproject.com','www.cozumpark.com',\n      'www.c-sharpcorner.com','www.cyberforum.ru','www.daniweb.com','www.databaseforum.info','www.dbforums.com',\n      'www.developpez.net','www.devx.com','www.ditii.com','www.dotnetmafia.com','www.dotnetspark.com',\n      'www.dreamincode.net','www.droidforums.net','www.edugeek.net','www.ehow.com','www.endusersharepoint.com',\n      'www.enterprisenetworkingplanet.com','www.excelbanter.com','www.excelforum.com','www.excelforum.pl',\n      'www.exchangefreaks.com','www.exchange-genie.com','www.exchangeinbox.com','www.experts-exchange.com',\n      'www.forum.mista.ru','www.forum.persianadmins.ir','www.forumla.de','www.forum-microsoft.org','www.forums.gr',\n      'www.forum-sam.com','www.forum-seven.com','www.forumtopics.com','www.generation-nt.com','www.go4answers.com',\n      'www.go4sharepoint.com','www.gotdotnet.ru','www.harbar.net','www.howardforums.com','www.infopathdev.com',\n      'www.ip-phone-forum.de','www.itproffs.se','www.jeremytaylor.net','www.khamis.net','www.mapforums.com',\n      'www.mcseboard.de','www.microsoftoffice2010forums.com','www.microsoftproject.ru','www.mikepfeiffer.net',\n      'www.mrexcel.com','www.msexchange.org','www.msexchangefaq.de','www.msfn.org','www.ms-office-forum.de',\n      'www.ms-office-forum.net','www.msofficeforums.com','www.mssharepointtips.com','www.msxfaq.de','www.myitforum.com',\n      'www.networksteve.com','www.novolocus.com','www.office-forums.com','www.office-loesung.de','www.online-marketing-forum.at',\n      'www.oooforum.org','www.oszone.net','www.outlookcode.com','www.outlookforums.com','www.pchelpforum.com',\n      'www.pcreview.co.uk','www.petri.co.il','www.physicsforums.com','www.proexchange.be','www.pro-exchange.be',\n      'www.programmersforum.ru','www.rondebruin.nl','www.server-talk.eu','www.sevenforums.com','www.sharemuch.com',\n      'www.sharepoint4developers.net','www.sharepointblues.com','www.sharepointforum.com','www.sharepointforum.nl',\n      'www.sharepointforums.org','www.sharepointnutsandbolts.com','www.sharepoint-tips.com','www.shudnow.net',\n      'www.slideshare.net','www.slipstick.com','www.sqaforums.com','www.sql.ru','www.stevieg.org','www.stumbleupon.com',\n      'www.supernature-forum.de','www.supforum.net','www.tech-archive.net','www.techques.com','www.techrepublic.com',\n      'www.techsupportforum.com','www.techtalkz.com','www.tek-tips.com','www.thevista.ru','www.tm1forum.com',\n      'www.toddklindt.com','www.tonstegeman.com','www.vbdotnetforums.com','www.vbforums.com','www.wictorwilen.se',\n      'www.windows-7-forum.net','www.windows-noob.com','www.windowsservercatalog.com','www.winfuture-forum.de',\n      'www.winvistatips.com','www.wssdemo.com','www.xbaseforum.de','www.xtremevbtalk.com','www.xing.com','www.youtube.com'];\n\n    var searchEngines = [\"beguide.com\", \"aol.com\", \"search.com\", \"dogpile.com\", \"dmoz.org\", \"biglobe.com\", \"aol.\", \"altavista.com\", \n      \"abacho.com\", \"ecosia.org\", \"yandex.\", \"suche.t-online.de\", \"coccoc.com\", \".google.\", \".finderoo.com\", \".qwant.com\", \n      \".yahoo.com\", \"play.google.com\", \".rakuten.com\",\".ocn.ne.jp\", \"jcom.co.jp\", \".jword.jp\", \".fenrir-inc.com\", \".lunascape.com\", \n      \".fmworld.net\", \"myvaio.sony.com\", \".earthlink.net\", \".sapo.pt\", \"duckduckgo.com\", \"sm.cn\", \"livedoor.com\", \"daum.net\",\n      \".virginmedia.com\", \".bt.com\", \"ee.co.uk\", \".alot.com\", \"search.avg.com\", \"search-results.com\", \"360.cn\", \"haosou.com\",\n      \"so.360.cn\", \".blekko.com\", \".googleadservices.com\", \"m.baidu\", \"m.bing\", \"search.comcast.net\", \"froute.crooz\",\n      \"auok.auone.jp\", \"aldn.jp\", \"m.mixi.jp\", \"tkmf.jp\", \"docomo.ne.jp\", \"mbkn.jp\", \"Centrum.cz\", \"Atlas.cz\", \"Zbozi.cz\",\n      \"kakaku.com\", \"baidu.\", \".soso.com\", \".sogou.com\", \"dict.youdao.com\", \".yicha.com\", \".iyappo.com\", \".searchoodle.com\",\n      \".roadrunner.com\", \"startpage.com\", \"mywebsearch.com\", \"zhongsou.com\", \"bing.com\", \"froute.crooz.jp\", \"ohnew.com\",\n      \"search.mobage.com\", \"infoseek.co.jp\", \"biglobe.com\", \"goo.ne.jp\", \"search.live.com\", \"searchteria.com\", \"cuil.com\",\n      \"eniro.\", \"www.msn.com\", \".sina.com\", \"m.yahoo.co\", \".crooz.com\", \"google.co.\", \"nifty.com\", \"ezweb.ne.jp\", \"wakwak.com\",\n      \"cafesta.com\", \"webalta.ru\", \"so-net.ne.jp\", \"yahoo.\", \"livedoor.com\", \"rambler.ru\", \"berlingske.dk\", \"kelkoo.\",\n      \"sesam.\", \"aladdin.com\", \"startsiden.no\", \"ofir.dk\", \"ask.co\", \"odn.ne.jp\", \"yol.co.jp\", \"dion.ne.jp\", \"istmania.com\",\n      \"metaeureka.com\", \"khoj.com\", \"monstercrawler.com\", \"nate.com\", \"business.com\", \"nifty.com\", \"mail.ru\", \"pricerunner.se\",\n      \"altavista.no\", \"kelkoo.se\", \"altavista.dk\", \"37.com\", \"rol.ro\", \"ntsearch.com\", \"holms.ru\", \"abrexa.co.uk\", \"limeysearch.com\",\n      \"huifa.com\", \"icq.com\", \"ixquick.eu\", \"conexcol.com\", \"jopinet.com\", \"infopage.com\", \"mirago.com\", \"ixquick.eu\", \"tapuz.co.il\",\n      \"1st-spot.com\", \"dialindia.com\", \"labrujula.com\", \"naver.com\", \"libero.it\", \"buscapique.com\", \"teoma.com\", \"heureka.sk\",\n      \"galileu.com.br\", \"kvasir.no\", \"luxpoint.com\", \"irl.com\", \"iwon.com\", \"flix.de\", \"tjohoo.com\", \"findwhat.com\", \"webstudio.com\",\n      \"fleecethenet.com\", \"wp.pl\", \"feynd.com\", \"findit-quick.com\", \"webbel.com\", \"walla.co.il\", \"dir.bg\", \"gohip.com\", \"grippo.com\",\n      \"globito.com\", \"wanadoo.com\", \"truesearch.com\", \"123.cl\", \"100.nu\", \"data.ru\", \"sherlock.cz\", \"rocketlinks.com\", \"sensis.com.au\",\n      \"ukindex.co.uk\", \"ukplus.co.uk\", \"tiscali.\", \"exploora.com\", \"allsearchengines.com\", \"eniro.se\", \"gulesider.no\", \"krak.dk\",\n      \"degulesider.dk\", \"egyptsearch.com\", \"profusion.com\", \"7search.com\", \"netsprint.pl\", \"polishworld.com\", \"myway.com\", \n      \"trovator.com\", \"empas.com\", \"usseek.com\", \"quepasa.com\", \"reference.com\", \"searchnz.co.nz\", \"surf.sk\", \"supercrawler.com\", \n      \"szm.sk\", \"search.ch\", \"seznam.cz\", \"find.wanadoo.nl\", \"suche.ch\", \"southasia.net\", \"smartpages.com\", \"szm.sk\",\n      \"toile.qc.ca\", \"canada.com\", \"wizzler.com\", \"web.de\", \"topfile.com\", \"virgilio.it\", \"webcrawler.com\", \"webwombat.com\",\n      \"surfer.ch\", \"soquick.com\", \"smartbeak.com\", \"simplypets.com\", \"thunderstone.com\", \"tiscali.com\", \"theinfodepot.com\", \n      \"thebighub.com\", \"search.ch\", \"searchalot.com\", \"snap.com\", \"startingpoint.com\", \"rageworld.com\", \"orbit.net\", \"ask.com\",\n      \"point2.com\", \"scour.com\", \"northernlight.com\", \"dmoz.org\", \"live.com\", \"metacrawler.com\", \"metadog.com\", \"metaiq.com\",\n      \"nbci.com\", \"mcfind.com\", \"lycos.\", \"excite.com.au\", \"magellan.com\", \"mamma.com\", \"kanoodle.com\", \"libero.it\", \"linkcenter.com\", \n      \"looksmart.com\", \"infoseek.co.\", \"infoseek.com\", \"blucora.com\", \"infotiger.com\", \"jayde.com\", \"jubii.dk\", \"go.com\", \"idealist.com\", \n      \"hotlaunch.com\", \"overture.com\", \"highway61.com\", \"hotbot.com\", \"ilse.nl\", \"fireball.de\", \"goo.ne.jp\", \"3721.com\", \"eerstekeuze.nl\",\n      \"zoeken.nl\", \"track.nl\", \"fansites.com\", \"zoeken.hetnet.nl\", \"dog.com\", \"dictionary.com\", \"cyberbritain.com\", \"excite.com\", \n      \"excite.\", \"about.com\", \"alltheweb.com\", \"enhance.com\", \"mojeek.com\", \"searx.me\", \"scroggle.com\", \"searchencrypt.com\", \n      \"clusty.com\", \"teoma.com\", \"yippy.com\", \"search.io\", \"boardreader.com\", \"blin.com\", \"shodan.io\", \"gigablast.com\", \"carrot2.org\",\n      \"pinoyweb.com\", \"maloka.com\", \"atypon.com\", \"qwantjunior.com\", \"findsounds.com\"];\n\n    var msftDomains = ['microsoft.com','xbox.com','azure.com','live.com'];\n\n    //Check for socialChannel\n    for (let i = 0; i < socials.length; i++) {\n      if(referrer != undefined) {\n        if (referrer.indexOf(socials[i]) != -1){\n          //Handle values like t.co overriding microsoft.com then returning as social\n          //Noting that any site with a name that ends in t.com will return true here for 't.co' which is not desired so we changed it to 't.co/'\n          if (referrer.indexOf('microsoft.com') == -1) {\n            //console.log(socials[i]);\n            socialChannel = true;\n          }\n        }\n      }\n      //console.log(socialChannel);\n    }\n  \n    //Check for searchEngineChannel\n    for (let i = 0; i < searchEngines.length; i++) {\n      if(referrer != undefined) {\n        if (referrer.indexOf(searchEngines[i]) != -1){\n          searchEnginesChannel = true;\n        }\n      }\n    }\n\n    //Check for microsoftChannel\n    for (let i = 0; i < msftDomains.length; i++) {\n      if(referrer != undefined) {\n        if (referrer.indexOf(msftDomains[i]) != -1){\n          microsoftChannel = true;\n        }\n      }\n    }\n\n    //if (referrerDE != undefined) {\n        //--External\n        //When a visitor's referring domain is populated but does not match one of the above categories\n        if (\n          ((referrer != undefined) && ((referrer.indexOf(\"microsoft.com\") == -1) || (referrer.indexOf(\"azure.com\") == -1) || (referrer.indexOf(\"xbox.com\") == -1))) ||\n          (url.indexOf('_par_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('part_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_afc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('aff_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_aff_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('tduid') != -1) ||\n          (url.indexOf('aff_') != -1)\n        ) {\n            //return 'external';\n            referrerType = 'external';\n            customReferrerType = 'External';\n        }\n        //else if (\n        //--Internal\n        //When a visitor's referring domain is from a known Microsoft domain OR when a visitor's referring domain is from www.bing.com and has a campaign parameter that contains \u201cs_cid\u201d and does not contain \u201cPPC\u201d in the page URL query string\n        if (\n          ((referrer != undefined) && ((referrer.indexOf(\"microsoft.com\") !== -1) || (referrer.indexOf(\"azure.com\") !== -1) || (referrer.indexOf(\"xbox.com\") !== -1))) ||\n          (microsoftChannel == true) ||\n          (\n            (referrer == 'www.bing.com') && \n            (\n              url.indexOf('ocid') != -1 || \n              rl.indexOf('wt.mc_id') != -1 || \n              url.indexOf('cm_mmc') != -1 || \n              url.indexOf('cr_cc') != -1\n            ) && \n            (url.indexOf('PPC') == -1)\n          ) ||\n          (url.indexOf('oan_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('mscom_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('spo_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('rm_one') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('tec_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('winstore_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('oo_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (referrer == \"live.com\")\n        ) {\n            //return 'internal';\n            referrerType = 'internal';\n            customReferrerType = 'Microsoft';\n        } \n        // else if (\n        //--Email\n        //Derived from traffic channel definitions for email\n        if (\n          (url.indexOf('cartemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('recemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('lifecycleemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('eml_cxm') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('promo') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('email_mmo') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('reviewemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_eml_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('eml_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_ema_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('ema_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pd_eml') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('trans') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (url.indexOf('trigger') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (url.indexOf('receipt') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (document.referrer == 'events.microsoft.com')\n        ) {\n            //return 'email';\n            referrerType = 'email';\n        } \n        //else if (\n        //--Social\n        //When a visitor's referring domain is from a known social media site\n        if (\n          (url.indexOf('_scl_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_soc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('usoc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('soc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_sol_') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_spl') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_pd_spl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_pd_scl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_pd_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pd_scl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_soc_pmc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('psoc_') != -1 && url.indexOf('ocid') != -1) ||\n          (socialChannel == true)\n        ) {\n            //return 'social';\n            referrerType = 'social';\n            customReferrerType = 'Social Media';\n        } \n        //else if (\n        if (\n          //When a visitor's referring domain is empty/null (e.g. refreshed page after a session ends, typed URL directly in browser, bookmarked the page, or otherwise no referrer value was passed). \n          //If a value is \u201cDirect\u201d it is not possible to learn where the traffic came from except for if a tracking code was present in the URL\n          (referrer == null || referrer == '')\n        ) {\n            //return 'typed_bookmarked';\n            referrerType = 'typed_bookmarked';\n            customReferrerType = 'Direct Traffic';\n            \n        } \n        //else if (\n        //--Organic Search\n        //When a visitor's referring domain was from a known search engine, and does not have a campaign parameter in the query string (such as an OCID)\n        if (\n          (searchEnginesChannel == true) &&\n          (\n            (url.indexOf('wt.mc_id') == -1) ||\n            (url.indexOf('cm_mmc') == -1) ||\n            (url.indexOf('cr_cc') == -1) ||\n            (url.indexOf('ocid') == -1)\n          )\n        ) {\n            //return 'search_engine';\n            referrerType = 'search_engine';\n            customReferrerType = 'Organic Search';\n        }\n\n        //--Paid Search\n        //When a visitor's referring domain is from a known search engine, and has a campaign parameter that contains \"ocid, wt.mc_id, cm_mmc, cr_cc\" OR contains an s_cid parameter\" and \"PPC\" in the page URL query string\n        if (\n          (searchEnginesChannel == true) &&\n          (\n            (\n              (url.indexOf('wt.mc_id') != -1) ||\n              (url.indexOf('cm_mmc') != -1) ||\n              (url.indexOf('cr_cc') != -1) ||\n              (url.indexOf('ocid') != -1)\n            ) ||\n            (\n              (url.indexOf('s_cid') != -1) &&\n              (url.indexOf('PPC') != -1)\n            )\n          )\n        ) {\n            //return 'search_engine';\n            referrerType = 'search_engine';\n            customReferrerType = 'Paid Search';\n        }\n        \n        //--Search Engine\n        if (\n          (url.indexOf('seo_omc_goo') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_sem_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pointitsem') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('ps_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('google') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('datafeed') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('baidu') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('bing') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('wt.mc_id') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('cm_mmc') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('cr_cc') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('ocid') != -1 && searchEnginesChannel == true) ||\n          (searchEnginesChannel == true)\n        ) {\n            //return 'search_engine';\n            referrerType = 'search_engine';\n        }\n    //}\n        referrerTypeDetails = {\n          \"referrerType\":referrerType,\n          \"customReferrerType\":customReferrerType\n        }\n    //console.log(referrerType);\n    //return referrerType;\n    return referrerTypeDetails;\n  } //end a_getReferrerType()\n\n/*\n  function a_getReferrerType(referrerPassed) {\n    var referrer;\n    var referrerDE = adobeSatelliteName.getVar(\"ACDL - Referrer\");\n    //var referrerDE = adobeSatelliteName.getVar(\"ACDL - Referrer Test\"); //Used for testing since referrer can't be changed manually\n    //var referrerType = undefined;\n    var referrerType = 'unknown';\n    if (referrerPassed !== undefined && referrerPassed !== null) {\n      referrer = referrerPassed;\n    } else {\n      referrer = referrerDE;\n    }\n    var url = document.URL;\n    var socialChannel = false;\n    var searchEnginesChannel = false;\n    var socials = ['tiktok', 'weixinbridge.com', 'minecraft.', 'microsoftonline.','onenote.com','microsoftcasualgames.','microsoftstream',\n      'xbox.','live.com','powerapps.com', 'powershellgallery.com', 'make.gov',\n      'make.power', 'make.preview', '.powerautomate.com','Ideas.power','zune.net','riskiq.com','powerup.microsoft.com',\n      'app-Info://platform/microsoft-', 'badoo.', 'blog.','cafemom.','deviantart.', 'digg.','facebook.','linkedin.',\n      'livejournal.','myspace.','ning.com','orkut.','pinterest.','tagged.com','twitter.','t.co/','yelp.','youtube.com',\n      '.reddit.com','.tumblr.com','.sina.com','.taringa.net','.tuenti.com','.odnoklassniki.ru','.vk.com','.vkontakte.ru',\n      '.flickr.com', '.renren.com','plus.google.com','.me2day.net','me2day.net','.kaixin001.com','.mixi.jp','.hi5.com',\n      '.vimeo.com','.delicious.com','500px.com','stackoverflow.com','instagram.com','www.whatsapp.com','airtelforum.com',\n      'androidforums.com','arstechnica.com','aspoc.net','axforum.info','bbs.winos.cn','bytes.com','clever-forum.de',\n      'community.bamboosolutions.com','community.spiceworks.com','computerhelpforums.net','connect.nintex.com','deforum.ru',\n      'dotnet-forum.de','dotnetforum.lk','eforum.idg.se','eightwone.com','en.wikipedia.org','entwickler-forum.de',\n      'exchangepedia.com','exchangeserverpro.com','forum','forum.0day.kiev.ua','forum.4programmers.net','forum.advice.inf.br',\n      'forum.ahsay.com','forum.alsacreations.com','forum.aspitalia.com','forum.aspvn.net','forum.chip.de',\n      'forum.clubedohardware.com.br','forum.codecall.net','forum.commvalut.com','forum.computerbild.de',\n      'forum.computeridee.nl','forum.corproot.net','forum.darkhardware.com','forum.de.selfhtml.org','forum.dobreprogramy.pl',\n      'forum.eclarsys.com','forum.enteo.com','forum.fok.nl','forum.foxclub.ru','forum.funkysouls.com','forum.ge',\n      'forum.generation-nt.com','forum.gigaset.com','forum.gpit.fr','forum.hardware.fr','forum.hostingcontroller.com',\n      'forum.html.it','forum.hwsw.hu','forum.imasters.com.br','forum.infostart.ru','forum.itlab.com.vn',\n      'forum.it-share.ro','forum.ixbt.com','forum.joomla.org.hu','forum.kaspersky.com','forum.katarincic.com',\n      'forum.ks-ekspert.pl','forum.lrytas.lt','forum.mailenable.com','forum.masterdrive.it','forum.mazzy.ru',\n      'forum.ms.com','forum.nic.ru','forum.notebookreview.com','forum.oszone.net','forum.parallels.com',\n      'forum.pcastuces.com','forum.persiannetworks.com','forum.root.cz','forum.ru-board.com','forum.saabsportclub.com',\n      'forum.script-coding.com','forum.sistemuzmani.com','forum.softpedia.com','forum.sources.ru','forum.spamcop.net',\n      'forum.specopssoft.com','forum.sudrf.ru','forum.swzone.it','forum.sysinternals.com','forum.sysman.ru',\n      'forum.techzine.nl','forum.telecharger.01net.com','forum.ultrabac.com','forum.vingrad.ru','forum.winadmin.ro',\n      'forum.windowsfaq.ru','forum.wordreference.com','forum.xda-developers.com','forum.zebulon.fr','forum.zive.cz',\n      'forum.zwame.pt','forums.4d.fr','forums.anandtech.com','forums.asp.net','forums.aspfree.com','forums.autodesk.com',\n      'forums.avalon.ru','forums.cnet.com','forums.cnetfrance.fr','forums.cpanel.net','forums.crackberry.com',\n      'forums.datatel.com','forums.daypilot.org','forums.devarticles.com','forums.devshed.com','forums.digitalpoint.com',\n      'forums.epmfaq.com','forums.gfi.com','forums.guru3d.com','forums.hardwarezone.com.sg','forums.iis.net',\n      'forums.isaserver.org','forums.juniper.net','forums.kemptechnologies.com','forums.kerio.com','forums.macnn.com',\n      'forums.macrumors.com','forums.madcapsoftware.com','forums.majorgeeks.com','forums.manageengine.com',\n      'forums.mozillazine.org','forums.msexchange.org','forums.mydigitallife.info','forums.ni.com','forums.ocsinventory-ng.org',\n      'forums.overclockers.co.uk','forums.overclockers.com.au','forums.overclockers.ru','forums.pentaho.com',\n      'forums.phplist.com','forums.renewedvision.com','forums.smartertools.com','forums.somethingawful.com',\n      'forums.speedguide.net','forums.techarena.in','forums.techguy.org','forums.techsoup.org','forums.toshiba.com',\n      'forums.untangle.com','forums.whirlpool.net.au','forum-tn.ovh.com','gathering.tweakers.net','geeks.ms',\n      'get-spscripts.com','hardforum.com','itknowledgeexchange.techtarget.com','johanveldhuis.nl','kin.naver.com',\n      'lnkd.in','mathforum.org','maximoaccess.maisforum.com','mobile.experts-exchange.com','msexchangeguru.com',\n      'msgroups.net','msmvps.com','ms-office-forum.de','ms-office-forum.net','mssharepointtips.com','msunified.net',\n      'myforums.oracle.com','myitforum.com','objectmix.com','officedeveloper.net','openxmldeveloper.org','pcforum.hu',\n      'programmersforum.ru','pspcommunity.org','searchexchange.techtarget.com','serverfault.com','serversupportforum.de',\n      'sharepoint.stackexchange.com','sharepointcommunity.de','sharepointforum.com','sharepointgeorge.com',\n      'sharepoint-sandbox.com','spservices.codeplex.com','stackoverflow.com','superuser.com','supportforums.blackberry.com',\n      'sympmarc.com','sysadmins.ru','theessentialexchange.com','thinkpad-forum.de','ubuntuforums.org','uforum.uz',\n      'vmware-forum.de','windowsforum.kr','windowsforums.org','windowssecrets.com','wssv4faq.mindsharp.com',\n      'www.accessforums.net','www.access-programmers.co.uk','www.accessribbon.de','www.administrator.de',\n      'www.andrewconnell.com','www.astaticstate.com','www.avforums.com','www.axforum.info','www.benjaminathawes.com',\n      'www.bhargavs.com','www.bizsupportonline.net','www.blackberryforums.com','www.blackberryforums.com.au',\n      'www.chaholl.com','www.chandima.net','www.cmswire.com','www.codeproject.com','www.cozumpark.com',\n      'www.c-sharpcorner.com','www.cyberforum.ru','www.daniweb.com','www.databaseforum.info','www.dbforums.com',\n      'www.developpez.net','www.devx.com','www.ditii.com','www.dotnetmafia.com','www.dotnetspark.com',\n      'www.dreamincode.net','www.droidforums.net','www.edugeek.net','www.ehow.com','www.endusersharepoint.com',\n      'www.enterprisenetworkingplanet.com','www.excelbanter.com','www.excelforum.com','www.excelforum.pl',\n      'www.exchangefreaks.com','www.exchange-genie.com','www.exchangeinbox.com','www.experts-exchange.com',\n      'www.forum.mista.ru','www.forum.persianadmins.ir','www.forumla.de','www.forum-microsoft.org','www.forums.gr',\n      'www.forum-sam.com','www.forum-seven.com','www.forumtopics.com','www.generation-nt.com','www.go4answers.com',\n      'www.go4sharepoint.com','www.gotdotnet.ru','www.harbar.net','www.howardforums.com','www.infopathdev.com',\n      'www.ip-phone-forum.de','www.itproffs.se','www.jeremytaylor.net','www.khamis.net','www.mapforums.com',\n      'www.mcseboard.de','www.microsoftoffice2010forums.com','www.microsoftproject.ru','www.mikepfeiffer.net',\n      'www.mrexcel.com','www.msexchange.org','www.msexchangefaq.de','www.msfn.org','www.ms-office-forum.de',\n      'www.ms-office-forum.net','www.msofficeforums.com','www.mssharepointtips.com','www.msxfaq.de','www.myitforum.com',\n      'www.networksteve.com','www.novolocus.com','www.office-forums.com','www.office-loesung.de','www.online-marketing-forum.at',\n      'www.oooforum.org','www.oszone.net','www.outlookcode.com','www.outlookforums.com','www.pchelpforum.com',\n      'www.pcreview.co.uk','www.petri.co.il','www.physicsforums.com','www.proexchange.be','www.pro-exchange.be',\n      'www.programmersforum.ru','www.rondebruin.nl','www.server-talk.eu','www.sevenforums.com','www.sharemuch.com',\n      'www.sharepoint4developers.net','www.sharepointblues.com','www.sharepointforum.com','www.sharepointforum.nl',\n      'www.sharepointforums.org','www.sharepointnutsandbolts.com','www.sharepoint-tips.com','www.shudnow.net',\n      'www.slideshare.net','www.slipstick.com','www.sqaforums.com','www.sql.ru','www.stevieg.org','www.stumbleupon.com',\n      'www.supernature-forum.de','www.supforum.net','www.tech-archive.net','www.techques.com','www.techrepublic.com',\n      'www.techsupportforum.com','www.techtalkz.com','www.tek-tips.com','www.thevista.ru','www.tm1forum.com',\n      'www.toddklindt.com','www.tonstegeman.com','www.vbdotnetforums.com','www.vbforums.com','www.wictorwilen.se',\n      'www.windows-7-forum.net','www.windows-noob.com','www.windowsservercatalog.com','www.winfuture-forum.de',\n      'www.winvistatips.com','www.wssdemo.com','www.xbaseforum.de','www.xtremevbtalk.com','www.xing.com','www.youtube.com']\n\n    var searchEngines = [\"beguide.com\", \"aol.com\", \"search.com\", \"dogpile.com\", \"dmoz.org\", \"biglobe.com\", \"aol.\", \"altavista.com\", \n      \"abacho.com\", \"ecosia.org\", \"yandex.\", \"suche.t-online.de\", \"coccoc.com\", \".google.\", \".finderoo.com\", \".qwant.com\", \n      \".yahoo.com\", \"play.google.com\", \".rakuten.com\",\".ocn.ne.jp\", \"jcom.co.jp\", \".jword.jp\", \".fenrir-inc.com\", \".lunascape.com\", \n      \".fmworld.net\", \"myvaio.sony.com\", \".earthlink.net\", \".sapo.pt\", \"duckduckgo.com\", \"sm.cn\", \"livedoor.com\", \"daum.net\",\n      \".virginmedia.com\", \".bt.com\", \"ee.co.uk\", \".alot.com\", \"search.avg.com\", \"search-results.com\", \"360.cn\", \"haosou.com\",\n      \"so.360.cn\", \".blekko.com\", \".googleadservices.com\", \"m.baidu\", \"m.bing\", \"search.comcast.net\", \"froute.crooz\",\n      \"auok.auone.jp\", \"aldn.jp\", \"m.mixi.jp\", \"tkmf.jp\", \"docomo.ne.jp\", \"mbkn.jp\", \"Centrum.cz\", \"Atlas.cz\", \"Zbozi.cz\",\n      \"kakaku.com\", \"baidu.\", \".soso.com\", \".sogou.com\", \"dict.youdao.com\", \".yicha.com\", \".iyappo.com\", \".searchoodle.com\",\n      \".roadrunner.com\", \"startpage.com\", \"mywebsearch.com\", \"zhongsou.com\", \"bing.com\", \"froute.crooz.jp\", \"ohnew.com\",\n      \"search.mobage.com\", \"infoseek.co.jp\", \"biglobe.com\", \"goo.ne.jp\", \"search.live.com\", \"searchteria.com\", \"cuil.com\",\n      \"eniro.\", \"www.msn.com\", \".sina.com\", \"m.yahoo.co\", \".crooz.com\", \"google.co.\", \"nifty.com\", \"ezweb.ne.jp\", \"wakwak.com\",\n      \"cafesta.com\", \"webalta.ru\", \"so-net.ne.jp\", \"yahoo.\", \"livedoor.com\", \"rambler.ru\", \"berlingske.dk\", \"kelkoo.\",\n      \"sesam.\", \"aladdin.com\", \"startsiden.no\", \"ofir.dk\", \"ask.co\", \"odn.ne.jp\", \"yol.co.jp\", \"dion.ne.jp\", \"istmania.com\",\n      \"metaeureka.com\", \"khoj.com\", \"monstercrawler.com\", \"nate.com\", \"business.com\", \"nifty.com\", \"mail.ru\", \"pricerunner.se\",\n      \"altavista.no\", \"kelkoo.se\", \"altavista.dk\", \"37.com\", \"rol.ro\", \"ntsearch.com\", \"holms.ru\", \"abrexa.co.uk\", \"limeysearch.com\",\n      \"huifa.com\", \"icq.com\", \"ixquick.eu\", \"conexcol.com\", \"jopinet.com\", \"infopage.com\", \"mirago.com\", \"ixquick.eu\", \"tapuz.co.il\",\n      \"1st-spot.com\", \"dialindia.com\", \"labrujula.com\", \"naver.com\", \"libero.it\", \"buscapique.com\", \"teoma.com\", \"heureka.sk\",\n      \"galileu.com.br\", \"kvasir.no\", \"luxpoint.com\", \"irl.com\", \"iwon.com\", \"flix.de\", \"tjohoo.com\", \"findwhat.com\", \"webstudio.com\",\n      \"fleecethenet.com\", \"wp.pl\", \"feynd.com\", \"findit-quick.com\", \"webbel.com\", \"walla.co.il\", \"dir.bg\", \"gohip.com\", \"grippo.com\",\n      \"globito.com\", \"wanadoo.com\", \"truesearch.com\", \"123.cl\", \"100.nu\", \"data.ru\", \"sherlock.cz\", \"rocketlinks.com\", \"sensis.com.au\",\n      \"ukindex.co.uk\", \"ukplus.co.uk\", \"tiscali.\", \"exploora.com\", \"allsearchengines.com\", \"eniro.se\", \"gulesider.no\", \"krak.dk\",\n      \"degulesider.dk\", \"egyptsearch.com\", \"profusion.com\", \"7search.com\", \"netsprint.pl\", \"polishworld.com\", \"myway.com\", \n      \"trovator.com\", \"empas.com\", \"usseek.com\", \"quepasa.com\", \"reference.com\", \"searchnz.co.nz\", \"surf.sk\", \"supercrawler.com\", \n      \"szm.sk\", \"search.ch\", \"seznam.cz\", \"find.wanadoo.nl\", \"suche.ch\", \"southasia.net\", \"smartpages.com\", \"szm.sk\",\n      \"toile.qc.ca\", \"canada.com\", \"wizzler.com\", \"web.de\", \"topfile.com\", \"virgilio.it\", \"webcrawler.com\", \"webwombat.com\",\n      \"surfer.ch\", \"soquick.com\", \"smartbeak.com\", \"simplypets.com\", \"thunderstone.com\", \"tiscali.com\", \"theinfodepot.com\", \n      \"thebighub.com\", \"search.ch\", \"searchalot.com\", \"snap.com\", \"startingpoint.com\", \"rageworld.com\", \"orbit.net\", \"ask.com\",\n      \"point2.com\", \"scour.com\", \"northernlight.com\", \"dmoz.org\", \"live.com\", \"metacrawler.com\", \"metadog.com\", \"metaiq.com\",\n      \"nbci.com\", \"mcfind.com\", \"lycos.\", \"excite.com.au\", \"magellan.com\", \"mamma.com\", \"kanoodle.com\", \"libero.it\", \"linkcenter.com\", \n      \"looksmart.com\", \"infoseek.co.\", \"infoseek.com\", \"blucora.com\", \"infotiger.com\", \"jayde.com\", \"jubii.dk\", \"go.com\", \"idealist.com\", \n      \"hotlaunch.com\", \"overture.com\", \"highway61.com\", \"hotbot.com\", \"ilse.nl\", \"fireball.de\", \"goo.ne.jp\", \"3721.com\", \"eerstekeuze.nl\",\n      \"zoeken.nl\", \"track.nl\", \"fansites.com\", \"zoeken.hetnet.nl\", \"dog.com\", \"dictionary.com\", \"cyberbritain.com\", \"excite.com\", \n      \"excite.\", \"about.com\", \"alltheweb.com\", \"enhance.com\", \"mojeek.com\", \"searx.me\", \"scroggle.com\", \"searchencrypt.com\", \n      \"clusty.com\", \"teoma.com\", \"yippy.com\", \"search.io\", \"boardreader.com\", \"blin.com\", \"shodan.io\", \"gigablast.com\", \"carrot2.org\",\n      \"pinoyweb.com\", \"maloka.com\", \"atypon.com\", \"qwantjunior.com\", \"findsounds.com\"]\n  \n    for (let i = 0; i < socials.length; i++) {\n      if(referrer != undefined) {\n        if (referrer.indexOf(socials[i]) != -1){\n          //Handle values like t.co overriding microsoft.com then returning as social\n          //Noting that any site with a name that ends in t.com will return true here for 't.co' which is not desired so we changed it to 't.co/'\n          if (referrer.indexOf('microsoft.com') == -1) {\n            //console.log(socials[i]);\n            socialChannel = true;\n          }\n        }\n      }\n      //console.log(socialChannel);\n    }\n  \n    for (let i = 0; i < searchEngines.length; i++) {\n      if(referrer != undefined) {\n        if (referrer.indexOf(searchEngines[i]) != -1){\n          searchEnginesChannel = true;\n        }\n      }\n    }\n  \n    //if (referrerDE != undefined) {\n        if (\n          ((referrer != undefined) && ((referrer.indexOf(\"microsoft.com\") == -1) || (referrer.indexOf(\"azure.com\") == -1) || (referrer.indexOf(\"xbox.com\") == -1))) ||\n          (url.indexOf('_par_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('part_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_afc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('aff_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_aff_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('tduid') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('tduid') != -1) ||\n          (url.indexOf('aff_') != -1)\n        ) {\n            //return 'external';\n            referrerType = 'external';\n        }\n        //else if (\n        if (\n          ((referrer != undefined) && ((referrer.indexOf(\"microsoft.com\") !== -1) || (referrer.indexOf(\"azure.com\") !== -1) || (referrer.indexOf(\"xbox.com\") !== -1))) ||\n          (url.indexOf('oan_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('mscom_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('spo_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('rm_one') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('tec_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('winstore_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('oo_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (referrer == \"live.com\")\n        ) {\n            //return 'internal';\n            referrerType = 'internal';\n        } \n        // else if (\n        if (\n          (url.indexOf('cartemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('recemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('lifecycleemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('eml_cxm') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('promo') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('email_mmo') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('reviewemail') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_eml_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('eml_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_ema_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('ema_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pd_eml') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('trans') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (url.indexOf('trigger') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (url.indexOf('receipt') != -1 && url.indexOf('wt.mc_id') != -1) ||\n          (document.referrer == 'events.microsoft.com')\n        ) {\n            //return 'email';\n            referrerType = 'email';\n        } \n        //else if (\n        if (\n          (url.indexOf('_scl_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_soc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('usoc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('soc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_sol_') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_spl') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_pd_spl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_pd_scl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_pd_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pd_scl') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('_soc_pmc_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('psoc_') != -1 && url.indexOf('ocid') != -1) ||\n          (socialChannel == true)\n        ) {\n            //return 'social';\n            referrerType = 'social';\n        } \n        //else if (\n        if (\n          (referrer == null || referrer == '')\n        ) {\n            //return 'typed_bookmarked';\n            referrerType = 'typed_bookmarked';\n        } \n        //else if (\n        if (\n          (url.indexOf('seo_omc_goo') != -1 && url.indexOf('ocid') != -1) ||\n          (url.indexOf('_sem_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('pointitsem') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('ps_') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('google') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('datafeed') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('baidu') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('bing') != -1 && (url.indexOf('wt.mc_id') != -1 || url.indexOf('ocid') != -1)) ||\n          (url.indexOf('wt.mc_id') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('cn mmc') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('cr cc') != -1 && searchEnginesChannel == true) ||\n          (url.indexOf('ocid') != -1 && searchEnginesChannel == true) ||\n          (searchEnginesChannel == true)\n        ) {\n            //return 'search_engine';\n            referrerType = 'search_engine';\n        }\n    //}\n  \n    //console.log(referrerType);\n    return referrerType;\n  } //end a_getReferrerType()\n*/\n\n/***Traffic Channels***/\n//Function to get traffic details object\nfunction a_getTrafficDetails(urlPassed,referrerTypeDetailsPassed,eventNamePassed) {\n  var currentUrl = window.location.href;\n  var socialChannelFlag = false;\n  var searchEnginesChannelFlag = false;\n  var entryUrlDE = adobeSatelliteName.getVar(\"ACDL - Entry URL\");\n  var entryReferrerTypeDE = adobeSatelliteName.getVar(\"ACDL - Entry Referrer Type\");\n  var entryCustomReferrerTypeDE = adobeSatelliteName.getVar(\"ACDL - Entry Custom Referrer Type\");\n  var entryReferrerDE = adobeSatelliteName.getVar(\"ACDL - Entry Referrer\");\n  //var trafficTactic = 'Unknown trafficTactic'; //Default value\n  //var trafficChannel = 'Unknown trafficChannel'; //Default value\n  //var trafficSubChannel = 'Unknown trafficSubChannel'; //Default value\n  var trafficTactic = 'Non-Paid'; //Default value\n  var trafficChannel = 'O&O'; //Default value\n  var trafficSubChannel = 'Page_Group'; //Default value\n  //var trafficTacticILAB = 'Unknown trafficTacticILAB';\n  //var trafficChannelILAB = 'Unknown trafficChannelILAB';\n  //var trafficSubChannelILAB = 'Unknown trafficSubChannelILAB';\n  var trafficTacticILAB = 'Non-Paid';\n  var trafficChannelILAB = 'Microsoft Internal';\n  var trafficSubChannelILAB = 'Page_Group';\n  var trafficDetailsObj = {};\n  var referrerTypePassed = undefined;\n  var customReferrerTypePassed = undefined;\n  if (referrerTypeDetailsPassed !== undefined) {\n    referrerTypePassed = referrerTypeDetailsPassed.referrerType;\n    customReferrerTypePassed = referrerTypeDetailsPassed.customReferrerType;\n  }\n  //ILAB Rules that do not require an event filter\n  switch (true) {\n      //---Paid | Affiliate | NA (ILAB)\n      //Visits with 'tduid' query string parameter OR wt.mc_id contains any of _afc_, aff_, _aff_ OR ocid contains _afc_, aff_, _aff_\n      case urlPassed.indexOf('tduid') != -1:\n      case urlPassed.indexOf('_afc_') != -1  && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('aff_') != -1  && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('_aff_') != -1  && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('_afc_') != -1  && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('aff_') != -1  && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('_aff_') != -1  && urlPassed.indexOf('ocid') != -1:\n          trafficTacticILAB = 'Paid';\n          trafficChannelILAB = 'Affiliate';\n          trafficSubChannelILAB = 'NA';\n          break;\n  } //end switch\n\n  //ILAB Rules that require an event filter\n  //-Page View\n  //if (eventNamePassed == 'pageView') { //Filter to only page  (if this is actually needed when getting these details up-stream instead of in segmentation)\n    switch (true) {\n        //---Paid | Paid Social | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: _pd_scl_, _soc_pmc_, psoc_, _pd_, _pd_spl AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_pd_scl_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_soc_pmc_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('psoc_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_pd_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_pd_spl') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: _pd_scl_, _soc_pmc_, psoc_, _pd_, _pd_spl AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_pd_scl_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_soc_pmc_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('psoc_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_pd_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_pd_spl') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        //Visits with a OCID query string parameter that contains '_ola_' AND referring domain = any of: facebook.com, instagram.com, twitter.com, youtube.com AND Web Event Type ends with .PageView\n        case socialChannelFlag && urlPassed.indexOf('_ola_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case socialChannelFlag && urlPassed.indexOf('_ola_') == -1 && urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Paid';\n            trafficChannelILAB = 'Paid Social';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        //---Paid | Display | NA (ILAB)\n        //Visits with a wt.mc_id query string parameter that contains any of: criteo, _ola_, _dis_, _ad_, ad_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('criteo') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_ola_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_dis_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_ad_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('ad_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        //Visits with a OCID query string parameter that contains any of: criteo, _ola_, _dis_, _ad_, ad_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('criteo') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_ola_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_dis_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_ad_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('ad_') != -1 && urlPassed.indexOf('ocid') != -1:\n            trafficTacticILAB = 'Paid';\n            trafficChannelILAB = 'Display';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        //---Paid | Paid Search | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: _sem_, pointitsem, ps_, google, datafeed, baidu, bing AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_sem_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('pointitsem') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('ps_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('google') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('datafeed') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('baidu') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('bing') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: _sem_, pointitsem, ps_, google, datafeed, baidu, bing AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_sem_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('pointitsem') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('ps_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('google') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('datafeed') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('baidu') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('bing') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Paid';\n            trafficChannelILAB = 'Paid Search';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Non-Paid | Email | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: _eml_, _ema_, eml_, pd_eml, cartemail, recemail, lifecyclemail, eml_cxm, email_mmo, reviewemail, promo AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_eml_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_ema_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('eml_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('pd_eml') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('cartemail') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('recemail') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('lifecyclemail') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('eml_cxm') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('eml_mmo') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('reviewemail') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('promo') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: _eml_, _ema_, eml_, pd_eml, cartemail, recemail, lifecyclemail, eml_cxm, email_mmo, reviewemail, promo AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_eml_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_ema_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('eml_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('pd_eml') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('cartemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('recemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('lifecyclemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('eml_cxm') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('eml_mmo') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('reviewemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('promo') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTacticILAB = 'Non-Paid';\n          trafficChannelILAB = 'Email';\n          trafficSubChannelILAB = 'NA';\n          break; \n\n        //---Non-Paid | Owned Social | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: _scl_, _soc_, usoc_, soc_\n        case urlPassed.indexOf('_scl_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('_soc_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('usoc_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('soc_') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: _scl_, _soc_, usoc_, soc_\n        case urlPassed.indexOf('_scl_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('_soc_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('usoc_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('soc_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Owned Social';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Non-Paid | In-Product | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: _inp_, part_onedrive, ugo_, prod_, win10, oo_win10, o365_reacquisition, bizbar AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_inp_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('part_onedrive') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('ugo_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('prod_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('win10') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('oo_win10') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('o365_reacquisition') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('bizbar') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: _inp_, part_onedrive, ugo_, prod_, win10, oo_win10, o365_reacquisition, bizbar AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_inp_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('part_onedrive') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('ugo_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('prod_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('win10') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('oo_win10') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('o365_reacquisition') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('bizbar') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'In-Product';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Paid | Partner | NA (ILAB)\n        //Visits with a wt.mc_id query string parameter that contains any of: _par_, part_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_par_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('part_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        //Visits with a OCID query string parameter that contains any of: _par_, part_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('_par_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('part_') != -1 && urlPassed.indexOf('ocid') != -1:\n            trafficTacticILAB = 'Paid';\n            trafficChannelILAB = 'Partner';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        //---Non-Paid | Microsoft Internal | NA (ILAB)\n        //Visits with a OCID query string parameter that contains any of: oan_, mscom_, spo_, rm_one, tec_, winstore_, oo_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('oan_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('mscom_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('spo_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('rm_one') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('tec_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('winstore_') != -1 && urlPassed.indexOf('ocid') != -1:\n        case urlPassed.indexOf('oo_') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter that contains any of: oan_, mscom_, spo_, rm_one, tec_, winstore_, oo_ AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('oan_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('mscom_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('spo_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('rm_one') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('tec_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('winstore_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        case urlPassed.indexOf('oo_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        //Visits with referring domain = live.com AND Web Event Type ends with .PageView\n        case entryReferrerDE == 'live.com':\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Microsoft Internal';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Unknown | QSG' | NA (ILAB)\n        //Visits with a OCID query string parameter = qsg AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('qsg') != -1 && urlPassed.indexOf('ocid') != -1:\n        //Visits with a wt.mc_id query string parameter = qsg AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('qsg') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Unknown';\n            trafficChannelILAB = 'QSG';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Unknown | Other Campaigns | NA (ILAB)\n        //Visits where a OCID query string parameter is set AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('ocid') != -1:\n        //Visits where a wt.mc_id query string parameter is set AND Web Event Type ends with .PageView\n        case urlPassed.indexOf('wt.mc_id') != -1:\n            trafficTacticILAB = 'Unknown';\n            trafficChannelILAB = 'Other Campaigns';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        //---Non-Paid | Microsoft Internal | NA (ILAB - Lower priority) \n        //Visits where Web Event Type ends with .PageView and Entry Referrer Type = Microsoft\n        case entryCustomReferrerTypeDE == 'Microsoft':\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Microsoft Internal';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Non-Paid | Organic Search | NA (ILAB)\n        //Visits where Web Event Type ends with .PageView and Entry Referrer Type = Organic Search\n        case entryCustomReferrerTypeDE == 'Organic Search':\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Organic Search';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Non-Paid | Organic Social | NA (ILAB)\n        //Visits where Web Event Type ends with .PageView and Entry Referrer Type = Social Media\n        case entryCustomReferrerTypeDE == 'Social Media':\n        case socialChannelFlag:\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Organic Social';\n            trafficSubChannelILAB = 'NA';\n            break;\n\n        //---Non-Paid | External | NA (ILAB)\n        //Visits where Web Event Type ends with .PageView and Entry Referrer Type = External\n        case entryCustomReferrerTypeDE == 'External':\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'External';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        //---Non-Paid | Direct | NA (ILAB)\n        //Visits where Web Event Type ends with .PageView and Entry Referrer Type = Direct Traffic\n        case entryCustomReferrerTypeDE == 'Direct Traffic':\n        //case entryReferrerDE == null:\n        //case entryReferrerDE == '':\n            trafficTacticILAB = 'Non-Paid';\n            trafficChannelILAB = 'Direct';\n            trafficSubChannelILAB = 'NA';\n            break;\n        \n        /*\n        //---Non-Paid | Microsoft Internal | Page_Group (ILAB)\n        //Visits were Web Event Type ends with .PageView (Default for ILAB)\n        //Moving ILAB default to top where vars are declared\n        case '':\n          trafficTacticILAB = 'Non-Paid';\n          trafficChannelILAB = 'Microsoft Internal';\n          trafficSubChannelILAB = 'Page_Group';\n          break;\n        */\n    } //end switch\n  //} //end event filter (Page View)\n\n  //DSR Rules that do not require an event filter\n  //--No DSR rules listed that do not require event filter\n\n  //DSR Rules that require and event filter\n  //-Page View\n  //if (eventNamePassed == 'pageView') { //Filter to only page  (if this is actually needed when getting these details up-stream instead of in segmentation)\n      \n      //---Non-Paid | Social | Organic Social (Default) (DSR)\n      //When a visit's referring domain is from a known* Social Media Site. This is based on the MSFT Standard referrer logic enriched in COSMOS. Web event type ends with .pageview.\n      //if (referrerTypeDE == 'social') {\n      if (entryReferrerTypeDE == 'social') {\n      //if (referrerTypePassed == 'social') {\n          socialChannelFlag = true;\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'Social';\n          trafficSubChannel = 'Organic Social'\n      }\n\n      //---Non-Paid | Organic Search | Organic Search (Default) (DSR)\n      //When a visit's referring domain was from a known* search engine, and does not have a campaign parameter in the query string. This is based on the MSFT Standard referrer logic enriched in COSMOS. Web event type ends with .pageview.\n      //--AND\n      //--Paid | Paid Search | Paid Serch (Default) (DSR)\n      //When a visit's referring domain is from a known* search engine, and has a campaign parameter (wt.mc _ id, ocid, cm mmc, cr cc) in the query string. This is based on the MSFT Standard referrer logic enriched in COSMOS. Web event type ends with .pageview.\n      //f (referrerTypeDE == 'search_engine') {\n      if (entryReferrerTypeDE == 'search_engine') {\n      //if (referrerTypePassed == 'search_engine') {\n          searchEnginesChannelFlag = true;\n          if (\n              (entryReferrerDE.indexOf('ocid') != -1) ||\n              (entryReferrerDE.indexOf('wt.mc_id') != -1) ||\n              (entryReferrerDE.indexOf('cmmmc') != -1) ||\n              (entryReferrerDE.indexOf('crcc') != -1)\n          ) {\n              trafficTactic = 'Paid';\n              trafficChannel = 'Paid Search';\n              trafficSubChannel = 'Paid Search'\n          } else {\n              trafficTactic = 'Non-Paid';\n              trafficChannel = 'Organic Search';\n              trafficSubChannel = 'Organic Search'\n          }\n\n      }\n\n      //---Non-Paid | Direct Traffic | Direct Traffic (Default) (DSR)\n      //When a visit's referring domain is empty/null (e.g. referrer url is stripped by a re-direct, the visitor refreshed the page, or typed in URL directly in browser or bookmarked the page)\u200b. This is based on the MSFT Standard referrer logic enriched in COSMOS. Web event type ends with .pageview.\n      //if (referrerTypeDE == 'typed_bookmarked') {\n      if (entryReferrerTypeDE == 'typed_bookmarked') {\n      //if (referrerTypePassed == 'typed_bookmarked') {\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'Direct Traffic';\n          trafficSubChannel = 'Direct Traffic'\n      }\n\n      //---Non-Paid | External | External (Default) (DSR)\n      //When a visit's referring domain is populated but is not a Microsoft referrer. This is based on the MSFT Standard referrer logic enriched in COSMOS. Web event type ends with .pageview.\n      //if (referrerTypeDE == 'external') {\n      if (entryReferrerTypeDE == 'external') {\n      //if (referrerTypePassed == 'external') {\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'External';\n          trafficSubChannel = 'External'\n      }\n\n //some comments show items that needed to be added\n  switch (true){\n      //---Paid | Affiliate | Afilliate (DSR)\n      //Visits with 'tduid' query string parameter or 'aff_' and web event type ends with .pageview\n      case urlPassed.indexOf('tduid') != -1:\n        case urlPassed.indexOf('aff_') != -1:\n            trafficTactic = 'Paid';\n            trafficChannel = 'Affiliate';\n            trafficSubChannel = 'Affiliate';\n            break;\n\n      //---Paid | Paid Search | Paid Search - PointIt (DSR)\n      //Visits with a wt.mc_id query string parameter that contains 'pointitsem' and web event type ends with .pageview\n\n      //---Paid | Paid Display | Paid Display (DSR)\n      //Visits with a OCID query string parameter that contains '_ola_' and web event type ends with .pageview\n      //Visits with a wt.mc _ id query string parameter that contains '_ola_' and web event type ends with .pageview\n      case urlPassed.indexOf('_ola_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('_ola_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTactic =  'Paid';  \n          trafficChannel = 'Paid Display';\n          trafficSubChannel = 'Paid Display';\n          break;\n\n      //---Paid | Paid Search | Paid Search (DSR)\n      //Visits with a OCID query string parameter that contains '_sem_' and web event type ends with .pageview\n      //Visits with a wt.mc_id query string parameter that contains '_ sem_' and web event type ends with .pageview\n      case urlPassed.indexOf('_sem_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('_sem_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n\n    //Unsure about the requirements below. are they for ILAB?\n      // When a visit's referring domain is from a known* search engine, \n      // and has a campaign parameter (wt.mc_id, ocid, cm mmc, cr cc) in the query string.\n      // \tVisits with a OCID query string parameter that contains any of: _sem_, pointitsem, ps_, google, datafeed, baidu, bing\n      // Visits with a wt.mc_id query string parameter that contains any of: _sem_, pointitsem, ps_, google, datafeed, baidu, bing\n      // case searchEnginesChannelFlag &&:\n          trafficTactic = 'Paid';\n          trafficChannel = 'Paid Search';\n          trafficSubChannel = 'Paid Search';\n          break;\n      \n      //---Paid | Paid Social | Paid Social (DSR)\n      //Visits with a OCID query string parameter that contains 'pd_scl' OR 'PSOC_' ('PSOC_' added on Dec 1, 2021) and web event type ends with .pageview\n      //Visits with a wt.mc _ id query string parameter that contains '_ sem_' and web event type ends with .pageview\n      case urlPassed.indexOf('pd_scl') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('PSOC_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('pd_scl') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTactic = 'Paid';\n          trafficChannel = 'Paid Social';\n          trafficSubChannel = 'Paid Social';\n          break;      \n\n      //---Paid | Paid Email | Paid Email (DSR)\n      //Visits with a OCID query string parameter that contains 'pd_eml' and web event type ends with .pageview\n      //Visits with a wt.mc _ id query string parameter that contains 'pd _ eml' and web event type ends with .pageview\n      case urlPassed.indexOf('pd_eml') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('pd_eml') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTactic = 'Paid';\n          trafficChannel = 'Paid Email';\n          trafficSubChannel = 'Paid Email';\n          break;\n\n      //---Non-Paid | Email | Email - Cart Recovery (DSR)\n      //Visits with a wt.mc_id query string parameter that contains 'cartemail' and web event type ends with .pageview\n      case urlPassed.indexOf('cartemail') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('cartemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Lifecycle';\n        break; \n\n      //---Non-Paid | Email | Email - Cross Sell (DSR)\n      //Visits with a wt.mc_id query string parameter that begins with 'recemail' and web event type ends with .pageview\n      case urlPassed.indexOf('recemail') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('recemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Lifecycle';\n        break; \n      \n      //---Non-Paid | Email | Email - Lifecycle (DSR)\n      //Visits with a wt.mc_id query string parameter that begins with 'lifecycleemail' and web event type ends with .pageview\n      case urlPassed.indexOf('lifecycleemail') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('lifecycleemail') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Lifecycle';\n        break; \n        \n      //---Non-Paid | Email | Email - Office CXM (DSR)\n      //Visits with a wt.mc_id query string parameter that begins with 'eml_cxm' and web event type ends with .pageview\n      case urlPassed.indexOf('eml_cxm') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('eml_cxm') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Office CXM';\n        break;\n\n      //---Non-Paid | Email | Email - Store Promotional (DSR)\n      //Visits with a wt.mc_id query string parameter that begins with 'promo' and web event type ends with .pageview\n      case urlPassed.indexOf('promo') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('promo') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Store Promotional';\n        break;\n\n      //---Non-Paid | Email | Email - Transactional (DSR)\n      //Visits with a wt.mc_id query string parameter that begings with 'trans', 'trigger', or 'receipt' and web event type ends with .pageview\n      case urlPassed.indexOf('trans') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('trigger') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('receipt') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Transactional';\n        break;\n\n      //---Non-Paid | Email | Email - Store Email (DSR)\n      //Visits with a OCID query string parameter that begins with 'ema_' OR contains '_ema_' and web event type ends with .pageview\n      case urlPassed.indexOf('_ema_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('ema_') != -1 && urlPassed.indexOf('ocid') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email - Store Email';\n        break;\n      \n      //---Non-Paid | Email | Email (DSR)\n      //Visits with an entry referrer domain that equals events.microsoft.com and web event type ends with .pageview (Added May 1, 2024)\n      //Note: This one is listed in the martech portal as lower priority so it may need to be moved down.\n      //case referrerUrlPassed == 'events.microsoft.com':\n      case entryReferrerDE == 'events.microsoft.com':\n      //Visits with a OCID query string parameter that contains '_eml_' or 'eml_' and web event type ends with .pageview\n      case urlPassed.indexOf('_eml_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('eml_') != -1 && urlPassed.indexOf('ocid') != -1:\n      //Visits with a wt.mc_id query string parameter that contains ' _eml_' or 'eml_' and web event type ends with .pageview\n      case urlPassed.indexOf('_eml_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n      case urlPassed.indexOf('eml_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n        trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email';\n        break;\n\n      //---Social - Sprinklr (DSR)\n      //Visits with an OCID query string parameter that contains '_scl_' OR '_spl' OR '_soc_' and web event type ends with .pageview\n      case urlPassed.indexOf('_scl_') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('_spl') != -1 && urlPassed.indexOf('ocid') != -1:\n      case urlPassed.indexOf('_soc_') != -1 && urlPassed.indexOf('ocid') != -1:\n      //Visits with a wt.mc_id query string parameter that contains '_ scl_' and web event type ends with .pageview\n      case urlPassed.indexOf('_scl_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'Social';\n          trafficSubChannel = 'Social - Sprinklr';\n          break;\n\n      //---Non-Paid | In-Product | CRM (DSR)\n      //Visits with a OCID query string parameter that contains 'crmip_' and web event type ends with .pageview\n      case urlPassed.indexOf('crmip_') != -1 && urlPassed.indexOf('ocid') != -1:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'In-Product';\n          trafficSubChannel = 'CRM';\n          break;\n\n      //---Non-Paid | Organic Search | Organic Shopping (DSR)\n      //Visits with a OCID query string parameter that contains 'seo_omc_goo' and web event type ends with .pageview\n      case urlPassed.indexOf('seo_omc_goo') != -1 && urlPassed.indexOf('ocid') != -1:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'Organic Search';\n          trafficSubChannel = 'Organic Shopping';\n          break;\n\n      //---Non-Paid | O&O | Product (DSR)\n      //Visits with a OCID query string parameter that contains ' _qsg_' and web event type ends with .pageview\n      case urlPassed.indexOf('_qsg_') != -1 && urlPassed.indexOf('ocid') != -1:\n      //Visits with a wt.mc_id query string parameter that contains ' _qsg_' and web event type ends with .pageview\n      case urlPassed.indexOf('_qsg_') != -1 && urlPassed.indexOf('wt.mc_id') != -1:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'O&O';\n          trafficSubChannel = 'Product';\n          break;\n      \n      //---Non-Paid | O&O | Support (DSR)\n      //Visits with an OCID query string parameter that starts with \u201coo_support\u201d and web event type ends with .pageview\n      case urlPassed.indexOf('oo_support') != -1 && urlPassed.indexOf('ocid') != -1:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'O&O';\n          trafficSubChannel = 'Support';\n          break;\n\n      //---Non-Paid | Email | Email (DSR)\n      //----This is listed as a lower priority than O&O Support in the martech portal documentation\n      //Visits with an entry referrer domain that equals events.microsoft.com and web event type ends with .pageview (Added May 1, 2024)\n      case entryReferrerDE == 'events.microsoft.com':\n       trafficTactic = 'Non-Paid';\n        trafficChannel = 'Email';\n        trafficSubChannel = 'Email';\n        break;\n\n\n      /*\n      //---Non-Paid | O&O | Page_Group (DSR)\n      //When a visit does not meet any of the criteria above. Web event type ends with .pageview.\n      //Moving DSR default to top where vars are declared\n      default:\n          trafficTactic = 'Non-Paid';\n          trafficChannel = 'O&O';\n          trafficSubChannel = 'Page_Group';\n      */\n  } //end switch\n//} //end event filter (Page View)\n  //Build final return object\n  trafficDetailsObj = {\n      \"DSR\": {\n        \"trafficTactic\":trafficTactic,\n        \"trafficChannel\":trafficChannel,\n        \"trafficSubChannel\":trafficSubChannel,\n        \"trafficDetailsFriendlyName\":trafficTactic+' | '+trafficChannel+' | '+trafficSubChannel\n      },\n      \"ILAB\": {\n        \"trafficTacticILAB\":trafficTacticILAB,\n        \"trafficChannelILAB\":trafficChannelILAB,\n        \"trafficSubChannelILAB\":trafficSubChannelILAB,\n        \"trafficDetailsFriendlyNameILAB\":trafficTacticILAB+' | '+trafficChannelILAB+' | '+trafficSubChannelILAB\n      }\n  };\n\n  return trafficDetailsObj;\n}\n\n  //Function to set the data layer by passing an event\n  function setAdobeDataLayer(eventNamePassed,eventPathPassed,eventPayloadPassed) {\n    //Reset on-the-fly (OTF) variables\n    a_resetOtfVars();\n\n    //Bring in Data Elements\n    //Event Info\n    var eventName = eventNamePassed;\n    var eventDataName = \"Unknown eventDataName\";\n    var eventPath = eventPathPassed;\n    var eventActionType = \"O\" //Default to \"O\" for other\n    var eventBehaviorID = \"Unknown eventBehaviorID\";\n    var eventBehaviorCategory = \"Unknown eventBehaviorCategory\"\n    var eventCategory = \"Unknown eventCategory\";\n\n    //Component Info\n    var dlPathSelector;\n    var componentFlag = \"N\";\n    var componentIDDE = adobeSatelliteName.getVar(\"Component ID\");\n    var componentID = \"Unknown componentID\";\n    //var componentTitleDE = adobeSatelliteName.getVar(\"Component Title\");\n    var componentTitle = \"Unknown componentTitle\";\n    var componentType = \"Unknown componentType\";\n\n    //Visior Profile\n    //var ECIDDE = adobeSatelliteName.getVar(\"ECID\");\n    var visitorECIDDE = adobeSatelliteName.getVar(\"ECID\");\n    var anonIdDE = adobeSatelliteName.getVar(\"ACDL - ANON Cookie\");\n    var mc1GUIDDE = adobeSatelliteName.getVar(\"ACDL - MC1 GUID\");\n    var marketoLeadIdDE = adobeSatelliteName.getVar(\"ACDL - Marketo Lead ID\");\n    var marketoMunchkinCookieDE = adobeSatelliteName.getVar(\"ACDL - Munchkin Cookie\");\n    var identityMapDE = adobeSatelliteName.getVar(\"ACDL - Identity Map\");\n    var consentApiObjectFlagDE = adobeSatelliteName.getVar(\"ACDL - Consent API Object Flag\");\n    var consentsSnapshotDE = adobeSatelliteName.getVar('ACDL - Consents and Preferences Snapshot');\n    var a_msftSegmentQualificationFlag = 0;\n\n    //Environment\n    var environmentLanguageDE = adobeSatelliteName.getVar(\"ACDL - Environment Language\");\n\n    //Site Info\n    var siteIDDE = adobeSatelliteName.getVar(\"ACDL - Site ID\");\n    var siteDomainDE = adobeSatelliteName.getVar(\"ACDL - Site Domain\");\n    var siteBrandDE = adobeSatelliteName.getVar(\"ACDL - Site Brand\");\n    var siteLocaleDE = adobeSatelliteName.getVar(\"ACDL - Site Locale\");\n    var siteLanguageDE = adobeSatelliteName.getVar(\"ACDL - Site Language\");\n    var siteMarketDE = adobeSatelliteName.getVar(\"ACDL - Site Market\");\n    var siteNameDE = adobeSatelliteName.getVar(\"ACDL - Site Name\");\n\n    //Place Context\n    var countryCodeDE = adobeSatelliteName.getVar(\"ACDL - Country Code\");\n    var longitudeDE = adobeSatelliteName.getVar(\"longitude\");\n    var latitudeDE = adobeSatelliteName.getVar(\"latitude\");\n\n    var userAgentDE = adobeSatelliteName.getVar(\"ACDL - User Agent\");\n\n    //Web Session\n    var webSessionDetailsObjDE = adobeSatelliteName.getVar(\"ACDL - Web Session Details\");\n    var sessionIDDE = adobeSatelliteName.getVar(\"ACDL - Session ID\");\n    var hitNumberDE = adobeSatelliteName.getVar(\"ACDL - Hit Number\");\n    var entryReferrerDE = adobeSatelliteName.getVar(\"ACDL - Entry Referrer\");\n    var entryReferrerDetailsDE = adobeSatelliteName.getVar(\"ACDL - Entry Referrer Type Details\");\n    var entryReferrerTypeDE = adobeSatelliteName.getVar(\"ACDL - Entry Referrer Type\");\n    var entryUrlDE = adobeSatelliteName.getVar(\"ACDL - Entry URL\");\n    //var entryReferrerType = a_getReferrerType(entryReferrerDE);\n    //var entryTrafficDetailsObj = a_getTrafficDetails(entryReferrerDE,entryReferrerTypeDE,eventName);\n\n    //Page Info\n    var pageIDDE = adobeSatelliteName.getVar(\"ACDL - Page ID\");\n    var pageNameDE = adobeSatelliteName.getVar(\"ACDL - Page Name\");\n    var componentPath = \"component.\"+componentIDDE;\n    var contentPathDE = adobeSatelliteName.getVar(\"ACDL - Content Path\");\n    var pagePath = \"page.\"+pageIDDE\n    var pageUrlDE = adobeSatelliteName.getVar(\"ACDL - URL\");\n    var pageUrlQsDE = adobeSatelliteName.getVar(\"ACDL - URLQS\");\n    var pageUrlNoQsDE = adobeSatelliteName.getVar(\"ACDL - URL Without QS\");\n    var pageCategoryDE = adobeSatelliteName.getVar(\"ACDL - Page Category\");\n    var pageTypeDE = adobeSatelliteName.getVar(\"ACDL - Page Type\");\n    var pageMetaContentTypeDE = adobeSatelliteName.getVar(\"ACDL - Meta - Page Content Type\");\n    var pageMetaThumbnailImgDE = adobeSatelliteName.getVar(\"ACDL - Meta - Thumbnail Image\");\n    var pageHeroImageDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image\");\n    var pageHeroImageContainerIDDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Container ID\");\n    var pageHeroImageContainerTypeDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Container Type\");\n    var pageHeroImageContainerTitleDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Container Title\");\n    var pageHeroImageAssetIDDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Asset ID\");\n    var pageHeroImageRepoPathDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Repo Path\");\n    var pageHeroImageRepoMobilePathDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Repo Mobile Path\");\n    var pageHeroImageDCTitleDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image DC Title\");\n    var pageHeroImageTypeDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Type\");\n    var pageHeroImageFileExtensionDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image File Extension\");\n    var pageHeroImageRepoModifyDateDE = adobeSatelliteName.getVar(\"ACDL - Page Hero Image Repo Modify Date\");\n    var prevPageUrlDE = adobeSatelliteName.getVar(\"ACDL - Previous Page URL\");\n    var isErrorPageFlagDE = adobeSatelliteName.getVar(\"ACDL - Error Page Flag\");\n    var isHomePageFlagDE = adobeSatelliteName.getVar(\"ACDL - Home Page Flag\");\n    var pageLoadTimeDE = adobeSatelliteName.getVar(\"dl_pageLoadTime\");\n    var pageLoadTimeRangeDE = adobeSatelliteName.getVar(\"dl_pageLoadTimeRange\");\n    var currentPageName;\n    var pageReferrerDE = adobeSatelliteName.getVar('ACDL - Referrer');\n    var pageReferrerTypeDE = adobeSatelliteName.getVar('ACDL - Referrer Type');\n    var pageReferrerTypeDetails = a_getReferrerType(pageReferrerDE);\n    var pageReferrerType = pageReferrerTypeDetails.referrerType;\n    var pageCustomReferrerType = pageReferrerTypeDetails.referrerType;\n    var pageCustomReferrerType;\n    var pageTrafficDetails = a_getTrafficDetails(pageReferrerDE,pageReferrerTypeDetails,eventName);\n    //var prevPageNameDE = adobeSatelliteName.getVar(\"Previous Page Name\");\n    var prevPageName;\n    var prevPageNameUpdatedFlag;\n    var prevPageUrlDE = adobeSatelliteName.getVar('ACDL - Previous Page URL');\n    var aemTagsArrayDE = adobeSatelliteName.getVar(\"ACDL - AEM Tags\");\n    //var pageOrientationDE = adobeSatelliteName.getVar(\"Page Orientation\");\n    //var viewportSizeDE = adobeSatelliteName.getVar(\"Viewport Size\");\n    var a_msftpageCategoryFlag = 0;\n    var a_datePublishedStringDE = adobeSatelliteName.getVar(\"ACDL - Date Published String\");\n    var a_datePublishedUnixDE = adobeSatelliteName.getVar(\"ACDL - Date Published Unix\");\n    var a_publicationDateMetaDE = adobeSatelliteName.getVar(\"Meta - Published Date\");\n    var a_msftPageViewFlagDE = adobeSatelliteName.getVar(\"ACDL - Page View Flag\");\n    var a_msftPageViewFlag = 0;\n    //var a_msftConsentBannerVisibilityFlag = false;\n    var msftConsentBannerVisibilityFlagDE = adobeSatelliteName.getVar(\"ACDL - Consent Banner Visibility Flag\");\n\n    //Campiagn Info\n    var campaignIDDE = adobeSatelliteName.getVar(\"ACDL - OCID\");\n    var campaignDetailsDE = adobeSatelliteName.getVar(\"ACDL - Campaign Details\");\n    var utmCampaignDE = adobeSatelliteName.getVar(\"ACDL - UTM Campaign\");\n    var utmContentDE = adobeSatelliteName.getVar(\"ACDL - UTM Content\");\n    var utmIdDE = adobeSatelliteName.getVar(\"ACDL - UTM ID\");\n    var utmMediumDE = adobeSatelliteName.getVar(\"ACDL - UTM Medium\");\n    var utmSourceDE = adobeSatelliteName.getVar(\"ACDL - UTM Source\");\n    var utmTermDE = adobeSatelliteName.getVar(\"ACDL - UTM Term\");\n    var ocidTrackingCode = adobeSatelliteName.getVar(\"ACDL - OCID\");\n    var icidTrackingCodeDE = adobeSatelliteName.getVar(\"ACDL - ICID (Internal Campaign ID)\");\n\n\n\n    \n    var elementType = \"Unknown elementType\";\n    var elementLinkName = \"Unknown elementLinkName\";\n    var elementLinkType = \"other\";\n\n    //Page Meta\n    var metaOgTitleDE = adobeSatelliteName.getVar(\"Meta - OG Title\");\n    var metaOgUrlDE = adobeSatelliteName.getVar(\"Meta - OG URL\");\n    var metaPageTemplateDE = adobeSatelliteName.getVar(\"Meta - Page Template\");\n    var metaDescriptionDE = adobeSatelliteName.getVar(\"Meta - Description\");\n    var metaAwaCmsDE = adobeSatelliteName.getVar(\"Meta - AWA CMS\");\n    var metaAwaMarketDE = adobeSatelliteName.getVar(\"Meta - AWA Market\");\n    var metaAwaPageTypeDE = adobeSatelliteName.getVar(\"Meta - AWA Page Type\");\n    var metaAwaPageTemplateDE = adobeSatelliteName.getVar(\"Meta - AWA Page Template\");\n    var metaAwaIsTentedFlagDE = adobeSatelliteName.getVar(\"Meta - AWA Is Tented Flag\");\n    var metaAwaCanvasTypeDE = adobeSatelliteName.getVar(\"Meta - AWA Canvas Type\");\n    \n    //Video Interaction Details\n    var videoInteractionDetails;\n  \n\n    //Handle pageView\n    //Set eventDataName and eventBehaviorID and eventCategory\n    if (eventName == \"pageView\") {\n      eventDataName = \"page view\";\n      eventBehaviorID = \"O\";\n      eventBehaviorCategory = \"Page View/Content Update\"\n      eventCategory = \"Page View/Content Update\"\n    }\n    \n    if (eventPath == null || eventPath == undefined) {\n      eventPath = pagePath;\n    }\n    \n\n    //Handle Components\n    if (eventPath !== null && eventPath != undefined) {\n      //Set Payload for Components\n      if (eventPath.indexOf('component.') !== -1) {\n        componentFlag = \"Y\";\n        // split on the `.` to get component ID\n        componentID = eventPath.split('.')[1];\n        componentPath =  eventPath;\n      }\n      //if (componentIDDE != 'undefined') {\n      if (componentPath != undefined) {\n        if (adobeDataLayer.getState(componentPath) != undefined) {\n          ////console.log('componentPath found: '+componentPath);\n          \n          //Get componentTitle\n          dlPathSelector = componentPath+'.dc:title';\n          ////console.log('dlPathSelector set to: '+dlPathSelector);\n          if (adobeDataLayer.getState(dlPathSelector) != undefined) {\n            componentTitle = adobeDataLayer.getState(dlPathSelector);\n            ////console.log('DL Component Title Found: '+componentTitle);\n          }\n\n          //Get componentType\n          dlPathSelector = componentPath+'.@type';\n          ////console.log('dlPathSelector set to: '+dlPathSelector);\n          if (adobeDataLayer.getState(dlPathSelector) != undefined) {\n            componentType = adobeDataLayer.getState(dlPathSelector);\n            ////console.log('DL Component Title Found: '+componentTitle);\n            //--AEM Core Component - Accordion\n            if (componentType == 'cep/components/accordion/item') {\n              elementType = 'Accordion Item';\n              elementLinkName = 'Accordion Action';\n              elementLinkType = 'Other';\n            }\n            \n            //--Universal Media Player\n            if (componentType == 'components/universal-media-player/video') {\n              elementType = 'Video';\n              elementLinkName = 'Video Interaction';\n              elementLinkType = 'Other';\n            }\n          }\n        }\n      }\n    }\n  \n    //Handle video events\n    //--videoPlay\n    if (eventName == 'videoPlay') {\n      if (eventPayloadPassed !== undefined) {\n        if (eventPayloadPassed.videoInteractionDetails !== undefined) {\n          videoInteractionDetails = eventPayloadPassed.videoInteractionDetails;\n        }\n      }\n    }\n\n    //Update VisitorProfile attributes\n    //Segmentation Qualification\n    if (typeof(window.adobeDataLayer) != \"undefined\") {\n        if (typeof(window.adobeDataLayer.getState('visitorProfile')) != \"undefined\") {\n            if (typeof(window.adobeDataLayer.getState('visitorProfile').segmentQualificationFlag) != \"undefined\") {\n              a_msftSegmentQualificationFlag = window.adobeDataLayer.getState('visitorProfile').segmentQualificationFlag;\n            } else {\n              a_msftSegmentQualificationFlag = 0;\n            }\n            if (typeof(window.adobeDataLayer.getState('visitorProfile').pageCategoryFlag) != \"undefined\") {\n              a_msftpageCategoryFlag = window.adobeDataLayer.getState('visitorProfile').pageCategoryFlag;\n            } else {\n              a_msftpageCategoryFlag = 0;\n            }\n        }\n    }\n\n  /*\n    //Function has been moved to the action setting all global functions\n    function a_getAemTagValues(item,index) {\n        var aemTagValue = item.innerText;\n        aemTagValuesArray.push(aemTagValue);\n    }\n \n    //Create array of all AEM tags on the page\n    if(document.querySelectorAll(\".related-topics-list span.c-list__text\").length !== 0) {\n        aemTagsArrayRaw = document.querySelectorAll(\".related-topics-list span.c-list__text\");\n        aemTagsArray = Array.from(aemTagsArrayRaw); //Convert nodelist to array\n        aemTagsArray.forEach(a_getAemTagValues);\n    }\n    \n    //Put the AEM tags array in the data layer\n    if(typeof(window.adobeDataLayer) != undefined) {\n        if(typeof(window.adobeDataLayer.pageInfo) != undefined) {\n            window.adobeDataLayer.pageInfo.aemTags = aemTagValuesArray;\n        }\n    }\n*/\n    if (typeof(window.adobeDataLayer) != \"undefined\") {\n        if (typeof(window.adobeDataLayer.getState('page.'+pageIDDE)) != \"undefined\") {\n            if (typeof(window.adobeDataLayer.getState('page.'+pageIDDE+'.pageName')) != \"undefined\") {\n                currentPageName = window.adobeDataLayer.getState('page.'+pageIDDE+'.pageName');\n            }\n        }\n    }\n\n    if (!String.prototype.endsWith) {\n        String.prototype.endsWith = function(search, this_len) {\n          if (this_len === undefined || this_len > this.length) {\n            this_len = this.length;\n          }\n          return this.substring(this_len - search.length, this_len) === search;\n        };\n    }\n\n    var pagepath = window.location.pathname.split('/');\n    var pagepathRaw = window.location.pathname;\n\n    if(pagepath.length > 0) {\n        if(pagepath[pagepath.length-1].endsWith('.html')) {\n            pagepath.splice(pagepath.length-1);\n        }\n        if(pagepath[0] === \"\") {\n            pagepath.splice(0, 1);\n        }\n    }\n\n    var siteSection1 = (pagepath.length > 0) ? pagepath[0] : \"\";\n    var siteSection2 = (pagepath.length > 1) ? pagepath[1] : \"\";\n    var siteSection3 = (pagepath.length > 2) ? pagepath[2] : \"\";\n    var siteSection4 = (pagepath.length > 3) ? pagepath[3] : \"\";\n    var siteSection5 = (pagepath.length > 4) ? pagepath[4] : \"\";\n    var siteSection6 = (pagepath.length > 5) ? pagepath[5] : \"\";  \n \n\n/*\n    //Page Category History\n    //Create an array to hold the page category history\n    var a_pageCategoryHistory = [];\n    //Populate the array with the session storage value if there is one\n    if (typeof(sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\")) != undefined) {\n      if (sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== null && sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== 'null' && sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== 'undefined' && sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\") !== '') {\n        a_pageCategoryHistory = JSON.parse(sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\"));\n        //a_pageCategoryHistory = sessionStorage.getItem(\"a_profilePageCategoryHistoryArray\");\n      }\n    }\n\n    //push current page category into the end of the array for all page category history.\n    if (a_msftpageCategoryFlag == 0) {\n      a_pageCategoryHistory.push(pageCategoryDE);\n      a_msftpageCategoryFlag = 1\n    }\n\n    //set session storage to new array values\n    sessionStorage.setItem(\"a_profilePageCategoryHistoryArray\",JSON.stringify(a_pageCategoryHistory));\n\n    //Limit size of the a_pageCategoryHistory array to 100 items with index 0-99 remaining\n    //--note this code is not yet finished as of 2022/11/22\n    a_pageCategoryHistory.splice(100);\n  \n    //Add audience segments before page load (set in adobeDataLayer)\n    var qualifyingSegment;\n    var a_campaignDetailsDE = adobeSatelliteName.getVar(\"Campaign Details\");\n    //Exclude visits with the following utms present social-dark,social-boost,paid social,search,email (these are associated with non-organic visits)\n    //--Using Campaign Details element to ensure it is for all visitors with the non-qualifying campaign values and not just on the landing page (as with document.location.href)\n    if (\n        (a_campaignDetailsDE == null) ||\n        (\n            (a_campaignDetailsDE !== null) &&\n            (a_campaignDetailsDE.indexOf('social-dark') !== -1) &&\n            (a_campaignDetailsDE.indexOf('social-boost') !== -1) &&\n            (a_campaignDetailsDE.indexOf('paid social') !== -1) &&\n            (a_campaignDetailsDE.indexOf('search') !== -1) &&\n            (a_campaignDetailsDE.indexOf('email') !== -1)\n        )\n    ) {\n        //Segment 1 - Corporate Leadership\n        //if (pagepathRaw.indexOf(\"/company\") !== -1) {\n        if (pagepathRaw.indexOf(\"/about-us\") !== -1) {\n            //if the user has more than one page view to an /about-us (formerly /company) page in the same visit they qualify for the segment\n            if (a_countArrayVals(a_pageCategoryHistory,\"Company\") >= 2) {\n                qualifyingSegment = \"Corporate Leadership\"\n            }\n        }\n        //Segment 2 - Brands / Informed Consumer\n        if (pagepathRaw.indexOf(\"/brands\") !== -1) {\n            //If the user visits /brands at least once they qualify for the segement\n            qualifyingSegment = \"Informed Consumer\";\n        }\n        //Segment 3 - ESG\n        if (\n            (pagepathRaw.indexOf(\"/sustainability\") !== -1) ||\n            (pagepathRaw.indexOf(\"/esg-resource-center\") !== -1) ||\n            (pagepathRaw.indexOf(\"/reports/business-environmental-social-governance\") !== -1)\n        ) {\n            //If the user has more than one page view to any sustainability category page in the same visit they qualify for the segment\n            if (a_countArrayVals(a_pageCategoryHistory,\"Sustainability\") >= 2) {\n                qualifyingSegment = \"ESG\";\n            }\n        }\n        //Segment 4 - PolicyMakers/Influencers\n        if (\n            //(pagepathRaw.indexOf(\"/social-impact\") !== -1) ||\n            //(pagepathRaw.indexOf(\"/policies-and-practices\") !== -1)\n            (pagepathRaw.indexOf(\"/social\") !== -1) ||\n            (pagepathRaw.indexOf(\"/legal\") !== -1) ||\n            (pagepathRaw.indexOf(\"/policies\") !== -1)\n        ) {\n            //If the user has more than one page view to any /shared-future /social-impact /policies-and-practices category page or any in the same visit they qualify for the segment\n            if (\n                (\n                    (a_countArrayVals(a_pageCategoryHistory,\"Social Impact\") >= 1) &&\n                    (a_countArrayVals(a_pageCategoryHistory,\"Policies and Practices\") >= 1)\n                ) ||\n                (\n                    (a_countArrayVals(a_pageCategoryHistory,\"Social Impact\") >= 2) ||\n                    (a_countArrayVals(a_pageCategoryHistory,\"Policies and Practices\") >= 2)\n                )\n            ) {\n                qualifyingSegment = \"PolicyMakers/Influencers\";\n            }\n        }\n        //Segment 5 - Advocates\n        //if (pagepathRaw.indexOf(\"/news\") !== -1) {\n        if (pagepathRaw.indexOf(\"/media-center\") !== -1) {\n            //If the user has more than one page view to any /news category page or any in the same visit they qualify for the segment\n            if (a_countArrayVals(a_pageCategoryHistory,\"Media Center\") >= 2) {\n                qualifyingSegment = \"Advocates\";\n            }\n        }\n        //Segment 6 - Financial\n        //There is also a Financial audience segment, but is is based on a click and will need to be set in the click payload script. Element CTA must equal 'Investors'. Possibly case sensitive.\n        //Note that the Financial segment may be on page view when we switch to OneXP\n    }\n  \n    //Create an array to hold the audience segments a user qualifies for - All\n    var a_currentAudienceSegments = [];\n    //Populate the array with the local storage value if there is one\n    if (typeof(localStorage.getItem(\"a_profileAudienceSegmentsArray\")) != undefined) {\n      if (localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== null && localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== 'null' && localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== 'undefined' && localStorage.getItem(\"a_profileAudienceSegmentsArray\") !== '') {\n        a_currentAudienceSegments = JSON.parse(localStorage.getItem(\"a_profileAudienceSegmentsArray\"));\n        //a_currentAudienceSegments = localStorage.getItem(\"a_profileAudienceSegmentsArray\");\n      }\n    }\n\n    //Create an array to hold the audience segments a user qualifies for - last touch\n    var a_currentAudienceSegmentsLastTouch = [];\n    //Populate the array with the local storage value if there is one\n    if (typeof(localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\")) != undefined) {\n      if (localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== null && localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== 'null' && localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== 'undefined' && localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\") !== '') {\n        a_currentAudienceSegmentsLastTouch = JSON.parse(localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\"));\n        //a_currentAudienceSegmentsLastTouch = localStorage.getItem(\"a_profileAudienceSegmentsLastTouchArray\");\n      }\n    }\n  \n    //push current qualifyingSegment into the end of the array for all segments (not last touch) then reorder it to the front (so it won't be cut off when trimming the array) and if the page view flag is set to 0 so this won't be pushed twice when digital data is set again at DOM Ready.\n    if (qualifyingSegment !== null && qualifyingSegment != \"null\"){\n      if (a_msftSegmentQualificationFlag == 0) {\n        a_currentAudienceSegments.push(qualifyingSegment);\n        a_reorderArray(a_currentAudienceSegments, a_currentAudienceSegments.length -1, 0);\n      }\n    }\n  \n  \n    //Check existing last touch array for the audience segment, if already in then splice it to the front from the current location, if not, push it into the front of the array.\n    if (typeof(a_currentAudienceSegmentsLastTouch) != undefined) {\n      if (a_currentAudienceSegmentsLastTouch !== null && a_currentAudienceSegmentsLastTouch != \"undefined\") {\n        if (a_currentAudienceSegmentsLastTouch.length !== 0) {\n          if (a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment) !== -1) {\n              //Move the audienceSegment item to the front of the array\n              a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n          } else {\n            console.log(\"Type: \"+typeof(a_currentAudienceSegmentsLastTouch)+\" | Value:\");\n            console.log(a_currentAudienceSegmentsLastTouch);\n            a_currentAudienceSegmentsLastTouch.push(qualifyingSegment);\n            a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n          }\n        } else if (a_currentAudienceSegmentsLastTouch.length == 0) {\n          if (qualifyingSegment !== null && qualifyingSegment != \"null\"){\n            if (a_msftSegmentQualificationFlag == 0) {\n              a_currentAudienceSegmentsLastTouch.push(qualifyingSegment);\n              a_reorderArray(a_currentAudienceSegmentsLastTouch, a_currentAudienceSegmentsLastTouch.indexOf(qualifyingSegment), 0);\n            }\n          }\n        }\n      }\n    }\n    \n    //Clean out null values in the arrays\n    const a_currentAudienceSegmentsClean = a_currentAudienceSegments.filter(function(x) {\n      return (x != null);\n    });\n    console.log(\"Audience Segments Clean:\");\n    console.log(a_currentAudienceSegmentsClean);\n  \n    const a_currentAudienceSegmentsLastTouchClean = a_currentAudienceSegmentsLastTouch.filter(function(x) {\n      return x != null;\n    });\n    console.log(\"Audience Segments Last Touch Clean:\");\n    console.log(a_currentAudienceSegmentsLastTouchClean);\n\n    //Limit size of the a_currentAudienceSegmentsLastTouchClean array to 10 items with index 0-9 remaining to avoide 255 character limit error\n    //--note this code is not yet finished as of 2023/02/28\n    a_currentAudienceSegmentsClean.splice(10);\n\n    //set local storage to new array values\n    //--All\n    //set local storage to new array values\n    localStorage.setItem(\"a_profileAudienceSegmentsArray\",JSON.stringify(a_currentAudienceSegmentsClean));\n    //--Last Touch\n    localStorage.setItem(\"a_profileAudienceSegmentsLastTouchArray\",JSON.stringify(a_currentAudienceSegmentsLastTouchClean));\n\n    //Create a var to hold the current primary and secondary audience segment values\n    var a_currentPrimaryAudienceSegment;\n    var a_currentSecondaryAudienceSegment;\n    if (typeof(a_currentAudienceSegmentsLastTouchClean) != undefined && a_currentAudienceSegmentsLastTouchClean != \"undefined\") {\n      if (a_currentAudienceSegmentsLastTouchClean !== null) {\n        if (a_currentAudienceSegmentsLastTouchClean.length !== 0) {\n            a_currentPrimaryAudienceSegment = a_currentAudienceSegmentsLastTouchClean[0];\n        }\n\n        if (a_currentAudienceSegmentsLastTouchClean.length >= 1) {\n            a_currentSecondaryAudienceSegment = a_currentAudienceSegmentsLastTouchClean[1];\n        }\n      }\n    }\n  \n    //Set page view flag to data element value if it is not undefined or 0\n    if (a_msftPageViewFlagDE != \"undefined\" && a_msftPageViewFlagDE != undefined && a_msftPageViewFlagDE != 0 && a_msftPageViewFlagDE != null) {\n      a_msftPageViewFlag = a_msftPageViewFlagDE;\n    }\n    \n    //set a_msftSegmentQualificationFlag if not null\n    if (qualifyingSegment !== null){\n      if (a_msftSegmentQualificationFlag == 0) {\n        a_msftSegmentQualificationFlag = 1;\n      }\n    }\n*/\n\n  // set up initial window.adobeDataLayer on page load with any values available before DOM is ready\n  window.adobeDataLayer = window.adobeDataLayer || [];\n\n  //Set eventPayload and push it to the events array in the data layer\n  var eventPayloadObj = {\n    \"event\":eventName,\n    \"eventInfo\":{\n        \"videoInteractionDetails\": videoInteractionDetails,\n        //\"path\":pagePath\n        //\"path\":componentPath\n        \"path\":eventPath,\n        \"componentTitle\":componentTitle,\n        \"componentType\":componentType,\n        \"elementType\":elementType,\n        \"elementLinkName\":elementLinkName,\n        \"elementLinkType\":elementLinkType,\n        \"environment\" : {\n            \"browserDetails\": {\n                \"userAgent\": userAgentDE \n            },\n            \"_dc\": {\n                \"language\": environmentLanguageDE    \n            }\n        },\n        \"identityMap\": identityMapDE,\n        \"marketing\" : {\n          \"trackingCode\": ocidTrackingCode,\n          \"_mscom\": {\n            \"ICID\": icidTrackingCodeDE\n          }\n        }, \n        \"placeContext\": {\n            \"geo\": {\n              \"_schema\" : {\n                \"longitude\": longitudeDE,\n                \"latitude\": latitudeDE\n              },\n              \"countryCode\": countryCodeDE\n            }\n        },\n        \"_mscom\": {\n            \"consents\" : consentsSnapshotDE,\n            \"currentIdentities\" :{\n              \"ANON\" : anonIdDE,\n              \"ECID\": visitorECIDDE,\n              \"MC1GUID\" : mc1GUIDDE,\n              \"marketoLeadId\": marketoLeadIdDE,\n              \"marketoMunchkinCookie\": marketoMunchkinCookieDE,\n            },\n            \"eventData\": {\n              \"eventName\": eventDataName,\n              \"actionType\": eventActionType,\n              \"behaviorID\": eventBehaviorID,\n              \"eventBehaviorCategory\": eventBehaviorCategory,\n              \"eventCategory\":eventCategory\n            }\n        },\n        \"web\": {\n            \"webPageDetails\": {\n              \"isErrorPage\" : isErrorPageFlagDE,\n              \"isHomePage\" : isHomePageFlagDE,\n              \"name\": pageNameDE,\n              \"URL\": pageUrlDE,\n              \"_mscom\": {\n                  \"pageInfo\": {\n                      \"pageLoadTime\": pageLoadTimeDE,\n                      \"pageLoadTimeRange\": pageLoadTimeRangeDE,\n                      \"prevPageURL\": prevPageUrlDE,\n                      \"URLWithoutQS\": pageUrlNoQsDE,\n                      \"URLQS\": pageUrlQsDE,\n                      \"msftConsentBannerVisibilityFlag\":msftConsentBannerVisibilityFlagDE,\n                      \"metaOgTitle\":metaOgTitleDE,\n                      \"metaOgUrl\":metaOgUrlDE,\n                      \"metaPageTemplate\":metaPageTemplateDE,\n                      \"metaDescription\":metaDescriptionDE,\n                      \"metaAwaCms\":metaAwaCmsDE,\n                      \"metaAwaMarket\":metaAwaMarketDE,\n                      \"metaAwaPageType\":metaAwaPageTypeDE,\n                      \"metaAwaPageTemplate\":metaAwaPageTemplateDE,\n                      \"metaAwaIsTentedFlag\":metaAwaIsTentedFlagDE,\n                      \"metaAwaCanvasType\":metaAwaCanvasTypeDE          \n                  },\n                  \"siteInfo\": {\n                      \"siteBrand\": siteBrandDE,\n                      \"siteDomain\": siteDomainDE,\n                      \"siteID\": siteIDDE,\n                      \"siteLanguage\": siteLanguageDE,\n                      \"siteLocale\": siteLocaleDE,\n                      \"siteMarket\": siteMarketDE,\n                      \"siteName\": siteNameDE,\n                  }\n              }\n            },\n            \"webInteraction\": {\n                \"hitNumber\": hitNumberDE\n            },\n          \"webReferrer\":{\n              \"URL\": pageReferrerDE,\n              //\"type\": pageReferrerTypeDE\n              \"type\": pageReferrerType,\n              \"_mscom\": {\n                \"pageReferrerTypeDetails\":pageReferrerTypeDetails,\n                \"pageTrafficDetails\": pageTrafficDetails\n              }\n          },\n          \"_mscom\": {\n            \"webSession\":webSessionDetailsObjDE\n          }\n        }\n    }, //end eventInfo\n    //\"eventID\":eventID,\n    //\"eventName\":eventName,\n    \"site\":{\n        \"siteID\":siteIDDE,\n        \"siteDomain\":siteDomainDE,\n        \"siteBrand\":siteBrandDE,\n        \"siteLocale\":siteLocaleDE,\n        \"siteLanguage\":siteLanguageDE,\n        \"siteMarket\":siteMarketDE\n    }, //end site\n    \"page\":{\n      [pageIDDE]:{\n        //--\"aemTags\":aemTagValuesArray,\n        \"contentPath\":contentPathDE,\n        \"pagePath\":pagePath,\n        \"pageUrl\":pageUrlDE,\n        \"pageName\":pageNameDE,\n        \"pageCategory\":pageCategoryDE,\n        \"pageType\":pageTypeDE,\n        \"pageMetaContentType\":pageMetaContentTypeDE,\n        \"pageMetaThumbnailImg\":pageMetaThumbnailImgDE,\n        //\"prevPageName\":prevPageNameDE,\n        \"prevPageUrl\":prevPageUrlDE,\n        \"pageHeroImage\":pageHeroImageDE,\n        \"pageHeroImageContainerID\":pageHeroImageContainerIDDE,\n        \"pageHeroImageAssetID\":pageHeroImageAssetIDDE,\n        \"pageHeroImageRepoPath\":pageHeroImageRepoPathDE,\n        \"pageHeroImageRepoMobilePath\":pageHeroImageRepoMobilePathDE,\n        \"pageHeroImageDCTitle\":pageHeroImageDCTitleDE,\n        \"pageHeroImageType\":pageHeroImageTypeDE,\n        \"pageHeroImageFileExtension\":pageHeroImageFileExtensionDE,\n        \"pageHeroImageRepoModifyDate\":pageHeroImageRepoModifyDateDE,\n        \"pageHeroImageContainerType\":pageHeroImageContainerTypeDE,\n        \"pageHeroImageContainerTitle\":pageHeroImageContainerTitleDE,\n        \"siteSection1\":siteSection1,\n        \"siteSection2\":siteSection2,\n        \"siteSection3\":siteSection3,\n        \"siteSection4\":siteSection4,\n        \"siteSection5\":siteSection5,\n        \"msftPageViewFlag\":a_msftPageViewFlag,\n        //\"viewportSize\":viewportSizeDE,\n        //\"pageOrientation\":pageOrientationDE,\n        \"pagePublishedDateString\":a_datePublishedStringDE,\n        \"pagePublishedDateUnix\":a_datePublishedUnixDE,\n        \"pagePublicationDateMeta\":a_publicationDateMetaDE,\n        //\"aemTags\":aemTagsArrayDE\n        //\"msftConsentBannerVisibilityFlag\":a_msftConsentBannerVisibilityFlag,\n        \"msftConsentBannerVisibilityFlag\":msftConsentBannerVisibilityFlagDE,\n        \"metaOgTitle\":metaOgTitleDE,\n        \"metaOgUrl\":metaOgUrlDE,\n        \"metaPageTemplate\":metaPageTemplateDE,\n        \"metaDescription\":metaDescriptionDE,\n        \"metaAwaCms\":metaAwaCmsDE,\n        \"metaAwaMarket\":metaAwaMarketDE,\n        \"metaAwaPageType\":metaAwaPageTypeDE,\n        \"metaAwaPageTemplate\":metaAwaPageTemplateDE,\n        \"metaAwaIsTentedFlag\":metaAwaIsTentedFlagDE,\n        \"metaAwaCanvasType\":metaAwaCanvasTypeDE,\n        \"pageLoadTime\": pageLoadTimeDE,\n        \"pageLoadTimeRange\": pageLoadTimeRangeDE\n      }\n    }, //end page\n    \"campaign\":{\n        \"campaignID\":campaignIDDE,\n        \"campaignDetails\":campaignDetailsDE,\n        \"utmCampaign\":utmCampaignDE,\n        \"utmContent\":utmContentDE,\n        \"utmId\":utmIdDE,\n        \"utmMedium\":utmMediumDE,\n        \"utmSource\":utmSourceDE,\n        \"utmTerm\":utmTermDE,\n        //\"campaignName\":campaignName,\n        //\"campaignType\":campaignType\n    }, //end campaign\n    \"visitorProfile\":{\n        \"visitorECID\":visitorECIDDE,\n        \"visitorIdentityMap\":identityMapDE,\n        \"consentsSnapshot\":consentsSnapshotDE,\n        \"webSessionDetails\":webSessionDetailsObjDE,\n        \"placeContext\": {\n          \"geo\": {\n            \"_schema\" : {\n              \"longitude\": longitudeDE,\n              \"latitude\": latitudeDE\n            },\n            \"countryCode\": countryCodeDE\n          }\n        }\n        //\"audienceSegments\":a_currentAudienceSegmentsClean,\n        //\"audienceSegmentPrimary\":a_currentPrimaryAudienceSegment,\n        //\"audienceSegmentSecondary\":a_currentSecondaryAudienceSegment,\n        //\"segmentQualificationFlag\":a_msftSegmentQualificationFlag,\n        //\"pageCategoryFlag\":a_msftpageCategoryFlag,\n        //\"visitormsftNameID\":msftNameIDDE,\n        //\"visitorFederatedId\":FederatedIDDE,\n        //\"userProfileStateAuthentication\":userProfileStateAuthentication,\n        //\"lastSearchedTerm\":lastSearchedTerm,\n        /*\n        \"locationInfo\":{\n            \"postalCode\":visitorProfilePostalCode,\n            \"country\":visitorProfileCountry,\n            \"state\":visitorProfileState,\n            \"city\":visitorProfileCity\n        }, //end locationInfo\n        \"brandPreferences\":{\n            \"userPreferredBrand\":{\n                \"brandInfo\":{\n                    \"brandID\":visitorProfilePreferredBrandID,\n                    \"brandName\":visitorProfilePreferredBrandName\n                }\n            }, //end userPreferredBrand\n            \"userLikedBrands\":userLikedBrandsArrayDL\n            } //end brandPreferences\n        */\n    } //end visitorProfile\n    //} //end eventInfo\n  } //end eventPayloadObj\n  window.adobeDataLayer.push(eventPayloadObj); //end push script\n  \n  //--Event Info\n  adobeSatelliteName.setVar(\"dl_eventName\", eventName);\n  adobeSatelliteName.setVar(\"dl_eventDataName\", eventDataName);\n  adobeSatelliteName.setVar(\"dl_eventActionType\", eventActionType);\n  adobeSatelliteName.setVar(\"dl_eventBehaviorID\", eventBehaviorID);\n  adobeSatelliteName.setVar(\"dl_eventCategory\", eventCategory);\n  adobeSatelliteName.setVar(\"dl_eventBehaviorCategory\", eventBehaviorCategory);\n  adobeSatelliteName.setVar(\"dl_hitNumber\", hitNumberDE);\n  adobeSatelliteName.setVar(\"dl_isErrorPageFlag\", isErrorPageFlagDE);\n  adobeSatelliteName.setVar(\"dl_prevPageUrl\", prevPageUrlDE)\n\n  if (componentFlag == \"Y\") {\n    adobeSatelliteName.setVar(\"dl_componentTitle\", componentTitle);\n    adobeSatelliteName.setVar(\"dl_componentType\", componentType);\n    adobeSatelliteName.setVar(\"dl_elementCTA\", componentTitle);\n    adobeSatelliteName.setVar(\"dl_elementType\", elementType);\n    adobeSatelliteName.setVar(\"dl_elementLinkName\", elementLinkName);\n    adobeSatelliteName.setVar(\"dl_elementLinkType\", elementLinkType);\n    adobeSatelliteName.setVar(\"dl_pageSectionID\", componentIDDE);\n    adobeSatelliteName.setVar(\"dl_pageSection\", componentTitle);\n  }\n\n  \n  if (eventName == 'pageView') {\n    //a_setPageViewFlag();\n    //Dispatch custom JS pageView event to listen for.\n    var a_pageViewTrigger = new CustomEvent('Page View Trigger', { 'detail': eventPayloadObj });\n      window.dispatchEvent(a_pageViewTrigger);\n      console.log('Page View Trigger Event Dispatched!');\n  }\n  \n}\n\nsetAdobeDataLayer(\"libraryLoaded\");\n\n//Listen for pageView event then trigger a_setPageViewFlag();\n//window.addEventListener('Page View Trigger',a_setPageViewFlag);",
language:"javascript"},timeout:2e3,delayNext:!0}]}]};var _satellite=function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function t(e){var t,o;return!1!==n(e)&&(void 0===(t=e.constructor)||!1!==n(o=t.prototype)&&!1!==o.hasOwnProperty("isPrototypeOf"))}function o(e){return"string"==typeof e&&-1!==e.indexOf("[")&&-1!==e.indexOf("]")}function a(e){return e.substr(0,e.indexOf("["))}function r(e,n,t){if(e.length&&un(n)){var i=e[0];if(1!==e.length){var s=e.slice(1);if(!o(i))return r(s,n[i],t);var l=n[i=a(i)];Array.isArray(l)&&l.forEach((function(e){return r(s,e,t)}))}else n.hasOwnProperty(i)&&"string"==typeof n[i]&&(n[i]=t(n[i]))}}if(window.atob){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=document,l=Object.assign,c=window,m=c,d=function(e,n,t,o){var a,r=Boolean(n&&Array.isArray(t)),i=Boolean(r&&e),s=document.createElement("a");if(r){var l=function(){var e=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw e.code="dynamic_host_resolver_constructor_error",e};if(e&&(/^((https?:)?\/\/).+/.test(e)||l(),/^\/\/.+/.test(e)?s.href=m.location.protocol+e:s.href=e),s.hostname||l(),-1===t.indexOf(s.hostname)){var c=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw c.code="dynamic_host_not_allowed",c}}var d=function(){if(null!=a)return a;if(i){var e=s.host;/:80$/.test(e)?e=e.replace(":80",""):/:80\/$/.test(e)?e=e.replace(":80/",""):/:443$/.test(e)?e=e.replace(":443",""):/:443\/$/.test(e)&&(e=e.replace(":443/","")),a=s.protocol+"//"+e}else a="";return a},u=function(e){return i&&"string"==typeof e?[d(),"/"===e.charAt(0)?e.slice(1):e].join("/"):e},f={getTurbineHost:d,decorateWithDynamicHost:u,get isDynamicEnforced(){return r}};return m&&o.onDebugChanged((function(e){e?m.dynamicHostResolver=f:delete m.dynamicHostResolver})),f},u=function(e){var n=[];return e.forEach((function(e){e.events&&e.events.forEach((function(t){n.push({rule:e,event:t})}))})),n.sort((function(e,n){return e.event.ruleOrder-n.event.ruleOrder}))},f="debug",p=function(e,n){var t=function(){return"true"===e.getItem(f)},o=function(n){e.setItem(f,n)},a=[],r=function(e){a.push(e)};return n.outputEnabled=t(),{onDebugChanged:r,getDebugEnabled:t,setDebugEnabled:function(e){t()!==e&&(o(e),n.outputEnabled=e,a.forEach((function(n){n(e)})))}}},g="Module did not export a function.",w=function(e,n,t){return function(o,a,r){r=r||[];var i=e.getModuleExports(o.modulePath);if("function"!=typeof i)throw new Error(g);var s=e.getModuleDefinition(o.modulePath),l=o.settings||{};!o.hasTransformedFilePaths&&s.filePaths&&(t(l,s.filePaths,o.modulePath),o.hasTransformedFilePaths=!0);var c=n(l,a);return i.bind(null,c).apply(null,r)}},h=function(e){return"string"==typeof e?e.replace(/\s+/g," ").trim():e},y={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},v="\ud83d\ude80",b=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":v,I=!1,S=function(e){if(I&&window.console){var n=Array.prototype.slice.call(arguments,1);n.unshift(b),e!==y.DEBUG||window.console[e]||(e=y.INFO),window.console[e].apply(window.console,n)}},_=S.bind(null,y.LOG),C=S.bind(null,y.INFO),T=S.bind(null,y.DEBUG),D=S.bind(null,y.WARN),k=S.bind(null,y.ERROR),x=function(){var e=I;I=!0,S.apply(null,Array.prototype.concat(y.WARN,Array.prototype.slice.call(arguments))),e||(I=!1)},P={log:_,info:C,debug:T,warn:D,error:k,deprecation:x,get outputEnabled(){return I},set outputEnabled(e){I=e},createPrefixedLogger:function(e){var n="["+e+"]";return{log:_.bind(null,n),info:C.bind(null,n),debug:T.bind(null,n),warn:D.bind(null,n),error:k.bind(null,n)}}},A=c,O="com.adobe.reactor.",E=function(e,n){var t=O+(n||"");return{getItem:function(n){try{return A[e].getItem(t+n)}catch(e){return null}},setItem:function(n,o){try{return A[e].setItem(t+n,o),!0}catch(e){return!1}}}},N=E,L="dataElements.",R=N("sessionStorage",L),U=N("localStorage",L),V={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},j={},q=function(e){var n;try{n=JSON.stringify(e)}catch(e){}return n},M=h,F=P,B={setValue:function(e,n,t){var o;switch(n){case V.PAGEVIEW:return void(j[e]=t);case V.SESSION:return void((o=q(t))&&R.setItem(e,o));case V.VISITOR:return void((o=q(t))&&U.setItem(e,o))}},getValue:function(e,n){var t;switch(n){case V.PAGEVIEW:return j.hasOwnProperty(e)?j[e]:null;case V.SESSION:return null===(t=R.getItem(e))?t:JSON.parse(t);case V.VISITOR:return null===(t=U.getItem(e))?t:JSON.parse(t)}}},z=function(e,n,t,o){return"Failed to execute data element module "+e.modulePath+" for data element "+n+". "+t+(o?"\n"+o:"")},H=function(e,n,t,o,a){return function(r,i){var s=n(r);if(!s)return o?"":void 0;var l,c,m=s.storageDuration;try{l=e.getModuleExports(s.modulePath),c=e.getModuleDefinition(s.modulePath)}catch(e){return void F.error(z(s,r,e.message,e.stack))}if("function"==typeof l){var d,u=s.settings||{};!s.hasTransformedFilePaths&&c.filePaths&&(a(u,c.filePaths,s.modulePath),s.hasTransformedFilePaths=!0);try{d=l(t(u,i),i)}catch(e){return void F.error(z(s,r,e.message,e.stack))}return m&&(null!=d?B.setValue(r,m,d):d=B.getValue(r,m)),null==d&&null!=s.defaultValue&&(d=s.defaultValue),"string"==typeof d&&(s.cleanText&&(d=M(d)),s.forceLowerCase&&(d=d.toLowerCase())),d}F.error(z(s,r,"Module did not export a function."))}},$=h,W={text:function(e){return e.textContent},cleanText:function(e){return $(e.textContent)}},G=function(e,n,t){for(var o,a=e,r=0,i=n.length;r<i;r++){if(null==a)return;var s=n[r];if(t&&"@"===s.charAt(0)){var l=s.slice(1);a=W[l](a)}else if(a.getAttribute&&(o=s.match(/^getAttribute\((.+)\)$/))){var c=o[1];a=a.getAttribute(c)}else a=a[s]}return a},Q=function(e,n,t){return function(o,a){var r;if(n(o))r=t(o,a);else{var i=o.split("."),s=i.shift();"this"===s?a&&(r=G(a.element,i,!0)):"event"===s?a&&(r=G(a,i)):"target"===s?a&&(r=G(a.target,i)):r=G(e[s],i)}return r}},J=function(e,n){return function(t){var o=t.split(".")[0];return Boolean(n(t)||"this"===o||"event"===o||"target"===o||e.hasOwnProperty(o))}},X=function(e,n,t){var o={exports:{}};return e.call(o.exports,o,o.exports,n,t),o.exports},Y=X,K=P,Z=function(){var e={},n=function(n){var t=e[n];if(!t)throw new Error("Module "+n+" not found.");return t},t=function(){Object.keys(e).forEach((function(e){try{o(e)}catch(t){var n="Error initializing module "+e+". "+t.message+(t.stack?"\n"+t.stack:"");K.error(n)}}))},o=function(e){var t=n(e);return t.hasOwnProperty("exports")||(t.exports=Y(t.definition.script,t.require,t.turbine)),t.exports};return{registerModule:function(n,t,o,a,r){var i={definition:t,extensionName:o,require:a,turbine:r};i.require=a,e[n]=i},hydrateCache:t,getModuleExports:o,getModuleDefinition:function(e){return n(e).definition},getModuleExtensionName:function(e){return n(e).extensionName}}},ee=P,ne=!1,te=function(e){return function(n,t){var o=e._monitors;o&&(ne||(ee.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),ne=!0),o.forEach((function(e){e[n]&&e[n](t)})))}},oe=P,ae=function(e,n,t){var o,a,r,i,s=[],l=function(o,a,r){if(!e(a))return o;s.push(a);var i=n(a,r);return s.pop(),null==i&&t?"":i};return o=function(e,n){var t=/^%([^%]+)%$/.exec(e);return t?l(e,t[1],n):e.replace(/%(.+?)%/g,(function(e,t){return l(e,t,n)}))},a=function(e,n){for(var t={},o=Object.keys(e),a=0;a<o.length;a++){var r=o[a],s=e[r];t[r]=i(s,n)}return t},r=function(e,n){for(var t=[],o=0,a=e.length;o<a;o++)t.push(i(e[o],n));return t},i=function(e,n){return"string"==typeof e?o(e,n):Array.isArray(e)?r(e,n):"object"==typeof e&&null!==e?a(e,n):e},function(e,n){return s.length>10?(oe.error("Data element circular reference detected: "+s.join(" -> ")),e):i(e,n)}},re=function(e){return function(){if("string"==typeof arguments[0])e[arguments[0]]=arguments[1];else if(arguments[0]){var n=arguments[0];for(var t in n)e[t]=n[t]}}},ie="undefined"!=typeof window&&window.Promise||void 0!==i&&i.Promise,se=ie,le=function(e,n,t){return function(o,a,r,i){return i.then((function(){var i,s=o.delayNext;return new se((function(n,t){var a=e(o,r,[r]);if(!s)return n();var l=o.timeout,c=new se((function(e,n){i=setTimeout((function(){n(new Error("A timeout occurred because the action took longer than "+l/1e3+" seconds to complete. "))}),l)}));se.race([a,c]).then(n,t)})).catch((function(e){return clearTimeout(i),e=n(e),t(o,a,e),se.reject(e)})).then((function(){clearTimeout(i)}))}))}},ce=ie,me=function(e,n,t,o,a){return function(r,i,s,l){return l.then((function(){var l;return new ce((function(n,t){var o=e(r,s,[s]),a=r.timeout,i=new ce((function(e,n){l=setTimeout((function(){n(new Error("A timeout occurred because the condition took longer than "+a/1e3+" seconds to complete. "))}),a)}));ce.race([o,i]).then(n,t)})).catch((function(e){return clearTimeout(l),e=n(e),o(r,i,e),ce.reject(e)})).then((function(e){if(clearTimeout(l),!t(r,e))return a(r,i),ce.reject()}))}))}},de=ie.resolve(),ue=function(e,n,t){return function(o,a){return o.conditions&&o.conditions.forEach((function(n){de=e(n,o,a,de)})),o.actions&&o.actions.forEach((function(e){de=n(e,o,a,de)})),de=(de=de.then((function(){t(o)}))).catch((function(){}))}},fe=function(e){return Boolean(e&&"object"==typeof e&&"function"==typeof e.then)},pe=function(e,n,t,o){return function(a,r){var i;if(a.conditions)for(var s=0;s<a.conditions.length;s++){i=a.conditions[s];try{var l=e(i,r,[r]);if(fe(l))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!n(i,l))return t(i,a),!1}catch(e){return o(i,a,e),!1}}return!0}},ge=function(e,n){return function(t,o){e(t,o)&&n(t,o)}},we=function(e){return function(n){var t=e.getModuleDefinition(n.modulePath);return t&&t.displayName||n.modulePath}},he=function(e){return function(n){var t=n.rule,o=n.event,a=e.getModuleDefinition(o.modulePath).name;return{$type:e.getModuleExtensionName(o.modulePath)+"."+a,$rule:{id:t.id,name:t.name}}}},ye=function(e,n,t,o,a,r){return function(i,s){var l=s.rule,c=s.event;c.settings=c.settings||{};try{var m=a(s);n(c,null,[function(n){var o=t(m,n);i((function(){e(o,l)}))}])}catch(e){r.error(o(c,l,e))}}},ve=function(e,n,t,o){return function(a,r,i){var s=n(a);t.error(e(s,r.name,i)),o("ruleActionFailed",{rule:r,action:a})}},be=function(e,n,t,o){return function(a,r,i){var s=n(a);t.error(e(s,r.name,i)),o("ruleConditionFailed",{rule:r,condition:a})}},Ie=function(e,n,t){return function(o,a){var r=e(o);n.log('Condition "'+r+'" for rule "'+a.name+'" was not met.'),t("ruleConditionFailed",{rule:a,condition:o})}},Se=function(e,n){return function(t){e.log('Rule "'+t.name+'" fired.'),n("ruleCompleted",{rule:t})}},_e=function(e,n,t){return function(o,a){var r;if(o.actions)for(var i=0;i<o.actions.length;i++){r=o.actions[i];try{e(r,a,[a])}catch(e){return void n(r,o,e)}}t(o)}},Ce=function(e,n,t,o){return function(a,r){o("ruleTriggered",{rule:r}),e?t(r,a):n(r,a)}},Te=function(e,n,t){return'Failed to execute "'+e+'" for "'+n+'" rule. '+t.message+(t.stack?"\n"+t.stack:"")},De=function(e,n){return n&&!e.negate||!n&&e.negate},ke=[],xe=!1,Pe=function(e){xe?e():ke.push(e)},Ae=function(e,n,t){e(n).forEach((function(e){t(Pe,e)})),xe=!0,ke.forEach((function(e){e()})),ke=[]},Oe=function(e){if(e||(e=new Error("The extension triggered an error, but no error information was provided.")),!(e instanceof Error)){var n="object"==typeof e?JSON.stringify(e):String(e);e=new Error(n)}return e},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.isPlainObject=t;var Ne,Le=P,Re=l,{isPlainObject:Ue}=Ee,Ve=function(e,n){return Ue(n=n||{})?n=Re({},n,e):Re(n,e),n.hasOwnProperty("type")||Object.defineProperty(n,"type",{get:function(){return Le.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),n.$type}}),n},je=function(e,n){return function(t,o){var a=e[t];if(a){var r=a.modules;if(r)for(var i=Object.keys(r),s=0;s<i.length;s++){var l=i[s],c=r[l];if(c.shared&&c.name===o)return n.getModuleExports(l)}}}},qe=function(e,n){return function(){return n?e(n):{}}},Me=function(e,n,t){return function(o){if(t){var a=o.split(".");a.splice(a.length-1||1,0,"min"),o=a.join(".")}return e(n)+o}},Fe=".js",Be=function(e){return e.substr(0,e.lastIndexOf("/"))},ze=function(e,n){return-1!==e.indexOf(n,e.length-n.length)},He=function(e,n){ze(n,Fe)||(n+=Fe);var t=n.split("/"),o=Be(e).split("/");return t.forEach((function(e){e&&"."!==e&&(".."===e?o.length&&o.pop():o.push(e))})),o.join("/")},$e={exports:{}};Ne=function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var o in t)n[o]=t[o]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function t(o){function a(){}function r(n,t,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},a.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var i=JSON.stringify(t);/^[\{\[]/.test(i)&&(t=i)}catch(e){}t=o.write?o.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var l in r)r[l]&&(s+="; "+l,!0!==r[l]&&(s+="="+r[l].split(";")[0]));return document.cookie=n+"="+t+s}}function i(e,t){if("undefined"!=typeof document){for(var a={},r=document.cookie?document.cookie.split("; "):[],i=0;i<r.length;i++){var s=r[i].split("="),l=s.slice(1).join("=");t||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=n(s[0]);if(l=(o.read||o)(l,c)||n(l),t)try{l=JSON.parse(l)}catch(e){}if(a[c]=l,e===c)break}catch(e){}}return e?a[e]:a}}return a.set=r,a.get=function(e){return i(e,!1)},a.getJSON=function(e){return i(e,!0)},a.remove=function(n,t){r(n,"",e(t,{expires:-1}))},a.defaults={},a.withConverter=t,a}return t((function(){}))},$e.exports=Ne();var We=$e.exports,Ge={get:We.get,set:We.set,remove:We.remove},Qe=ie,Je=function(e,n){return new Qe((function(t,o){n.onload=function(){t(n)},n.onerror=function(){o(new Error("Failed to load script "+e))}}))},Xe=function(e){var n={};if(!e||"string"!=typeof e)return n;var t=e.trim().replace(/^[?#&]/,""),o=new URLSearchParams(t),a=o.keys();do{var r=a.next(),i=r.value;if(i){var s=o.getAll(i);1===s.length?n[i]=s[0]:n[i]=s}}while(!1===r.done);return n},Ye=function(e){var n="{{space}}",t=new URLSearchParams;return Object.keys(e).forEach((function(o){var a=e[o];"string"==typeof e[o]?a=a.replace(/ /g,n):["object","undefined"].includes(typeof a)&&!Array.isArray(a)&&(a=""),Array.isArray(a)?a.forEach((function(e){t.append(o,e)})):t.append(o,a)})),t.toString().replace(new RegExp(encodeURIComponent(n),"g"),"%20")},Ke="@adobe/reactor-",Ze={cookie:Ge,document:s,"load-script":function(e){var n=document.createElement("script");n.src=e,n.async=!0;var t=Je(e,n);return document.getElementsByTagName("head")[0].appendChild(n),t},"object-assign":l,promise:ie,"query-string":{parse:function(e){return Xe(e)},stringify:function(e){return Ye(e)}},window:c},en=function(e){return function(n){if(0===n.indexOf(Ke)){var t=n.substr(Ke.length),o=Ze[t];if(o)return o}if(0===n.indexOf("./")||0===n.indexOf("../"))return e(n);throw new Error('Cannot resolve module "'+n+'".')}},nn=je,tn=qe,on=Me,an=P,rn=He,sn=en,ln=function(e,n,t,o,a,r,i){var s=e.extensions,l=e.buildInfo,c=e.environment,m=e.property.settings;if(s){var d=nn(s,n);Object.keys(s).forEach((function(u){var f=s[u],p=f.settings;Array.isArray(f.filePaths)&&(p=r(p,f.filePaths));var g=tn(o,p);if(f.modules){var w=an.createPrefixedLogger(f.displayName),h=on(i,f.hostedLibFilesBaseUrl,l.minified),y={buildInfo:l,environment:c,property:{name:e.property.name,id:e.property.id},getDataElementValue:a,getExtensionSettings:g,getHostedLibFileUrl:h,getSharedModule:d,logger:w,propertySettings:m,replaceTokens:o,onDebugChanged:t.onDebugChanged,get debugEnabled(){return t.getDebugEnabled()}};Object.keys(f.modules).forEach((function(e){var t=f.modules[e],o=sn((function(t){var o=rn(e,t);return n.getModuleExports(o)}));n.registerModule(e,t,u,o,y)}))}})),n.hydrateCache()}return n},cn=Ge,mn=P,dn=function(e,n,t,o,a){var r=mn.createPrefixedLogger("Custom Script");e.track=function(e){mn.log('"'+e+'" does not match any direct call identifiers.')},e.getVisitorId=function(){return null},e.property={name:n.property.name,id:n.property.id},e.company=n.company,e.buildInfo=n.buildInfo,e.environment=n.environment,e.logger=r,e.notify=function(e,n){switch(mn.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),n){case 3:r.info(e);break;case 4:r.warn(e);break;case 5:r.error(e);break;default:r.log(e)}},e.getVar=o,e.setVar=a,e.setCookie=function(e,n,t){var o="",a={};t&&(o=", { expires: "+t+" }",a.expires=t);var r='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+e+'", "'+n+'"'+o+").";mn.deprecation(r),cn.set(e,n,a)},e.readCookie=function(e){return mn.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+e+'").'),cn.get(e)},e.removeCookie=function(e){mn.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+e+'").'),cn.remove(e)},e.cookie=cn,e.pageBottom=function(){},e.setDebug=t;var i=!1;Object.defineProperty(e,"_container",{get:function(){return i||(mn.warn("_satellite._container may change at any time and should only be used for debugging."),i=!0),n}})},{isPlainObject:un}=Ee,fn=s,pn=l,gn=d,wn=u,hn=p,yn=w,vn=H,bn=Q,In=J,Sn=Z,_n=te,Cn=ae,Tn=re,Dn=le,kn=me,xn=ue,Pn=pe,An=ge,On=we,En=he,Nn=ye,Ln=ve,Rn=be,Un=Ie,Vn=Se,jn=_e,qn=Ce,Mn=Te,Fn=De,Bn=Ae,zn=Oe,Hn=Ve,$n=E,Wn=ln,Gn=dn,Qn=function(e,n){return function(t,o,a){return e&&un(t)&&Object.keys(t).length&&Array.isArray(o)&&o.length?(o.forEach((function(e){Boolean(null!=a&&/^core\/.*actions.*\/customCode\.js$/.test(a))&&"source"===e&&!t.isExternal||r(e.split("."),t,n)})),t):t}},Jn=P,Xn=window._satellite;if(Xn&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var Yn=Xn.container;delete Xn.container;var Kn=pn({},Yn.buildInfo);Object.defineProperty(Kn,"environment",{get:function(){return Jn.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),Yn.environment.stage}}),Yn.buildInfo=Kn;var Zn,et=hn($n("localStorage"),Jn),nt="";fn.currentScript&&fn.currentScript.getAttribute("src")&&(nt=fn.currentScript.getAttribute("src"));try{Zn=gn(nt,Boolean(Yn.company.dynamicCdnEnabled),Yn.company.cdnAllowList,et)}catch(e){throw Jn.warn("Please review the following error:"),e}var tt,ot=Qn(Zn.isDynamicEnforced,Zn.decorateWithDynamicHost),at=Sn(),rt=Yn.property.settings.undefinedVarsReturnEmpty,it=Yn.property.settings.ruleComponentSequencingEnabled,st=Yn.dataElements||{},lt=function(e){return st[e]},ct=function(){return tt.apply(null,arguments)},mt=vn(at,lt,ct,rt,ot),dt={},ut=Tn(dt),ft=In(dt,lt),pt=bn(dt,lt,mt);tt=Cn(ft,pt,rt),Gn(Xn,Yn,et.setDebugEnabled,pt,ut),Wn(Yn,at,et,tt,mt,ot,Zn.decorateWithDynamicHost);var gt=_n(Xn),wt=yn(at,tt,ot),ht=On(at),yt=Un(ht,Jn,gt),vt=Rn(Mn,ht,Jn,gt),bt=Ln(Mn,ht,Jn,gt),It=Vn(Jn,gt),St=Nn(qn(it,An(Pn(wt,Fn,yt,vt),jn(wt,bt,It)),xn(kn(wt,zn,Fn,vt,yt),Dn(wt,zn,bt),It),gt),wt,Hn,Mn,En(at),Jn);Bn(wn,Yn.rules||[],St)}return e(Xn)}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();